<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-码农/苍穹外卖/苍穹外卖-day06" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">苍穹外卖-day06 | Coisini</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day06/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="苍穹外卖-day06 | Coisini"><meta data-rh="true" name="description" content="课程内容"><meta data-rh="true" property="og:description" content="课程内容"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day06/"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day06/" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day06/" hreflang="x-default"><meta name="google-site-verification" content="1FUPX6Qo4y3ecU623ShEurhgnjhSTjK49rRMhEDlzFA">
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.79037026.css">
<script src="/assets/js/runtime~main.468f2b27.js" defer="defer"></script>
<script src="/assets/js/main.4763ab3e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Coisini</b></a></div><div class="navbar__items navbar__items--right"><a href="https://minddiy.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>苍穹外卖-day06</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="课程内容">课程内容<a href="#课程内容" class="hash-link" aria-label="Direct link to 课程内容" title="Direct link to 课程内容">​</a></h2>
<ul>
<li>HttpClient</li>
<li>微信小程序开发</li>
<li>微信登录</li>
<li>导入商品浏览功能代码</li>
</ul>
<p>功能实现：<strong>微信登录</strong>、<strong>商品浏览</strong></p>
<p><strong>微信登录效果图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203184545847-d46e5ab4ef6885a973c609356e1dba57.png" width="434" height="763" class="img_ev3q"></p>
<p><strong>商品浏览效果图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203184623026-79db4decf0e7db55cacaf2aebb22095c.png" width="431" height="763" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-httpclient">1. HttpClient<a href="#1-httpclient" class="hash-link" aria-label="Direct link to 1. HttpClient" title="Direct link to 1. HttpClient">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-介绍">1.1 介绍<a href="#11-介绍" class="hash-link" aria-label="Direct link to 1.1 介绍" title="Direct link to 1.1 介绍">​</a></h3>
<p>HttpClient 是Apache Jakarta Common 下的子项目，可以用来提供高效的、最新的、功能丰富的支持 HTTP 协议的客户端编程工具包，并且它支持 HTTP 协议最新的版本和建议。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203185003231-9a80586e11428806537894e423d6f550.png" width="1196" height="288" class="img_ev3q"></p>
<p><strong>HttpClient作用：</strong></p>
<ul>
<li>发送HTTP请求</li>
<li>接收响应数据</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203185149985-2508d6cb11225449fa5b6fb722519b57.png" width="134" height="226" class="img_ev3q"></p>
<p><strong>HttpClient应用场景：</strong></p>
<p>当我们在使用扫描支付、查看地图、获取验证码、查看天气等功能时</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203185536013-f2eb8484115495d43aa060b0049e92ed.png" width="353" height="259" class="img_ev3q"></p>
<p>其实，应用程序本身并未实现这些功能，都是在应用程序里访问提供这些功能的服务，访问这些服务需要发送HTTP请求，并且接收响应数据，可通过HttpClient来实现。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203185427462-90f503b0f20105d08a4dc4d18dd74711.png" width="1159" height="588" class="img_ev3q"></p>
<p><strong>HttpClient的maven坐标：</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.apache.httpcomponents</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">httpclient</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">4.5.13</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>HttpClient的核心API：</strong></p>
<ul>
<li>HttpClient：Http客户端对象类型，使用该类型对象可发起Http请求。</li>
<li>HttpClients：可认为是构建器，可创建HttpClient对象。</li>
<li>CloseableHttpClient：实现类，实现了HttpClient接口。</li>
<li>HttpGet：Get方式请求类型。</li>
<li>HttpPost：Post方式请求类型。</li>
</ul>
<p><strong>HttpClient发送请求步骤：</strong></p>
<ul>
<li>创建HttpClient对象</li>
<li>创建Http请求对象</li>
<li>调用HttpClient的execute方法发送请求</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-入门案例">1.2 入门案例<a href="#12-入门案例" class="hash-link" aria-label="Direct link to 1.2 入门案例" title="Direct link to 1.2 入门案例">​</a></h3>
<p>对HttpClient编程工具包有了一定了解后，那么，我们使用HttpClient在Java程序当中来构造Http的请求，并且把请求发送出去，接下来，就通过入门案例分别发送<strong>GET请求</strong>和<strong>POST请求</strong>，具体来学习一下它的使用方法。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="121-get方式请求">1.2.1 GET方式请求<a href="#121-get方式请求" class="hash-link" aria-label="Direct link to 1.2.1 GET方式请求" title="Direct link to 1.2.1 GET方式请求">​</a></h4>
<p>正常来说，首先，应该导入HttpClient相关的坐标，但在项目中，就算不导入，也可以使用相关的API。</p>
<p>因为在项目中已经引入了aliyun-sdk-oss坐标：</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">com.aliyun.oss</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">aliyun-sdk-oss</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述依赖的底层已经包含了HttpClient相关依赖。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203194852825-fae8749c7dc81b05e1e3accc053f57f3.png" width="712" height="707" class="img_ev3q"></p>
<p>故选择导入或者不导入均可。</p>
<p>进入到sky-server模块，编写测试代码，发送GET请求。</p>
<p><strong>实现步骤：</strong></p>
<ol>
<li>创建HttpClient对象</li>
<li>创建请求对象</li>
<li>发送请求，接受响应结果</li>
<li>解析结果</li>
<li>关闭资源</li>
</ol>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.test;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.http.HttpEntity;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.http.client.methods.CloseableHttpResponse;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.http.client.methods.HttpGet;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.http.impl.client.CloseableHttpClient;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.http.impl.client.HttpClients;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.http.util.EntityUtils;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.junit.jupiter.api.Test;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.boot.test.context.SpringBootTest;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class HttpClientTest {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 测试通过httpclient发送GET方式的请求</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void testGET() throws Exception{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //创建httpclient对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        CloseableHttpClient httpClient = HttpClients.createDefault();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //创建请求对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        HttpGet httpGet = new HttpGet(&quot;http://localhost:8080/user/shop/status&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //发送请求，接受响应结果</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        CloseableHttpResponse response = httpClient.execute(httpGet);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获取服务端返回的状态码</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        int statusCode = response.getStatusLine().getStatusCode();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(&quot;服务端返回的状态码为：&quot; + statusCode);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        HttpEntity entity = response.getEntity();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String body = EntityUtils.toString(entity);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(&quot;服务端返回的数据为：&quot; + body);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //关闭资源</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        response.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        httpClient.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在访问<a href="http://localhost:8080/user/shop/status%E8%AF%B7%E6%B1%82%E6%97%B6%EF%BC%8C%E9%9C%80%E8%A6%81%E6%8F%90%E5%89%8D%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:8080/user/shop/status请求时，需要提前启动项目。</a></p>
<p><strong>测试结果：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203195917572-2ae9111e050fd5b2f2167f94254dc448.png" width="1059" height="448" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="122-post方式请求">1.2.2 POST方式请求<a href="#122-post方式请求" class="hash-link" aria-label="Direct link to 1.2.2 POST方式请求" title="Direct link to 1.2.2 POST方式请求">​</a></h4>
<p>在HttpClientTest中添加POST方式  请求方法，相比GET请求来说，POST请求若携带参数需要封装请求体对象，并将该对象设置在请求对象中。</p>
<p><strong>实现步骤：</strong></p>
<ol>
<li>创建HttpClient对象</li>
<li>创建请求对象</li>
<li>发送请求，接收响应结果</li>
<li>解析响应结果</li>
<li>关闭资源</li>
</ol>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 测试通过httpclient发送POST方式的请求</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void testPOST() throws Exception{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        // 创建httpclient对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        CloseableHttpClient httpClient = HttpClients.createDefault();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //创建请求对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        HttpPost httpPost = new HttpPost(&quot;http://localhost:8080/admin/employee/login&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        JSONObject jsonObject = new JSONObject();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        jsonObject.put(&quot;username&quot;,&quot;admin&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        jsonObject.put(&quot;password&quot;,&quot;123456&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        StringEntity entity = new StringEntity(jsonObject.toString());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //指定请求编码方式</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        entity.setContentEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //数据格式</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        entity.setContentType(&quot;application/json&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        httpPost.setEntity(entity);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //发送请求</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        CloseableHttpResponse response = httpClient.execute(httpPost);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //解析返回结果</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        int statusCode = response.getStatusLine().getStatusCode();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(&quot;响应码为：&quot; + statusCode);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        HttpEntity entity1 = response.getEntity();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String body = EntityUtils.toString(entity1);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(&quot;响应数据为：&quot; + body);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //关闭资源</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        response.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        httpClient.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>测试结果：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203201023925-16ffbac9c09b55cb2fb1281c5ec9acdf.png" width="1728" height="372" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-微信小程序开发">2. 微信小程序开发<a href="#2-微信小程序开发" class="hash-link" aria-label="Direct link to 2. 微信小程序开发" title="Direct link to 2. 微信小程序开发">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-介绍">2.1 介绍<a href="#21-介绍" class="hash-link" aria-label="Direct link to 2.1 介绍" title="Direct link to 2.1 介绍">​</a></h3>
<p>小程序是一种新的开放能力，开发者可以快速地开发一个小程序。可以在微信内被便捷地获取和传播，同时具有出色的使用体验。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203204712437-a894fec9575cc66e0adcd58f847cee3c.png" width="536" height="538" class="img_ev3q"></p>
<p>**官方网址：**<a href="https://mp.weixin.qq.com/cgi-bin/wx?token=&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/cgi-bin/wx?token=&amp;lang=zh_CN</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203205305487-6dfc09d3be3ba2675f5125cec1cad185.png" width="1891" height="838" class="img_ev3q"></p>
<p>小程序主要运行微信内部，可通过上述网站来整体了解微信小程序的开发。</p>
<p>**首先，**在进行小程序开发时，需要先去注册一个小程序，在注册的时候，它实际上又分成了不同的注册的主体。我们可以以个人的身份来注册一个小程序，当然，也可以以企业政府、媒体或者其他组织的方式来注册小程序。那么，不同的主体注册小程序，最终开放的权限也是不一样的。比如以个人身份来注册小程序，是无法开通支付权限的。若要提供支付功能，必须是企业、政府或者其它组织等。所以，不同的主体注册小程序后，可开发的功能是不一样的。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203210640473-1a5abfe274e98b6ccac652ef650a5e01.png" width="1208" height="351" class="img_ev3q"></p>
<p>**然后，**微信小程序我们提供的一些开发的支持，实际上微信的官方是提供了一系列的工具来帮助开发者快速的接入
并且完成小程序的开发，提供了完善的开发文档，并且专门提供了一个开发者工具，还提供了相应的设计指南，同时也提供了一些小程序体验DEMO，可以快速的体验小程序实现的功能。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203211226920-0761e6a951a6fe10717a0de9abe645bd.png" width="1459" height="531" class="img_ev3q"></p>
<p>**最后，**开发完一个小程序要上线，也给我们提供了详细地接入流程。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203211535565-0ed4e894658bb00637cb58cc64648c26.png" width="833" height="671" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-准备工作">2.2 准备工作<a href="#22-准备工作" class="hash-link" aria-label="Direct link to 2.2 准备工作" title="Direct link to 2.2 准备工作">​</a></h3>
<p>开发微信小程序之前需要做如下准备工作：</p>
<ul>
<li>注册小程序</li>
<li>完善小程序信息</li>
<li>下载开发者工具</li>
</ul>
<p><strong>1). 注册小程序</strong></p>
<p>注册地址：<a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/wxopen/waregister?action=step1</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203212348111-a4f1382df3a1dbee6632587f4eba67ec.png" width="986" height="676" class="img_ev3q"></p>
<p><strong>2). 完善小程序信息</strong></p>
<p>登录小程序后台：<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/</a></p>
<p>两种登录方式选其一即可</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203212454040-e39548e84a5ad9bd34ec8eee362312f6.png" width="558" height="397" class="img_ev3q"></p>
<p>完善小程序信息、小程序类目</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203212615981-7a0a48a00ab2e8d90dabc3d2715ab37e.png" width="1243" height="593" class="img_ev3q"></p>
<p>查看小程序的 AppID</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203212702993-c49bbfe7a38312be781ead11c6af1087.png" width="1333" height="637" class="img_ev3q"></p>
<p><strong>3). 下载开发者工具</strong></p>
<p>资料中已提供，无需下载，熟悉下载步骤即可。</p>
<p>下载地址： <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203212836364-1169229ee8ffa868224f995d447fe7e0.png" width="1287" height="615" class="img_ev3q"></p>
<p>扫描登录开发者工具</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203212954956-907ceb781c509fe30758ec95f8877b67.png" width="400" height="569" class="img_ev3q"></p>
<p>创建小程序项目</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203213042020-04d56cf936795067fdf159e57b64fa2d.png" width="832" height="624" class="img_ev3q"></p>
<p>熟悉开发者工具布局</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203213108317-a1269b5827c2e842c87d797c8d0ee451.png" width="1205" height="639" class="img_ev3q"></p>
<p>设置不校验合法域名</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203213212370-0e945c51667e46facd8983a52d69f51c.png" width="578" height="655" class="img_ev3q"></p>
<p>**注：**开发阶段，小程序发出请求到后端的Tomcat服务器，若不勾选，请求发送失败。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-入门案例">2.3 入门案例<a href="#23-入门案例" class="hash-link" aria-label="Direct link to 2.3 入门案例" title="Direct link to 2.3 入门案例">​</a></h3>
<p>实际上，小程序的开发本质上属于前端开发，主要使用JavaScript开发，咱们现在的定位主要还是在后端，所以，对于小程序开发简单了解即可。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="231-小程序目录结构">2.3.1 小程序目录结构<a href="#231-小程序目录结构" class="hash-link" aria-label="Direct link to 2.3.1 小程序目录结构" title="Direct link to 2.3.1 小程序目录结构">​</a></h4>
<p>小程序包含一个描述整体程序的 app 和多个描述各自页面的 page。一个小程序主体部分由三个文件组成，必须放在项目的根目录，如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203220557676-07609992bd51d7f190beddef1740c9e3.png" width="332" height="448" class="img_ev3q"></p>
<p><strong>文件说明：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203220635867-926ae072e38513b818c22d83d8cbd304.png" width="884" height="387" class="img_ev3q"></p>
<p>**app.js：**必须存在，主要存放小程序的逻辑代码</p>
<p>**app.json：**必须存在，小程序配置文件，主要存放小程序的公共配置</p>
<p><strong>app.wxss:</strong>  非必须存在，主要存放小程序公共样式表，类似于前端的CSS  样式</p>
<p>对小程序主体三个文件了解后，其实一个小程序又有多个页面。比如说，有商品浏览页面、购物车的页面、订单支付的页面、商品的详情页面等等。那这些页面会放在哪呢？
会存放在pages目录。</p>
<p>每个小程序页面主要由四个文件组成：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203220826893-dc89bdd951cfab0883f9dbbbff553a10.png" width="352" height="501" class="img_ev3q"></p>
<p><strong>文件说明：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221203220839187-5a3b542bbed831105f263fd2bdbed462.png" width="836" height="448" class="img_ev3q"></p>
<p>**js文件：**必须存在，存放页面业务逻辑代码，编写的js代码。</p>
<p>**wxml文件：**必须存在，存放页面结构，主要是做页面布局，页面效果展示的，类似于HTML页面。</p>
<p>**json文件：**非必须，存放页面相关的配置。</p>
<p>**wxss文件：**非必须，存放页面样式表，相当于CSS文件。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="232-编写和编译小程序">2.3.2 编写和编译小程序<a href="#232-编写和编译小程序" class="hash-link" aria-label="Direct link to 2.3.2 编写和编译小程序" title="Direct link to 2.3.2 编写和编译小程序">​</a></h4>
<p><strong>1). 编写</strong></p>
<p>进入到index.wxml，编写页面布局</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">container</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">{{msg}}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">type</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">default</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">bindtap</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">getUserInfo</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">获取用户信息</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">image</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">style</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">width: 100px;height: 100px;</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">src</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">{{avatarUrl}}</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">image</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    {{nickName}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">type</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">primary</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">bindtap</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">wxlogin</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">微信登录</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    授权码：{{code}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">   </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">type</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">warn</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">bindtap</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">sendRequest</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">发送请求</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    响应结果：{{result}}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">view</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>进入到index.js，编写业务逻辑代码</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function maybe-class-name" style="color:hsl(221, 87%, 60%)">Page</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  data</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    msg</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;hello world&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    avatarUrl</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    nickName</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    code</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    result</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">getUserInfo</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getUserProfile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      desc</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;获取用户信息&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">success</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">setData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          avatarUrl</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">userInfo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">avatarUrl</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          nickName</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">userInfo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">nickName</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">wxlogin</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">login</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">success</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;授权码：&quot;</span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">code</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">setData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          code</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">code</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">sendRequest</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">request</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      url</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;http://localhost:8080/user/shop/status&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      method</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;GET&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">success</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;响应结果：&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">setData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          result</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">data</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). 编译</strong></p>
<p>点击编译按钮</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204181233015-2bed0d08f1c35877975dd0fc457b367c.png" width="713" height="163" class="img_ev3q"></p>
<p><strong>3). 运行效果</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204181606927-14d31cfec9681b35e65ad54ac0ab40f5.png" width="395" height="533" class="img_ev3q"></p>
<p>点击<strong>获取用户信息</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204182056440-06625cf37d673d448981449d8799448c.png" width="276" height="284" class="img_ev3q"></p>
<p>点击<strong>微信登录</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204182238762-b33e11a55b1c0de796e900b58491ebc4.png" width="404" height="131" class="img_ev3q"></p>
<p>点击<strong>发送请求</strong></p>
<p>因为请求<a href="http://localhost:8080/user/shop/status%EF%BC%8C%E5%85%88%E8%A6%81%E5%90%AF%E5%8A%A8%E5%90%8E%E5%8F%B0%E9%A1%B9%E7%9B%AE%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:8080/user/shop/status，先要启动后台项目。</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204192519728-35a68cdcb99c78f9f76c4cec0c1b1f4d.png" width="898" height="270" class="img_ev3q"></p>
<p>**注：**设置不校验合法域名，若不勾选，请求发送失败。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="233-发布小程序">2.3.3 发布小程序<a href="#233-发布小程序" class="hash-link" aria-label="Direct link to 2.3.3 发布小程序" title="Direct link to 2.3.3 发布小程序">​</a></h4>
<p>小程序的代码都已经开发完毕，要将小程序发布上线，让所有的用户都能使用到这个小程序。</p>
<p>点击上传按钮：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204225355015-81e277227682d01902dd633bd1b65b70.png" width="1017" height="471" class="img_ev3q"></p>
<p>指定版本号：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204225502698-4ba09903e7549b6544dcf31ca133f6b7.png" width="805" height="282" class="img_ev3q"></p>
<p>上传成功：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204225557820-2f3dee81fbe15a1c431dcd02f424ef26.png" width="509" height="325" class="img_ev3q"></p>
<p>把代码上传到微信服务器就表示小程序已经发布了吗？
**其实并不是。**当前小程序版本只是一个开发版本。</p>
<p>进到微信公众平台，打开版本管理页面。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204230231476-e68a43fe31ce5f97068ef986b2a91de3.png" width="1276" height="350" class="img_ev3q"></p>
<p>需提交审核，变成审核版本，审核通过后，进行发布，变成线上版本。</p>
<p>一旦成为线上版本，这就说明小程序就已经发布上线了，微信用户就可以在微信里面去搜索和使用这个小程序了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-微信登录">3. 微信登录<a href="#3-微信登录" class="hash-link" aria-label="Direct link to 3. 微信登录" title="Direct link to 3. 微信登录">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-导入小程序代码">3.1 导入小程序代码<a href="#31-导入小程序代码" class="hash-link" aria-label="Direct link to 3.1 导入小程序代码" title="Direct link to 3.1 导入小程序代码">​</a></h3>
<p>开发微信小程序，本质上是属于前端  的开发，我们的重点其实还是后端代码开发。所以，小程序的代码已经提供好了，直接导入到微信开发者工具当中，直接来使用就可以了。</p>
<p><strong>1). 找到资料</strong></p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="452" height="120" class="img_ev3q"></p>
<p><strong>2). 导入代码</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204205631809-417d0f613f3f8121e04a76884dfe607f.png" width="1194" height="883" class="img_ev3q"></p>
<p>AppID：使用自己的AppID</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204210011364-e07413bb6cc9d8cf2b9ce97bef220e65.png" width="1191" height="888" class="img_ev3q"></p>
<p><strong>3). 查看项目结构</strong></p>
<p>主体的文件:app.js app.json app.wxss
项目的页面比较多，主要存放在pages目录。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204210739195-40a9eac84e69057a751cf68f7207aa06.png" width="1851" height="879" class="img_ev3q"></p>
<p><strong>4). 修改配置</strong></p>
<p>因为小程序要请求后端服务，需要修改为自己后端服务的ip地址和端口号(默认不需要修改)</p>
<p>common--&gt;vendor.js--&gt;搜索(ctrl+f)--&gt;baseUri</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204211239035-aadc99b07528df8b1598ce764911ff04.png" width="1015" height="833" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-微信登录流程">3.2 微信登录流程<a href="#32-微信登录流程" class="hash-link" aria-label="Direct link to 3.2 微信登录流程" title="Direct link to 3.2 微信登录流程">​</a></h3>
<p>微信登录：<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html</a></p>
<p><strong>流程图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204211800753-79096d962c7f2062cd5863cb370b058d.png" width="832" height="738" class="img_ev3q"></p>
<p><strong>步骤分析：</strong></p>
<ol>
<li>小程序端，调用wx.login()获取code，就是授权码。</li>
<li>小程序端，调用wx.request()发送请求并携带code，请求开发者服务器(自己编写的后端服务)。</li>
<li>开发者服务端，通过HttpClient向微信接口服务发送请求，并携带appId+appsecret+code三个参数。</li>
<li>开发者服务端，接收微信接口服务返回的数据，session_key+opendId等。opendId是微信用户的唯一标识。</li>
<li>开发者服务端，自定义登录态，生成令牌(token)和openid等数据返回给小程序端，方便后绪请求身份校验。</li>
<li>小程序端，收到自定义登录态，存储storage。</li>
<li>小程序端，后绪通过wx.request()发起业务请求时，携带token。</li>
<li>开发者服务端，收到请求后，通过携带的token，解析当前登录用户的id。</li>
<li>开发者服务端，身份校验通过后，继续相关的业务逻辑处理，最终返回业务数据。</li>
</ol>
<p>接下来，我们使用Postman进行测试。</p>
<p><strong>说明：</strong></p>
<ol>
<li>调用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html" target="_blank" rel="noopener noreferrer">wx.login()</a> 获取 <strong>临时登录凭证code</strong> ，并回传到开发者服务器。</li>
<li>调用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/login/auth.code2Session.html" target="_blank" rel="noopener noreferrer">auth.code2Session</a> 接口，换取 <strong>用户唯一标识 OpenID</strong> 、 用户在微信开放平台帐号下的<strong>唯一标识UnionID</strong>（若当前小程序已绑定到微信开放平台帐号） 和 <strong>会话密钥 session_key</strong>。</li>
</ol>
<p>之后开发者服务器可以根据用户标识来生成自定义登录态，用于后续业务逻辑中前后端交互时识别用户身份。</p>
<p><strong>实现步骤：</strong></p>
<p><strong>1). 获取授权码</strong></p>
<p>点击确定按钮，获取授权码，每个授权码只能使用一次，每次测试，需重新获取。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204222008130-c4c28dcabaae58e3d97f7b88504416a5.png" width="1030" height="604" class="img_ev3q"></p>
<p><strong>2). 明确请求接口</strong></p>
<p>请求方式、请求路径、请求参数</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204222434054-fead113ef56f30164723cb706eb21019.png" width="963" height="759" class="img_ev3q"></p>
<p><strong>3). 发送请求</strong></p>
<p>获取session_key和openid</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204223956568-663b0ed4175e72c996388acb5a0bf139.png" width="1259" height="853" class="img_ev3q"></p>
<p>若出现code been used错误提示，说明授权码已被使用过，请重新获取</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221204224130409-49a084013105c4a4da6c40c928415840.png" width="1259" height="824" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-需求分析和设计">3.3 需求分析和设计<a href="#33-需求分析和设计" class="hash-link" aria-label="Direct link to 3.3 需求分析和设计" title="Direct link to 3.3 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="331-产品原型">3.3.1 产品原型<a href="#331-产品原型" class="hash-link" aria-label="Direct link to 3.3.1 产品原型" title="Direct link to 3.3.1 产品原型">​</a></h4>
<p>用户进入到小程序的时候，微信授权登录之后才能点餐。需要获取当前微信用户的相关信息，比如昵称、头像等，这样才能够进入到小程序进行下单操作。是基于微信登录来实现小程序的登录功能，没有采用传统账户密码登录的方式。若第一次使用小程序来点餐，就是一个新用户，需要把这个新的用户保存到数据库当中完成自动注册。</p>
<p><strong>登录功能原型图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205173711304-1a3069ebdc11d0d29014b7187c3cb864.png" width="854" height="673" class="img_ev3q"></p>
<p><strong>业务规则：</strong></p>
<ul>
<li>基于微信登录实现小程序的登录功能</li>
<li>如果是新用户需要自动完成注册</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="332-接口设计">3.3.2 接口设计<a href="#332-接口设计" class="hash-link" aria-label="Direct link to 3.3.2 接口设计" title="Direct link to 3.3.2 接口设计">​</a></h4>
<p>通过微信登录的流程，如果要完成微信登录的话，最终就要获得微信用户的openid。在小程序端获取授权码后，向后端服务发送请求，并携带授权码，这样后端服务在收到授权码后，就可以去请求微信接口服务。最终，后端向小程序返回openid和token等数据。</p>
<p>基于上述的登录流程，就可以设计出该接口的<strong>请求参数</strong>和<strong>返回数据</strong>。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205175429394-ca094e606aa5ecc40e1a7437c5c3dd63.png" width="614" height="647" class="img_ev3q"></p>
<p>**说明：**请求路径/user/user/login,第一个user代表用户端，第二个user代表用户模块。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="333-表设计">3.3.3 表设计<a href="#333-表设计" class="hash-link" aria-label="Direct link to 3.3.3 表设计" title="Direct link to 3.3.3 表设计">​</a></h4>
<p>当用户第一次使用小程序时，会完成自动注册，把用户信息存储到<strong>user</strong>表中。</p>



























































<table><thead><tr><th><strong>字段名</strong></th><th><strong>数据类型</strong></th><th><strong>说明</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>主键</td><td>自增</td></tr><tr><td>openid</td><td>varchar(45)</td><td>微信用户的唯一标识</td><td></td></tr><tr><td>name</td><td>varchar(32)</td><td>用户姓名</td><td></td></tr><tr><td>phone</td><td>varchar(11)</td><td>手机号</td><td></td></tr><tr><td>sex</td><td>varchar(2)</td><td>性别</td><td></td></tr><tr><td>id_number</td><td>varchar(18)</td><td>身份证号</td><td></td></tr><tr><td>avatar</td><td>varchar(500)</td><td>微信用户头像路径</td><td></td></tr><tr><td>create_time</td><td>datetime</td><td>注册时间</td><td></td></tr></tbody></table>
<p>**说明：**手机号字段比较特殊，个人身份注册的小程序没有权限获取到微信用户的手机号。如果是以企业的资质
注册的小程序就能够拿到微信用户的手机号。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-代码开发">3.4 代码开发<a href="#34-代码开发" class="hash-link" aria-label="Direct link to 3.4 代码开发" title="Direct link to 3.4 代码开发">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="341-定义相关配置">3.4.1 定义相关配置<a href="#341-定义相关配置" class="hash-link" aria-label="Direct link to 3.4.1 定义相关配置" title="Direct link to 3.4.1 定义相关配置">​</a></h4>
<p><strong>配置微信登录所需配置项：</strong></p>
<p>application-dev.yml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sky</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">wechat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">appid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> wxffb3637a228223b8</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> 84311df9199ecacdf4f12d27b6b9522d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>application.yml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sky</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">wechat</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">appid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">sky.wechat.appid</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">sky.wechat.secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>配置为微信用户生成jwt令牌时使用的配置项：</strong></p>
<p>application.yml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sky</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">jwt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 设置jwt签名加密时使用的秘钥</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">admin-secret-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> itcast</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 设置jwt过期时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">admin-ttl</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">7200000</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 设置前端传递过来的令牌 名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">admin-token-name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> token</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">user-secret-key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> itheima</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">user-ttl</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">7200000</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">user-token-name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> authentication</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="342-dto设计">3.4.2 DTO设计<a href="#342-dto设计" class="hash-link" aria-label="Direct link to 3.4.2 DTO设计" title="Direct link to 3.4.2 DTO设计">​</a></h4>
<p><strong>根据传入参数设计DTO类：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205183625049-69be801c3986804c91d5c86fb358fa2b.png" width="765" height="199" class="img_ev3q"></p>
<p>在sky-pojo模块，UserLoginDTO.java已定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.dto;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * C端用户登录</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class UserLoginDTO implements Serializable {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String code;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="343-vo设计">3.4.3 VO设计<a href="#343-vo设计" class="hash-link" aria-label="Direct link to 3.4.3 VO设计" title="Direct link to 3.4.3 VO设计">​</a></h4>
<p><strong>根据返回数据设计VO类：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205183923272-e267c4d6d4269a4a8f4b7fd8ba6dc00d.png" width="646" height="424" class="img_ev3q"></p>
<p>在sky-pojo模块，UserLoginVO.java已定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.vo;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.AllArgsConstructor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Builder;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.NoArgsConstructor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Builder</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@NoArgsConstructor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class UserLoginVO implements Serializable {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Long id;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String openid;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String token;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="344-controller层">3.4.4 Controller层<a href="#344-controller层" class="hash-link" aria-label="Direct link to 3.4.4 Controller层" title="Direct link to 3.4.4 Controller层">​</a></h4>
<p><strong>根据接口定义创建UserController的login方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.user;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.JwtClaimsConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.UserLoginDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.User;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.properties.JwtProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.UserService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.utils.JwtUtil;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.UserLoginVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.PostMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestBody;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/user/user&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;C端用户相关接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class UserController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private UserService userService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private JwtProperties jwtProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 微信登录</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param userLoginDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @PostMapping(&quot;/login&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;微信登录&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;UserLoginVO&gt; login(@RequestBody UserLoginDTO userLoginDTO){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;微信用户登录：{}&quot;,userLoginDTO.getCode());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //微信登录</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        User user = userService.wxLogin(userLoginDTO);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //为微信用户生成jwt令牌</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        claims.put(JwtClaimsConstant.USER_ID,user.getId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String token = JwtUtil.createJWT(jwtProperties.getUserSecretKey(), jwtProperties.getUserTtl(), claims);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        UserLoginVO userLoginVO = UserLoginVO.builder()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .id(user.getId())</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .openid(user.getOpenid())</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .token(token)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(userLoginVO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中，JwtClaimsConstant.USER_ID常量已定义。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="345-service层接口">3.4.5 Service层接口<a href="#345-service层接口" class="hash-link" aria-label="Direct link to 3.4.5 Service层接口" title="Direct link to 3.4.5 Service层接口">​</a></h4>
<p><strong>创建UserService接口：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.UserLoginDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.User;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface UserService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 微信登录</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param userLoginDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    User wxLogin(UserLoginDTO userLoginDTO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="346-service层实现类">3.4.6 Service层实现类<a href="#346-service层实现类" class="hash-link" aria-label="Direct link to 3.4.6 Service层实现类" title="Direct link to 3.4.6 Service层实现类">​</a></h4>
<p>**创建UserServiceImpl实现类：**实现获取微信用户的openid和微信登录功能</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service.impl;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.alibaba.fastjson.JSON;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.alibaba.fastjson.JSONObject;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.MessageConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.UserLoginDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.User;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.exception.LoginFailedException;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.UserMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.properties.WeChatProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.UserService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.utils.HttpClientUtil;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.stereotype.Service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalDateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Service</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class UserServiceImpl implements UserService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //微信服务接口地址</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static final String WX_LOGIN = &quot;https://api.weixin.qq.com/sns/jscode2session&quot;;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private WeChatProperties weChatProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private UserMapper userMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 微信登录</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param userLoginDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public User wxLogin(UserLoginDTO userLoginDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String openid = getOpenid(userLoginDTO.getCode());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //判断openid是否为空，如果为空表示登录失败，抛出业务异常</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if(openid == null){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            throw new LoginFailedException(MessageConstant.LOGIN_FAILED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //判断当前用户是否为新用户</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        User user = userMapper.getByOpenid(openid);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //如果是新用户，自动完成注册</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if(user == null){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            user = User.builder()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    .openid(openid)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    .createTime(LocalDateTime.now())</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    .build();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            userMapper.insert(user);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //返回这个用户对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return user;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 调用微信接口服务，获取微信用户的openid</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param code</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String getOpenid(String code){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //调用微信接口服务，获得当前微信用户的openid</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Map&lt;String, String&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;appid&quot;,weChatProperties.getAppid());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;secret&quot;,weChatProperties.getSecret());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;js_code&quot;,code);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;grant_type&quot;,&quot;authorization_code&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String json = HttpClientUtil.doGet(WX_LOGIN, map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        JSONObject jsonObject = JSON.parseObject(json);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String openid = jsonObject.getString(&quot;openid&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return openid;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="347-mapper层">3.4.7 Mapper层<a href="#347-mapper层" class="hash-link" aria-label="Direct link to 3.4.7 Mapper层" title="Direct link to 3.4.7 Mapper层">​</a></h4>
<p><strong>创建UserMapper接口：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.mapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.User;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.ibatis.annotations.Mapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.ibatis.annotations.Select;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface UserMapper {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据openid查询用户</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param openid</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Select(&quot;select * from user where openid = #{openid}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    User getByOpenid(String openid);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 插入数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param user</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void insert(User user);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建UserMapper.xml映射文件：</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&lt;!</span><span class="token doctype doctype-tag" style="color:hsl(230, 8%, 24%)">DOCTYPE</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">mapper</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">PUBLIC</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token doctype" style="color:hsl(230, 8%, 24%)">        </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">com.sky.mapper.UserMapper</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">insert</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">insert</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">useGeneratedKeys</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">true</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">keyProperty</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">id</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        insert into user (openid, name, phone, sex, id_number, avatar, create_time)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        values (#{openid}, #{name}, #{phone}, #{sex}, #{idNumber}, #{avatar}, #{createTime})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">insert</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="348-编写拦截器">3.4.8 编写拦截器<a href="#348-编写拦截器" class="hash-link" aria-label="Direct link to 3.4.8 编写拦截器" title="Direct link to 3.4.8 编写拦截器">​</a></h4>
<p>**编写拦截器JwtTokenUserInterceptor：**统一拦截用户端发送的请求并进行jwt校验</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.interceptor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.JwtClaimsConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.context.BaseContext;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.properties.JwtProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.utils.JwtUtil;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.jsonwebtoken.Claims;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.method.HandlerMethod;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.servlet.HandlerInterceptor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import javax.servlet.http.HttpServletRequest;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import javax.servlet.http.HttpServletResponse;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * jwt令牌校验的拦截器</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class JwtTokenUserInterceptor implements HandlerInterceptor {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private JwtProperties jwtProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 校验jwt</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param request</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param handler</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //判断当前拦截到的是Controller的方法还是其他资源</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if (!(handler instanceof HandlerMethod)) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //当前拦截到的不是动态方法，直接放行</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //1、从请求头中获取令牌</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String token = request.getHeader(jwtProperties.getUserTokenName());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //2、校验令牌</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            log.info(&quot;jwt校验:{}&quot;, token);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            Claims claims = JwtUtil.parseJWT(jwtProperties.getUserSecretKey(), token);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            Long userId = Long.valueOf(claims.get(JwtClaimsConstant.USER_ID).toString());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            log.info(&quot;当前用户的id：&quot;, userId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            BaseContext.setCurrentId(userId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //3、通过，放行</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //4、不通过，响应401状态码</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            response.setStatus(401);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            return false;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在WebMvcConfiguration配置类中注册拦截器：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	@Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private JwtTokenUserInterceptor jwtTokenUserInterceptor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 注册自定义拦截器</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param registry</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    protected void addInterceptors(InterceptorRegistry registry) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;开始注册自定义拦截器...&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //.........</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        registry.addInterceptor(jwtTokenUserInterceptor)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .addPathPatterns(&quot;/user/**&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .excludePathPatterns(&quot;/user/user/login&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .excludePathPatterns(&quot;/user/shop/status&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-功能测试">3.5 功能测试<a href="#35-功能测试" class="hash-link" aria-label="Direct link to 3.5 功能测试" title="Direct link to 3.5 功能测试">​</a></h3>
<p>重新编译小程序，进行登录，获取到openid和token数据</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205192506490-2c21bd1a9ec3b0fdb003c61adffb1262.png" width="1851" height="853" class="img_ev3q"></p>
<p>查看后台日志</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205192943394-b51e669b574d04bb2403fa21674fb566.png" width="1520" height="289" class="img_ev3q"></p>
<p>查看数据库user表，第一次登录，会自动注册</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205193018421-ac086bb36a2ed841d31ffe0ec2d98499.png" width="993" height="82" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-导入商品浏览功能代码">4. 导入商品浏览功能代码<a href="#4-导入商品浏览功能代码" class="hash-link" aria-label="Direct link to 4. 导入商品浏览功能代码" title="Direct link to 4. 导入商品浏览功能代码">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-需求分析和设计">4.1 需求分析和设计<a href="#41-需求分析和设计" class="hash-link" aria-label="Direct link to 4.1 需求分析和设计" title="Direct link to 4.1 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="411-产品原型">4.1.1 产品原型<a href="#411-产品原型" class="hash-link" aria-label="Direct link to 4.1.1 产品原型" title="Direct link to 4.1.1 产品原型">​</a></h4>
<p>用户登录成功后跳转到系统首页，在首页需要根据分类来展示菜品和套 餐。如果菜品设置了口味信息，需要展示<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="69" height="35" class="img_ev3q"></p>
<p>​         <strong>菜品列表效果图</strong>                                                   <strong>菜品口味效果图</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205193821129-31b202665d55677073a5d79d50fa4a54.png" width="398" height="706" class="img_ev3q"></p>
<p>​         <strong>套餐列表效果图</strong>                                                   <strong>套餐详情效果图</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205193859016-4d030207f2ad80a9ee1530c72c53ce92.png" width="400" height="706" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="412-接口设计">4.1.2 接口设计<a href="#412-接口设计" class="hash-link" aria-label="Direct link to 4.1.2 接口设计" title="Direct link to 4.1.2 接口设计">​</a></h4>
<p>根据上述原型图先<strong>粗粒度</strong>设计接口，共包含4个接口。</p>
<p><strong>接口设计：</strong></p>
<ul>
<li>查询分类</li>
<li>根据分类id查询菜品</li>
<li>根据分类id查询套餐</li>
<li>根据套餐id查询包含的菜品</li>
</ul>
<p>接下来<strong>细粒度</strong>分析每个接口，明确每个接口的请求方式、请求路径、传入参数和返回值。</p>
<p><strong>1). 查询分类</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205200235328-615f21ff8bb5627bc37364fdb5199b4f.png" width="620" height="502" class="img_ev3q"></p>
<p><strong>2). 根据分类id查询菜品</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205200319686-2488c4b6b8ef14436dbde05544e9575a.png" width="452" height="553" class="img_ev3q"></p>
<p><strong>3). 根据分类id查询套餐</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205200415135-f261fd122554d6a1e422888b7f2e00a2.png" width="446" height="565" class="img_ev3q"></p>
<p><strong>4). 根据套餐id查询包含  的菜品</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205200537591-e6e0bef204ae4b227374ea05fa5f3a17.png" width="710" height="893" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-代码导入">4.2 代码导入<a href="#42-代码导入" class="hash-link" aria-label="Direct link to 4.2 代码导入" title="Direct link to 4.2 代码导入">​</a></h3>
<p>导入资料中的商品浏览功能代码即可</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205201043358-4a8783c92a9617e385a26ba7723b337a.png" width="808" height="452" class="img_ev3q"></p>
<p>可按照mapper--&gt;service--&gt;controller依次导入，这样代码不会显示相应的报错。</p>
<p>进入到sky-server模块中</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="421-mapper层">4.2.1 Mapper层<a href="#421-mapper层" class="hash-link" aria-label="Direct link to 4.2.1 Mapper层" title="Direct link to 4.2.1 Mapper层">​</a></h4>
<p><strong>在SetmealMapper.java中添加list和getDishItemBySetmealId两个方法</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 动态条件查询套餐</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param setmeal</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;Setmeal&gt; list(Setmeal setmeal);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据套餐id查询菜品选项</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param setmealId</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Select(&quot;select sd.name, sd.copies, d.image, d.description &quot; +</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            &quot;from setmeal_dish sd left join dish d on sd.dish_id = d.id &quot; +</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            &quot;where sd.setmeal_id = #{setmealId}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;DishItemVO&gt; getDishItemBySetmealId(Long setmealId);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建SetmealMapper.xml文件</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&lt;!</span><span class="token doctype doctype-tag" style="color:hsl(230, 8%, 24%)">DOCTYPE</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">mapper</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">PUBLIC</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token doctype" style="color:hsl(230, 8%, 24%)">        </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">com.sky.mapper.SetmealMapper</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">list</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">parameterType</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">Setmeal</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">Setmeal</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        select * from setmeal</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">name != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and name like concat(&#x27;%&#x27;,#{name},&#x27;%&#x27;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">categoryId != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and category_id = #{categoryId}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">status != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and status = #{status}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="422-service层">4.2.2 Service层<a href="#422-service层" class="hash-link" aria-label="Direct link to 4.2.2 Service层" title="Direct link to 4.2.2 Service层">​</a></h4>
<p><strong>创建SetmealService.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.SetmealDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.SetmealPageQueryDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Setmeal;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.PageResult;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishItemVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.SetmealVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface SetmealService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 条件查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param setmeal</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;Setmeal&gt; list(Setmeal setmeal);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id查询菜品选项</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;DishItemVO&gt; getDishItemById(Long id);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建SetmealServiceImpl.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service.impl;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Setmeal;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.DishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.SetmealDishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.SetmealMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.SetmealService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishItemVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.stereotype.Service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 套餐业务实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Service</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class SetmealServiceImpl implements SetmealService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private SetmealMapper setmealMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private SetmealDishMapper setmealDishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private DishMapper dishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 条件查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param setmeal</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public List&lt;Setmeal&gt; list(Setmeal setmeal) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;Setmeal&gt; list = setmealMapper.list(setmeal);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id查询菜品选项</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public List&lt;DishItemVO&gt; getDishItemById(Long id) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return setmealMapper.getDishItemBySetmealId(id);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在DishService.java中添加listWithFlavor方法定义</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 条件查询菜品和口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dish</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;DishVO&gt; listWithFlavor(Dish dish);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在DishServiceImpl.java中实现listWithFlavor方法</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 条件查询菜品和口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dish</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public List&lt;DishVO&gt; listWithFlavor(Dish dish) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;Dish&gt; dishList = dishMapper.list(dish);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;DishVO&gt; dishVOList = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        for (Dish d : dishList) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            DishVO dishVO = new DishVO();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            BeanUtils.copyProperties(d,dishVO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //根据菜品id查询对应的口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            List&lt;DishFlavor&gt; flavors = dishFlavorMapper.getByDishId(d.getId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dishVO.setFlavors(flavors);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dishVOList.add(dishVO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return dishVOList;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="423-controller层">4.2.3 Controller层<a href="#423-controller层" class="hash-link" aria-label="Direct link to 4.2.3 Controller层" title="Direct link to 4.2.3 Controller层">​</a></h4>
<p><strong>创建DishController.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.user;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.StatusConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Dish;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.DishService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController(&quot;userDishController&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/user/dish&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;C端-菜品浏览接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class DishController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private DishService dishService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据分类id查询菜品</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param categoryId</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/list&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;根据分类id查询菜品&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;List&lt;DishVO&gt;&gt; list(Long categoryId) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Dish dish = new Dish();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dish.setCategoryId(categoryId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dish.setStatus(StatusConstant.ENABLE);//查询起售中的菜品</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;DishVO&gt; list = dishService.listWithFlavor(dish);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(list);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建CategoryController.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.user;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Category;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.CategoryService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController(&quot;userCategoryController&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/user/category&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;C端-分类接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class CategoryController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private CategoryService categoryService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询分类</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param type</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/list&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;查询分类&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;List&lt;Category&gt;&gt; list(Integer type) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;Category&gt; list = categoryService.list(type);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(list);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建SetmealController.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.user;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.StatusConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Setmeal;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.SetmealService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishItemVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.PathVariable;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController(&quot;userSetmealController&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/user/setmeal&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;C端-套餐浏览接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class SetmealController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private SetmealService setmealService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 条件查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param categoryId</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/list&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;根据分类id查询套餐&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;List&lt;Setmeal&gt;&gt; list(Long categoryId) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Setmeal setmeal = new Setmeal();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        setmeal.setCategoryId(categoryId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        setmeal.setStatus(StatusConstant.ENABLE);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;Setmeal&gt; list = setmealService.list(setmeal);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(list);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据套餐id查询包含的菜品列表</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/dish/{id}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;根据套餐id查询包含的菜品列表&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;List&lt;DishItemVO&gt;&gt; dishList(@PathVariable(&quot;id&quot;) Long id) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;DishItemVO&gt; list = setmealService.getDishItemById(id);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(list);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-功能测试">4.3 功能测试<a href="#43-功能测试" class="hash-link" aria-label="Direct link to 4.3 功能测试" title="Direct link to 4.3 功能测试">​</a></h3>
<p>重启服务器、重新编译小程序</p>
<p>微信登录进入首页</p>
<p><strong>菜品和套餐分类查询：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205205634465-41b71163e443b17bf6ccd8c8d71a7a99.png" width="1871" height="865" class="img_ev3q"></p>
<p><strong>具体分类下的菜品查询：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205205935019-89fd1e9969c8368032a8e027a671d120.png" width="1864" height="827" class="img_ev3q"></p>
<p><strong>菜品口味查询：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205210121546-f4cc56bf64a4ce2e41791313f10a4e8f.png" width="1864" height="839" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-代码提交">4.4 代码提交<a href="#44-代码提交" class="hash-link" aria-label="Direct link to 4.4 代码提交" title="Direct link to 4.4 代码提交">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221205210421016-dd472a35464f60124a76f96fd402de7b.png" width="1073" height="1000" class="img_ev3q"></p>
<p>后续步骤和其它功能代码提交一致，不再赘述。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#课程内容" class="table-of-contents__link toc-highlight">课程内容</a></li><li><a href="#1-httpclient" class="table-of-contents__link toc-highlight">1. HttpClient</a><ul><li><a href="#11-介绍" class="table-of-contents__link toc-highlight">1.1 介绍</a></li><li><a href="#12-入门案例" class="table-of-contents__link toc-highlight">1.2 入门案例</a></li></ul></li><li><a href="#2-微信小程序开发" class="table-of-contents__link toc-highlight">2. 微信小程序开发</a><ul><li><a href="#21-介绍" class="table-of-contents__link toc-highlight">2.1 介绍</a></li><li><a href="#22-准备工作" class="table-of-contents__link toc-highlight">2.2 准备工作</a></li><li><a href="#23-入门案例" class="table-of-contents__link toc-highlight">2.3 入门案例</a></li></ul></li><li><a href="#3-微信登录" class="table-of-contents__link toc-highlight">3. 微信登录</a><ul><li><a href="#31-导入小程序代码" class="table-of-contents__link toc-highlight">3.1 导入小程序代码</a></li><li><a href="#32-微信登录流程" class="table-of-contents__link toc-highlight">3.2 微信登录流程</a></li><li><a href="#33-需求分析和设计" class="table-of-contents__link toc-highlight">3.3 需求分析和设计</a></li><li><a href="#34-代码开发" class="table-of-contents__link toc-highlight">3.4 代码开发</a></li><li><a href="#35-功能测试" class="table-of-contents__link toc-highlight">3.5 功能测试</a></li></ul></li><li><a href="#4-导入商品浏览功能代码" class="table-of-contents__link toc-highlight">4. 导入商品浏览功能代码</a><ul><li><a href="#41-需求分析和设计" class="table-of-contents__link toc-highlight">4.1 需求分析和设计</a></li><li><a href="#42-代码导入" class="table-of-contents__link toc-highlight">4.2 代码导入</a></li><li><a href="#43-功能测试" class="table-of-contents__link toc-highlight">4.3 功能测试</a></li><li><a href="#44-代码提交" class="table-of-contents__link toc-highlight">4.4 代码提交</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>