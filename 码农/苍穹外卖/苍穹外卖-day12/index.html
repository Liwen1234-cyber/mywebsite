<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-码农/苍穹外卖/苍穹外卖-day12" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">苍穹外卖-day12 | Coisini</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day12/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="苍穹外卖-day12 | Coisini"><meta data-rh="true" name="description" content="课程内容"><meta data-rh="true" property="og:description" content="课程内容"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day12/"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day12/" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day12/" hreflang="x-default"><meta name="google-site-verification" content="1FUPX6Qo4y3ecU623ShEurhgnjhSTjK49rRMhEDlzFA">
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.79037026.css">
<script src="/assets/js/runtime~main.468f2b27.js" defer="defer"></script>
<script src="/assets/js/main.4763ab3e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Coisini</b></a></div><div class="navbar__items navbar__items--right"><a href="https://minddiy.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>苍穹外卖-day12</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="课程内容">课程内容<a href="#课程内容" class="hash-link" aria-label="Direct link to 课程内容" title="Direct link to 课程内容">​</a></h2>
<ul>
<li>工作台</li>
<li>Apache POI</li>
<li>导出运营数据Excel报表</li>
</ul>
<p>功能实现：<strong>工作台</strong>、<strong>数据导出</strong></p>
<p><strong>工作台效果图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130190031553-b0e703cea133d4fbd84185fd7fba22f4.png" width="1674" height="791" class="img_ev3q"></p>
<p><strong>数据导出效果图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130190124725-bbb8befcc2d24f14feb5406d9fd15c67.png" width="1601" height="828" class="img_ev3q"></p>
<p>在数据统计页面点击<strong>数据导出</strong>：生成Excel报表</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130190243865-5ff681903a7e58d25a16aec32037d831.png" width="1155" height="788" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-工作台">1. 工作台<a href="#1-工作台" class="hash-link" aria-label="Direct link to 1. 工作台" title="Direct link to 1. 工作台">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-需求分析和设计">1.1 需求分析和设计<a href="#11-需求分析和设计" class="hash-link" aria-label="Direct link to 1.1 需求分析和设计" title="Direct link to 1.1 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="111-产品原型">1.1.1 产品原型<a href="#111-产品原型" class="hash-link" aria-label="Direct link to 1.1.1 产品原型" title="Direct link to 1.1.1 产品原型">​</a></h4>
<p>工作台是系统运营的数据看板，并提供快捷操作入口，可以有效提高商家的工作效率。</p>
<p><strong>工作台展示的数据：</strong></p>
<ul>
<li>今日数据</li>
<li>订单管理</li>
<li>菜品总览</li>
<li>套餐总览</li>
<li>订单信息</li>
</ul>
<p><strong>原型图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130191051003-a268640233fe6aea80f62fc627e5d598.png" width="1140" height="678" class="img_ev3q"></p>
<p><strong>名词解释：</strong></p>
<ul>
<li>营业额：已完成订单的总金额</li>
<li>有效订单：已完成订单的数量</li>
<li>订单完成率：有效订单数 / 总  订单数 * 100%</li>
<li>平均客单价：营业额 / 有效订单数</li>
<li>新增用户：新增用户的数量</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="112-接口设计">1.1.2 接口设计<a href="#112-接口设计" class="hash-link" aria-label="Direct link to 1.1.2 接口设计" title="Direct link to 1.1.2 接口设计">​</a></h4>
<p>通过上述原型图分析，共包含6个接口。</p>
<p><strong>接口设计：</strong></p>
<ul>
<li>今日数据接口</li>
<li>订单管理接口</li>
<li>菜品总览接口</li>
<li>套餐总览接口</li>
<li>订单搜索（已完成）</li>
<li>各个状态的订单数量统计（已完成）</li>
</ul>
<p><strong>1). 今日数据的接口设计</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130191820764-564ff5007cf50aa1c5cd08dbfe3a02b0.png" width="480" height="317" class="img_ev3q"></p>
<p><strong>2). 订单管理的接口设计</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130192105373-d140abc58c7095f3aed90e5887584be9.png" width="771" height="868" class="img_ev3q"></p>
<p><strong>3). 菜品总览的接口设计</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130192225168-b9a064817618be3e9b8e732c556c9c4b.png" width="840" height="765" class="img_ev3q"></p>
<p><strong>4). 套餐总览的接口设计</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130195425389-1890925e9f211cc57c0c2fb999f1a60c.png" width="822" height="750" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-代码导入">1.2 代码导入<a href="#12-代码导入" class="hash-link" aria-label="Direct link to 1.2 代码导入" title="Direct link to 1.2 代码导入">​</a></h3>
<p>直接导入课程资料中的工作台模块功能代码即可：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130195535421-798682657bc174672d315b70e5c756b3.png" width="414" height="296" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="121-controller层">1.2.1 Controller层<a href="#121-controller层" class="hash-link" aria-label="Direct link to 1.2.1 Controller层" title="Direct link to 1.2.1 Controller层">​</a></h4>
<p><strong>添加WorkSpaceController.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.admin;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.WorkspaceService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.BusinessDataVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.OrderOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.SetmealOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalDateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 工作台</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/admin/workspace&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;工作台相关接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class WorkSpaceController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private WorkspaceService workspaceService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 工作台今日数据查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/businessData&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;工作台今日数据查询&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;BusinessDataVO&gt; businessData(){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获得当天的开始时间</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        LocalDateTime begin = LocalDateTime.now().with(LocalTime.MIN);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获得当天的结束时间</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        LocalDateTime end = LocalDateTime.now().with(LocalTime.MAX);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        BusinessDataVO businessDataVO = workspaceService.getBusinessData(begin, end);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(businessDataVO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询订单管理数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/overviewOrders&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;查询订单管理数据&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;OrderOverViewVO&gt; orderOverView(){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(workspaceService.getOrderOverView());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询菜品总览</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/overviewDishes&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;查询菜品总览&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;DishOverViewVO&gt; dishOverView(){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(workspaceService.getDishOverView());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询套餐总览</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/overviewSetmeals&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;查询套餐总览&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;SetmealOverViewVO&gt; setmealOverView(){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(workspaceService.getSetmealOverView());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="122-service层接口">1.2.2 Service层接口<a href="#122-service层接口" class="hash-link" aria-label="Direct link to 1.2.2 Service层接口" title="Direct link to 1.2.2 Service层接口">​</a></h4>
<p><strong>添加WorkspaceService.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.BusinessDataVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.OrderOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.SetmealOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalDateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface WorkspaceService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据时间段统计营业数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param begin</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param end</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    BusinessDataVO getBusinessData(LocalDateTime begin, LocalDateTime end);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询订单管理数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    OrderOverViewVO getOrderOverView();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询菜品总览</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    DishOverViewVO getDishOverView();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询套餐总览</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    SetmealOverViewVO getSetmealOverView();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="123-service层实现类">1.2.3 Service层实现类<a href="#123-service层实现类" class="hash-link" aria-label="Direct link to 1.2.3 Service层实现类" title="Direct link to 1.2.3 Service层实现类">​</a></h4>
<p><strong>添加WorkspaceServiceImpl.java</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service.impl;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.StatusConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Orders;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.DishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.OrderMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.SetmealMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.mapper.UserMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.WorkspaceService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.BusinessDataVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.OrderOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.SetmealOverViewVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.stereotype.Service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalDateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Service</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class WorkspaceServiceImpl implements WorkspaceService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private OrderMapper orderMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private UserMapper userMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private DishMapper dishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private SetmealMapper setmealMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据时间段统计营业数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param begin</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param end</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public BusinessDataVO getBusinessData(LocalDateTime begin, LocalDateTime end) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         * 营业额：当日已完成订单的总金额</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         * 有效订单：当日已完成订单的数量</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         * 订单完成率：有效订单数 / 总订单数</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         * 平均客单价：营业额 / 有效订单数</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         * 新增用户：当日新增用户的数量</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">         */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Map map = new HashMap();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;begin&quot;,begin);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;end&quot;,end);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //查询总订单数</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer totalOrderCount = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, Orders.COMPLETED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //营业额</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Double turnover = orderMapper.sumByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        turnover = turnover == null? 0.0 : turnover;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //有效订单数</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer validOrderCount = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Double unitPrice = 0.0;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Double orderCompletionRate = 0.0;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if(totalOrderCount != 0 &amp;&amp; validOrderCount != 0){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //订单完成率</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            orderCompletionRate = validOrderCount.doubleValue() / totalOrderCount;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //平均客单价</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            unitPrice = turnover / validOrderCount;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //新增用户数</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer newUsers = userMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return BusinessDataVO.builder()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .turnover(turnover)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .validOrderCount(validOrderCount)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .orderCompletionRate(orderCompletionRate)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .unitPrice(unitPrice)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .newUsers(newUsers)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询订单管理数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public OrderOverViewVO getOrderOverView() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Map map = new HashMap();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;begin&quot;, LocalDateTime.now().with(LocalTime.MIN));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, Orders.TO_BE_CONFIRMED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //待接单</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer waitingOrders = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //待派送</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, Orders.CONFIRMED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer deliveredOrders = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //已完成</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, Orders.COMPLETED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer completedOrders = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //已取消</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, Orders.CANCELLED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer cancelledOrders = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //全部订单</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, null);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer allOrders = orderMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return OrderOverViewVO.builder()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .waitingOrders(waitingOrders)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .deliveredOrders(deliveredOrders)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .completedOrders(completedOrders)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .cancelledOrders(cancelledOrders)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .allOrders(allOrders)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询菜品总览</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public DishOverViewVO getDishOverView() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Map map = new HashMap();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, StatusConstant.ENABLE);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer sold = dishMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, StatusConstant.DISABLE);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer discontinued = dishMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return DishOverViewVO.builder()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .sold(sold)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .discontinued(discontinued)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 查询套餐总览</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public SetmealOverViewVO getSetmealOverView() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Map map = new HashMap();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, StatusConstant.ENABLE);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer sold = setmealMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        map.put(&quot;status&quot;, StatusConstant.DISABLE);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Integer discontinued = setmealMapper.countByMap(map);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return SetmealOverViewVO.builder()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .sold(sold)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .discontinued(discontinued)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="124-mapper层">1.2.4 Mapper层<a href="#124-mapper层" class="hash-link" aria-label="Direct link to 1.2.4 Mapper层" title="Direct link to 1.2.4 Mapper层">​</a></h4>
<p><strong>在SetmealMapper中添加countByMap方法定义</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据条件统计套餐数量</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param map</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Integer countByMap(Map map);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在SetmealMapper.xml中添加对应SQL实现</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">countByMap</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">java.lang.Integer</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        select count(id) from setmeal</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">status != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and status = #{status}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">categoryId != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and category_id = #{categoryId}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在DishMapper中添加countByMap方法定义</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据条件统计菜品数量</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param map</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Integer countByMap(Map map);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在DishMapper.xml中添加对应SQL实现</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">countByMap</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">java.lang.Integer</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        select count(id) from dish</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">status != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and status = #{status}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">categoryId != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and category_id = #{categoryId}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-功能测试">1.3 功能测试<a href="#13-功能测试" class="hash-link" aria-label="Direct link to 1.3 功能测试" title="Direct link to 1.3 功能测试">​</a></h3>
<p>可以通过如下方式进行测试：</p>
<ul>
<li>通过接口文档测试</li>
<li>前后端联调测试</li>
</ul>
<p>接下来我们使用上述两种方式分别测试。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="131-接口文档测试">1.3.1 接口文档测试<a href="#131-接口文档测试" class="hash-link" aria-label="Direct link to 1.3.1 接口文档测试" title="Direct link to 1.3.1 接口文档测试">​</a></h4>
<p><strong>启动服务</strong>，访问<a href="http://localhost:8080/doc.html%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%B7%A5%E4%BD%9C%E5%8F%B0%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3" target="_blank" rel="noopener noreferrer">http://localhost:8080/doc.html，进入工作台相关接口</a></p>
<p>**注意：**使用admin用户登录重新获取token，在全局参数设置中添加，防止token失效。</p>
<p><strong>1). 今日数据查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131103600918-d4c75cc564db698139cea8a94b402fd6.png" width="1902" height="639" class="img_ev3q"></p>
<p><strong>2). 菜品总览查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131103714898-cf85ecc3d9b2f34f52a4839e6379c39e.png" width="1897" height="587" class="img_ev3q"></p>
<p><strong>3). 订单管理数据查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131103808342-641fe665c9043560764e893c66507cde.png" width="1901" height="621" class="img_ev3q"></p>
<p><strong>4). 套餐总览查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131103903802-b7b5c1687bb92deb7a7b4bb8232f594d.png" width="1907" height="601" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="132-前后端联调测试">1.3.2 前后端联调测试<a href="#132-前后端联调测试" class="hash-link" aria-label="Direct link to 1.3.2 前后端联调测试" title="Direct link to 1.3.2 前后端联调测试">​</a></h4>
<p><strong>启动nginx</strong>,访问 <a href="http://localhost%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%B7%A5%E4%BD%9C%E5%8F%B0" target="_blank" rel="noopener noreferrer">http://localhost，进入工作台</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131104243713-1627806d4a9e9caaed529755421b1ff9.png" width="1884" height="833" class="img_ev3q"></p>
<p>进入开发者模式，分别查看今日数据、订单管理、菜品总览、套餐总览</p>
<p><strong>1). 今日数据查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131104849876-bd3e9e68729484b69d95a5d6cfedab2d.png" width="1897" height="804" class="img_ev3q"></p>
<p><strong>2). 订单管理数据查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131104939694-604359466e0331fcf22e5c6ae4228c4c.png" width="1901" height="795" class="img_ev3q"></p>
<p><strong>3). 菜品总览查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131105023109-4041d593884afabf4261b243932bf169.png" width="1896" height="804" class="img_ev3q"></p>
<p><strong>4). 套餐总览查询</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131105123610-0c3357ff23be709418d9d3ab258bcd97.png" width="1903" height="796" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-代码提交">1.4 代码提交<a href="#14-代码提交" class="hash-link" aria-label="Direct link to 1.4 代码提交" title="Direct link to 1.4 代码提交">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131105528906-980bb9bd1ccead9603839fe0d8693dd0.png" width="1075" height="1002" class="img_ev3q"></p>
<p>后续步骤和其它功能代码提交一致，不再赘述。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-apache-poi">2. Apache POI<a href="#2-apache-poi" class="hash-link" aria-label="Direct link to 2. Apache POI" title="Direct link to 2. Apache POI">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-介绍">2.1 介绍<a href="#21-介绍" class="hash-link" aria-label="Direct link to 2.1 介绍" title="Direct link to 2.1 介绍">​</a></h3>
<p>Apache POI 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用 POI 在 Java 程序中对Miscrosoft Office各种文件进行读写操作。
一般情况下，POI 都是用于操作 Excel 文件。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131110631081-6e69dffbf689d900dfb712747e5b93a3.png" width="900" height="265" class="img_ev3q"></p>
<p><strong>Apache POI 的应用场景：</strong></p>
<ul>
<li>
<p>银行网银系统导出交易明细</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131110810568-d36f0acde03493cedce63da3821d2793.png" width="1130" height="427" class="img_ev3q"></p>
</li>
<li>
<p>各种业务系统导出Excel报表</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131110839959-3c6d11e6eebd4e982a91d09c7a7c4e6e.png" width="1130" height="567" class="img_ev3q"></p>
</li>
<li>
<p>批量导入业务数据</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131110856903-8ab59b2af3f13b9b2d089fd935ef92a9.png" width="1143" height="600" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-入门案例">2.2 入门案例<a href="#22-入门案例" class="hash-link" aria-label="Direct link to 2.2 入门案例" title="Direct link to 2.2 入门案例">​</a></h3>
<p>Apache POI既可以将数据写入Excel文件，也可以读取Excel文件中的数据，接下来分别进行实现。</p>
<p><strong>Apache POI的maven坐标：</strong>(项目中已导入)</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.apache.poi</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">poi</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.16</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">org.apache.poi</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">groupId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">poi-ooxml</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">artifactId</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">3.16</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">version</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">dependency</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="221-将数据写入excel文件">2.2.1 将数据写入Excel文件<a href="#221-将数据写入excel文件" class="hash-link" aria-label="Direct link to 2.2.1 将数据写入Excel文件" title="Direct link to 2.2.1 将数据写入Excel文件">​</a></h4>
<p><strong>1). 代码开发</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.test;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFCell;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFRow;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFSheet;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.File;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.FileInputStream;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.FileOutputStream;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class POITest {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 基于POI向Excel文件写入数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void write() throws Exception{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //在内存中创建一个Excel文件对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFWorkbook excel = new XSSFWorkbook();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //创建Sheet页</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFSheet sheet = excel.createSheet(&quot;itcast&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //在Sheet页中创建行，0表示第1行</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFRow row1 = sheet.createRow(0);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //创建单元格并在单元格中设置值，单元格编号也是从0开始，1表示第2个单元格</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        row1.createCell(1).setCellValue(&quot;姓名&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        row1.createCell(2).setCellValue(&quot;城市&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFRow row2 = sheet.createRow(1);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        row2.createCell(1).setCellValue(&quot;张三&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        row2.createCell(2).setCellValue(&quot;北京&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFRow row3 = sheet.createRow(2);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        row3.createCell(1).setCellValue(&quot;李四&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        row3.createCell(2).setCellValue(&quot;上海&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        FileOutputStream out = new FileOutputStream(new File(&quot;D:\\itcast.xlsx&quot;));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //通过输出流将内存中的Excel文件写入到磁盘上</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        excel.write(out);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //关闭资源</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        out.flush();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        out.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        excel.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        write();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). 实现效果</strong></p>
<p>在D盘中生成itcast.xlsx文件，创建名称为itcast的Sheet页，同时将内容成功写入。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131112905034-c9b1dcae1585ba017a107fc3bde80aa9.png" width="1513" height="988" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="222-读取excel文件中的数据">2.2.2 读取Excel文件中的数据<a href="#222-读取excel文件中的数据" class="hash-link" aria-label="Direct link to 2.2.2 读取Excel文件中的数据" title="Direct link to 2.2.2 读取Excel文件中的数据">​</a></h4>
<p><strong>1). 代码开发</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.test;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFCell;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFRow;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFSheet;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.File;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.FileInputStream;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.FileOutputStream;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class POITest {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 基于POI读取Excel文件</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void read() throws Exception{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        FileInputStream in = new FileInputStream(new File(&quot;D:\\itcast.xlsx&quot;));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //通过输入流读取指定的Excel文件</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFWorkbook excel = new XSSFWorkbook(in);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获取Excel文件的第1个Sheet页</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        XSSFSheet sheet = excel.getSheetAt(0);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获取Sheet页中的最后一行的行号</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        int lastRowNum = sheet.getLastRowNum();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        for (int i = 0; i &lt;= lastRowNum; i++) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获取Sheet页中的行</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            XSSFRow titleRow = sheet.getRow(i);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获取行的第2个单元格</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            XSSFCell cell1 = titleRow.getCell(1);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获取单元格中的文本内容</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String cellValue1 = cell1.getStringCellValue();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获取行的第3个单元格</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            XSSFCell cell2 = titleRow.getCell(2);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获取单元格中的文本内容</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String cellValue2 = cell2.getStringCellValue();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(cellValue1 + &quot; &quot; +cellValue2);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //关闭资源</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        in.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        excel.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        read();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). 实现效果</strong></p>
<p>将itcast.xlsx文件中的数据进行读取</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131113255962-c6d4826503e01767278153aeced50044.png" width="1583" height="403" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-导出运营数据excel报表">3. 导出运营数据Excel报表<a href="#3-导出运营数据excel报表" class="hash-link" aria-label="Direct link to 3. 导出运营数据Excel报表" title="Direct link to 3. 导出运营数据Excel报表">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-需求分析和设计">3.1 需求分析和设计<a href="#31-需求分析和设计" class="hash-link" aria-label="Direct link to 3.1 需求分析和设计" title="Direct link to 3.1 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="311-产品原型">3.1.1 产品原型<a href="#311-产品原型" class="hash-link" aria-label="Direct link to 3.1.1 产品原型" title="Direct link to 3.1.1 产品原型">​</a></h4>
<p>在数据统计页面，有一个数据导出的按钮，点击该按钮时，其实就会下载一个文件。这个文件实际上是一个Excel形式的文件，文件中主要包含最近30日运营相关的数据。表格的形式已经固定，主要由概览数据和明细数据两部分组成。真正导出这个报表之后，相对应的数字就会填充在表格中，就可以进行存档。</p>
<p><strong>原型图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131151132672-b754a11c012262cf4a3499d89f399a5d.png" width="1277" height="748" class="img_ev3q"></p>
<p>导出的Excel报表格式：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130201026785-2987985f3fc387e7b393859ee1ba918a.png" width="792" height="535" class="img_ev3q"></p>
<p><strong>业务规则：</strong></p>
<ul>
<li>导出Excel形式的报表文件</li>
<li>导出最近30天的运营数据</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="312-接口设计">3.1.2 接口设计<a href="#312-接口设计" class="hash-link" aria-label="Direct link to 3.1.2 接口设计" title="Direct link to 3.1.2 接口设计">​</a></h4>
<p>通过上述原型图设计对应的接口。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230130201109280-84dc1af4d05530a55312ede8a0d47ca4.png" width="392" height="445" class="img_ev3q"></p>
<p><strong>注意：</strong></p>
<ul>
<li>
<p>当前接口没有传递参数，因为导出的是最近30天的运营数据，后端计算即可，所以不需要任何参数</p>
</li>
<li>
<p>当前接口没有返回数据，因为报表导出功能本质上是文件下载，服务端会通过输出流将Excel文件下载到客户端浏览器</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-代码开发">3.2 代码开发<a href="#32-代码开发" class="hash-link" aria-label="Direct link to 3.2 代码开发" title="Direct link to 3.2 代码开发">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="321-实现步骤">3.2.1 实现步骤<a href="#321-实现步骤" class="hash-link" aria-label="Direct link to 3.2.1 实现步骤" title="Direct link to 3.2.1 实现步骤">​</a></h4>
<p>1). 设计Excel模板文件</p>
<p>2). 查询近30天的运营数据</p>
<p>3). 将查询到的运营数据写入模板文件</p>
<p>4). 通过输出流将Excel文件下载到客户端浏览器</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131152610559-8af9351b53c47f346ba49b6acbb6bac1.png" width="838" height="820" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="322-controller层">3.2.2 Controller层<a href="#322-controller层" class="hash-link" aria-label="Direct link to 3.2.2 Controller层" title="Direct link to 3.2.2 Controller层">​</a></h4>
<p><strong>根据接口定义，在ReportController中创建export方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 导出运营数据报表</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/export&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;导出运营数据报表&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void export(HttpServletResponse response){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        reportService.exportBusinessData(response);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="323-service层接口">3.2.3 Service层接口<a href="#323-service层接口" class="hash-link" aria-label="Direct link to 3.2.3 Service层接口" title="Direct link to 3.2.3 Service层接口">​</a></h4>
<p><strong>在ReportService接口中声明导出运营数据报表的方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 导出近30天的运营数据报表</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     **/</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void exportBusinessData(HttpServletResponse response);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="324-service层实现类">3.2.4 Service层实现类<a href="#324-service层实现类" class="hash-link" aria-label="Direct link to 3.2.4 Service层实现类" title="Direct link to 3.2.4 Service层实现类">​</a></h4>
<p><strong>在ReportServiceImpl实现类中实现导出运营数据报表的方法:</strong></p>
<p>提前将资料中的<strong>运营数据报表模板.xlsx</strong>拷贝到项目的resources/template目录中</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**导出近30天的运营数据报表</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param response</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     **/</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void exportBusinessData(HttpServletResponse response) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        LocalDate begin = LocalDate.now().minusDays(30);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        LocalDate end = LocalDate.now().minusDays(1);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //查询概览运营数据，提供给Excel模板文件</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        BusinessDataVO businessData = workspaceService.getBusinessData(LocalDateTime.of(begin,LocalTime.MIN), LocalDateTime.of(end, LocalTime.MAX));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        InputStream inputStream = this.getClass().getClassLoader().getResourceAsStream(&quot;template/运营数据报表模板.xlsx&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //基于提供好的模板文件创建一个新的Excel表格对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            XSSFWorkbook excel = new XSSFWorkbook(inputStream);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获得Excel文件中的一个Sheet页</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            XSSFSheet sheet = excel.getSheet(&quot;Sheet1&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            sheet.getRow(1).getCell(1).setCellValue(begin + &quot;至&quot; + end);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获得第4行</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            XSSFRow row = sheet.getRow(3);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //获取单元格</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            row.getCell(2).setCellValue(businessData.getTurnover());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            row.getCell(4).setCellValue(businessData.getOrderCompletionRate());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            row.getCell(6).setCellValue(businessData.getNewUsers());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            row = sheet.getRow(4);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            row.getCell(2).setCellValue(businessData.getValidOrderCount());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            row.getCell(4).setCellValue(businessData.getUnitPrice());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            for (int i = 0; i &lt; 30; i++) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                LocalDate date = begin.plusDays(i);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">               //准备明细数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                businessData = workspaceService.getBusinessData(LocalDateTime.of(date,LocalTime.MIN), LocalDateTime.of(date, LocalTime.MAX));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row = sheet.getRow(7 + i);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row.getCell(1).setCellValue(date.toString());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row.getCell(2).setCellValue(businessData.getTurnover());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row.getCell(3).setCellValue(businessData.getValidOrderCount());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row.getCell(4).setCellValue(businessData.getOrderCompletionRate());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row.getCell(5).setCellValue(businessData.getUnitPrice());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                row.getCell(6).setCellValue(businessData.getNewUsers());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //通过输出流将文件下载到客户端浏览器中</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            ServletOutputStream out = response.getOutputStream();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            excel.write(out);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //关闭资源</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            out.flush();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            excel.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }catch (IOException e){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-功能测试">3.3 功能测试<a href="#33-功能测试" class="hash-link" aria-label="Direct link to 3.3 功能测试" title="Direct link to 3.3 功能测试">​</a></h3>
<p>直接使用前后端联调测试。</p>
<p><strong>进入数据统计</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131155111294-ce6256d9fe33e8e3fd3e77b728e9d5fa.png" width="1891" height="855" class="img_ev3q"></p>
<p><strong>点击数据导出</strong>：Excel报表下载成功</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131160647328-ea26fc5677d5ed3a075f29ebe85a8389.png" width="879" height="636" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-代码提交">3.4 代码提交<a href="#34-代码提交" class="hash-link" aria-label="Direct link to 3.4 代码提交" title="Direct link to 3.4 代码提交">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20230131160929202-00fc903949697b419f18123c1d0f91c5.png" width="1076" height="1005" class="img_ev3q"></p>
<p>后续步骤和其它功能代码提交一致，不再赘述。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#课程内容" class="table-of-contents__link toc-highlight">课程内容</a></li><li><a href="#1-工作台" class="table-of-contents__link toc-highlight">1. 工作台</a><ul><li><a href="#11-需求分析和设计" class="table-of-contents__link toc-highlight">1.1 需求分析和设计</a></li><li><a href="#12-代码导入" class="table-of-contents__link toc-highlight">1.2 代码导入</a></li><li><a href="#13-功能测试" class="table-of-contents__link toc-highlight">1.3 功能测试</a></li><li><a href="#14-代码提交" class="table-of-contents__link toc-highlight">1.4 代码提交</a></li></ul></li><li><a href="#2-apache-poi" class="table-of-contents__link toc-highlight">2. Apache POI</a><ul><li><a href="#21-介绍" class="table-of-contents__link toc-highlight">2.1 介绍</a></li><li><a href="#22-入门案例" class="table-of-contents__link toc-highlight">2.2 入门案例</a></li></ul></li><li><a href="#3-导出运营数据excel报表" class="table-of-contents__link toc-highlight">3. 导出运营数据Excel报表</a><ul><li><a href="#31-需求分析和设计" class="table-of-contents__link toc-highlight">3.1 需求分析和设计</a></li><li><a href="#32-代码开发" class="table-of-contents__link toc-highlight">3.2 代码开发</a></li><li><a href="#33-功能测试" class="table-of-contents__link toc-highlight">3.3 功能测试</a></li><li><a href="#34-代码提交" class="table-of-contents__link toc-highlight">3.4 代码提交</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>