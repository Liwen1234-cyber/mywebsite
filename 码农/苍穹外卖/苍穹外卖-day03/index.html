<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-码农/苍穹外卖/苍穹外卖-day03" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">苍穹外卖-day03 | Coisini</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day03/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="苍穹外卖-day03 | Coisini"><meta data-rh="true" name="description" content="课程内容"><meta data-rh="true" property="og:description" content="课程内容"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day03/"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day03/" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/苍穹外卖/苍穹外卖-day03/" hreflang="x-default"><meta name="google-site-verification" content="1FUPX6Qo4y3ecU623ShEurhgnjhSTjK49rRMhEDlzFA">
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.79037026.css">
<script src="/assets/js/runtime~main.468f2b27.js" defer="defer"></script>
<script src="/assets/js/main.4763ab3e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Coisini</b></a></div><div class="navbar__items navbar__items--right"><a href="https://minddiy.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>苍穹外卖-day03</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="课程内容">课程内容<a href="#课程内容" class="hash-link" aria-label="Direct link to 课程内容" title="Direct link to 课程内容">​</a></h2>
<ul>
<li>公共字段自动填充</li>
<li>新增菜品</li>
<li>菜品分页查询</li>
<li>删除菜品</li>
<li>修改菜品</li>
</ul>
<p>**功能实现：**菜品管理</p>
<p><strong>菜品管理效果图：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121142133307-68fca31000d1a510a07d14c932849a23.png" width="1672" height="794" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-公共字段自动填充">1. 公共字段自动填充<a href="#1-公共字段自动填充" class="hash-link" aria-label="Direct link to 1. 公共字段自动填充" title="Direct link to 1. 公共字段自动填充">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-问题分析">1.1 问题分析<a href="#11-问题分析" class="hash-link" aria-label="Direct link to 1.1 问题分析" title="Direct link to 1.1 问题分析">​</a></h3>
<p>在上一章节我们已经完成了后台系统的<strong>员工管理功能</strong>和<strong>菜品分类功能</strong>的开发，在<strong>新增员工</strong>或者<strong>新增菜品分类</strong>时需要设置创建时间、创建人、修改时间、修改人等字段，在<strong>编辑员工</strong>或者<strong>编辑菜品分类</strong>时需要设置修改时间、修改人等字段。这些字段属于公共字段，也就是也就是在我们的系统中很多表中都会有这些字段，如下：</p>



































<table><thead><tr><th><strong>序号</strong></th><th><strong>字段名</strong></th><th><strong>含义</strong></th><th><strong>数据类型</strong></th></tr></thead><tbody><tr><td>1</td><td>create_time</td><td>创建时间</td><td>datetime</td></tr><tr><td>2</td><td>create_user</td><td>创建人id</td><td>bigint</td></tr><tr><td>3</td><td>update_time</td><td>修改时间</td><td>datetime</td></tr><tr><td>4</td><td>update_user</td><td>修改人id</td><td>bigint</td></tr></tbody></table>
<p>而针对于这些字段，我们的赋值方式为：</p>
<p>1). 在新增数据时, 将createTime、updateTime 设置为当前时间, createUser、updateUser设置为当前登录用户ID。</p>
<p>2). 在更新数据时, 将updateTime 设置为当前时间, updateUser设置为当前登录 用户ID。</p>
<p>目前,在我们的项目中处理这些字段都是在每一个业务方法中进行赋值操作,如下:</p>
<p><strong>新增员工方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 新增员工</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param employeeDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void save(EmployeeDTO employeeDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //.......................</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		//////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //设置当前记录的创建时间和修改时间</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employee.setCreateTime(LocalDateTime.now());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employee.setUpdateTime(LocalDateTime.now());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //设置当前记录创建人id和修改人id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employee.setCreateUser(BaseContext.getCurrentId());//目前写个假数据，后期修改</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employee.setUpdateUser(BaseContext.getCurrentId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		///////////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employeeMapper.insert(employee);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>编辑员工方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 编辑员工信息</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param employeeDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void update(EmployeeDTO employeeDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       //........................................</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	   ///////////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employee.setUpdateTime(LocalDateTime.now());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employee.setUpdateUser(BaseContext.getCurrentId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       ///////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        employeeMapper.update(employee);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>新增菜品分类方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 新增分类</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param categoryDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void save(CategoryDTO categoryDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       //....................................</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">       //////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //设置创建时间、修改时间、创建人、修改人</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        category.setCreateTime(LocalDateTime.now());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        category.setUpdateTime(LocalDateTime.now());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        category.setCreateUser(BaseContext.getCurrentId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        category.setUpdateUser(BaseContext.getCurrentId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ///////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        categoryMapper.insert(category);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>修改菜品分类方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 修改分类</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param categoryDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void update(CategoryDTO categoryDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //....................................</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">		//////////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //设置修改时间、修改人</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        category.setUpdateTime(LocalDateTime.now());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        category.setUpdateUser(BaseContext.getCurrentId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //////////////////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        categoryMapper.update(category);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果都按照上述的操作方式来处理这些公共字段, 需要在每一个业务方法中进行操作, 编码相对冗余、繁琐，那能不能对于这些公共字段在某个地方统一处理，来简化开发呢？</p>
<p><strong>答案是可以的，我们使用AOP切面编程，实现功能增强，来完成公共字段自动填充功能。</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-实现思路">1.2 实现思路<a href="#12-实现思路" class="hash-link" aria-label="Direct link to 1.2 实现思路" title="Direct link to 1.2 实现思路">​</a></h3>
<p>在实现公共字段自动填充，也就是在插入或者更新的时候为指定字段赋予指定的值，使用它的好处就是可以统一对这些字段进行处理，避免了重复代码。在上述的问题分析中，我们提到有四个公共字段，需要在新增/更新中进行赋值操作, 具体情况如下:</p>








































<table><thead><tr><th><strong>序号</strong></th><th><strong>字段名</strong></th><th><strong>含义</strong></th><th><strong>数据类型</strong></th><th><strong>操作类型</strong></th></tr></thead><tbody><tr><td>1</td><td>create_time</td><td>创建时间</td><td>datetime</td><td>insert</td></tr><tr><td>2</td><td>create_user</td><td>创建人id</td><td>bigint</td><td>insert</td></tr><tr><td>3</td><td>update_time</td><td>修改时间</td><td>datetime</td><td>insert、update</td></tr><tr><td>4</td><td>update_user</td><td>修改人id</td><td>bigint</td><td>insert、update</td></tr></tbody></table>
<p><strong>实现步骤：</strong></p>
<p>1). 自定义注解 AutoFill，用于标识需要进行公共字段自动填充的方法</p>
<p>2). 自定义切面类 AutoFillAspect，统一拦截加入了 AutoFill 注解的方法，通过反射为公共字段赋值</p>
<p>3). 在 Mapper 的方法上加入 AutoFill 注解</p>
<p>若要实现上述步骤，需掌握以下知识(之前课程内容都学过)</p>
<p>**技术点：**枚举、注解、AOP、反射</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-代码开发">1.3 代码开发<a href="#13-代码开发" class="hash-link" aria-label="Direct link to 1.3 代码开发" title="Direct link to 1.3 代码开发">​</a></h3>
<p>按照上一小节分析的实现步骤依次实现，共三步。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="131-步骤一">1.3.1 步骤一<a href="#131-步骤一" class="hash-link" aria-label="Direct link to 1.3.1 步骤一" title="Direct link to 1.3.1 步骤一">​</a></h4>
<p><strong>自定义注解 AutoFill</strong></p>
<p>进入到sky-server模块，创建com.sky.annotation包。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.annotation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.enumeration.OperationType;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.lang.annotation.ElementType;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.lang.annotation.Retention;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.lang.annotation.RetentionPolicy;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.lang.annotation.Target;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 自定义注解，用于标识某个方法需要进行功能字段自动填充处理</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Target(ElementType.METHOD)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Retention(RetentionPolicy.RUNTIME)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public @interface AutoFill {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //数据库操作类型：UPDATE INSERT</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    OperationType value();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中OperationType已在sky-common模块中定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.enumeration;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 数据库操作类型</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public enum OperationType {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 更新操作</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    UPDATE,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 插入操作</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    INSERT</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="132-步骤二">1.3.2 步骤二<a href="#132-步骤二" class="hash-link" aria-label="Direct link to 1.3.2 步骤二" title="Direct link to 1.3.2 步骤二">​</a></h4>
<p><strong>自定义切面 AutoFillAspect</strong></p>
<p>在sky-server模块，创建com.sky.aspect包。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.aspect;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 自定义切面，实现公共字段自动填充处理逻辑</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Aspect</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class AutoFillAspect {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 切入点</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Pointcut(&quot;execution(* com.sky.mapper.*.*(..)) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void autoFillPointCut(){}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 前置通知，在通知中进行公共字段的赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Before(&quot;autoFillPointCut()&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void autoFill(JoinPoint joinPoint){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /////////////////////重要////////////////////////////////////</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //可先进行调试，是否能进入该方法 提前在mapper方法添加AutoFill注解</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;开始进行公共字段自动填充...&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>完善自定义切面 AutoFillAspect 的 autoFill 方法</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.aspect;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.annotation.AutoFill;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.AutoFillConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.context.BaseContext;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.enumeration.OperationType;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.aspectj.lang.JoinPoint;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.aspectj.lang.annotation.Aspect;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.aspectj.lang.annotation.Before;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.aspectj.lang.annotation.Pointcut;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.aspectj.lang.reflect.MethodSignature;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.lang.reflect.Method;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalDateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 自定义切面，实现公共字段自动填充处理逻辑</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Aspect</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class AutoFillAspect {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 切入点</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Pointcut(&quot;execution(* com.sky.mapper.*.*(..)) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void autoFillPointCut(){}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 前置通知，在通知中进行公共字段的赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Before(&quot;autoFillPointCut()&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void autoFill(JoinPoint joinPoint){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;开始进行公共字段自动填充...&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获取到当前被拦截的方法上的数据库操作类型</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        MethodSignature signature = (MethodSignature) joinPoint.getSignature();//方法签名对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        AutoFill autoFill = signature.getMethod().getAnnotation(AutoFill.class);//获得方法上的注解对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        OperationType operationType = autoFill.value();//获得数据库操作类型</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获取到当前被拦截的方法的参数--实体对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Object[] args = joinPoint.getArgs();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if(args == null || args.length == 0){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Object entity = args[0];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //准备赋值的数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        LocalDateTime now = LocalDateTime.now();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Long currentId = BaseContext.getCurrentId();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //根据当前不同  的操作类型，为对应的属性通过反射来赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if(operationType == OperationType.INSERT){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //为4个公共字段赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Method setCreateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_TIME, LocalDateTime.class);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Method setCreateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_USER, Long.class);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Method setUpdateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Method setUpdateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                //通过反射为对象属性赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                setCreateTime.invoke(entity,now);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                setCreateUser.invoke(entity,currentId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                setUpdateTime.invoke(entity,now);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                setUpdateUser.invoke(entity,currentId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            } catch (Exception e) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                e.printStackTrace();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }else if(operationType == OperationType.UPDATE){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //为2个公共字段赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Method setUpdateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                Method setUpdateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                //通过反射为对象属性赋值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                setUpdateTime.invoke(entity,now);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                setUpdateUser.invoke(entity,currentId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            } catch (Exception e) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                e.printStackTrace();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="133-步骤三">1.3.3 步骤三<a href="#133-步骤三" class="hash-link" aria-label="Direct link to 1.3.3 步骤三" title="Direct link to 1.3.3 步骤三">​</a></h4>
<p><strong>在Mapper接口的方法上加入 AutoFill 注解</strong></p>
<p>以<strong>CategoryMapper</strong>为例，分别在新增和修改方法添加@AutoFill()注解，也需要<strong>EmployeeMapper</strong>做相同操作</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.mapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface CategoryMapper {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 插入数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param category</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Insert(&quot;insert into category(type, name, sort, status, create_time, update_time, create_user, update_user)&quot; +</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            &quot; VALUES&quot; +</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            &quot; (#{type}, #{name}, #{sort}, #{status}, #{createTime}, #{updateTime}, #{createUser}, #{updateUser})&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @AutoFill(value = OperationType.INSERT)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void insert(Category category);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id修改分类</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param category</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @AutoFill(value = OperationType.UPDATE)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void update(Category category);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>同时</strong>，将业务层为公共字段赋值的代码注释掉。</p>
<p>1). 将员工管理的新增和编辑方法中的公共字段赋值的代码注释。</p>
<p>2). 将菜品分类管理的新增和修改方法中的公共字段赋值的代码注释。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-功能测试">1.4 功能测试<a href="#14-功能测试" class="hash-link" aria-label="Direct link to 1.4 功能测试" title="Direct link to 1.4 功能测试">​</a></h3>
<p>以<strong>新增菜品  分类</strong>为例，进行测试</p>
<p><strong>启动项目和Nginx</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121154642757-0391c77fde3df4bbbd82cc0cbc450556.png" width="763" height="415" class="img_ev3q"></p>
<p><strong>查看控制台</strong></p>
<p>通过观察控制台输出的SQL来确定公共字段填充是否完成</p>
<p><img decoding="async" loading="lazy" alt="image-20221121154841887" src="/assets/images/image-20221121154841887-9b200b29395d37888fe175af989daaaf.png" width="1743" height="143" class="img_ev3q"></p>
<p><strong>查看表</strong></p>
<p>category表中数据</p>
<p><img decoding="async" loading="lazy" alt="image-20221121155104152" src="/assets/images/image-20221121155104152-f08d35337d5214f76b031fe1578d9868.png" width="1363" height="59" class="img_ev3q"></p>
<p>其中create_time,update_time,create_user,update_user字段都已完成自动填充。</p>
<p>由于使用admin(id=1)用户登录进行菜品添加操作,故create_user,update_user都为1.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-代码提交">1.5 代码提交<a href="#15-代码提交" class="hash-link" aria-label="Direct link to 1.5 代码提交" title="Direct link to 1.5 代码提交">​</a></h3>
<p><strong>点击提交：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121155718603-08318b412c4fd02c52a187b7b4f1d630.png" width="1092" height="1000" class="img_ev3q"></p>
<p><strong>提交过程中</strong>，出现提示：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121155824695-f67318539a3778b2af253b737b40c280.png" width="460" height="205" class="img_ev3q"></p>
<p><strong>继续push:</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121160002324-fadbaf5eeb1bd41281faaef6e6ab24ce.png" width="942" height="844" class="img_ev3q"></p>
<p><strong>推送成功：</strong></p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf0AAABeCAYAAAApM818AAATUUlEQVR4nO3dTWgb+d0H8O/YlpM4trRr522TuGk0tZM0kCIo09ueZHUhhWWprnuYSw02RDkUU9FzEYQeooAMOfSZwl5VzEIDqWT2sLcOBfUpjxuvk9FuNvFus954I1l2UsvOPAeN5Bm92CPN+HW+HzCs49/M/P/zop/+b7PCZ599poOIiIiOpK6uLgwPD+Py5cvoGR4eRl9fHwRB2O9yERERkYt0XceLFy/w7NkzDA8Po+fs2bP7XSYiIiLaJbqu49WrV1hdXUXXfheGiIiIdk9XVyXV67rOpE9EROQFi4uLTPpERERewaRPRETkAd3d3Uz6REREXsGkT0RE5BFM+kRERB7BpE9EROQBuq6jZ78LQURE5LbNzbf46vkiNjY2AAA+nw8/vni+tmbdi5j0iYjoSFovl/Hd9y8t/3bh7BkcO9a7TyXaf3w5DxERHUnVFr7Zerm8DyVptPb69a7E2sGkT0REh9pKaRWra1vJsVBcwdPFbxrivl78FsWVUu330uoaSqure1LGqkJxBf96tADt6bMdY7Wnz/CvRwsoFFdcOTa794mI6FArlzfwhfYlyhsbCAwMoLfXh6WXy01ji6US5hae4MzQIN6sr6O4UkKvz4cbP70CX8/up8O112/w6Ekeuq7Xhh7ES8NNY7Wnz2oxj57kcePaFfSdOO7o+OzeJyKiQ+3p4jcoG135hZWVlgnf7LuXy7UW/3q5jGeL3+5qGav6ThzH6aHBrXJ8/7Jpi9+c8AHg9NCg44QP7HJL/9nKBh6/Wsfym7cAgMHjXRh5pxfDA+xcICIi58rlDXy//EPLv/f2+jBw8iQAoFhaRbnFmP7S8jKGL7y3J639asu+mtTrW/z1Cf/MqaGWvQGdcLWG5U0dn+ZX8dd8Cd+UGidRAMD5/h78KtiPD4Mn4esW3Dw8ERF5SHd3F86dPoVvv1tq+NvgOwGIP/4Rerq7AQAbm5t48uXX+KFQaIg9e/pULW4vtEr89f/tdsIHAKFYLOpu7Gh+eR1/+PtLvFjbtBV/tq8bv//FEK4Oenf5BBERObf8qoAvtC9rv/t8PoSuX0V3XSLf2NzEP//vUW04AACuiJcx+E5gz8pqVt+qN3Mz4ZdKJczPz2NwcNCdMf3Pn6/ht58v2U74APBibRO//XwJnz9fc6MIRETkUSeOH7P8Hhjob0j4ANDT3Q3/QH/dts7HyjslXhrGmVNDDf++Gy38KsdJf355HXf+8QPWN9vvMFjf1HHnHz9gfnndaTGIiIhoG4IgOEv65U0df/j7y5YJ/+NrfmR+fRGZX1/Ex9f8TWPWjX2UO/jSQERE9PrNfy2/F1ZK2Nxs7Hne2Ny0rNOvbPtmV8u2nVbd+61m9TvleMnep/nVtrr0W3mxtolP83v7ggQiIjrc3r59i6+eLVrG8wGgXC7jyVdfWxJ/dSJfue5NfV9oX+Kr54vQ9b1teDabpW/u6t+txO9o9v6DfGnnoDb2FR3p3zmQiIgIlf+pzn+Wvm/6t+VXBfzz3/O2luy9WPoeF86d3ZMle8DOy/JaLedzQ8c1fFosY7HFsryqTx4V8cmjoq39LZY28LRYxiW/r9MiERGRh/h8PTg1+G7LF/Ksr5fxcv3Vjvs5PTh4YBL+Tuv4neq4e//LwvYJHwB+dvoYPr7mx8fX/PjZ6WM7xtvZp1km5off3+InHEYso7W1v07UyhBOQdvj7iEvyKTCCJuuayzV3jXl9SE62i5dOF9L2IGBAcsb71o5MzRYm8Xf6/Nh+MJ7u1rGqrXXbyxfUFrN0q+f1b/0chlrr92Ze9DxV5uXb3Yey79x6hg+/mllAt8n/y7if5f+u228nX3apqpQoiHMJXKYnRTd2y/tGT0TQzSuWv9xJLg/hSGiA8nn68EV8TK6urpwsu8EAOD04Lt49u1/sFKyzhXz9/dj+Py5WsIvra4B0Pesld934jiu/SSIR0/yOD00uG3rvfq3pZfLuPaToCuv4XU8e/8wUOP3kGEL75CTkMgVUCwWkYzwLY5EZDXQf7KW8AEg4B/ApQvnG+J+dOE9yzr9/pN96DfG/PdKwD+AG9dGbXXXi5eGcePaKAL+AVeO7Wj2/tBx919Z2PE+pQRyhUpSKBaLKBRySCck449zeJwHdD2DmNFFHDZ1Eeu6hlS4sQtY1zWkYtauZX84hpS2zReI/DRi4a34cCyzY5eyneO0W3YA0LUMYuGwacgj3LRrvJ24VKw+zlo/u+fMTlwm5kcgqhi/qYiHAvD7Y/jb2/bPBRF5T0+T1nuv72DMGes7cWLnoA5i7ei4T+NywP3ukN3YZyd0XcP0WAj1PctQFcRDc0Aui0mxrsWpxhEK1YdHMT7aeniho+PYKb+WwlgoDutuVSjxEJSFNIrJiEtxUSgzCeSyEwgib6suu1VnIiKzXp8PZ04NYcNYoufz+eDzHYwcs586bulf8vtwod+9E3ihv6fzmftqHKFAoNZqDARCprHg6+0PA+cfYsbYXE7kKr0HuTTkysEQv5dtupmUSCNXKKBQyKHa0aDOPGzd6uzwONvRdQ3T40aClhJI56zlgXIHKU13FFcpZwISAKhxjE/n7dfFZlwkWUQhLVfPrNG9nwR794nIju7uLoiXhnFFvIwr4mUEf3QRXV1HfkR7R47OwM2ge+vq3dyXmZy+i4jQeaZQZu4hldEgiBEkjeGDagu47kiYmhiDKAgQBBEffFTN+guwM9/c/nF2YE6qUxOIiJXyTEwlIEky0rn7lZa0gzgAEMRJ3De+IVS+2LRfF9fqTEREtjhK+h8GT+Jsn/Ox/bN93fgw6O5kCkmSkUjnOpr4JYiTmJKrSVtBPBqC3x+ujNG3GtOXRtHuGoGOjtMhITKJ2dkkIuL2pdwuTokGYF4WGar2pqgLyIsTtuqyl3UmIqItjmfv+7oF/P4XQ+jtbp5YP3lUROQvzxH5y/OWL+npNfbha7EPW+om8hWLRczOJjEZ6XypXiQ5i0IujUQ1QUGFqkQRCgUsE8ic2qvjdExbQP3weyt263Lg60xEdAQ5fvc+AFwd7MXUz99tmfi309stYOrn7+LqYK/TYuwKQYxgMjlrjDvnkDCGmN1eBrhbx5l7nK/9t66lEAvHkGrywqJt48RRVFOznLZ+sdr6SdaGUOzWZa/OLRERbXFlVsP7F/vwx/dPt9XVf7avG398/zTev9jnRhFsEDFam1x3Dxljklp2erxhJrmeiW29Aa6a/ILASC39ucP+ceyXHcEPUJtOEDfF3puBYnSnxzJ6R3HKndvIGF3wura1dM4fy9iui/Nz28a5ICIiC9em318d7MX/RM7h0/wq/pov4ZsW7+U/39+DXwX78WHwpLMu/TYJgoiR6wBUAKqCaEhpHTx2CwlJQVwFlGgIDZHyTUeTA9s/jv2yC4KIifsJzITiUNEkVkrg1liHcU2PLSN9dwyAaKsuusNz29Z1JCIiC1fXL/i6BURH+vHnX57DnyLn8DtpEL+58Q5+c+Md/E4axJ8i5/DnX55DdKR/TxN+1djdHNKyqUUpSUik01vL1AyCIGIim0M6IVvbn5IEOZFG7u6YK+Vp5zh2yw5UJstlc2nIkvmPEiQ5jVx2AqIgdBSXkK0Hk+QE0rnK6gi7dXHj3LZzLoiIaItQLBY5gEpERHRElUolzM/PY2ho6Oi/e5+IiIhcmr1PREREhwOTPhERkUcw6RMREXkEkz4REZFHMOkTERF5gON37xMREdHhwNn7REREHsKkT0RE5BFM+kRERB7BpE9EROQRTPpEREQewNn7REREHsHZ+0RERB7CpE9EROQRTPpEREQewaRPRETkAUtLS0z6REREXjA0NMSkT0RE5AXnzp1j0iciIvKKQ530tVQYfr+/+U84hlRG25Xj6rqGVNgPfzgFTdd35RiW48QybW2XibW/zWHV7FroWgqxcAyZHa6N3bi90Ok95ca9qGdiu34vt+sgXRuio+RQJ/1tqQri0RBiGW99aGipMKLKfpdif+UfzkBR3Ys76rIPFOD6CERB2O+i1PDaELnviLycR0a6UECxWLT85NIyAEC5M32gWjC7Rdc1ZGJhhOLe+qQUBBGTs0UUZycPVNJqV6f1cFp/Xc/ggQLIN8fa3paIDp8jkPSbEyNJpGUA6gI0tO4GbdaFrusaUjHz0EEYsZZDBVnEwqa4VGOcrmVMMX6EwzFktMYvIlomhrBpeCKbt1dXXc/gdiCEqALI6QRke5u1PG6qSdnq6+Cvq4OupRD2+xFOaab9bZ0P3XSMcKzuGjjZ1nRdn7x9glTYb3zxURANBBBudj2MbVrF7VTX7ex4nkz329bwVAx/e/Kk6f1puTb+MGKpjOV+rb+vzb9nMimEd7g3kX0ABTJujjm7Dpbymuvf5LjbPV/tXpv6Z6nV+bV7/YiOMr57vwld1zA9FkLc0reoQmk6VLCAe2NRUzekCiVujdO1FMZCUUtXpaoqiIbGLMlVS4URiirY2pWC6Pg9LNgs96icRq6Qxd2xEZtbGOXLxBqOG68rm56JNdQBTeoAAFi4h/Ha/lQo8XGkMimMmY6hKnGEbmcbC+NkW5e0VVcn287dwXi1V0YahRhs3F/DPQEVSjwKW505ahzRaBzqNvcmAOQfzwHyTUTMvQQdXodaeS3lsx63vefLyu6zBMDW+SXyoiOb9LVMrDK2Xf+BtpP8Q8yogCSnkTOGDQq5BCQAyoO6ZKMqUJCoxeUSxpCCEafrGqbH41AhQU7nTEMPCUhQEb9XjcvgXlwFICFhxBVyaSSg2BrXFIQIJpORtrt3dV3D9B2lctxcwTQsomLmYd4SowLWOiQkACri49bhE1VRcN2Iq+4rHo0DiZzlXGLucUNL0cm2lfNQ6equlK0y7DM7KdqOa7euzc6l7W1VtVavZl3zLe8JqdXVbMJ0D+eMDc33sK5reDijQhq1nqNOrkN1X4CMdG5ruK3h2dnh+dr22th4luyeXyKvOgJJv9IFWD97PxQ1ktmtzsYq1bk7uDc9jYymQRAnMVssopiM1EXJSGcnah8owYmb1q716gdc4j6Ska0PVjEyifsJCVAeVGYn5x9jDpW4SSNOECOYuG98uO4WU/kmRcEoWxLFYnErWRoxkNPWOkzOGsMnM3hoHoYwxQXHjPMhJXB/wmhqBT/AR60q5WRbN7RbV0fbypia2Kb5mX0ABU7uCRnpu2Ome3Oqcdgn/xAzqoSPPqgrRwfXoTa3oJiEiDwymRRSsRjGQnE0+95q7/mqL6uNZ8lU/23PL5FHHYGk35wkyUjnsrVkZpcgTmJKBqCqUOJxREOh2hhmw7igNAprG0nEqPnDUFuACkCNhxq/lMRVAHN4nN+Kuz5S9yG120nO0HDcJppN9Bq72Th7oL7VaByglnwEQcTI9ebHcLKtm+zW1dG2DfeOVf7xHIAmCdnuPbHTvQlU7jvpI9QfotPrUJ0TEAqFEI3GEVeUhoTf1vNVX1bYeJZa1p+IjvTs/dnZJCJtJvyqSLLSbSibPiRVJY5o6DbXDdORkX2gQProA1e6vnU9g9tGq16SZSQSaaTTOeQK6YYeBj5fRPvnCCR9e2qtE2M2/xYNC036H8XIJJKzxrhhLo3KcL2C+mH9bYmjkADI6cYvJZWf2UpPhBE397i+77h52dzWeNxGDfMZYKzvPoKc1NWt8xSs3Ky1uRU11WEEh6pL9ez08thiDFHJ6QJmk0lMTkYQiYgIGv9er+3ny+6zREQteXT2voIH06ZJamNRmD+S9Uys0t2YytQmKQWDIkZGJQASmvV8tmR0xSrRMcvbAXXNWHblN944FhzBdQBqfNyydKm+bK4zyqfGx2uzn3UthZjftHSs2p2sRC3LFmsvAWrSPXww1HX32olzUle3z5Mxlq7Gx2v3jq5ljMlsLjAt1XOT8iBrejNiBrer5TUm/bX3fDVemx2fJSLalqeSfnVsVTHGBQOBEOKQLd2MGLuFhASo8ShCxgTBQCCEaFxt+4NbEERMTFVnP2+NRQZClWVXUuIWIoIAQYjgrjFLWoluUzaXWcoXMuoaikMBIE9VJihWYyr5LFQ3jiohcX/igM6MrtSp2Tr9VnFO6ur2eRKECG5VZ/5X74mQzeV6NjRdqueE6UtP7bmpX74ItPl8NV6bnZ4lItqep5K+EEkil5Brs58lOYFc9hZGzTGCiIlsDglLtpUqS4yy7Sc4IZJEIWcdv4RUWXZkXk4mRJLWcU5JRrqubLuhclzZNCO8UrZkRLDEZBvq0NlEyb0QnJiqlVVd0Fous2sW56Subp8ncXK2ybVp/+VL9Vot1XNCEERM3E831D2RzllekmX3+Wp1bew8S0TUmlAsFtknRnRIVN6+GMVcgomOiOwplUqYn5/HlStXvNXSJzosqsvf/KbX3eq6huztyjwP1ybgEZGnsKVPdADVXlfbbAxfSnQ01ERE3lRt6V+9epUtfaKDyO25JUREAFv6RERERxpb+kRERB7EpE9EROQRTPpEREQewaRPRETkEUz6REREHsGkT0RE5BFM+kRERB7BpE9EROQRTPpEREQewaRPRETkEUz6REREHsGkT0RE5AGCIDDpExEReQWTPhERkQewpU9EROQRTPpEREQe8v+eMCDec7hGxwAAAABJRU5ErkJggg==" width="509" height="94" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-新增菜品">2. 新增菜品<a href="#2-新增菜品" class="hash-link" aria-label="Direct link to 2. 新增菜品" title="Direct link to 2. 新增菜品">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-需求分析与设计">2.1 需求分析与设计<a href="#21-需求分析与设计" class="hash-link" aria-label="Direct link to 2.1 需求分析与设计" title="Direct link to 2.1 需求分析与设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="211-产品原型">2.1.1 产品原型<a href="#211-产品原型" class="hash-link" aria-label="Direct link to 2.1.1 产品原型" title="Direct link to 2.1.1 产品原型">​</a></h4>
<p>后台系统中可以管理菜品信息，通过 <strong>新增功能</strong>来添加一个新的菜品，在添加菜品时需要选择当前菜品所属的菜品分类，并且需要上传菜品图片。</p>
<p><strong>新增菜品原型：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121164131337-8639a6e060189e52690fc2651d95055c.png" width="1057" height="759" class="img_ev3q"></p>
<p>当填写完表单信息, 点击&quot;保存&quot;按钮后, 会提交该表单的数据到服务端, 在服务端中需要接受数据, 然后将数据保存至数据库中。</p>
<p><strong>业务规则：</strong></p>
<ul>
<li>菜品名称必须是唯一的</li>
<li>菜品必须属于某个分类下，不能单独存在</li>
<li>新增菜品时可以根据情况选择菜品的口味</li>
<li>每个菜品必须对应一张图片</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="212-接口设计">2.1.2 接口设计<a href="#212-接口设计" class="hash-link" aria-label="Direct link to 2.1.2 接口设计" title="Direct link to 2.1.2 接口设计">​</a></h4>
<p>根据上述原型图先<strong>粗粒度</strong>设计接口，共包含3个接口。</p>
<p><strong>接口设计：</strong></p>
<ul>
<li>根据类 型查询分类（已完成）</li>
<li>文件上传</li>
<li>新增菜品</li>
</ul>
<p>接下来<strong>细粒度</strong>分析每个接口，明确每个接口的请求方式、请求路径、传入参数和返回值。</p>
<p><strong>1. 根据类型查询分类</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121165033612-267940da95cb2dc57519e3454e8e0f84.png" width="666" height="509" class="img_ev3q"></p>
<p><strong>2. 文件上传</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121165201319-6cc4e11362f82ae11cda35ebe697df90.png" width="648" height="686" class="img_ev3q"></p>
<p><strong>3. 新增菜品</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121165254961-5e9de17d121af2348b62d202a3d7f1bd.png" width="495" height="441" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="213-表设计">2.1.3 表设计<a href="#213-表设计" class="hash-link" aria-label="Direct link to 2.1.3 表设计" title="Direct link to 2.1.3 表设计">​</a></h4>
<p>通过原型图进行分析：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121165917874-d9671059d035d877d39ba746b90bd601.png" width="1083" height="782" class="img_ev3q"></p>
<p>新增菜品，其实就是将新增页面录入的菜品信息插入到dish表，如果添加了口味做法，还需要向dish_flavor表插入数据。所以在新增菜品时，涉及到两个表：</p>

















<table><thead><tr><th>表名</th><th>说明</th></tr></thead><tbody><tr><td>dish</td><td>菜品表</td></tr><tr><td>dish_flavor</td><td>菜品口味表</td></tr></tbody></table>
<p><strong>1). 菜品表:dish</strong></p>













































































<table><thead><tr><th><strong>字段名</strong></th><th><strong>数据类型</strong></th><th><strong>说明</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>主键</td><td> 自增</td></tr><tr><td>name</td><td>varchar(32)</td><td>菜品名称</td><td>唯一</td></tr><tr><td>category_id</td><td>bigint</td><td>分类id</td><td>逻辑外键</td></tr><tr><td>price</td><td>decimal(10,2)</td><td>菜品价格</td><td></td></tr><tr><td>image</td><td>varchar(255)</td><td>图片路径</td><td></td></tr><tr><td>description</td><td>varchar(255)</td><td>菜品描述</td><td></td></tr><tr><td>status</td><td>int</td><td>售卖状态</td><td>1起售 0停售</td></tr><tr><td>create_time</td><td>datetime</td><td>创建时间</td><td></td></tr><tr><td>update_time</td><td>datetime</td><td>最后修改时间</td><td></td></tr><tr><td>create_user</td><td>bigint</td><td>创建人id</td><td></td></tr><tr><td>update_user</td><td>bigint</td><td>最后修改人id</td><td></td></tr></tbody></table>
<p><strong>2). 菜品口味表:dish_flavor</strong></p>



































<table><thead><tr><th><strong>字段名</strong></th><th><strong>数据类型</strong></th><th><strong>说明</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>主键</td><td>自增</td></tr><tr><td>dish_id</td><td>bigint</td><td>菜品id</td><td>逻辑外键</td></tr><tr><td>name</td><td>varchar(32)</td><td>口味名称</td><td></td></tr><tr><td>value</td><td>varchar(255)</td><td>口味值</td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-代码开发">2.2 代码开发<a href="#22-代码开发" class="hash-link" aria-label="Direct link to 2.2 代码开发" title="Direct link to 2.2 代码开发">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="221-文件上传实现">2.2.1 文件上传实现<a href="#221-文件上传实现" class="hash-link" aria-label="Direct link to 2.2.1 文件上传实现" title="Direct link to 2.2.1 文件上传实现">​</a></h4>
<p>因为在新增菜品时，需要上传菜品对应的图片(文件)，包括后绪其它功能也会使用到文件上传，故要实现通用的文件上传接口。</p>
<p>文件上传，是指将本地图片、视频、音频等文件上传到服务器上，可以供其他用户浏览或下载的过程。文件上传在项目中应用非常广泛，我们经常发抖音、发朋友圈都用到了文件上传功能。</p>
<p>实现文件上传服务，需要有存储的支持，那么我们的解决方案将以下几种：</p>
<ol>
<li>直接将图片保存到服务的硬盘（springmvc中的文件上传）
<ol>
<li>优点：开发便捷，成本低</li>
<li>缺点：扩容困难</li>
</ol>
</li>
<li>使用分布式文件系统进行存储
<ol>
<li>优点：容易实现扩容</li>
<li>缺点：开发复杂度稍大（有成熟的产品可以使用，比如：FastDFS,MinIO）</li>
</ol>
</li>
<li>使用第三方的存储服务（例如OSS）
<ol>
<li>优点：开发简单，拥有强大功能，免维护</li>
<li>缺点：付费</li>
</ol>
</li>
</ol>
<p>在本项目选用阿里云的OSS服务进行文件存储。（前面课程已学习过阿里云OSS,不再赘述）</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121174942235-a03250244129008f30e2dbaa5cf2fe97.png" width="961" height="194" class="img_ev3q"></p>
<p><strong>实现步骤：</strong></p>
<p><strong>1). 定义OSS相关配置</strong></p>
<p>在sky-server模块</p>
<p>application-dev.yml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sky</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">alioss</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> oss</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">cn</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">hangzhou.aliyuncs.com</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">access-key-id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> LTAI5tPeFLzsPPT8gG3LPW64</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">access-key-secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> U6k1brOZ8gaOIXv3nXbulGTUzy6Pd7</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">bucket-name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> sky</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">take</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">out</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>application.yml</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token key atrule" style="color:hsl(35, 99%, 36%)">spring</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">profiles</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">active</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> dev    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">#设置环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">sky</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">alioss</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">endpoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">sky.alioss.endpoint</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">access-key-id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">sky.alioss.access</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">id</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">access-key-secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">sky.alioss.access</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">secret</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(35, 99%, 36%)">bucket-name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">sky.alioss.bucket</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">-</span><span class="token plain">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). 读取OSS配置</strong></p>
<p>在sky-common模块中，已定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.properties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.boot.context.properties.ConfigurationProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@ConfigurationProperties(prefix = &quot;sky.alioss&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class AliOssProperties {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String endpoint;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String accessKeyId;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String accessKeySecret;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String bucketName;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>3). 生成OSS工具类对象</strong></p>
<p>在sky-server模块</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.config;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.properties.AliOssProperties;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.utils.AliOssUtil;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.context.annotation.Bean;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.context.annotation.Configuration;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 配置类，用于创建AliOssUtil对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class OssConfiguration {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ConditionalOnMissingBean</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public AliOssUtil aliOssUtil(AliOssProperties aliOssProperties){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;开始创建阿里云文件上传工具类对象：{}&quot;,aliOssProperties);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return new AliOssUtil(aliOssProperties.getEndpoint(),</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                aliOssProperties.getAccessKeyId(),</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                aliOssProperties.getAccessKeySecret(),</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                aliOssProperties.getBucketName());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中，AliOssUtil.java已在sky-common模块中定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.utils;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.aliyun.oss.ClientException;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.aliyun.oss.OSS;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.aliyun.oss.OSSClientBuilder;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.aliyun.oss.OSSException;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.AllArgsConstructor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.ByteArrayInputStream;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class AliOssUtil {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String endpoint;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String accessKeyId;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String accessKeySecret;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String bucketName;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 文件上传</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param bytes</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param objectName</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public String upload(byte[] bytes, String objectName) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        // 创建OSSClient实例。</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            // 创建PutObject请求。</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            ossClient.putObject(bucketName, objectName, new ByteArrayInputStream(bytes));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } catch (OSSException oe) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Caught an OSSException, which means your request made it to OSS, &quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    + &quot;but was rejected with an error response for some reason.&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Error Message:&quot; + oe.getErrorMessage());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Error Code:&quot; + oe.getErrorCode());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Request ID:&quot; + oe.getRequestId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Host ID:&quot; + oe.getHostId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } catch (ClientException ce) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Caught an ClientException, which means the client encountered &quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    + &quot;a serious internal problem while trying to communicate with OSS, &quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    + &quot;such as not being able to access the network.&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            System.out.println(&quot;Error Message:&quot; + ce.getMessage());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            if (ossClient != null) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                ossClient.shutdown();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //文件访问路径规则 https://BucketName.Endpoint/ObjectName</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        StringBuilder stringBuilder = new StringBuilder(&quot;https://&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        stringBuilder</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .append(bucketName)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .append(&quot;.&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .append(endpoint)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .append(&quot;/&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                .append(objectName);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;文件上传到:{}&quot;, stringBuilder.toString());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return stringBuilder.toString();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>4). 定义文件上传接口</strong></p>
<p>在sky-server模块中定义接口</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.admin;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.constant.MessageConstant;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.utils.AliOssUtil;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.PostMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.multipart.MultipartFile;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.UUID;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 通用接口</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/admin/common&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;通用接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class CommonController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private AliOssUtil aliOssUtil;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 文件上传</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param file</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @PostMapping(&quot;/upload&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;文件上传&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;String&gt; upload(MultipartFile file){</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;文件上传：{}&quot;,file);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //原始文件名</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String originalFilename = file.getOriginalFilename();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //截取原始文件名的后缀   dfdfdf.png</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String extension = originalFilename.substring(originalFilename.lastIndexOf(&quot;.&quot;));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //构造新文件名称</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String objectName = UUID.randomUUID().toString() + extension;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //文件的请求路径</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            String filePath = aliOssUtil.upload(file.getBytes(), objectName);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            return Result.success(filePath);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            log.error(&quot;文件上传失败：{}&quot;, e);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.error(MessageConstant.UPLOAD_FAILED);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="222-新增菜品实现">2.2.2 新增菜品实现<a href="#222-新增菜品实现" class="hash-link" aria-label="Direct link to 2.2.2 新增菜品实现" title="Direct link to 2.2.2 新增菜品实现">​</a></h4>
<p><strong>1). 设计DTO类</strong></p>
<p>在sky-pojo模块中</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.dto;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.DishFlavor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.math.BigDecimal;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class DishDTO implements Serializable {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Long id;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品名称</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String name;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品分类id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Long categoryId;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品价格</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private BigDecimal price;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //图片</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String image;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //描述信息</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String description;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //0 停售 1 起售</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Integer status;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private List&lt;DishFlavor&gt; flavors = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). Controller层</strong></p>
<p>进入到sky-server模块</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.controller.admin;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.DishDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.DishPageQueryDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Dish;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.PageResult;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.result.Result;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.service.DishService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.vo.DishVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import io.swagger.annotations.ApiOperation;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.springframework.web.bind.annotation.*;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.Set;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> * 菜品管理</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"> */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@RequestMapping(&quot;/admin/dish&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Api(tags = &quot;菜品相关接口&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class DishController {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private DishService dishService;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 新增菜品</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @PostMapping</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;新增菜品&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result save(@RequestBody DishDTO dishDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;新增菜品：{}&quot;, dishDTO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishService.saveWithFlavor(dishDTO);//后绪步骤开发</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>3). Service层接口</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.dto.DishDTO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.Dish;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface DishService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 新增菜品和对应的口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void saveWithFlavor(DishDTO dishDTO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>4). Service层实现类</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.service.impl;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Service</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class DishServiceImpl implements DishService {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private DishMapper dishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private DishFlavorMapper dishFlavorMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 新增菜品和对应的口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Transactional</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void saveWithFlavor(DishDTO dishDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Dish dish = new Dish();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        BeanUtils.copyProperties(dishDTO, dish);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //向菜品表插入1条数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishMapper.insert(dish);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //获取insert语句生成的主键值</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Long dishId = dish.getId();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;DishFlavor&gt; flavors = dishDTO.getFlavors();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if (flavors != null &amp;&amp; flavors.size() &gt; 0) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            flavors.forEach(dishFlavor -&gt; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                dishFlavor.setDishId(dishId);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            });</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //向口味表插入n条数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dishFlavorMapper.insertBatch(flavors);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>5). Mapper层</strong></p>
<p>DishMapper.java中添加</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 插入菜品数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dish</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @AutoFill(value = OperationType.INSERT)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void insert(Dish dish);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在/resources/mapper中创建DishMapper.xml</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&lt;!</span><span class="token doctype doctype-tag" style="color:hsl(230, 8%, 24%)">DOCTYPE</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">mapper</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">PUBLIC</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token doctype" style="color:hsl(230, 8%, 24%)">        </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">com.sky.mapper.DishMapper</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">insert</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">insert</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">useGeneratedKeys</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">true</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">keyProperty</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">id</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        insert into dish (name, category_id, price, image, description, create_time, update_time, create_user,update_user, status)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        values (#{name}, #{categoryId}, #{price}, #{image}, #{description}, #{createTime}, #{updateTime}, #{createUser}, #{updateUser}, #{status})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">insert</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>DishFlavorMapper.java</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.mapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.DishFlavor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface DishFlavorMapper {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 批量插入口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param flavors</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void insertBatch(List&lt;DishFlavor&gt; flavors);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在/resources/mapper中创建DishFlavorMapper.xml</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&lt;!</span><span class="token doctype doctype-tag" style="color:hsl(230, 8%, 24%)">DOCTYPE</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">mapper</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">PUBLIC</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token doctype" style="color:hsl(230, 8%, 24%)">        </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">com.sky.mapper.DishFlavorMapper</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">insert</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">insertBatch</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        insert into dish_flavor (dish_id, name, value) VALUES</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">foreach</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">collection</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">flavors</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">item</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">df</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">separator</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">,</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            (#{df.dishId},#{df.name},#{df.value})</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">foreach</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">insert</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-功能测试">2.3 功能测试<a href="#23-功能测试" class="hash-link" aria-label="Direct link to 2.3 功能测试" title="Direct link to 2.3 功能测试">​</a></h3>
<p>进入到菜品管理---&gt;新建菜品</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121195440804-c8f72ad7d385c6265330ba2ab38753ef.png" width="1212" height="772" class="img_ev3q"></p>
<p>由于没有实现菜品查询功能，所以保存后，暂且在表中查看添加的数据。</p>
<p>dish表：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121195737692-ba30c2d5ec51ecdff9bb15fc5b66ba6d.png" width="1797" height="272" class="img_ev3q"></p>
<p>dish_flavor表：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121195902555-142fafc9c299bcd8d4cc8092fdf59828.png" width="924" height="272" class="img_ev3q"></p>
<p>测试成功。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24代码提交">2.4代码提交<a href="#24代码提交" class="hash-link" aria-label="Direct link to 2.4代码提交" title="Direct link to 2.4代码提交">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121200332933-a3afe08b6274b274f1688ee1892c361b.png" width="1077" height="997" class="img_ev3q"></p>
<p>后续步骤和上述功能代码提交一致，不再赘述。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-菜品分页查询">3. 菜品分页查询<a href="#3-菜品分页查询" class="hash-link" aria-label="Direct link to 3. 菜品分页查询" title="Direct link to 3. 菜品分页查询">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-需求分析和设计">3.1 需求分析和设计<a href="#31-需求分析和设计" class="hash-link" aria-label="Direct link to 3.1 需求分析和设计" title="Direct link to 3.1 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="311-产品原型">3.1.1 产品原型<a href="#311-产品原型" class="hash-link" aria-label="Direct link to 3.1.1 产品原型" title="Direct link to 3.1.1 产品原型">​</a></h4>
<p>系统中的菜品数据很多的时候，如果在一个页面中全部展示出来会显得比较乱，不便于查看，所以一般的系统中都会以分页的方式来展示列表数据。</p>
<p><strong>菜品分页原型：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121201552489-25094dee66c09c18c0aef8cb948f0627.png" width="1041" height="672" class="img_ev3q"></p>
<p>在菜品列表展示时，除了菜品的基本信息(名称、售价、售卖状态、最后操作时间)外，还有两个字段略微特殊，第一个是图片字段 ，我们从数据库查询出来的仅仅是图片的名字，图片要想在表格中回显展示出来，就需要下载这个图片。第二个是菜品分类，这里展示的是分类名称，而不是分类ID，此时我们就需要根据菜品的分类ID，去分类表中查询分类信息  ，然后在页面展示。</p>
<p><strong>业务规则：</strong></p>
<ul>
<li>根据页码展示菜品信息</li>
<li>每页展示10条数据</li>
<li>分页查询时可以根据需要输入菜品名称、菜品分类、菜品状态进行查询</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="312-接口设计">3.1.2 接口设计<a href="#312-接口设计" class="hash-link" aria-label="Direct link to 3.1.2 接口设计" title="Direct link to 3.1.2 接口设计">​</a></h4>
<p>根据上述原型图，设计出相应的接口。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121202019258-b5a46706db1f4ee1cacfed761d428d6d.png" width="507" height="697" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-代码开发">3.2 代码开发<a href="#32-代码开发" class="hash-link" aria-label="Direct link to 3.2 代码开发" title="Direct link to 3.2 代码开发">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="321-设计dto类">3.2.1 设计DTO类<a href="#321-设计dto类" class="hash-link" aria-label="Direct link to 3.2.1 设计DTO类" title="Direct link to 3.2.1 设计DTO类">​</a></h4>
<p><strong>根据菜品分页查询接口定义设计对应的DTO：</strong></p>
<p>在sky-pojo模块中，已定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.dto;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class DishPageQueryDTO implements Serializable {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private int page;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private int pageSize;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String name;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Integer categoryId; //分类id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Integer status; //状态 0表示禁用 1表示启用</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="322-设计vo类">3.2.2 设计VO类<a href="#322-设计vo类" class="hash-link" aria-label="Direct link to 3.2.2 设计VO类" title="Direct link to 3.2.2 设计VO类">​</a></h4>
<p><strong>根据菜品分页查询接口定义设计对应的VO：</strong></p>
<p>在sky-pojo模块中，已定义</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.vo;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.DishFlavor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.AllArgsConstructor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Builder;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.Data;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import lombok.NoArgsConstructor;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.math.BigDecimal;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.time.LocalDateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Builder</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@NoArgsConstructor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class DishVO implements Serializable {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Long id;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品名称</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String name;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品分类id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Long categoryId;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品价格</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private BigDecimal price;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //图片</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String image;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //描述信息</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String description;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //0 停售 1 起售</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private Integer status;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //更新时间</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private LocalDateTime updateTime;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //分类名称</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String categoryName;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //菜品关联的口味</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private List&lt;DishFlavor&gt; flavors = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="323-controller层">3.2.3 Controller层<a href="#323-controller层" class="hash-link" aria-label="Direct link to 3.2.3 Controller层" title="Direct link to 3.2.3 Controller层">​</a></h4>
<p><strong>根据接口定义创建DishController的page分页查询方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品分页查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishPageQueryDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/page&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;菜品分页查询&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;PageResult&gt; page(DishPageQueryDTO dishPageQueryDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;菜品分页查询:{}&quot;, dishPageQueryDTO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        PageResult pageResult = dishService.pageQuery(dishPageQueryDTO);//后绪步骤定义</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(pageResult);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="324-service层接口">3.2.4 Service层接口<a href="#324-service层接口" class="hash-link" aria-label="Direct link to 3.2.4 Service层接口" title="Direct link to 3.2.4 Service层接口">​</a></h4>
<p><strong>在 DishService 中扩展分页查询方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品分页查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishPageQueryDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    PageResult pageQuery(DishPageQueryDTO dishPageQueryDTO);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="325-service层实现类">3.2.5 Service层实现类<a href="#325-service层实现类" class="hash-link" aria-label="Direct link to 3.2.5 Service层实现类" title="Direct link to 3.2.5 Service层实现类">​</a></h4>
<p><strong>在 DishServiceImpl 中实现分页查询方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品分页查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishPageQueryDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public PageResult pageQuery(DishPageQueryDTO dishPageQueryDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        PageHelper.startPage(dishPageQueryDTO.getPage(), dishPageQueryDTO.getPageSize());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Page&lt;DishVO&gt; page = dishMapper.pageQuery(dishPageQueryDTO);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return new PageResult(page.getTotal(), page.getResult());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="326-mapper层">3.2.6 Mapper层<a href="#326-mapper层" class="hash-link" aria-label="Direct link to 3.2.6 Mapper层" title="Direct link to 3.2.6 Mapper层">​</a></h4>
<p><strong>在 DishMapper 接口中声明 pageQuery 方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品分页查询</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishPageQueryDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Page&lt;DishVO&gt; pageQuery(DishPageQueryDTO dishPageQueryDTO);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在 DishMapper.xml 中编写SQL：</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">pageQuery</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">com.sky.vo.DishVO</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        select d.* , c.name as categoryName from dish d left outer join category c on d.category_id = c.id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">name != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and d.name like concat(&#x27;%&#x27;,#{name},&#x27;%&#x27;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">categoryId != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and d.category_id = #{categoryId}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">status != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                and d.status = #{status}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">where</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        order by d.create_time desc</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-功能测试">3.3 功能测试<a href="#33-功能测试" class="hash-link" aria-label="Direct link to 3.3 功能测试" title="Direct link to 3.3 功能测试">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="331-接口文档测试">3.3.1 接口文档测试<a href="#331-接口文档测试" class="hash-link" aria-label="Direct link to 3.3.1 接口文档测试" title="Direct link to 3.3.1 接口文档测试">​</a></h4>
<p>**启动服务：**访问<a href="http://localhost:8080/doc.html%EF%BC%8C%E8%BF%9B%E5%85%A5%E8%8F%9C%E5%93%81%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3" target="_blank" rel="noopener noreferrer">http://localhost:8080/doc.html，进入菜品分页查询接口</a></p>
<p>**注意：**使用admin用户登录重新获取token，防止token失效。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121210252403-1478f88e1bd632121dea4d54761680df.png" width="1902" height="649" class="img_ev3q"></p>
<p><strong>点击发送：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121210333489-344a39254dc10137a3c6f8393258e897.png" width="1378" height="357" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="332-前后端联调测试">3.3.2 前后端联调测试<a href="#332-前后端联调测试" class="hash-link" aria-label="Direct link to 3.3.2 前后端联调测试" title="Direct link to 3.3.2 前后端联调测试">​</a></h4>
<p>启动nginx,访问 <a href="http://localhost" target="_blank" rel="noopener noreferrer">http://localhost</a></p>
<p><strong>点击菜品管理</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121210500188-4cb1d727b0719aaa068737cd9fc814cd.png" width="1900" height="844" class="img_ev3q"></p>
<p>数据成功查出。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-删除菜品">4. 删除菜品<a href="#4-删  除菜品" class="hash-link" aria-label="Direct link to 4. 删除菜品" title="Direct link to 4. 删除菜品">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-需求分析和设计">4.1 需求分析和设计<a href="#41-需求分析和设计" class="hash-link" aria-label="Direct link to 4.1 需求分析和设计" title="Direct link to 4.1 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="411-产品原型">4.1.1 产品原型<a href="#411-产品原型" class="hash-link" aria-label="Direct link to 4.1.1 产品原型" title="Direct link to 4.1.1 产品原型">​</a></h4>
<p>在菜品列表页面，每个菜品后面对应的操作分别为<strong>修改</strong>、<strong>删除</strong>、<strong>停售</strong>，可通过删除功能完成对菜品及相关的数据进行删除。</p>
<p><strong>删除菜品原型：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121211236356-a24af806283ab53a098da0bcea09dc41.png" width="1283" height="662" class="img_ev3q"></p>
<p><strong>业务规则：</strong></p>
<ul>
<li>可以一次删除一个菜品，也可以批量删除菜品</li>
<li>起售中的菜品不能删除</li>
<li>被套餐关联的菜品不能删除</li>
<li>删除菜品后，关联的口味数据也需要删除掉</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="412-接口设计">4.1.2 接口设计<a href="#412-接口设计" class="hash-link" aria-label="Direct link to 4.1.2 接口设计" title="Direct link to 4.1.2 接口设计">​</a></h4>
<p>根据上述原型图，设计出相应的接口。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121211801121-969ce824658266e45f63bfdfa05c3af5.png" width="630" height="586" class="img_ev3q"></p>
<p>**注意：**删除一个菜品和批量删除菜品共用一个接口，故ids可包含多个菜品id,之间用逗号分隔。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="413-表设计">4.1.3 表设计<a href="#413-表设计" class="hash-link" aria-label="Direct link to 4.1.3 表设计" title="Direct link to 4.1.3 表设计">​</a></h4>
<p>在进行删除菜品操作时，会涉及到以下三张表。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221121212436851-bcb3fec75c3997c63422f3e04266247c.png" width="1167" height="693" class="img_ev3q"></p>
<p><strong>注意事项：</strong></p>
<ul>
<li>在dish表中删除菜品基本数据时，同时，也要把关联在dish_flavor表中的数据一块删除。</li>
<li>setmeal_dish表为菜品和套餐关联的中间表。</li>
<li>若删除的菜品数据关联着某个套餐，此时，删除失败。</li>
<li>若要删除套餐关联的菜品数据，先解除两者关联，再对菜品进行删除。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-代码开发">4.2 代码开发<a href="#42-代码开发" class="hash-link" aria-label="Direct link to 4.2 代码开发" title="Direct link to 4.2 代码开发">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="412-controller层">4.1.2 Controller层<a href="#412-controller层" class="hash-link" aria-label="Direct link to 4.1.2 Controller层" title="Direct link to 4.1.2 Controller层">​</a></h4>
<p><strong>根据删除菜品的接口定义在DishController中创建方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品批量删除</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param ids</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @DeleteMapping</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;菜品批量删除&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result delete(@RequestParam List&lt;Long&gt; ids) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;菜品批量删除：{}&quot;, ids);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishService.deleteBatch(ids);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="422-service层接口">4.2.2 Service层接口<a href="#422-service层接口" class="hash-link" aria-label="Direct link to 4.2.2 Service层接口" title="Direct link to 4.2.2 Service层接口">​</a></h4>
<p><strong>在DishService接口中声明deleteBatch方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品批量删除</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param ids</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void deleteBatch(List&lt;Long&gt; ids);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="423-service层实现类">4.2.3 Service层实现类<a href="#423-service层实现类" class="hash-link" aria-label="Direct link to 4.2.3 Service层实现类" title="Direct link to 4.2.3 Service层实现类">​</a></h4>
<p><strong>在DishServiceImpl中实现deleteBatch方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private SetmealDishMapper setmealDishMapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 菜品批量删除</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param ids</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Transactional//事务</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void deleteBatch(List&lt;Long&gt; ids) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //判断当前菜品是否能够删除---是否存在起售中的菜品？？</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        for (Long id : ids) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            Dish dish = dishMapper.getById(id);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            if (dish.getStatus() == StatusConstant.ENABLE) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                //当前菜品处于起售中，不能删除</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                throw new DeletionNotAllowedException(MessageConstant.DISH_ON_SALE);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //判断当前菜品是否能够删除---是否被套餐关联了？？</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;Long&gt; setmealIds = setmealDishMapper.getSetmealIdsByDishIds(ids);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if (setmealIds != null &amp;&amp; setmealIds.size() &gt; 0) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //当前菜品被套餐关联了，不能删除</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            throw new DeletionNotAllowedException(MessageConstant.DISH_BE_RELATED_BY_SETMEAL);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //删除菜品表中的菜品数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        for (Long id : ids) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dishMapper.deleteById(id);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //删除菜品关联的口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dishFlavorMapper.deleteByDishId(id);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="424-mapper层">4.2.4 Mapper层<a href="#424-mapper层" class="hash-link" aria-label="Direct link to 4.2.4 Mapper层" title="Direct link to 4.2.4 Mapper层">​</a></h4>
<p><strong>在DishMapper中声明getById方法，并配置SQL：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据主键查询菜品</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Select(&quot;select * from dish where id = #{id}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Dish getById(Long id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>创建SetmealDishMapper，声明getSetmealIdsByDishIds方法，并在xml文件中编写SQL：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">package com.sky.mapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import com.sky.entity.SetmealDish;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.ibatis.annotations.Delete;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import org.apache.ibatis.annotations.Mapper;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public interface SetmealDishMapper {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据菜品id查询对应的套餐id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishIds</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    //select setmeal_id from setmeal_dish where dish_id in (1,2,3,4)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;Long&gt; getSetmealIdsByDishIds(List&lt;Long&gt; dishIds);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>SetmealDishMapper.xml</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token prolog" style="color:hsl(230, 4%, 64%)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&lt;!</span><span class="token doctype doctype-tag" style="color:hsl(230, 8%, 24%)">DOCTYPE</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">mapper</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype name" style="color:hsl(230, 8%, 24%)">PUBLIC</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token doctype" style="color:hsl(230, 8%, 24%)">        </span><span class="token doctype string" style="color:hsl(119, 34%, 47%)">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token doctype" style="color:hsl(230, 8%, 24%)"> </span><span class="token doctype punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">namespace</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">com.sky.mapper.SetmealDishMapper</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">getSetmealIdsByDishIds</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">resultType</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">java.lang.Long</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        select setmeal_id from setmeal_dish where dish_id in</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">foreach</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">collection</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">dishIds</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">item</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">dishId</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">separator</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">,</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">open</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">close</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            #{dishId}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">foreach</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">select</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">mapper</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在DishMapper.java中声明deleteById方法并配置SQL：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据主键删除菜品数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Delete(&quot;delete from dish where id = #{id}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void deleteById(Long id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>在DishFlavorMapper中声明deleteByDishId方法并配置SQL：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据菜品id删除对应的口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishId</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Delete(&quot;delete from dish_flavor where dish_id = #{dishId}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void deleteByDishId(Long dishId);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-功能测试">4.3 功能测试<a href="#43-功能测试" class="hash-link" aria-label="Direct link to 4.3 功能测试" title="Direct link to 4.3 功能测试">​</a></h3>
<p>既可以通过Swagger接口文档进行测试，也可以通过前后端联调测试，接下来，我们直接使用<strong>前后端联调测试</strong>。</p>
<p>进入到菜品列表查询页面</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122125332084-bc601ef0bb2942d0f08899c5536d2b10.png" width="1893" height="791" class="img_ev3q"></p>
<p>对测试菜品进行删除操作</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122125625014-52aa6439b74570affae501d4931734cf.png" width="1896" height="751" class="img_ev3q"></p>
<p>同时，进到dish表和dish_flavor两个表查看<strong>测试菜品</strong>的相关数据都已被成功删除。</p>
<p>再次，删除状态为启售的菜品</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122125841464-06dbe1190f05ae69b995bc0ed3ae3388.png" width="1889" height="652" class="img_ev3q"></p>
<p>点击批量删除</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122130016566-692da8799af38f9a9e3f1028cfed718c.png" width="1896" height="562" class="img_ev3q"></p>
<p>删除失败，因为起售中的菜品不能删除。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-代码提交">4.4 代码提交<a href="#44-代码提交" class="hash-link" aria-label="Direct link to 4.4 代码提交" title="Direct link to 4.4 代码提交">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122130426605-ccabfce4cbbcbcd52014f93ecee975b3.png" width="1082" height="1004" class="img_ev3q"></p>
<p>后续步骤和上述功能代码提交一致，不再赘述。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-修改菜品">5. 修改菜品<a href="#5-修改菜品" class="hash-link" aria-label="Direct link to 5. 修改菜品" title="Direct link to 5. 修改菜品">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-需求分析和设计">5.1 需求分析和设计<a href="#51-需求分析和设计" class="hash-link" aria-label="Direct link to 5.1 需求分析和设计" title="Direct link to 5.1 需求分析和设计">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="511-产品原型">5.1.1 产品原型<a href="#511-产品原型" class="hash-link" aria-label="Direct link to 5.1.1 产品原型" title="Direct link to 5.1.1 产品原型">​</a></h4>
<p>在菜品管理列表页面点击修改按钮，跳转到修改菜品页面，在修改页面回显菜品相关信息并进行修改，最后点击保存按钮完成修改操作。</p>
<p><strong>修改菜品原型：</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122130837173-9941e0c08224209dd398ea1a4f90f8ee.png" width="1082" height="744" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="512-接口设计">5.1.2 接口设计<a href="#512-接口设计" class="hash-link" aria-label="Direct link to 5.1.2 接口设计" title="Direct link to 5.1.2 接口设计">​</a></h4>
<p>通过对上述原型图进行分析，该页面共涉及4个接口。</p>
<p><strong>接口：</strong></p>
<ul>
<li>根据id查询菜品</li>
<li>根据类型查询分类(已实现)</li>
<li>文件上传(已实现)</li>
<li>修改菜品</li>
</ul>
<p>我们只需要实现<strong>根据id查询菜品</strong>和<strong>修改菜品</strong>两个接口，接下来，我们来重点分析这两个接口。</p>
<p><strong>1). 根据id查询菜品</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122131733147-22e13aa325ca401ba21127a8f857cedf.png" width="301" height="554" class="img_ev3q"></p>
<p><strong>2). 修改菜品</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122131837393-6f7e9b9814689cd5bc74092eaf9dcb65.png" width="550" height="456" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122131914533-79b6005248e4ff0145dd7e45b7e5d654.png" width="502" height="261" class="img_ev3q"></p>
<p><strong>注:因为是修改功能，请求方式可设置为PUT。</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-代码开发">5.2 代码开发<a href="#52-代码开发" class="hash-link" aria-label="Direct link to 5.2 代码开发" title="Direct link to 5.2 代码开发">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="521-根据id查询菜品实现">5.2.1 根据id查询菜品实现<a href="#521-根据id查询菜品实现" class="hash-link" aria-label="Direct link to 5.2.1 根据id查询菜品实现" title="Direct link to 5.2.1 根据id查询菜品实现">​</a></h4>
<p><strong>1). Controller层</strong></p>
<p><strong>根据id查询菜品的接口定义在DishController中创建方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id查询菜品</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @GetMapping(&quot;/{id}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;根据id查询菜品&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result&lt;DishVO&gt; getById(@PathVariable Long id) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;根据id查询菜品：{}&quot;, id);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        DishVO dishVO = dishService.getByIdWithFlavor(id);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success(dishVO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). Service层接口</strong></p>
<p><strong>在DishService接口中声明getByIdWithFlavor方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id查询菜品和对应的口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    DishVO getByIdWithFlavor(Long id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>3). Service层实现类</strong></p>
<p><strong>在DishServiceImpl中实现getByIdWithFlavor方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id查询菜品和对应的口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param id</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public DishVO getByIdWithFlavor(Long id) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //根据id查询菜品数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Dish dish = dishMapper.getById(id);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //根据菜品id查询口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;DishFlavor&gt; dishFlavors = dishFlavorMapper.getByDishId(id);//后绪步骤实现</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //将查询到的数据封装到VO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        DishVO dishVO = new DishVO();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        BeanUtils.copyProperties(dish, dishVO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishVO.setFlavors(dishFlavors);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return dishVO;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>4). Mapper层</strong></p>
<p><strong>在DishFlavorMapper中声明getByDishId方法，并配置SQL：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据菜品id查询对应的口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishId</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Select(&quot;select * from dish_flavor where dish_id = #{dishId}&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    List&lt;DishFlavor&gt; getByDishId(Long dishId);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="521-修改菜品实现">5.2.1 修改菜品实现<a href="#521-修改菜品实现" class="hash-link" aria-label="Direct link to 5.2.1 修改菜品实现" title="Direct link to 5.2.1 修改菜品实现">​</a></h4>
<p><strong>1). Controller层</strong></p>
<p><strong>根据修改菜品的接口定义在DishController中创建方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 修改菜品</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @PutMapping</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @ApiOperation(&quot;修改菜品&quot;)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public Result update(@RequestBody DishDTO dishDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        log.info(&quot;修改菜品：{}&quot;, dishDTO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishService.updateWithFlavor(dishDTO);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return Result.success();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2). Service层接口</strong></p>
<p><strong>在DishService接口中声明updateWithFlavor方法 ：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id修改菜品基本信息和对应的口味信息</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void updateWithFlavor(DishDTO dishDTO);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>3). Service层实现类</strong></p>
<p><strong>在DishServiceImpl中实现updateWithFlavor方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id修改菜品基本信息和对应的口味信息</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dishDTO</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public void updateWithFlavor(DishDTO dishDTO) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Dish dish = new Dish();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        BeanUtils.copyProperties(dishDTO, dish);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //修改菜品表基本信息</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishMapper.update(dish);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //删除原有的口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dishFlavorMapper.deleteByDishId(dishDTO.getId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        //重新插入口味数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        List&lt;DishFlavor&gt; flavors = dishDTO.getFlavors();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if (flavors != null &amp;&amp; flavors.size() &gt; 0) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            flavors.forEach(dishFlavor -&gt; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                dishFlavor.setDishId(dishDTO.getId());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            });</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            //向口味表插入n条数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            dishFlavorMapper.insertBatch(flavors);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>4). Mapper层</strong></p>
<p><strong>在DishMapper中，声明update方法：</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">	/**</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * 根据id动态修改菜品数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     *</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     * @param dish</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @AutoFill(value = OperationType.UPDATE)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    void update(Dish dish);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>并在DishMapper.xml文件中编写SQL:</strong></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">update</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">update</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        update dish</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">set</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">name != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">name = #{name},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">categoryId != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">category_id = #{categoryId},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">price != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">price = #{price},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">image != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">image = #{image},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">description != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">description = #{description},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">status != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">status = #{status},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">updateTime != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">update_time = #{updateTime},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">updateUser != null</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain">update_user = #{updateUser},</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">if</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">set</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        where id = #{id}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">update</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-功能测试">5.3 功能测试<a href="#53-功能测试" class="hash-link" aria-label="Direct link to 5.3 功能测试" title="Direct link to 5.3 功能测试">​</a></h3>
<p>本次测试直接通过<strong>前后端联调测试</strong> ，可使用Debug方式启动项目，观察运行中步骤。</p>
<p>进入菜品列表查询页面，对第一个菜品的价格进行修改</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122141233080-a6b9857a9d847735cd6e737f2f083553.png" width="1891" height="670" class="img_ev3q"></p>
<p>点击修改，回显成功</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122141348677-064edfaf1dd067f1d6c8e5525753d4d9.png" width="1581" height="844" class="img_ev3q"></p>
<p>菜品价格修改后，点击保存</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122141456498-fbd313df1ae21e189b7c96c6a64e6a1f.png" width="1892" height="758" class="img_ev3q"></p>
<p>修改成功</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-代码提交">5.4 代码提交<a href="#54-代码提交" class="hash-link" aria-label="Direct link to 5.4 代码提交" title="Direct link to 5.4 代码提交">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20221122141554380-ca81bd1d58b572bfba209f6f922756db.png" width="1083" height="1001" class="img_ev3q"></p>
<p>后续步骤和上述功能代码提交一致，不再赘述。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#课程内容" class="table-of-contents__link toc-highlight">课程内容</a></li><li><a href="#1-公共字段自动填充" class="table-of-contents__link toc-highlight">1. 公共字段自动填充</a><ul><li><a href="#11-问题分析" class="table-of-contents__link toc-highlight">1.1 问题分析</a></li><li><a href="#12-实现思路" class="table-of-contents__link toc-highlight">1.2 实现思路</a></li><li><a href="#13-代码开发" class="table-of-contents__link toc-highlight">1.3 代码开发</a></li><li><a href="#14-功能测试" class="table-of-contents__link toc-highlight">1.4 功能测试</a></li><li><a href="#15-代码提交" class="table-of-contents__link toc-highlight">1.5 代码提交</a></li></ul></li><li><a href="#2-新增菜品" class="table-of-contents__link toc-highlight">2. 新增菜品</a><ul><li><a href="#21-需求分析与设计" class="table-of-contents__link toc-highlight">2.1 需求分析与设计</a></li><li><a href="#22-代码开发" class="table-of-contents__link toc-highlight">2.2 代码开发</a></li><li><a href="#23-功能测试" class="table-of-contents__link toc-highlight">2.3 功能测试</a></li><li><a href="#24代码提交" class="table-of-contents__link toc-highlight">2.4代码提交</a></li></ul></li><li><a href="#3-菜品分页查询" class="table-of-contents__link toc-highlight">3. 菜品分页查询</a><ul><li><a href="#31-需求分析和设计" class="table-of-contents__link toc-highlight">3.1 需求分析和设计</a></li><li><a href="#32-代码开发" class="table-of-contents__link toc-highlight">3.2 代码开发</a></li><li><a href="#33-功能测试" class="table-of-contents__link toc-highlight">3.3 功能测试</a></li></ul></li><li><a href="#4-删除菜品" class="table-of-contents__link toc-highlight">4. 删除菜品</a><ul><li><a href="#41-需求分析和设计" class="table-of-contents__link toc-highlight">4.1 需求分析和设计</a></li><li><a href="#42-代码开发" class="table-of-contents__link toc-highlight">4.2 代码开发</a></li><li><a href="#43-功能测试" class="table-of-contents__link toc-highlight">4.3 功能测试</a></li><li><a href="#44-代码提交" class="table-of-contents__link toc-highlight">4.4 代码提交</a></li></ul></li><li><a href="#5-修改菜品" class="table-of-contents__link toc-highlight">5. 修改菜品</a><ul><li><a href="#51-需求分析和设计" class="table-of-contents__link toc-highlight">5.1 需求分析和设计</a></li><li><a href="#52-代码开发" class="table-of-contents__link toc-highlight">5.2 代码开发</a></li><li><a href="#53-功能测试" class="table-of-contents__link toc-highlight">5.3 功能测试</a></li><li><a href="#54-代码提交" class="table-of-contents__link toc-highlight">5.4 代码提交</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>