<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-码农/deep_learning/Classification" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Classification | Coisini</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.minddiy.top/码农/deep_learning/Classification/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Classification | Coisini"><meta data-rh="true" name="description" content="To learn more"><meta data-rh="true" property="og:description" content="To learn more"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.minddiy.top/码农/deep_learning/Classification/"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/deep_learning/Classification/" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/deep_learning/Classification/" hreflang="x-default"><meta name="google-site-verification" content="1FUPX6Qo4y3ecU623ShEurhgnjhSTjK49rRMhEDlzFA">
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.79037026.css">
<script src="/assets/js/runtime~main.468f2b27.js" defer="defer"></script>
<script src="/assets/js/main.4763ab3e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Coisini</b></a></div><div class="navbar__items navbar__items--right"><a href="https://minddiy.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Classification</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="to-learn-more">To learn more<a href="#to-learn-more" class="hash-link" aria-label="Direct link to To learn more" title="Direct link to To learn more">​</a></h2>
<p>接下来讲有关分类怎麼做这件事情,这边讲的是一个短的版本,因為时间有限的关係,如果你想要看长的版本的话,可以看一下<a href="https://www.bilibili.com/video/BV13x411v7US?p=10" target="_blank" rel="noopener noreferrer">过去上课的录影</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320164739451-536b2a2b6c31153901aebd4d1f2635fe.png" width="474" height="258" class="img_ev3q"></p>
<p>过去可能是花两个小时,到三个小时的时间才讲完,分类这件事情,我们这边用一个最快的方法,直接跟你讲分类是怎麼做的</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classification-as-regression">Classification as Regression？<a href="#classification-as-regression" class="hash-link" aria-label="Direct link to Classification as Regression？" title="Direct link to Classification as Regression？">​</a></h2>
<p>分类是怎麼做的呢 我们已经讲了,Regression就是输入一个向量,然后输出一个数值,我们希望输出的数值跟某一个label,也就是我们要学习的目标,越接近越好，这门课里面，<strong>如果是正确的答案就有加Hat,Model的输出没有加Hat</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320165723587-c1805147eb272a6089d0040faf088732.png" width="581" height="138" class="img_ev3q"></p>
<p>有一个可能,假设你会用Regression的话,我们其实可以<strong>把Classification,当作是Regression来看</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320170048002-4b022fd8ddeb1894dcecc40f70c1ab58.png" width="649" height="260" class="img_ev3q"></p>
<p>这个方法不一定是个好方法,这是一个比较奇妙的方法,输入一个东西以后,我们的输出仍然是一个scaler,它叫做y 然后这一个y,我们要让它跟正确答案,那个Class越接近越好,但是<strong>y是一个数字</strong>,我们怎麼让它跟Class越接近越好呢,我们<strong>必须把Class也变成数字</strong></p>
<p>举例来说 Class1就是编号1,Class2就是编号2,Class3就是编号3,接下来呢 我们要做的事情,就是希望y可以跟Class的编号,越接近越好</p>
<p>但是这会是一个  好方法吗,如果你仔细想想的话,这个方法也许在某些状况下,是会有瑕疵的</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="484" height="131" class="img_ev3q"></p>
<p>因為如果你假设说Class one就是编号1,Class two就是编号2,Class3就是编号3,意味著说你觉得<strong>Class1跟Class2是比较像</strong>,然后<strong>Class1跟Class3 它是比较不像</strong>,像这样子的表示Class的方式,有时候可行 有时候不可行</p>
<ul>
<li>
<p>假设你的Class one two three<strong>真的有某种关係</strong>举例来说,你想要根据一个人的身高跟体重,然后预测他是几年级的小学生,一年级 二年级 还是三年级,那可能一年级真的跟二年级比较接近,一年级真的跟三年级比较没有关係</p>
</li>
<li>
<p>但是假设你的三个Class本身,<strong>并没有什麼特定的关係</strong>的话,你说Class one是1,Class two是2 Class two是3,那就很奇怪了,因為你这样是预设说,一二有比较近的关係,一三有比较远的关係,所以怎麼办呢</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="class-as-one-hot-vector">Class as one-hot vector<a href="#class-as-one-hot-vector" class="hash-link" aria-label="Direct link to Class as one-hot vector" title="Direct link to Class as one-hot vector">​</a></h2>
<p>当你在做分类的问题的时候,比较常见的做法是把你的Class,用 One-hot vector来表示</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="289" height="124" class="img_ev3q"></p>
<p>如果有三个Class,我们的 label 这个ŷ,就是一个三维的向量,然后呢 如果是Class1就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">1</span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord">0</span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span></span></span></span>,如果是Class2就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">0</span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord">1</span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span></span></span></span>,如果是Class3就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">0</span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord">0</span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span></span></span></span>,所以每一个Class,你都用一个One-hot vector来表示</p>
<p>而且你用One-hot vector来表示的话,就没有说Class1跟Class2比较接近,Class1跟Class3比较远这样子的问题,如果你把这个One-hot vector,<strong>用算距离的话,Class之间 两两它们的距离都是一样</strong></p>
<p>如果我们今天的目标y hat是一个向量 比如说,ŷ是有三个element的向量，那我们的network,也应该要Output的维度也是三个数字才行</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320185241328-9b8d0dcc7841751fa3c62608eda6caf2.png" width="794" height="434" class="img_ev3q"></p>
<p>到目前為止我们讲的network,其实都只Output一个数值,因為我们<strong>过去做的都是Regression的问题,所以只Output一个数字</strong></p>
<p>其实<strong>从一个数值改到三个数值,它是没有什麼不同的</strong></p>
<p>你可以Output一个数值,你就可以Output三个数值,所以把本来Output一个数值的方法,重复三次</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320185906259-018abddc17292d3b7a8481e17bcd8b0d.png" width="799" height="438" class="img_ev3q"></p>
<ul>
<li>
<p>把a₁ a₂ a₃,乘上三个不同的Weight 加上bias,得到y₁</p>
</li>
<li>
<p>再把a₁ a₂ a₃乘上另外三个Weight,再加上另外一个bias得到y₂</p>
</li>
<li>
<p>再把a₁ a₂ a₃再乘上另外一组Weight,再加上另外一个bias得到y₃</p>
</li>
</ul>
<p>你就可以產生三组数字,所以你就可以Input一个feature的Vector,然后產生y₁ y₂ y₃,然后希望y₁ y₂ y₃,跟我们的目标越接近越好,</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classification-with-softmax">Classification with softmax<a href="#classification-with-softmax" class="hash-link" aria-label="Direct link to Classification with softmax" title="Direct link to Classification with softmax">​</a></h2>
<p>好 那所以我们现在,知道了Regression是怎麼做的,Input x Output y 要跟 label ŷ,越接近越好</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320190545539-4a02862e71a0d70924f3311ef5d0a9e3.png" width="593" height="141" class="img_ev3q"></p>
<p>如果是Classification,input x可能乘上一个W,再加上b 再通过activation function,再乘上W&#x27;再加上b&#x27; 得到y,我们现在的<strong>y它不是一个数值,它是一个向量</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320190621261-ffd021c1ffb83af2db2e8c365febb91f.png" width="581" height="287" class="img_ev3q"></p>
<p>但是在做Classification的时候,我们往往会<strong>把y再通过一个叫做Soft-max的function得到y&#x27;</strong>,然后我们才去计算,y&#x27;跟y hat之间的距离</p>
<p>為什麼要加上Soft-max呢,一个比较简单的解释（如果是在过去的课程裡面,我们会先从generative的Model开始讲起,然后一路讲到Logistic Regression）</p>
<p>这边有一个骗小孩的解释就是,这个ŷ 它裡面的值,都是0跟1,它是One-hot vector,所以裡面的值只有0跟1，但是y裡面有任何值</p>
<p>既然我们的目标只有0跟1,但是==y有<strong>任何值</strong>,我们就先把它Normalize到<strong>0到1之间</strong>,这样才好跟 label 的计算相似度==,这是一个比较简单的讲法</p>
<p>如果你真的想要知道,為什麼要用Soft-max的话,你可以参考过去的上课录影,如果你不想知道的话,你就记得这个Soft-max要做的事情,就是把本来y裡面可以放任何值,改成挪到0到1之间</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="softmax">Softmax<a href="#softmax" class="hash-link" aria-label="Direct link to Softmax" title="Direct link to Softmax">​</a></h3>
<p>这个是Soft-max的block,输入y₁ y₂ y₃,它会產生y₁&#x27; y₂&#x27; y₃&#x27;</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320193732150-36210f83317f7d407d1330f2fa2d08c0.png" width="763" height="466" class="img_ev3q"></p>
<p>它裡面运作的模式是这个样子的</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0489em;vertical-align:-0.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.5488em;vertical-align:-1.1218em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>我们会先把所有的y取一个exponential,就算是负数,取exponential以后也变成正的,然后你再对它做Normalize,除掉所有y的exponential值的和,然后你就得到y&#x27;</p>
<p>或者是用图示化的方法是这个样子</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320194237298-572ccad7429289169055d9678f797253.png" width="762" height="469" class="img_ev3q"></p>
<p>y₁取exp y₂取exp y₃取exp,把它全部加起来,得到一个Summation,接下来再把exp y₁&#x27;除掉Summation,exp y₂&#x27;除掉Summation,exp y₃&#x27;除掉Summation,就得到y₁&#x27; y₂&#x27; y₃&#x27;</p>
<p>有了这个式子以后,你就会发现</p>
<ul>
<li>y₁&#x27; y₂&#x27; y₃&#x27;,它们都  是介於<strong>0到1之间</strong></li>
<li>y₁&#x27; y₂&#x27; y₃&#x27;,它们的<strong>和是1</strong></li>
</ul>
<p>如果举一个例子的话,本来 y₁等於3y₂等於1,y₃等於负3,取完exponential的时候呢,就变成exp3 就是20,exp1就是2.7,exp-3就是0.05,做完Normalization以后,这边就变成0.88  0.12 跟0</p>
<p>所以这个Soft-max它要做的事情,除了Normalized,让 y₁&#x27; y₂&#x27; y₃&#x27;,<strong>变成0到1之间</strong>,还有<strong>和為1</strong>以外,它还有一个附带的效果是,==它会让大的值跟小的值的差距更大==</p>
<p>本来-3 然后通过exponential,再做Normalized以后,会变成趋近於0的值,然后这个Soft-max的输入,往往就叫它==logit==</p>
<p>这边考虑了3个class的状况,那<strong>如果两个class会是怎麼样</strong></p>
<p>如果是两个class你当然可以直接套soft-max这个function没有问题,但是也许你更常听到的是,当有两个class的时候,我们就不套soft-max,我们直接取sigmoid</p>
<p>那==当两个class用sigmoid,跟soft-max两个class,你如果推一下的话,会发现说这两件事情是等价的==</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="loss-of-classification">Loss of Classification<a href="#loss-of-classification" class="hash-link" aria-label="Direct link to Loss of Classification" title="Direct link to Loss of Classification">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320195929935-51602837238b12962fe3bbe7fd881b2a.png" width="803" height="159" class="img_ev3q"></p>
<p>我们把x,丢到一个Network裡面產生y以后,我们会通过soft-max得到y&#x27;,再去计算y&#x27;跟ŷ之间的距离,这个写作е</p>
<p><strong>计算y&#x27;跟ŷ之间的距离不只一种做法</strong>,举例来说,如果我喜欢的话,我要让这个距离是Mean Square Error</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>
<p>就是把ŷ裡面每一个element拿出来,然后计算它们的平方和,当作我们的error,这样也是计算两个向量之间的距离,你也可以说,你也可以做到说当minimize,Mean Square Error的时候,我们可以让ŷ等於y&#x27;</p>
<p>但是有另外一个更常用的做法,叫做Cross-entropy</p>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>这个Cross-entropy它的式子乍看之下,会让你觉得有点匪夷所思,怎麼是这个样子呢</p>
<ul>
<li>Cross-entropy是summation over所有的i</li>
<li>然后把ŷ的第i位拿出来,乘上y&#x27;的第i位取Natural log</li>
<li>然后再全部加起来</li>
</ul>
<p>这个是Cross-entropy,那当ŷ跟y&#x27;一模一样的时候,你也可以Minimize Cross-entropy的值,此时,MSE会是最小的,Cross-entropy也会是最小的</p>
<p>但是為什麼会有Cross-entropy,这麼奇怪的式子出现呢？</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320201703299-7f7f8b546b2e917203309fc02c9a8f06.png" width="778" height="550" class="img_ev3q"></p>
<p>那如果要讲得长一点的话,这整个故事我们可以把它讲成,<strong>Make Minimize Cross-entropy其实就是maximize likelihood</strong>,你很可能在很多地方,都听过likelihood这个词汇,详见<a href="https://www.bilibili.com/video/BV13x411v7US?p=10" target="_blank" rel="noopener noreferrer">过去上课影片</a></p>
<p>所以如果有一天有人问你说,如果我们今天在做分类问题的时候,maximize likelihood,跟Minimize Cross-entropy,有什麼关係的时候,不要回答说它们其实很像,但是其实又有很微妙的不同这样,不是这样,它们两个就是一模一样的东西,只是同一件事不同的讲法而已</p>
<p>所以假设你可以接受说,我们在训练一个classifier的时候,应该要maximize likelihood就可以接受,应该要Minimizing Cross-entropy</p>
<p>在pytorch裡面,Cross-entropy跟Soft-max,他们是被绑在一起的,他们是一个Set,你只要Copy Cross-entropy,裡面就自动内建了Soft-max</p>
<p>那接下来<strong>从optimization的角度,来说明相较於Mean Square Error,Cross-entropy是被更常用在分类上,</strong></p>
<p>那这个部分,你完全可以在数学上面做证明,但是我这边,是直接用举例的方式来跟你说明,如果你真的非常想看数学证明的话,我把连结放在这边<a href="http://speech.ee.ntu.edu.tw/~tlkagk/courses/MLDS_2015_2/Lecture/Deep%20More%20(v2).ecm.mp4/index.html%E4%BD%A0%E5%8F%AF%E4%BB%A5%E4%B8%80%E4%B8%8B%E8%BF%87%E5%8E%BB%E4%B8%8A%E8%AF%BE%E7%9A%84%E5%BD%95%E5%BD%B1" target="_blank" rel="noopener noreferrer">http://speech.ee.ntu.edu.tw/~tlkagk/courses/MLDS_2015_2/Lecture/Deep%20More%20(v2).ecm.mp4/index.html你可以一下过去上课的录影</a></p>
<p>如果你不想知道的话,那我们就是举一个例子来告诉你说,為什麼是Cross-entropy比较好</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320205142242-c76d304b20f1ee41a4a6d55ccb08b930.png" width="759" height="163" class="img_ev3q"></p>
<p>那现在我们要做一个<strong>3个Class的分类</strong></p>
<p>Network先输出y₁ y₂ y₃,在通过soft-max以后,產生y₁&#x27; y₂&#x27;跟y₃&#x27;</p>
<p>那接下来假设我们的正确答案就是100,我们要去计算100这个向量,跟y₁&#x27; y₂&#x27;跟y₃&#x27;他们之间的距离,那这个距离我们用е来表示,е可以是Mean square error, 也可以是Cross-entropy,</p>
<p>我们现在假设y₁的变化是从-10到10,y₂的变化也是从-10到10,y₃我们就固定设成-1000</p>
<p>因為y₃设很小,所以过soft-max以后y₃&#x27;就非常趋近於0,它跟正确答案非常接近,且它对我们的结果影响很少</p>
<p>总之我们<strong>y₃设一个定值</strong>,我们<strong>只看<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>跟<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>有变化的时候,对我们的e对我们的Loss对我们loss有什麼样的影响</strong></p>
<p>那我们看一下 如果我们这个e,设定為Mean Square Error,跟Cross-entropy的时候,算出来的Error surface会有什麼样,不一样的地方.底下这两个图,就分别在我们e是Mean square error,跟Cross-entropy的时候,y₁ y₂的变化对loss的影响,对Error surface的影响,</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320205913652-5545979d7e1292a31a5f45da563c6966.png" width="855" height="513" class="img_ev3q"></p>
<p>我们这边是用<strong>红色代表Loss大,蓝色代表Loss小</strong></p>
<ul>
<li>
<p>那如果今天<strong>y₁很大 y₂很小</strong>,就代表<strong>y₁&#x27;会很接近1,y₂&#x27;会很接近0</strong>,所以不管是对Mean Square Error,或是Cross-entropy而言,<strong>y₁大 y₂小的时候 Loss都是小的</strong></p>
</li>
<li>
<p>如果<strong>y₁小 y₂大</strong>的话,这边<strong>y₁&#x27;就是0 y₂&#x27;就是1</strong>,所以这个时候Loss会比较大</p>
</li>
</ul>
<p>所以这两个图都是<strong>左上角Loss大,右下角Loss小</strong>,所以我们就期待说,我们最后<strong>在Training的时候,我们的参数可以走到右下角</strong>的地方</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-20210320210341112-9854215fa259a378fdce775bc751cce8.png" width="851" height="369" class="img_ev3q"></p>
<p>那假设<strong>我们开始的地方,都是左上角</strong></p>
<ul>
<li>如果我们选择Cross-Entropy,左上角这个地方,它是有斜率的,所以你有办法透过gradient,一路往右下的地方走,</li>
<li>如果你选Mean square error的话,你就卡住了,Mean square error在这种Loss很大的地方,它是非常平坦的,它的gradient是非常小趋近於0的,如果你初始的时候在这个地方,离你的目标非常远,那它gradient又很小,你就会没有办法用gradient descent,顺利的走到右下角的地方去,</li>
</ul>
<p>所以你如果你今天自己在做classification,你选Mean square error的时候,你有非常大的可能性会train不起来,当然这个是在你没有好的optimizer的情况下,今  天如果你用Adam,这个地方gradient很小,那gradient很小之后,它learning rate之后会自动帮你调大,也许你还是有机会走到右下角,不过这会让你的training,比较困难一点,让你training的起步呢,比较慢一点</p>
<p>所以这边有一个很好的例子,是告诉我们说,就算是Loss function的定义,都可能影响Training是不是容易这件事情,刚才说要用神罗天征,直接把error surface炸平,这边就是一个好的例子告诉我们说,你可以改Loss function,居然可以改变optimization的难度,</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#to-learn-more" class="table-of-contents__link toc-highlight">To learn more</a></li><li><a href="#classification-as-regression" class="table-of-contents__link toc-highlight">Classification as Regression？</a></li><li><a href="#class-as-one-hot-vector" class="table-of-contents__link toc-highlight">Class as one-hot vector</a></li><li><a href="#classification-with-softmax" class="table-of-contents__link toc-highlight">Classification with softmax</a><ul><li><a href="#softmax" class="table-of-contents__link toc-highlight">Softmax</a></li></ul></li><li><a href="#loss-of-classification" class="table-of-contents__link toc-highlight">Loss of Classification</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>