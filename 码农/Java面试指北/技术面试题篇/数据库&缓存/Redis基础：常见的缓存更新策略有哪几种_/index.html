<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-码农/Java面试指北/技术面试题篇/数据库&缓存/Redis基础：常见的缓存更新策略有哪几种_" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Redis 基础：常见的缓存更新策略有哪几种? | Coisini</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.minddiy.top/码农/Java面试指北/技术面试题篇/数据库&amp;缓存/Redis基础：常见的缓存更新策略有哪几种_/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Redis 基础：常见的缓存更新策略有哪几种? | Coisini"><meta data-rh="true" name="description" content="下面介绍到的三种模式各有优劣，不存在最佳模式，根据具体的业务场景选择适合自己的缓存读写模式即可！"><meta data-rh="true" property="og:description" content="下面介绍到的三种模式各有优劣，不存在最佳模式，根据具体的业务场景选择适合自己的缓存读写模式即可！"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.minddiy.top/码农/Java面试指北/技术面试题篇/数据库&amp;缓存/Redis基础：常见的缓存更新策略有哪几种_/"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/Java面试指北/技术面试题篇/数据库&amp;缓存/Redis基础：常见的缓存更新策略有哪几种_/" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.minddiy.top/码农/Java面试指北/技术面试题篇/数据库&amp;缓存/Redis基础：常见的缓存更新策略有哪几种_/" hreflang="x-default"><meta name="google-site-verification" content="1FUPX6Qo4y3ecU623ShEurhgnjhSTjK49rRMhEDlzFA">
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.79037026.css">
<script src="/assets/js/runtime~main.468f2b27.js" defer="defer"></script>
<script src="/assets/js/main.4763ab3e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Coisini</b></a></div><div class="navbar__items navbar__items--right"><a href="https://minddiy.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Redis 基础：常见的缓存更新策略有哪几种?</h1></header>
<p>下面介绍到的三种模式各有优劣，不存在最佳模式，根据具体的业务场景选择适合自己的缓存读写模式即可！</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cache-aside-pattern旁路缓存模式">Cache Aside Pattern（旁路缓存模式）<a href="#cache-aside-pattern旁路缓存模式" class="hash-link" aria-label="Direct link to Cache Aside Pattern（旁路缓存模式）" title="Direct link to Cache Aside Pattern（旁路缓存模式）">​</a></h2>
<p><strong>Cache Aside Pattern 是我们平时使用比较多的一个缓存读写模式，比较适合读请求比较多的场景。</strong></p>
<p>Cache Aside Pattern 中服务端需要同时维系数据库（后文简称 db）和缓存（后文简称 cache），并且是以 db 的结果为准。</p>
<p>下面我们来看一下这个策略模式下的缓存读写步骤。</p>
<p><strong>写</strong> ：</p>
<ol>
<li>先更新 db；</li>
<li>直接删除 cache 。</li>
</ol>
<p>简单画了一张图帮助大家理解写的步骤。</p>
<p><img decoding="async" loading="lazy" alt="cache-aside-write.png" src="data:image/png;base64,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" width="417" height="249" class="img_ev3q"></p>
<p><strong>读</strong> :</p>
<ol>
<li>从 cache 中读取数据，读取到就直接返回；</li>
<li>cache 中读取不到的话，就从 db 中读取数据返回；</li>
<li>再把 db 中读取到的数据放到 cache 中。</li>
</ol>
<p>简单画了一张图帮助大家理解读的步骤。</p>
<p><img decoding="async" loading="lazy" alt="cache-aside-read.png" src="data:image/png;base64,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" width="736" height="249" class="img_ev3q"></p>
<p>你仅仅了解了上面这些内容的话是远远不够的，我们还要搞懂其中的原理。</p>
<p>比如说面试官可能会问你：“<strong>为什么删除 cache，而不是更新 cache？</strong>”</p>
<p>主要原因有两点：</p>
<ol>
<li><strong>对服务端资源造成浪费</strong> ：删除 cache 更加直接，这是因为 cache 中存放的一些数据需要服务端经过大量的计算才能得出，会消耗服务端的资源，是一笔不小的开销。如果频繁修改 db，就能会导致需要频繁更新 cache，而 cache 中的数据可能都没有被访问到。</li>
<li><strong>产生数据不一致问题</strong> ：并发场景下，更新 cache 产生数据不一致性问题的概率会更大（后文会解释原因）。</li>
</ol>
<p>面试官很可能会追问：“<strong>在写数据的过程中，可以先删除 cache ，后更新 db 么？</strong>”</p>
<p><strong>答案：</strong> 那肯定是不行的！因为这样可能会造成 <strong>数据库（db）和缓存（Cache）数据不一致</strong>的问题。</p>
<p>举例：请求 1 先写数据 A，请求 2 随后读数据 A 的话，就很有可能产生数据不一致性的问题。这个过程可以简单描述为：</p>
<ol>
<li>请求 1 先把 cache 中的 A 数据删除；</li>
<li>请求 2 从 db 中读取数据；</li>
<li>请求 1 再把 db 中的 A 数据更新。</li>
</ol>
<p>这就会导致请求 2 读取到的是旧值。</p>
<p>当你这样回答之后，面试官可能会紧接着就追问：“<strong>在写数据的过程中，先更新 db，后删除 cache 就没有问题了么？</strong>”</p>
<p><strong>答案：</strong> 理论上来说还是可能会出现数据不一致性的问题，不过概率非常小，因为缓存的写入速度是比数据库的写入速度快很多。</p>
<p>举例：请求 1 先读数据 A，请求 2 随后写数据 A，并且数据 A 在请求 1 请求之前不在缓存中的话，也有可能产生 数据不一致性的问题。这个过程可以简单描述为：</p>
<ol>
<li>请求 1 从 db 读数据 A；</li>
<li>请求 2 更新 db 中的数据 A（此时缓存中无数据 A ，故不用执行删除缓存操作 ）；</li>
<li>请求 1 将数据 A 写入 cache。</li>
</ol>
<p>这就会导致 cache 中存放的其实是旧值。</p>
<p>现在我们再来分析一下 <strong>Cache Aside Pattern 的缺陷</strong>。</p>
<p><strong>缺陷 1：首次请求数据一定不在 cache 的问题</strong></p>
<p>解决办法：可以将热点数据可以提前放入 cache 中。</p>
<p><strong>缺陷 2：写操作比较频繁的话导致 cache 中的数据会被频繁被删除，这样会影响缓存命中率 。</strong></p>
<p>解决办法：</p>
<ul>
<li>数据库和缓存数据强一致场景 ：更新 db 的时候同样更新 cache，不过我们需要加一个锁/分布式锁来保证更新 cache 的时候不存在线程安全问题。</li>
<li>可以短暂地允许数据库和缓存数据不一致的场景 ：为缓存数据设置一个合理的过期时间。过期时间越短，数据一致性越高，但缓存命中率越低。需要根据具体的业务场景和数据访问模式来权衡。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="readwrite-through-pattern读写穿透">Read/Write Through Pattern（读写穿透）<a href="#readwrite-through-pattern读写穿透" class="hash-link" aria-label="Direct link to Read/Write Through Pattern（读写穿透）" title="Direct link to Read/Write Through Pattern（读写穿透）">​</a></h2>
<p>Read/Write Through Pattern 中服务端把 cache 视为主要数据存储，从中读取数据并将数据写入其中。cache 服务负责将此数据读取和写入 db，从而减轻了应用程序的职责。</p>
<p>这种缓存读写策略小伙伴们应该也发现了在平时在开发过程中非常少见。抛去性能方面的影响，大概率是因为我们经常使用的分布式缓存 Redis 并没有提供 cache 将数据写入 db 的功能  。</p>
<p><strong>写（Write Through）：</strong></p>
<ul>
<li>先查 cache，cache 中不存在，直接更新 db。</li>
<li>cache 中存在，则先更新 cache，然后 cache 服务自己更新 db（<strong>同步更新 cache 和 db</strong>）。</li>
</ul>
<p>简单画了一张图帮助大家理解写的步骤。</p>
<p><img decoding="async" loading="lazy" alt="write-through.png" src="data:image/png;base64,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" width="637" height="201" class="img_ev3q"></p>
<p><strong>读(Read Through)：</strong></p>
<ul>
<li>从 cache 中读取数据，读取到就直接返回 。</li>
<li>读取不到的话，先从 db 加载，写入到 cache 后返回响应。</li>
</ul>
<p>简单画了一张图帮助大家理解读的步骤。</p>
<p><img decoding="async" loading="lazy" alt="read-through.png" src="data:image/png;base64,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" width="637" height="129" class="img_ev3q"></p>
<p>Read-Through Pattern 实际只是在 Cache-Aside Pattern 之上进行了封装。在 Cache-Aside Pattern 下，发生读请求的时候，如果 cache 中不存在对应的数据，是由客户端自己负责把数据写入 cache，而 Read Through Pattern 则是 cache 服务自己来写入缓存的，这对客户端是透明的。</p>
<p>和 Cache Aside Pattern 一样， Read-Through Pattern 也有首次请求数据一定不再 cache 的问题，对于热点数据可以提前放入缓存中。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="write-behind-pattern异步缓存写入">Write Behind Pattern（异步缓存写入）<a href="#write-behind-pattern异步缓存写入" class="hash-link" aria-label="Direct link to Write Behind Pattern（异步缓存写入）" title="Direct link to Write Behind Pattern（异步缓存写入）">​</a></h2>
<p>Write Behind Pattern 和 Read/Write Through Pattern 很相似，两者都是由 cache 服务来负责 cache 和 db 的读写。</p>
<p>但是，两个又有很大的不同：<strong>Read/Write Through 是同步更新 cache 和 db，而 Write Behind 则是只更新缓存，不直接更新 db，而是改为异步批量的方式来更新 db。</strong></p>
<p>很明显，这种方式对数据一致性带来了更大的挑战，比如 cache 数据可能还没异步更新 db 的话，cache 服务可能就就挂掉了。</p>
<p>这种策略在我们平时开发过程中也非常非常少见，但是不代表它的应用场景少，比如消息队列中消息的异步写入磁盘、MySQL 的 Innodb Buffer Pool 机制都用到了这种策略。</p>
<p>Write Behind Pattern 下 db 的写性能非常高，非常适合一些数据经常变化又对数据一致性要求没那么高的场景，比如浏览量、点赞量。</p>
<blockquote>
<p>更新: 2024-11-05 20:11:32<br>
原文: <a href="https://www.yuque.com/snailclimb/mf2z3k/sy238z" target="_blank" rel="noopener noreferrer">https://www.yuque.com/snailclimb/mf2z3k/sy238z</a></p>
</blockquote></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cache-aside-pattern旁路缓存模式" class="table-of-contents__link toc-highlight">Cache Aside Pattern（旁路缓存模式）</a></li><li><a href="#readwrite-through-pattern读写穿透" class="table-of-contents__link toc-highlight">Read/Write Through Pattern（读写穿透）</a></li><li><a href="#write-behind-pattern异步缓存写入" class="table-of-contents__link toc-highlight">Write Behind Pattern（异步缓存写入）</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>