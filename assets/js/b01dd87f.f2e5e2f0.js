"use strict";(self.webpackChunkmybase=self.webpackChunkmybase||[]).push([[6045],{95e3:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"\u7801\u519c/JavaNote/SSM","title":"MyBatis","description":"\u57fa\u672c\u4ecb\u7ecd","source":"@site/docs/\u7801\u519c/JavaNote/SSM.md","sourceDirName":"\u7801\u519c/JavaNote","slug":"/\u7801\u519c/JavaNote/SSM","permalink":"/\u7801\u519c/JavaNote/SSM","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var i=s(74848),l=s(28453);const c={},a="MyBatis",t={},d=[{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd",level:2},{value:"\u57fa\u672c\u64cd\u4f5c",id:"\u57fa\u672c\u64cd\u4f5c",level:2},{value:"\u76f8\u5173API",id:"\u76f8\u5173api",level:3},{value:"\u6620\u5c04\u914d\u7f6e",id:"\u6620\u5c04\u914d\u7f6e",level:3},{value:"\u6838\u5fc3\u914d\u7f6e",id:"\u6838\u5fc3\u914d\u7f6e",level:3},{value:"#{}\u548c${}",id:"\u548c",level:3},{value:"\u65e5\u5fd7\u6587\u4ef6",id:"\u65e5\u5fd7\u6587\u4ef6",level:3},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0",level:3},{value:"\u6279\u91cf\u64cd\u4f5c",id:"\u6279\u91cf\u64cd\u4f5c",level:3},{value:"\u4ee3\u7406\u5f00\u53d1",id:"\u4ee3\u7406\u5f00\u53d1",level:2},{value:"\u4ee3\u7406\u89c4\u5219",id:"\u4ee3\u7406\u89c4\u5219",level:3},{value:"\u5b9e\u73b0\u539f\u7406",id:"\u5b9e\u73b0\u539f\u7406",level:3},{value:"\u7ed3\u679c\u6620\u5c04",id:"\u7ed3\u679c\u6620\u5c04",level:2},{value:"\u76f8\u5173\u6807\u7b7e",id:"\u76f8\u5173\u6807\u7b7e",level:3},{value:"\u5d4c\u5957\u67e5\u8be2",id:"\u5d4c\u5957\u67e5\u8be2",level:3},{value:"\u591a\u8868\u67e5\u8be2",id:"\u591a\u8868\u67e5\u8be2",level:3},{value:"\u4e00\u5bf9\u4e00",id:"\u4e00\u5bf9\u4e00",level:4},{value:"\u4e00\u5bf9\u591a",id:"\u4e00\u5bf9\u591a",level:4},{value:"\u591a\u5bf9\u591a",id:"\u591a\u5bf9\u591a",level:4},{value:"\u9274\u522b\u5668",id:"\u9274\u522b\u5668",level:3},{value:"\u5ef6\u8fdf\u52a0\u8f7d",id:"\u5ef6\u8fdf\u52a0\u8f7d",level:3},{value:"\u4e24\u79cd\u52a0\u8f7d",id:"\u4e24\u79cd\u52a0\u8f7d",level:4},{value:"assocation",id:"assocation",level:4},{value:"collection",id:"collection",level:4},{value:"\u6ce8\u89e3\u5f00\u53d1",id:"\u6ce8\u89e3\u5f00\u53d1",level:2},{value:"\u5355\u8868\u64cd\u4f5c",id:"\u5355\u8868\u64cd\u4f5c",level:3},{value:"\u591a\u8868\u64cd\u4f5c",id:"\u591a\u8868\u64cd\u4f5c",level:3},{value:"\u76f8\u5173\u6ce8\u89e3",id:"\u76f8\u5173\u6ce8\u89e3",level:4},{value:"\u4e00\u5bf9\u4e00",id:"\u4e00\u5bf9\u4e00-1",level:4},{value:"\u4e00\u5bf9\u591a",id:"\u4e00\u5bf9\u591a-1",level:4},{value:"\u591a\u5bf9\u591a",id:"\u591a\u5bf9\u591a-1",level:4},{value:"\u7f13\u5b58\u673a\u5236",id:"\u7f13\u5b58\u673a\u5236",level:2},{value:"\u7f13\u5b58\u6982\u8ff0",id:"\u7f13\u5b58\u6982\u8ff0",level:3},{value:"\u4e00\u7ea7\u7f13\u5b58",id:"\u4e00\u7ea7\u7f13\u5b58",level:3},{value:"\u4e8c\u7ea7\u7f13\u5b58",id:"\u4e8c\u7ea7\u7f13\u5b58",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-1",level:4},{value:"\u76f8\u5173\u5c5e\u6027",id:"\u76f8\u5173\u5c5e\u6027",level:4},{value:"\u6e90\u7801\u89e3\u6790",id:"\u6e90\u7801\u89e3\u6790",level:4},{value:"\u81ea\u5b9a\u4e49",id:"\u81ea\u5b9a\u4e49",level:3},{value:"\u6784\u9020\u8bed\u53e5",id:"\u6784\u9020\u8bed\u53e5",level:2},{value:"\u52a8\u6001 SQL",id:"\u52a8\u6001-sql",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-2",level:4},{value:"where",id:"where",level:4},{value:"if",id:"if",level:4},{value:"set",id:"set",level:4},{value:"choose",id:"choose",level:4},{value:"trim",id:"trim",level:4},{value:"foreach",id:"foreach",level:4},{value:"SQL\u7247\u6bb5",id:"sql\u7247\u6bb5",level:4},{value:"\u9006\u5411\u5de5\u7a0b",id:"\u9006\u5411\u5de5\u7a0b",level:3},{value:"\u6784\u5efa SQL",id:"\u6784\u5efa-sql",level:3},{value:"\u57fa\u7840\u8bed\u6cd5",id:"\u57fa\u7840\u8bed\u6cd5",level:4},{value:"\u57fa\u672c\u64cd\u4f5c",id:"\u57fa\u672c\u64cd\u4f5c-1",level:4},{value:"\u8fd0\u884c\u539f\u7406",id:"\u8fd0\u884c\u539f\u7406",level:2},{value:"\u8fd0\u884c\u673a\u5236",id:"\u8fd0\u884c\u673a\u5236",level:3},{value:"\u83b7\u53d6\u5de5\u5382",id:"\u83b7\u53d6\u5de5\u5382",level:3},{value:"\u83b7\u53d6\u4f1a\u8bdd",id:"\u83b7\u53d6\u4f1a\u8bdd",level:3},{value:"\u83b7\u53d6\u4ee3\u7406",id:"\u83b7\u53d6\u4ee3\u7406",level:3},{value:"\u6267\u884cSQL",id:"\u6267\u884csql",level:3},{value:"\u63d2\u4ef6\u4f7f\u7528",id:"\u63d2\u4ef6\u4f7f\u7528",level:2},{value:"\u63d2\u4ef6\u539f\u7406",id:"\u63d2\u4ef6\u539f\u7406",level:3},{value:"\u5206\u9875\u63d2\u4ef6",id:"\u5206\u9875\u63d2\u4ef6",level:3},{value:"\u5206\u9875\u64cd\u4f5c",id:"\u5206\u9875\u64cd\u4f5c",level:3},{value:"\u53c2\u6570\u83b7\u53d6",id:"\u53c2\u6570\u83b7\u53d6",level:3},{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"IoC",id:"ioc",level:2},{value:"\u57fa\u672c\u6982\u8ff0",id:"\u57fa\u672c\u6982\u8ff0",level:3},{value:"\u5165\u95e8\u9879\u76ee",id:"\u5165\u95e8\u9879\u76ee",level:3},{value:"XML\u5f00\u53d1",id:"xml\u5f00\u53d1",level:3},{value:"bean",id:"bean",level:4},{value:"\u57fa\u672c\u5c5e\u6027",id:"\u57fa\u672c\u5c5e\u6027",level:5},{value:"\u4f5c\u7528\u8303\u56f4",id:"\u4f5c\u7528\u8303\u56f4",level:5},{value:"\u751f\u547d\u5468\u671f",id:"\u751f\u547d\u5468\u671f",level:5},{value:"\u521b\u5efa\u65b9\u5f0f",id:"\u521b\u5efa\u65b9\u5f0f",level:5},{value:"\u83b7\u53d6Bean",id:"\u83b7\u53d6bean",level:5},{value:"DI",id:"di",level:4},{value:"\u4f9d\u8d56\u6ce8\u5165",id:"\u4f9d\u8d56\u6ce8\u5165",level:5},{value:"set \u6ce8\u5165",id:"set-\u6ce8\u5165",level:5},{value:"\u6784\u9020\u6ce8\u5165",id:"\u6784\u9020\u6ce8\u5165",level:5},{value:"\u96c6\u5408\u6ce8\u5165",id:"\u96c6\u5408\u6ce8\u5165",level:5},{value:"P",id:"p",level:4},{value:"SpEL",id:"spel",level:4},{value:"prop",id:"prop",level:4},{value:"import",id:"import",level:4},{value:"\u4e09\u65b9\u8d44\u6e90",id:"\u4e09\u65b9\u8d44\u6e90",level:4},{value:"Druid",id:"druid",level:5},{value:"Mybatis",id:"mybatis-1",level:5},{value:"\u6ce8\u89e3\u5f00\u53d1",id:"\u6ce8\u89e3\u5f00\u53d1-1",level:3},{value:"\u6ce8\u89e3\u9a71\u52a8",id:"\u6ce8\u89e3\u9a71\u52a8",level:4},{value:"XML",id:"xml",level:5},{value:"\u7eaf\u6ce8\u89e3",id:"\u7eaf\u6ce8\u89e3",level:5},{value:"\u626b\u63cf\u5668",id:"\u626b\u63cf\u5668",level:5},{value:"\u57fa\u672c\u6ce8\u89e3",id:"\u57fa\u672c\u6ce8\u89e3",level:4},{value:"\u8bbe\u7f6e bean",id:"\u8bbe\u7f6e-bean",level:5},{value:"\u4f5c\u7528\u8303\u56f4",id:"\u4f5c\u7528\u8303\u56f4-1",level:5},{value:"\u751f\u547d\u5468\u671f",id:"\u751f\u547d\u5468\u671f-1",level:5},{value:"\u52a0\u8f7d\u8d44\u6e90",id:"\u52a0\u8f7d\u8d44\u6e90",level:5},{value:"\u5c5e\u6027\u6ce8\u5165",id:"\u5c5e\u6027\u6ce8\u5165",level:4},{value:"\u57fa\u672c\u7c7b\u578b",id:"\u57fa\u672c\u7c7b\u578b",level:5},{value:"\u81ea\u52a8\u88c5\u914d",id:"\u81ea\u52a8\u88c5\u914d",level:5},{value:"\u5c5e\u6027\u6ce8\u5165",id:"\u5c5e\u6027\u6ce8\u5165-1",level:6},{value:"\u4f18\u5148\u6ce8\u5165",id:"\u4f18\u5148\u6ce8\u5165",level:6},{value:"\u6ce8\u89e3\u5bf9\u6bd4",id:"\u6ce8\u89e3\u5bf9\u6bd4",level:6},{value:"\u9759\u6001\u6ce8\u5165",id:"\u9759\u6001\u6ce8\u5165",level:5},{value:"\u6587\u4ef6\u8bfb\u53d6",id:"\u6587\u4ef6\u8bfb\u53d6",level:4},{value:"\u52a0\u8f7d\u63a7\u5236",id:"\u52a0\u8f7d\u63a7\u5236",level:4},{value:"\u4f9d\u8d56\u52a0\u8f7d",id:"\u4f9d\u8d56\u52a0\u8f7d",level:5},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:5},{value:"\u6574\u5408\u8d44\u6e90",id:"\u6574\u5408\u8d44\u6e90",level:4},{value:"\u5bfc\u5165",id:"\u5bfc\u5165",level:5},{value:"Druid",id:"druid-1",level:5},{value:"Junit",id:"junit",level:5},{value:"IoC\u539f\u7406",id:"ioc\u539f\u7406",level:3},{value:"\u6838\u5fc3\u7c7b",id:"\u6838\u5fc3\u7c7b",level:4},{value:"BeanFactory",id:"beanfactory",level:5},{value:"FactoryBean",id:"factorybean",level:5},{value:"\u8fc7\u6ee4\u5668",id:"\u8fc7\u6ee4\u5668",level:4},{value:"\u6570\u636e\u51c6\u5907",id:"\u6570\u636e\u51c6\u5907",level:5},{value:"\u8fc7\u6ee4\u5668",id:"\u8fc7\u6ee4\u5668-1",level:5},{value:"\u5bfc\u5165\u5668",id:"\u5bfc\u5165\u5668",level:4},{value:"\u6ce8\u518c\u5668",id:"\u6ce8\u518c\u5668",level:4},{value:"\u5904\u7406\u5668",id:"\u5904\u7406\u5668",level:4},{value:"\u76d1\u542c\u5668",id:"\u76d1\u542c\u5668",level:4},{value:"\u57fa\u672c\u6982\u8ff0",id:"\u57fa\u672c\u6982\u8ff0-1",level:5},{value:"\u5b9e\u73b0\u539f\u7406",id:"\u5b9e\u73b0\u539f\u7406-1",level:5},{value:"\u6ce8\u89e3\u5b9e\u73b0",id:"\u6ce8\u89e3\u5b9e\u73b0",level:5},{value:"AOP",id:"aop",level:2},{value:"\u57fa\u672c\u6982\u8ff0",id:"\u57fa\u672c\u6982\u8ff0-2",level:3},{value:"\u6838\u5fc3\u6982\u5ff5",id:"\u6838\u5fc3\u6982\u5ff5",level:3},{value:"\u6982\u5ff5\u8be6\u89e3",id:"\u6982\u5ff5\u8be6\u89e3",level:4},{value:"\u5165\u95e8\u9879\u76ee",id:"\u5165\u95e8\u9879\u76ee-1",level:4},{value:"XML\u5f00\u53d1",id:"xml\u5f00\u53d1-1",level:3},{value:"AspectJ",id:"aspectj",level:4},{value:"AOP",id:"aop-1",level:4},{value:"config",id:"config",level:5},{value:"pointcut",id:"pointcut",level:5},{value:"aspect",id:"aspect",level:5},{value:"Pointcut",id:"pointcut-1",level:4},{value:"\u5207\u5165\u70b9",id:"\u5207\u5165\u70b9",level:5},{value:"\u8868\u8fbe\u5f0f",id:"\u8868\u8fbe\u5f0f",level:5},{value:"\u914d\u7f6e\u65b9\u5f0f",id:"\u914d\u7f6e\u65b9\u5f0f",level:5},{value:"Advice",id:"advice",level:4},{value:"\u901a\u77e5\u7c7b\u578b",id:"\u901a\u77e5\u7c7b\u578b",level:5},{value:"before",id:"before",level:6},{value:"after",id:"after",level:6},{value:"after-r",id:"after-r",level:6},{value:"after-t",id:"after-t",level:6},{value:"around",id:"around",level:6},{value:"\u901a\u77e5\u987a\u5e8f",id:"\u901a\u77e5\u987a\u5e8f",level:5},{value:"\u83b7\u53d6\u6570\u636e",id:"\u83b7\u53d6\u6570\u636e",level:5},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:6},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:6},{value:"\u5f02\u5e38",id:"\u5f02\u5e38",level:6},{value:"\u83b7\u53d6\u5168\u90e8",id:"\u83b7\u53d6\u5168\u90e8",level:6},{value:"\u6ce8\u89e3\u5f00\u53d1",id:"\u6ce8\u89e3\u5f00\u53d1-2",level:3},{value:"AOP\u6ce8\u89e3",id:"aop\u6ce8\u89e3",level:4},{value:"\u542f\u52a8\u6ce8\u89e3",id:"\u542f\u52a8\u6ce8\u89e3",level:4},{value:"XML",id:"xml-1",level:5},{value:"\u7eaf\u6ce8\u89e3",id:"\u7eaf\u6ce8\u89e3-1",level:5},{value:"\u57fa\u672c\u6ce8\u89e3",id:"\u57fa\u672c\u6ce8\u89e3-1",level:4},{value:"Aspect",id:"aspect-1",level:5},{value:"Pointcut",id:"pointcut-2",level:5},{value:"Before",id:"before-1",level:5},{value:"After",id:"after-1",level:5},{value:"AfterR",id:"afterr",level:5},{value:"AfterT",id:"aftert",level:5},{value:"Around",id:"around-1",level:5},{value:"\u6267\u884c\u987a\u5e8f",id:"\u6267\u884c\u987a\u5e8f",level:4},{value:"AOP \u539f\u7406",id:"aop-\u539f\u7406",level:3},{value:"\u9759\u6001\u4ee3\u7406",id:"\u9759\u6001\u4ee3\u7406",level:4},{value:"Proxy",id:"proxy",level:4},{value:"CGLIB",id:"cglib",level:4},{value:"\u4ee3\u7406\u9009\u62e9",id:"\u4ee3\u7406\u9009\u62e9",level:4},{value:"\u7ec7\u5165\u65f6\u673a",id:"\u7ec7\u5165\u65f6\u673a",level:4},{value:"\u4e8b\u52a1",id:"\u4e8b\u52a1",level:2},{value:"\u4e8b\u52a1\u673a\u5236",id:"\u4e8b\u52a1\u673a\u5236",level:3},{value:"\u4e8b\u52a1\u4ecb\u7ecd",id:"\u4e8b\u52a1\u4ecb\u7ecd",level:4},{value:"\u9694\u79bb\u7ea7\u522b",id:"\u9694\u79bb\u7ea7\u522b",level:4},{value:"\u4f20\u64ad\u884c\u4e3a",id:"\u4f20\u64ad\u884c\u4e3a",level:4},{value:"\u8d85\u65f6\u5c5e\u6027",id:"\u8d85\u65f6\u5c5e\u6027",level:4},{value:"\u53ea\u8bfb\u5c5e\u6027",id:"\u53ea\u8bfb\u5c5e\u6027",level:4},{value:"\u6838\u5fc3\u5bf9\u8c61",id:"\u6838\u5fc3\u5bf9\u8c61",level:3},{value:"\u4e8b\u52a1\u5bf9\u8c61",id:"\u4e8b\u52a1\u5bf9\u8c61",level:4},{value:"PTM",id:"ptm",level:4},{value:"Definition",id:"definition",level:4},{value:"Status",id:"status",level:4},{value:"\u7f16\u7a0b\u5f0f",id:"\u7f16\u7a0b\u5f0f",level:3},{value:"\u63a7\u5236\u65b9\u5f0f",id:"\u63a7\u5236\u65b9\u5f0f",level:4},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:4},{value:"\u7f16\u7a0b\u5f0f",id:"\u7f16\u7a0b\u5f0f-1",level:4},{value:"AOP\u6539\u9020",id:"aop\u6539\u9020",level:4},{value:"\u58f0\u660e\u5f0f",id:"\u58f0\u660e\u5f0f",level:3},{value:"XML",id:"xml-2",level:4},{value:"tx\u4f7f\u7528",id:"tx\u4f7f\u7528",level:5},{value:"tx\u914d\u7f6e",id:"tx\u914d\u7f6e",level:5},{value:"advice",id:"advice-1",level:6},{value:"attributes",id:"attributes",level:6},{value:"method",id:"method",level:6},{value:"\u6ce8\u89e3",id:"\u6ce8\u89e3",level:4},{value:"\u5f00\u542f\u6ce8\u89e3",id:"\u5f00\u542f\u6ce8\u89e3",level:5},{value:"XML",id:"xml-3",level:6},{value:"\u7eaf\u6ce8\u89e3",id:"\u7eaf\u6ce8\u89e3-2",level:6},{value:"\u914d\u7f6e\u6ce8\u89e3",id:"\u914d\u7f6e\u6ce8\u89e3",level:5},{value:"\u4f7f\u7528\u6ce8\u89e3",id:"\u4f7f\u7528\u6ce8\u89e3",level:5},{value:"\u6a21\u677f\u5bf9\u8c61",id:"\u6a21\u677f\u5bf9\u8c61",level:3},{value:"\u539f\u7406",id:"\u539f\u7406",level:2},{value:"XML",id:"xml-4",level:3},{value:"IOC",id:"ioc-1",level:3},{value:"\u5bb9\u5668\u542f\u52a8",id:"\u5bb9\u5668\u542f\u52a8",level:4},{value:"\u83b7\u53d6Bean",id:"\u83b7\u53d6bean-1",level:4},{value:"\u751f\u547d\u5468\u671f",id:"\u751f\u547d\u5468\u671f-2",level:4},{value:"\u56db\u4e2a\u9636\u6bb5",id:"\u56db\u4e2a\u9636\u6bb5",level:5},{value:"\u521b\u5efa\u5b9e\u4f8b",id:"\u521b\u5efa\u5b9e\u4f8b",level:5},{value:"\u5faa\u73af\u4f9d\u8d56",id:"\u5faa\u73af\u4f9d\u8d56",level:4},{value:"\u5faa\u73af\u5f15\u7528",id:"\u5faa\u73af\u5f15\u7528",level:5},{value:"\u6e90\u7801\u89e3\u6790",id:"\u6e90\u7801\u89e3\u6790-1",level:5},{value:"AOP",id:"aop-2",level:3},{value:"\u6ce8\u89e3\u539f\u7406",id:"\u6ce8\u89e3\u539f\u7406",level:4},{value:"\u540e\u7f6e\u5904\u7406",id:"\u540e\u7f6e\u5904\u7406",level:4},{value:"\u83b7\u53d6\u901a\u77e5",id:"\u83b7\u53d6\u901a\u77e5",level:4},{value:"\u521b\u5efa\u4ee3\u7406",id:"\u521b\u5efa\u4ee3\u7406",level:4},{value:"\u65b9\u6cd5\u589e\u5f3a",id:"\u65b9\u6cd5\u589e\u5f3a",level:4},{value:"\u4e8b\u52a1",id:"\u4e8b\u52a1-1",level:3},{value:"\u89e3\u6790\u65b9\u6cd5",id:"\u89e3\u6790\u65b9\u6cd5",level:4},{value:"\u6807\u7b7e\u89e3\u6790",id:"\u6807\u7b7e\u89e3\u6790",level:5},{value:"\u6ce8\u89e3\u89e3\u6790",id:"\u6ce8\u89e3\u89e3\u6790",level:5},{value:"\u9a71\u52a8\u65b9\u6cd5",id:"\u9a71\u52a8\u65b9\u6cd5",level:4},{value:"\u5f00\u542f\u4e8b\u52a1",id:"\u5f00\u542f\u4e8b\u52a1",level:4},{value:"\u4e8b\u52a1\u7ed1\u5b9a",id:"\u4e8b\u52a1\u7ed1\u5b9a",level:5},{value:"\u4e8b\u52a1\u521b\u5efa",id:"\u4e8b\u52a1\u521b\u5efa",level:5},{value:"\u4e8b\u52a1\u91cd\u5165",id:"\u4e8b\u52a1\u91cd\u5165",level:5},{value:"\u6302\u8d77\u6062\u590d",id:"\u6302\u8d77\u6062\u590d",level:5},{value:"\u63d0\u4ea4\u56de\u6eda",id:"\u63d0\u4ea4\u56de\u6eda",level:4},{value:"\u56de\u6eda\u65b9\u5f0f",id:"\u56de\u6eda\u65b9\u5f0f",level:5},{value:"\u63d0\u4ea4\u65b9\u5f0f",id:"\u63d0\u4ea4\u65b9\u5f0f",level:5},{value:"\u6e05\u7406\u73b0\u573a",id:"\u6e05\u7406\u73b0\u573a",level:5},{value:"\u6ce8\u89e3",id:"\u6ce8\u89e3-1",level:3},{value:"Component",id:"component",level:4},{value:"Autowired",id:"autowired",level:4},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-3",level:2},{value:"\u57fa\u672c\u914d\u7f6e",id:"\u57fa\u672c\u914d\u7f6e",level:2},{value:"\u5165\u95e8\u9879\u76ee",id:"\u5165\u95e8\u9879\u76ee-2",level:3},{value:"\u52a0\u8f7d\u63a7\u5236",id:"\u52a0\u8f7d\u63a7\u5236-1",level:3},{value:"\u6ce8\u89e3\u9a71\u52a8",id:"\u6ce8\u89e3\u9a71\u52a8-1",level:3},{value:"\u8bf7\u6c42\u6620\u5c04",id:"\u8bf7\u6c42\u6620\u5c04",level:3},{value:"\u57fa\u672c\u64cd\u4f5c",id:"\u57fa\u672c\u64cd\u4f5c-2",level:2},{value:"\u8bf7\u6c42\u5904\u7406",id:"\u8bf7\u6c42\u5904\u7406",level:3},{value:"\u666e\u901a\u7c7b\u578b",id:"\u666e\u901a\u7c7b\u578b",level:4},{value:"POJO\u7c7b\u578b",id:"pojo\u7c7b\u578b",level:4},{value:"\u7b80\u5355\u7c7b\u578b",id:"\u7b80\u5355\u7c7b\u578b",level:5},{value:"\u53c2\u6570\u51b2\u7a81",id:"\u53c2\u6570\u51b2\u7a81",level:5},{value:"\u590d\u6742\u7c7b\u578b",id:"\u590d\u6742\u7c7b\u578b",level:5},{value:"\u5bb9\u5668\u7c7b\u578b",id:"\u5bb9\u5668\u7c7b\u578b",level:5},{value:"\u6570\u7ec4\u96c6\u5408",id:"\u6570\u7ec4\u96c6\u5408",level:4},{value:"\u6570\u7ec4\u7c7b\u578b",id:"\u6570\u7ec4\u7c7b\u578b",level:5},{value:"\u96c6\u5408\u7c7b\u578b",id:"\u96c6\u5408\u7c7b\u578b",level:5},{value:"\u8f6c\u6362\u5668",id:"\u8f6c\u6362\u5668",level:4},{value:"\u7c7b\u578b",id:"\u7c7b\u578b",level:5},{value:"\u65e5\u671f",id:"\u65e5\u671f",level:5},{value:"\u81ea\u5b9a\u4e49",id:"\u81ea\u5b9a\u4e49-1",level:5},{value:"\u54cd\u5e94\u5904\u7406",id:"\u54cd\u5e94\u5904\u7406",level:3},{value:"\u9875\u9762\u8df3\u8f6c",id:"\u9875\u9762\u8df3\u8f6c",level:4},{value:"\u6570\u636e\u8df3\u8f6c",id:"\u6570\u636e\u8df3\u8f6c",level:4},{value:"JSON",id:"json",level:4},{value:"Restful",id:"restful",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-4",level:4},{value:"\u8bbf\u95ee\u65b9\u5f0f",id:"\u8bbf\u95ee\u65b9\u5f0f",level:4},{value:"\u53c2\u6570\u6ce8\u89e3",id:"\u53c2\u6570\u6ce8\u89e3",level:4},{value:"\u8bc6\u522b\u539f\u7406",id:"\u8bc6\u522b\u539f\u7406",level:4},{value:"Servlet",id:"servlet",level:3},{value:"\u8fd0\u884c\u539f\u7406",id:"\u8fd0\u884c\u539f\u7406-1",level:2},{value:"\u6280\u672f\u67b6\u6784",id:"\u6280\u672f\u67b6\u6784",level:3},{value:"\u7ec4\u4ef6\u4ecb\u7ecd",id:"\u7ec4\u4ef6\u4ecb\u7ecd",level:4},{value:"\u5de5\u4f5c\u539f\u7406",id:"\u5de5\u4f5c\u539f\u7406",level:4},{value:"\u8c03\u5ea6\u51fd\u6570",id:"\u8c03\u5ea6\u51fd\u6570",level:3},{value:"\u8bf7\u6c42\u6620\u5c04",id:"\u8bf7\u6c42\u6620\u5c04-1",level:3},{value:"\u6620\u5c04\u5668",id:"\u6620\u5c04\u5668",level:4},{value:"\u9002\u914d\u5668",id:"\u9002\u914d\u5668",level:4},{value:"\u65b9\u6cd5\u6267\u884c",id:"\u65b9\u6cd5\u6267\u884c",level:4},{value:"\u53c2\u6570\u89e3\u6790",id:"\u53c2\u6570\u89e3\u6790",level:4},{value:"\u54cd\u5e94\u5904\u7406",id:"\u54cd\u5e94\u5904\u7406-1",level:3},{value:"\u54cd\u5e94\u6570\u636e",id:"\u54cd\u5e94\u6570\u636e",level:4},{value:"\u534f\u5546\u7b56\u7565",id:"\u534f\u5546\u7b56\u7565",level:4},{value:"\u89c6\u56fe\u89e3\u6790",id:"\u89c6\u56fe\u89e3\u6790",level:3},{value:"\u8fd4\u56de\u89e3\u6790",id:"\u8fd4\u56de\u89e3\u6790",level:4},{value:"\u7ed3\u679c\u6d3e\u53d1",id:"\u7ed3\u679c\u6d3e\u53d1",level:4},{value:"\u5f02\u6b65\u8c03\u7528",id:"\u5f02\u6b65\u8c03\u7528",level:2},{value:"\u8bf7\u6c42\u53c2\u6570",id:"\u8bf7\u6c42\u53c2\u6570",level:3},{value:"\u54cd\u5e94\u6570\u636e",id:"\u54cd\u5e94\u6570\u636e-1",level:3},{value:"\u8de8\u57df\u8bbf\u95ee",id:"\u8de8\u57df\u8bbf\u95ee",level:3},{value:"\u62e6\u622a\u5668",id:"\u62e6\u622a\u5668",level:2},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-5",level:3},{value:"\u5904\u7406\u65b9\u6cd5",id:"\u5904\u7406\u65b9\u6cd5",level:3},{value:"\u524d\u7f6e\u5904\u7406",id:"\u524d\u7f6e\u5904\u7406",level:4},{value:"\u540e\u7f6e\u5904\u7406",id:"\u540e\u7f6e\u5904\u7406-1",level:4},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406",level:4},{value:"\u62e6\u622a\u914d\u7f6e",id:"\u62e6\u622a\u914d\u7f6e",level:3},{value:"\u62e6\u622a\u5668\u94fe",id:"\u62e6\u622a\u5668\u94fe",level:3},{value:"\u6e90\u7801\u89e3\u6790",id:"\u6e90\u7801\u89e3\u6790-2",level:3},{value:"\u81ea\u5b9a\u4e49",id:"\u81ea\u5b9a\u4e49-2",level:3},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406-1",level:2},{value:"\u5904\u7406\u5668",id:"\u5904\u7406\u5668-1",level:3},{value:"\u6ce8\u89e3\u5f00\u53d1",id:"\u6ce8\u89e3\u5f00\u53d1-3",level:3},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:3},{value:"\u6587\u4ef6\u4f20\u8f93",id:"\u6587\u4ef6\u4f20\u8f93",level:2},{value:"\u4e0a\u4f20\u4e0b\u8f7d",id:"\u4e0a\u4f20\u4e0b\u8f7d",level:3},{value:"\u540d\u79f0\u95ee\u9898",id:"\u540d\u79f0\u95ee\u9898",level:3},{value:"\u6e90\u7801\u89e3\u6790",id:"\u6e90\u7801\u89e3\u6790-3",level:3},{value:"\u5b9e\u7528\u6280\u672f",id:"\u5b9e\u7528\u6280\u672f",level:2},{value:"\u6821\u9a8c\u6846\u67b6",id:"\u6821\u9a8c\u6846\u67b6",level:3},{value:"\u6821\u9a8c\u6982\u8ff0",id:"\u6821\u9a8c\u6982\u8ff0",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:4},{value:"\u5f00\u542f\u6821\u9a8c",id:"\u5f00\u542f\u6821\u9a8c",level:5},{value:"\u6821\u9a8c\u89c4\u5219",id:"\u6821\u9a8c\u89c4\u5219",level:5},{value:"\u9519\u8bef\u4fe1\u606f",id:"\u9519\u8bef\u4fe1\u606f",level:5},{value:"\u591a\u89c4\u5219\u6821\u9a8c",id:"\u591a\u89c4\u5219\u6821\u9a8c",level:4},{value:"\u5d4c\u5957\u6821\u9a8c",id:"\u5d4c\u5957\u6821\u9a8c",level:4},{value:"\u5206\u7ec4\u6821\u9a8c",id:"\u5206\u7ec4\u6821\u9a8c",level:4},{value:"Lombok",id:"lombok",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-6",level:2},{value:"Boot\u4ecb\u7ecd",id:"boot\u4ecb\u7ecd",level:3},{value:"\u6784\u5efa\u5de5\u7a0b",id:"\u6784\u5efa\u5de5\u7a0b",level:3},{value:"\u81ea\u52a8\u88c5\u914d",id:"\u81ea\u52a8\u88c5\u914d-1",level:2},{value:"\u4f9d\u8d56\u7ba1\u7406",id:"\u4f9d\u8d56\u7ba1\u7406",level:3},{value:"\u5e95\u5c42\u6ce8\u89e3",id:"\u5e95\u5c42\u6ce8\u89e3",level:3},{value:"SpringBoot",id:"springboot",level:4},{value:"Configuration",id:"configuration",level:4},{value:"Condition",id:"condition",level:4},{value:"\u6761\u4ef6\u6ce8\u89e3",id:"\u6761\u4ef6\u6ce8\u89e3",level:5},{value:"\u81ea\u5b9a\u4e49\u6ce8\u89e3",id:"\u81ea\u5b9a\u4e49\u6ce8\u89e3",level:5},{value:"\u5e38\u7528\u6ce8\u89e3",id:"\u5e38\u7528\u6ce8\u89e3",level:5},{value:"ImportRes",id:"importres",level:4},{value:"Properties",id:"properties",level:4},{value:"\u88c5\u914d\u539f\u7406",id:"\u88c5\u914d\u539f\u7406",level:3},{value:"\u542f\u52a8\u6d41\u7a0b",id:"\u542f\u52a8\u6d41\u7a0b",level:4},{value:"\u6ce8\u89e3\u5206\u6790",id:"\u6ce8\u89e3\u5206\u6790",level:4},{value:"\u88c5\u914d\u6d41\u7a0b",id:"\u88c5\u914d\u6d41\u7a0b",level:4},{value:"\u4e8b\u4ef6\u76d1\u542c",id:"\u4e8b\u4ef6\u76d1\u542c",level:3},{value:"\u914d\u7f6e\u6587\u4ef6",id:"\u914d\u7f6e\u6587\u4ef6",level:2},{value:"\u914d\u7f6e\u65b9\u5f0f",id:"\u914d\u7f6e\u65b9\u5f0f-1",level:3},{value:"\u6587\u4ef6\u7c7b\u578b",id:"\u6587\u4ef6\u7c7b\u578b",level:4},{value:"\u52a0\u8f7d\u987a\u5e8f",id:"\u52a0\u8f7d\u987a\u5e8f",level:4},{value:"yaml\u8bed\u6cd5",id:"yaml\u8bed\u6cd5",level:3},{value:"\u83b7\u53d6\u914d\u7f6e",id:"\u83b7\u53d6\u914d\u7f6e",level:3},{value:"\u914d\u7f6e\u63d0\u793a",id:"\u914d\u7f6e\u63d0\u793a",level:3},{value:"Profile",id:"profile",level:3},{value:"Web\u5f00\u53d1",id:"web\u5f00\u53d1",level:2},{value:"\u529f\u80fd\u652f\u6301",id:"\u529f\u80fd\u652f\u6301",level:3},{value:"\u9759\u6001\u8d44\u6e90",id:"\u9759\u6001\u8d44\u6e90",level:3},{value:"\u8bbf\u95ee\u89c4\u5219",id:"\u8bbf\u95ee\u89c4\u5219",level:4},{value:"\u6b22\u8fce\u9875\u9762",id:"\u6b22\u8fce\u9875\u9762",level:4},{value:"\u6e90\u7801\u5206\u6790",id:"\u6e90\u7801\u5206\u6790",level:4},{value:"Rest\u6620\u5c04",id:"rest\u6620\u5c04",level:3},{value:"\u5185\u5d4c\u5bb9\u5668",id:"\u5185\u5d4c\u5bb9\u5668",level:3},{value:"\u81ea\u5b9a\u4e49",id:"\u81ea\u5b9a\u4e49-3",level:3},{value:"\u5b9a\u5236\u89c4\u5219",id:"\u5b9a\u5236\u89c4\u5219",level:4},{value:"\u5b9a\u5236\u5bb9\u5668",id:"\u5b9a\u5236\u5bb9\u5668",level:4},{value:"\u6570\u636e\u8bbf\u95ee",id:"\u6570\u636e\u8bbf\u95ee",level:2},{value:"JDBC",id:"jdbc",level:3},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-1",level:4},{value:"\u81ea\u52a8\u914d\u7f6e",id:"\u81ea\u52a8\u914d\u7f6e",level:4},{value:"Druid",id:"druid-2",level:3},{value:"MyBatis",id:"mybatis-2",level:3},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-2",level:4},{value:"\u81ea\u52a8\u914d\u7f6e",id:"\u81ea\u52a8\u914d\u7f6e-1",level:4},{value:"MyBatis-Plus",id:"mybatis-plus",level:4},{value:"Redis",id:"redis",level:3},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-3",level:4},{value:"\u81ea\u52a8\u914d\u7f6e",id:"\u81ea\u52a8\u914d\u7f6e-2",level:4},{value:"\u5355\u5143\u6d4b\u8bd5",id:"\u5355\u5143\u6d4b\u8bd5",level:2},{value:"Junit5",id:"junit5",level:3},{value:"\u5e38\u7528\u6ce8\u89e3",id:"\u5e38\u7528\u6ce8\u89e3-1",level:3},{value:"\u65ad\u8a00\u673a\u5236",id:"\u65ad\u8a00\u673a\u5236",level:3},{value:"\u7b80\u5355\u65ad\u8a00",id:"\u7b80\u5355\u65ad\u8a00",level:4},{value:"\u6570\u7ec4\u65ad\u8a00",id:"\u6570\u7ec4\u65ad\u8a00",level:4},{value:"\u7ec4\u5408\u65ad\u8a00",id:"\u7ec4\u5408\u65ad\u8a00",level:4},{value:"\u5f02\u5e38\u65ad\u8a00",id:"\u5f02\u5e38\u65ad\u8a00",level:4},{value:"\u8d85\u65f6\u65ad\u8a00",id:"\u8d85\u65f6\u65ad\u8a00",level:4},{value:"\u5feb\u901f\u5931\u8d25",id:"\u5feb\u901f\u5931\u8d25",level:4},{value:"\u524d\u7f6e\u6761\u4ef6",id:"\u524d\u7f6e\u6761\u4ef6",level:3},{value:"\u5d4c\u5957\u6d4b\u8bd5",id:"\u5d4c\u5957\u6d4b\u8bd5",level:3},{value:"\u53c2\u6570\u6d4b\u8bd5",id:"\u53c2\u6570\u6d4b\u8bd5",level:3},{value:"\u6307\u6807\u76d1\u63a7",id:"\u6307\u6807\u76d1\u63a7",level:2},{value:"Actuator",id:"actuator",level:3},{value:"Endpoint",id:"endpoint",level:3},{value:"\u9879\u76ee\u90e8\u7f72",id:"\u9879\u76ee\u90e8\u7f72",level:2},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-7",level:2},{value:"\u670d\u52a1\u6ce8\u518c",id:"\u670d\u52a1\u6ce8\u518c",level:2},{value:"Eureka",id:"eureka",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-8",level:4},{value:"\u670d\u52a1\u7aef",id:"\u670d\u52a1\u7aef",level:4},{value:"\u5ba2\u6237\u7aef",id:"\u5ba2\u6237\u7aef",level:4},{value:"\u751f\u4ea7\u8005",id:"\u751f\u4ea7\u8005",level:5},{value:"\u6d88\u8d39\u8005",id:"\u6d88\u8d39\u8005",level:5},{value:"\u96c6\u7fa4\u6784\u5efa",id:"\u96c6\u7fa4\u6784\u5efa",level:4},{value:"\u670d\u52a1\u7aef",id:"\u670d\u52a1\u7aef-1",level:5},{value:"\u751f\u4ea7\u8005",id:"\u751f\u4ea7\u8005-1",level:5},{value:"\u8d1f\u8f7d\u5747\u8861",id:"\u8d1f\u8f7d\u5747\u8861",level:5},{value:"\u670d\u52a1\u53d1\u73b0",id:"\u670d\u52a1\u53d1\u73b0",level:4},{value:"\u81ea\u6211\u4fdd\u62a4",id:"\u81ea\u6211\u4fdd\u62a4",level:4},{value:"Consul",id:"consul",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-9",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-4",level:4},{value:"\u670d\u52a1\u8c03\u7528",id:"\u670d\u52a1\u8c03\u7528",level:2},{value:"Ribbon",id:"ribbon",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-10",level:4},{value:"\u5de5\u4f5c\u6d41\u7a0b",id:"\u5de5\u4f5c\u6d41\u7a0b",level:4},{value:"\u6838\u5fc3\u7ec4\u4ef6",id:"\u6838\u5fc3\u7ec4\u4ef6",level:4},{value:"OpenFeign",id:"openfeign",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-11",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-5",level:4},{value:"\u8d85\u65f6\u95ee\u9898",id:"\u8d85\u65f6\u95ee\u9898",level:4},{value:"\u65e5\u5fd7\u7ea7\u522b",id:"\u65e5\u5fd7\u7ea7\u522b",level:4},{value:"\u670d\u52a1\u7194\u65ad",id:"\u670d\u52a1\u7194\u65ad",level:2},{value:"Hystrix",id:"hystrix",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-12",level:4},{value:"\u670d\u52a1\u964d\u7ea7",id:"\u670d\u52a1\u964d\u7ea7",level:4},{value:"\u6848\u4f8b\u6784\u5efa",id:"\u6848\u4f8b\u6784\u5efa",level:5},{value:"\u964d\u7ea7\u64cd\u4f5c",id:"\u964d\u7ea7\u64cd\u4f5c",level:5},{value:"\u670d\u52a1\u7194\u65ad",id:"\u670d\u52a1\u7194\u65ad-1",level:4},{value:"\u7194\u65ad\u7c7b\u578b",id:"\u7194\u65ad\u7c7b\u578b",level:5},{value:"\u7194\u65ad\u64cd\u4f5c",id:"\u7194\u65ad\u64cd\u4f5c",level:5},{value:"\u5de5\u4f5c\u6d41\u7a0b",id:"\u5de5\u4f5c\u6d41\u7a0b-1",level:4},{value:"\u670d\u52a1\u76d1\u63a7",id:"\u670d\u52a1\u76d1\u63a7",level:4},{value:"\u670d\u52a1\u7f51\u5173",id:"\u670d\u52a1\u7f51\u5173",level:2},{value:"Zuul",id:"zuul",level:3},{value:"Gateway",id:"gateway",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-13",level:4},{value:"\u7f51\u5173\u4f7f\u7528",id:"\u7f51\u5173\u4f7f\u7528",level:4},{value:"\u914d\u7f6e\u65b9\u5f0f",id:"\u914d\u7f6e\u65b9\u5f0f-2",level:5},{value:"\u6ce8\u5165Bean",id:"\u6ce8\u5165bean",level:5},{value:"\u52a8\u6001\u8def\u7531",id:"\u52a8\u6001\u8def\u7531",level:5},{value:"\u65ad\u8a00\u7c7b\u578b",id:"\u65ad\u8a00\u7c7b\u578b",level:4},{value:"Filter\u4f7f\u7528",id:"filter\u4f7f\u7528",level:4},{value:"\u670d\u52a1\u914d\u7f6e",id:"\u670d\u52a1\u914d\u7f6e",level:2},{value:"config",id:"config-1",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-14",level:4},{value:"\u670d\u52a1\u7aef",id:"\u670d\u52a1\u7aef-2",level:4},{value:"\u5ba2\u6237\u7aef",id:"\u5ba2\u6237\u7aef-1",level:4},{value:"\u57fa\u672c\u914d\u7f6e",id:"\u57fa\u672c\u914d\u7f6e-1",level:5},{value:"\u52a8\u6001\u5237\u65b0",id:"\u52a8\u6001\u5237\u65b0",level:5},{value:"\u670d\u52a1\u6d88\u606f",id:"\u670d\u52a1\u6d88\u606f",level:2},{value:"Bus",id:"bus",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-15",level:4},{value:"\u5168\u5c40\u5e7f\u64ad",id:"\u5168\u5c40\u5e7f\u64ad",level:4},{value:"\u5b9a\u70b9\u901a\u77e5",id:"\u5b9a\u70b9\u901a\u77e5",level:4},{value:"Stream",id:"stream",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-16",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-6",level:4},{value:"\u9ad8\u7ea7\u7279\u6027",id:"\u9ad8\u7ea7\u7279\u6027",level:4},{value:"Sleuth",id:"sleuth",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-17",level:4},{value:"\u94fe\u8def\u76d1\u63a7",id:"\u94fe\u8def\u76d1\u63a7",level:4},{value:"Alibaba",id:"alibaba",level:2},{value:"Nacos",id:"nacos",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-18",level:4},{value:"\u6ce8\u518c\u4e2d\u5fc3",id:"\u6ce8\u518c\u4e2d\u5fc3",level:4},{value:"\u914d\u7f6e\u4e2d\u5fc3",id:"\u914d\u7f6e\u4e2d\u5fc3",level:4},{value:"\u57fa\u7840\u914d\u7f6e",id:"\u57fa\u7840\u914d\u7f6e",level:5},{value:"\u5206\u7c7b\u914d\u7f6e",id:"\u5206\u7c7b\u914d\u7f6e",level:5},{value:"\u52a0\u8f7d\u914d\u7f6e",id:"\u52a0\u8f7d\u914d\u7f6e",level:5},{value:"\u96c6\u7fa4\u67b6\u6784",id:"\u96c6\u7fa4\u67b6\u6784",level:4},{value:"Sentinel",id:"sentinel",level:3},{value:"\u57fa\u672c\u4ecb\u7ecd",id:"\u57fa\u672c\u4ecb\u7ecd-19",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-7",level:4},{value:"\u6d41\u63a7\u89c4\u5219",id:"\u6d41\u63a7\u89c4\u5219",level:4},{value:"\u964d\u7ea7\u7194\u65ad",id:"\u964d\u7ea7\u7194\u65ad",level:4},{value:"\u70ed\u70b9\u9650\u6d41",id:"\u70ed\u70b9\u9650\u6d41",level:4},{value:"\u7cfb\u7edf\u89c4\u5219",id:"\u7cfb\u7edf\u89c4\u5219",level:4},{value:"\u670d\u52a1\u8c03\u7528",id:"\u670d\u52a1\u8c03\u7528-1",level:4},{value:"\u6301\u4e45\u5316",id:"\u6301\u4e45\u5316",level:4},{value:"Seata",id:"seata",level:3},{value:"\u5206\u5e03\u4e8b\u7269",id:"\u5206\u5e03\u4e8b\u7269",level:4},{value:"\u57fa\u672c\u914d\u7f6e",id:"\u57fa\u672c\u914d\u7f6e-2",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528-8",level:4}];function o(n){const e={a:"a",array:"array",association:"association",bean:"bean",beans:"beans",br:"br",code:"code",collection:"collection",configuration:"configuration","constructor-arg":"constructor-arg",datasoure:"datasoure",delete:"delete",discriminator:"discriminator",e:"e",em:"em",environment:"environment",environments:"environments",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",header:"header",hr:"hr",id:"id",img:"img",import:"import",insert:"insert",li:"li",list:"list",map:"map",mapper:"mapper",mappers:"mappers",ol:"ol",otherwise:"otherwise",p:"p",package:"package",pre:"pre",properties:"properties",property:"property",props:"props",result:"result",resultmap:"resultmap",resulttype:"resulttype",select:"select",set:"set",settings:"settings",strong:"strong",t:"t",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",transactionmanager:"transactionmanager",typealias:"typealias",typealiases:"typealiases",ul:"ul",update:"update",when:"when",where:"where",...(0,l.R)(),...n.components},r=e["constructor-arg"];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"mybatis",children:"MyBatis"})}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u4ecb\u7ecd",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"ORM\uff08Object Relational Mapping\uff09\uff1a \u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\uff0c\u6307\u7684\u662f\u6301\u4e45\u5316\u6570\u636e\u548c\u5b9e\u4f53\u5bf9\u8c61\u7684\u6620\u5c04\u6a21\u5f0f\uff0c\u89e3\u51b3\u9762\u5411\u5bf9\u8c61\u4e0e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5b58\u5728\u7684\u4e92\u4e0d\u5339\u914d\u7684\u73b0\u8c61"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(52270).A+"",width:"1032",height:"291"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"MyBatis"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyBatis \u662f\u4e00\u4e2a\u4f18\u79c0\u7684\u57fa\u4e8e Java \u7684\u6301\u4e45\u5c42\u6846\u67b6\uff0c\u5b83\u5185\u90e8\u5c01\u88c5\u4e86 JDBC\uff0c\u4f7f\u5f00\u53d1\u8005\u53ea\u9700\u5173\u6ce8 SQL \u8bed\u53e5\u672c\u8eab\uff0c\u800c\u4e0d\u9700\u8981\u82b1\u8d39\u7cbe\u529b\u53bb\u5904\u7406\u52a0\u8f7d\u9a71\u52a8\u3001\u521b\u5efa\u8fde\u63a5\u3001\u521b\u5efa Statement \u7b49\u8fc7\u7a0b\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyBatis \u901a\u8fc7 XML \u6216\u6ce8\u89e3\u7684\u65b9\u5f0f\u5c06\u8981\u6267\u884c\u7684\u5404\u79cd Statement \u914d\u7f6e\u8d77\u6765\uff0c\u5e76\u901a\u8fc7 Java \u5bf9\u8c61\u548c Statement \u4e2d SQL \u7684\u52a8\u6001\u53c2\u6570\u8fdb\u884c\u6620\u5c04\u751f\u6210\u6700\u7ec8\u6267\u884c\u7684 SQL \u8bed\u53e5\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyBatis \u6846\u67b6\u6267\u884c SQL \u5e76\u5c06\u7ed3\u679c\u6620\u5c04\u4e3a Java \u5bf9\u8c61\u5e76\u8fd4\u56de\u3002\u91c7\u7528 ORM \u601d\u60f3\u89e3\u51b3\u4e86\u5b9e\u4f53\u548c\u6570\u636e\u5e93\u6620\u5c04\u7684\u95ee\u9898\uff0c\u5bf9 JDBC \u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u5c4f\u853d\u4e86 JDBC \u5e95\u5c42 API \u7684\u8c03\u7528\u7ec6\u8282\uff0c\u4f7f\u6211\u4eec\u4e0d\u7528\u64cd\u4f5c JDBC API\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u5bf9\u6570\u636e\u5e93\u7684\u6301\u4e45\u5316\u64cd\u4f5c\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["MyBatis \u5b98\u7f51\u5730\u5740\uff1a",(0,i.jsx)(e.a,{href:"http://www.mybatis.org/mybatis-3/",children:"http://www.mybatis.org/mybatis-3/"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u89c6\u9891\uff1a",(0,i.jsx)(e.a,{href:"https://space.bilibili.com/37974444/",children:"https://space.bilibili.com/37974444/"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u64cd\u4f5c",children:"\u57fa\u672c\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.h3,{id:"\u76f8\u5173api",children:"\u76f8\u5173API"}),"\n",(0,i.jsx)(e.p,{children:"Resources\uff1a\u52a0\u8f7d\u8d44\u6e90\u7684\u5de5\u5177\u7c7b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"InputStream getResourceAsStream(String fileName)"}),"\uff1a\u901a\u8fc7\u7c7b\u52a0\u8f7d\u5668\u8fd4\u56de\u6307\u5b9a\u8d44\u6e90\u7684\u5b57\u8282\u6d41\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53c2\u6570 fileName \u662f\u653e\u5728 src \u7684\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u540d\uff1aMyBatisConfig.xml"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"SqlSessionFactoryBuilder\uff1a\u6784\u5efa\u5668\uff0c\u7528\u6765\u83b7\u53d6 SqlSessionFactory \u5de5\u5382\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SqlSessionFactory build(InputStream is)"}),"\uff1a\u901a\u8fc7\u6307\u5b9a\u8d44\u6e90\u7684\u5b57\u8282\u8f93\u5165\u6d41\u83b7\u53d6 SqlSession \u5de5\u5382\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"SqlSessionFactory\uff1a\u83b7\u53d6 SqlSession \u6784\u5efa\u8005\u5bf9\u8c61\u7684\u5de5\u5382\u63a5\u53e3"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SqlSession openSession()"}),"\uff1a\u83b7\u53d6 SqlSession \u6784\u5efa\u8005\u5bf9\u8c61\uff0c\u5e76\u5f00\u542f\u624b\u52a8\u63d0\u4ea4\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SqlSession openSession(boolean)"}),"\uff1a\u83b7\u53d6 SqlSession \u6784\u5efa\u8005\u5bf9\u8c61\uff0c\u53c2\u6570\u4e3a true \u5f00\u542f\u81ea\u52a8\u63d0\u4ea4\u4e8b\u52a1"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"SqlSession\uff1a\u6784\u5efa\u8005\u5bf9\u8c61\u63a5\u53e3\uff0c\u7528\u4e8e\u6267\u884c SQL\u3001\u7ba1\u7406\u4e8b\u52a1\u3001\u63a5\u53e3\u4ee3\u7406"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["SqlSession ",(0,i.jsx)(e.strong,{children:"\u4ee3\u8868\u548c\u6570\u636e\u5e93\u7684\u4e00\u6b21\u4f1a\u8bdd"}),"\uff0c\u7528\u5b8c\u5fc5\u987b\u5173\u95ed"]}),"\n",(0,i.jsx)(e.li,{children:"SqlSession \u548c Connection \u4e00\u6837\u90fd\u662f\u975e\u7ebf\u7a0b\u5b89\u5168\uff0c\u6bcf\u6b21\u4f7f\u7528\u90fd\u5e94\u8be5\u53bb\u83b7\u53d6\u65b0\u7684\u5bf9\u8c61"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6ce8\uff1a",(0,i.jsx)(e.strong,{children:"update \u6570\u636e\u9700\u8981\u63d0\u4ea4\u4e8b\u52a1\uff0c\u6216\u5f00\u542f\u9ed8\u8ba4\u63d0\u4ea4"})]}),"\n",(0,i.jsx)(e.p,{children:"SqlSession \u5e38\u7528 API\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsxs)(e.td,{children:["List",(0,i.jsx)(e.e,{children:" selectList(String statement,Object parameter)"})]}),(0,i.jsx)(e.td,{children:"\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u8fd4\u56deList\u96c6\u5408"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"T selectOne(String statement,Object parameter)"}),(0,i.jsx)(e.td,{children:"\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\u5bf9\u8c61"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int insert(String statement,Object parameter)"}),(0,i.jsx)(e.td,{children:"\u6267\u884c\u65b0\u589e\u8bed\u53e5\uff0c\u8fd4\u56de\u5f71\u54cd\u884c\u6570"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int update(String statement,Object parameter)"}),(0,i.jsx)(e.td,{children:"\u6267\u884c\u5220\u9664\u8bed\u53e5\uff0c\u8fd4\u56de\u5f71\u54cd\u884c\u6570"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int delete(String statement,Object parameter)"}),(0,i.jsx)(e.td,{children:"\u6267\u884c\u4fee\u6539\u8bed\u53e5\uff0c\u8fd4\u56de\u5f71\u54cd\u884c\u6570"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void commit()"}),(0,i.jsx)(e.td,{children:"\u63d0\u4ea4\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void rollback()"}),(0,i.jsx)(e.td,{children:"\u56de\u6eda\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsxs)(e.td,{children:["T getMapper(Class",(0,i.jsx)(e.t,{children:" cls)"})]}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u6307\u5b9a\u63a5\u53e3\u7684\u4ee3\u7406\u5b9e\u73b0\u7c7b\u5bf9\u8c61"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void close()"}),(0,i.jsx)(e.td,{children:"\u91ca\u653e\u8d44\u6e90"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6620\u5c04\u914d\u7f6e",children:"\u6620\u5c04\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u5305\u542b\u4e86\u6570\u636e\u548c\u5bf9\u8c61\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u4ee5\u53ca\u8981\u6267\u884c\u7684 SQL \u8bed\u53e5\uff0c\u653e\u5728 src \u76ee\u5f55\u4e0b"}),"\n",(0,i.jsx)(e.p,{children:"\u547d\u540d\uff1aStudentMapper.xml"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u5934\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml-dtd",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6839\u6807\u7b7e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.mapper,{children:"\uff1a\u6838\u5fc3\u6839\u6807\u7b7e"})}),"\n",(0,i.jsx)(e.li,{children:"namespace\uff1a\u5c5e\u6027\uff0c\u540d\u79f0\u7a7a\u95f4"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529f\u80fd\u6807\u7b7e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"< select >\uff1a\u67e5\u8be2\u529f\u80fd\u6807\u7b7e"}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.insert,{children:"\uff1a\u65b0\u589e\u529f\u80fd\u6807\u7b7e"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.update,{children:"\uff1a\u4fee\u6539\u529f\u80fd\u6807\u7b7e"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.delete,{children:["\uff1a\u5220\u9664\u529f\u80fd\u6807\u7b7e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"id\uff1a\u5c5e\u6027\uff0c\u552f\u4e00\u6807\u8bc6\uff0c\u914d\u5408\u540d\u79f0\u7a7a\u95f4\u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:"resultType\uff1a\u6307\u5b9a\u7ed3\u679c\u6620\u5c04\u5bf9\u8c61\u7c7b\u578b\uff0c\u548c\u5bf9\u5e94\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7c7b\u578b\uff08\u5168\u9650\u5b9a\u540d\uff09\u4fdd\u6301\u4e00\u81f4\uff0c\u4f46\u662f\u5982\u679c\u8fd4\u56de\u503c\u662f List \u5219\u548c\u5176\u6cdb\u578b\u4fdd\u6301\u4e00\u81f4"}),"\n",(0,i.jsx)(e.li,{children:"parameterType\uff1a\u6307\u5b9a\u53c2\u6570\u6620\u5c04\u5bf9\u8c61\u7c7b\u578b\uff0c\u5fc5\u987b\u548c\u5bf9\u5e94\u7684\u65b9\u6cd5\u7684\u53c2\u6570\u7c7b\u578b\uff08\u5168\u9650\u5b9a\u540d\uff09\u4fdd\u6301\u4e00\u81f4"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"statementType"}),"\uff1a\u53ef\u9009 STATEMENT\uff0cPREPARED \u6216 CALLABLE\uff0c\u9ed8\u8ba4\u503c\uff1aPREPARED\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"STATEMENT\uff1a\u76f4\u63a5\u64cd\u4f5c SQL\uff0c\u4f7f\u7528 Statement \u4e0d\u8fdb\u884c\u9884\u7f16\u8bd1\uff0c\u83b7\u53d6\u6570\u636e\uff1a$"}),"\n",(0,i.jsx)(e.li,{children:"PREPARED\uff1a\u9884\u5904\u7406\u53c2\u6570\uff0c\u4f7f\u7528 PreparedStatement \u8fdb\u884c\u9884\u7f16\u8bd1\uff0c\u83b7\u53d6\u6570\u636e\uff1a#"}),"\n",(0,i.jsx)(e.li,{children:"CALLABLE\uff1a\u6267\u884c\u5b58\u50a8\u8fc7\u7a0b\uff0cCallableStatement"}),"\n"]}),"\n"]}),"\n"]}),"\n"]})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\u83b7\u53d6\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["SQL \u83b7\u53d6\u53c2\u6570\uff1a",(0,i.jsx)(e.code,{children:"#{\u5c5e\u6027\u540d}"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml-dtd",children:'<mapper namespace="StudentMapper">\n    <select id="selectById" resultType="student" parameterType="int">\n\t\tSELECT * FROM student WHERE id = #{id}\n    </select>\n<mapper/>\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5f3a\u70c8\u63a8\u8350\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://mybatis.org/mybatis-3/zh/sqlmap-xml.html",children:"https://mybatis.org/mybatis-3/zh/sqlmap-xml.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6838\u5fc3\u914d\u7f6e",children:"\u6838\u5fc3\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u5305\u542b\u4e86 MyBatis \u6700\u6838\u5fc3\u7684\u8bbe\u7f6e\u548c\u5c5e\u6027\u4fe1\u606f\uff0c\u5982\u6570\u636e\u5e93\u7684\u8fde\u63a5\u3001\u4e8b\u52a1\u3001\u8fde\u63a5\u6c60\u4fe1\u606f\u7b49"}),"\n",(0,i.jsx)(e.p,{children:"\u547d\u540d\uff1aMyBatisConfig.xml"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u7684\u6587\u4ef6\u5934\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml-dtd",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd">\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6839\u6807\u7b7e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.configuration,{children:"\uff1a\u6838\u5fc3\u6839\u6807\u7b7e"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165\u8fde\u63a5\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.properties,{children:"\uff1a \u5f15\u5165\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u6587\u4ef6\u6807\u7b7e"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"resource\uff1a\u5c5e\u6027\uff0c\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u540d"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml-dtd",children:'<properties resource="jdbc.properties"/>\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8c03\u6574\u8bbe\u7f6e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.settings,{children:"\uff1a\u53ef\u4ee5\u6539\u53d8 Mybatis \u8fd0\u884c\u65f6\u884c\u4e3a"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8d77\u522b\u540d\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.typealiases,{children:"\uff1a\u4e3a\u5168\u7c7b\u540d\u8d77\u522b\u540d\u7684\u7236\u6807\u7b7e"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.typealias,{children:["\uff1a\u4e3a\u5168\u7c7b\u540d\u8d77\u522b\u540d\u7684\u5b50\u6807\u7b7e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"type\uff1a\u6307\u5b9a\u5168\u7c7b\u540d"}),"\n",(0,i.jsx)(e.li,{children:"alias\uff1a\u6307\u5b9a\u522b\u540d"}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.package,{children:"\uff1a\u4e3a\u6307\u5b9a\u5305\u4e0b\u6240\u6709\u7c7b\u8d77\u522b\u540d\u7684\u5b50\u6807\u7b7e\uff0c\u522b\u540d\u5c31\u662f\u7c7b\u540d\uff0c\u9996\u5b57\u6bcd\u5c0f\u5199"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml-dtd",children:'\x3c!--\u8d77\u522b\u540d--\x3e\n<typeAliases>\n\t<typeAlias type="bean.Student" alias="student"/>\n\t<package name="com.seazean.bean"/>\n\t\t\x3c!--\u4e8c\u9009\u4e00--\x3e\n</typeAliase>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u5e26\u522b\u540d\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u522b\u540d"}),(0,i.jsx)(e.th,{children:"\u6570\u636e\u7c7b\u578b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"string"}),(0,i.jsx)(e.td,{children:"java.lang.String"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"long"}),(0,i.jsx)(e.td,{children:"java.lang.Lang"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int"}),(0,i.jsx)(e.td,{children:"java.lang.Integer"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"double"}),(0,i.jsx)(e.td,{children:"java.lang.Double"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean"}),(0,i.jsx)(e.td,{children:"java.lang.Boolean"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"...."}),(0,i.jsx)(e.td,{children:"......"})]})]})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u73af\u5883\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\u6807\u7b7e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.environments,{children:"\uff1a\u914d\u7f6e\u6570\u636e\u5e93\u73af\u5883\u6807\u7b7e\uff0cdefault \u5c5e\u6027\u6307\u5b9a\u54ea\u4e2a environment"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.environment,{children:"\uff1a\u914d\u7f6e\u6570\u636e\u5e93\u73af\u5883\u5b50\u6807\u7b7e\uff0cid \u5c5e\u6027\u662f\u552f\u4e00\u6807\u8bc6\uff0c\u4e0e default \u5bf9\u5e94"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.transactionmanager,{children:"\uff1a\u4e8b\u52a1\u7ba1\u7406\u6807\u7b7e\uff0ctype \u5c5e\u6027\u9ed8\u8ba4 JDBC \u4e8b\u52a1"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.datasoure,{children:["\uff1a\u6570\u636e\u6e90\u6807\u7b7e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"type \u5c5e\u6027\uff1aPOOLED \u4f7f\u7528\u8fde\u63a5\u6c60\uff08MyBatis \u5185\u7f6e\uff09\uff0cUNPOOLED \u4e0d\u4f7f\u7528\u8fde\u63a5\u6c60"}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.property,{children:["\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\u6807\u7b7e\u3002\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"name \u5c5e\u6027\u53d6\u503c\uff1adriver\uff0curl\uff0cusername\uff0cpassword"}),"\n",(0,i.jsx)(e.li,{children:"value \u5c5e\u6027\u53d6\u503c\uff1a\u4e0e name \u5bf9\u5e94"}),"\n"]}),"\n"]})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.mappers,{children:"\uff1a\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u6807\u7b7e"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.mapper,{children:["\uff1a\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u5b50\u6807\u7b7e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"resource\uff1a\u5c5e\u6027\u6307\u5b9a\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0"}),"\n",(0,i.jsx)(e.li,{children:"url\uff1a\u5f15\u7528\u7f51\u8def\u8def\u5f84\u6216\u8005\u78c1\u76d8\u8def\u5f84\u4e0b\u7684 sql \u6620\u5c04\u6587\u4ef6"}),"\n",(0,i.jsx)(e.li,{children:"class\uff1a\u6307\u5b9a\u6620\u5c04\u914d\u7f6e\u7c7b"}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.package,{children:"\uff1a\u6279\u91cf\u6ce8\u518c"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://mybatis.org/mybatis-3/zh/configuration.html",children:"https://mybatis.org/mybatis-3/zh/configuration.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u548c",children:"#{}\u548c${}"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsxs)(e.strong,{children:["#{}\uff1a",(0,i.jsx)(e.strong,{children:"\u5360\u4f4d\u7b26\uff0c\u4f20\u5165\u7684\u5185\u5bb9\u4f1a\u4f5c\u4e3a\u5b57\u7b26\u4e32"}),"\u52a0\u4e0a\u5f15\u53f7"]}),"\uff0c\u4ee5",(0,i.jsx)(e.strong,{children:"\u9884\u7f16\u8bd1"}),"\u7684\u65b9\u5f0f\u4f20\u5165\uff0c\u5c06 sql \u4e2d\u7684 #{} \u66ff\u6362\u4e3a ? \u53f7\uff0c\u8c03\u7528 PreparedStatement \u7684 set \u65b9\u6cd5\u6765\u8d4b\u503c\uff0c\u6709\u6548\u7684\u9632\u6b62 SQL \u6ce8\u5165\uff0c\u63d0\u9ad8\u7cfb\u7edf\u5b89\u5168\u6027"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsxs)(e.strong,{children:["${}\uff1a",(0,i.jsx)(e.strong,{children:"\u62fc\u63a5\u7b26\uff0c\u4f20\u5165\u7684\u5185\u5bb9\u4f1a"}),"\u76f4\u63a5\u66ff\u6362"]}),"\u62fc\u63a5\uff0c\u4e0d\u4f1a\u52a0\u4e0a\u5f15\u53f7\uff0c\u53ef\u80fd\u5b58\u5728 sql \u6ce8\u5165\u7684\u5b89\u5168\u9690\u60a3"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u80fd\u7528 #{} \u7684\u5730\u65b9\u5c31\u7528 #{}\uff0c\u4e0d\u7528\u6216\u5c11\u7528 ${}"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5fc5\u987b\u4f7f\u7528 ${} \u7684\u60c5\u51b5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8868\u540d\u4f5c\u53c2\u6570\u65f6\uff0c\u5982\uff1a",(0,i.jsx)(e.code,{children:"SELECT * FROM ${tableName}"})]}),"\n",(0,i.jsxs)(e.li,{children:["order by \u65f6\uff0c\u5982\uff1a",(0,i.jsx)(e.code,{children:"SELECT * FROM t_user ORDER BY ${columnName}"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"sql \u8bed\u53e5\u4f7f\u7528 #{}\uff0cproperties \u6587\u4ef6\u5185\u5bb9\u83b7\u53d6\u4f7f\u7528 ${}"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u65e5\u5fd7\u6587\u4ef6",children:"\u65e5\u5fd7\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u65e5\u5e38\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6392\u67e5\u95ee\u9898\u65f6\u9700\u8981\u8f93\u51fa MyBatis \u771f\u6b63\u6267\u884c\u7684 SQL \u8bed\u53e5\u3001\u53c2\u6570\u3001\u7ed3\u679c\u7b49\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u501f\u52a9 log4j \u7684\u529f\u80fd\u6765\u5b9e\u73b0\u6267\u884c\u4fe1\u606f\u7684\u8f93\u51fa\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u6839\u6807\u7b7e\u5185\u914d\u7f6e log4j"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u914d\u7f6eLOG4J--\x3e\n<settings>\n\t<setting name="logImpl" value="log4j"/>\n</settings>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728 src \u76ee\u5f55\u4e0b\u521b\u5efa log4j.properties"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"# Global logging configuration\nlog4j.rootLogger=DEBUG, stdout\n# Console output...\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n\n\n#\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\n  #log4j.appender.file=org.apache.log4j.FileAppender\n  #log4j.appender.file.File=../logs/iask.log\n  #log4j.appender.file.layout=org.apache.log4j.PatternLayout\n  #log4j.appender.file.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss}  %l  %m%n\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pom.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.slf4j</groupId>\n    <artifactId>slf4j-api</artifactId>\n    <version>1.7.21</version>\n</dependency>\n<dependency>\n    <groupId>org.slf4j</groupId>\n    <artifactId>slf4j-log4j12</artifactId>\n    <version>1.7.21</version>\n</dependency>\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u4ee3\u7801\u5b9e\u73b0",children:"\u4ee3\u7801\u5b9e\u73b0"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9e\u4f53\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Student {\n    private Integer id;\n    private String name;\n    private Integer age;\n    .....\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"StudentMapper"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface StudentMapper {\n    //\u67e5\u8be2\u5168\u90e8\n    public abstract List<Student> selectAll();\n\n    //\u6839\u636eid\u67e5\u8be2\n    public abstract Student selectById(Integer id);\n\n    //\u65b0\u589e\u6570\u636e\n    public abstract Integer insert(Student stu);\n\n    //\u4fee\u6539\u6570\u636e\n    public abstract Integer update(Student stu);\n\n    //\u5220\u9664\u6570\u636e\n    public abstract Integer delete(Integer id);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"config.properties"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"driver=com.mysql.jdbc.Driver\nurl=jdbc:mysql://192.168.2.184:3306/db1\nusername=root\npassword=123456\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyBatisConfig.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd">\n\n\x3c!--\u6838\u5fc3\u6839\u6807\u7b7e--\x3e\n<configuration>\n    \x3c!--\u5f15\u5165\u6570\u636e\u5e93\u8fde\u63a5\u7684\u914d\u7f6e\u6587\u4ef6--\x3e\n    <properties resource="jdbc.properties"/>\n    \n    \x3c!--\u914d\u7f6eLOG4J--\x3e\n    <settings>\n        <setting name="logImpl" value="log4j"/>\n    </settings>\n    \n    \x3c!--\u8d77\u522b\u540d--\x3e\n    <typeAliases>\n        <typeAlias type="bean.Student" alias="student"/>\n        \x3c!--<package name="bean"/>--\x3e\n    </typeAliases>\n\n    \x3c!--\u914d\u7f6e\u6570\u636e\u5e93\u73af\u5883\uff0c\u53ef\u4ee5\u591a\u4e2a\u73af\u5883\uff0cdefault\u6307\u5b9a\u54ea\u4e2a--\x3e\n    <environments default="mysql">\n        \x3c!--id\u5c5e\u6027\u552f\u4e00\u6807\u8bc6--\x3e\n        <environment id="mysql">\n            \x3c!--\u4e8b\u52a1\u7ba1\u7406\uff0ctype\u5c5e\u6027\uff0c\u9ed8\u8ba4JDBC\u4e8b\u52a1--\x3e\n            <transactionManager type="JDBC"></transactionManager>\n            \x3c!--\u6570\u636e\u6e90\u4fe1\u606f   type\u5c5e\u6027\u8fde\u63a5\u6c60--\x3e\n            <dataSource type="POOLED">\n                \x3c!--property\u83b7\u53d6\u6570\u636e\u5e93\u8fde\u63a5\u7684\u914d\u7f6e\u4fe1\u606f--\x3e\n                <property name="driver" value="${driver}"/>\n                <property name="url" value="${url}"/>\n                <property name="username" value="${username}"/>\n                <property name="password" value="${password}"/>\n            </dataSource>\n        </environment>\n    </environments>\n\n    \x3c!--\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6--\x3e\n    <mappers>\n        \x3c!--mapper\u5f15\u5165\u6307\u5b9a\u7684\u6620\u5c04\u914d\u7f6e resource\u5c5e\u6027\u6267\u884c\u7684\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0--\x3e\n        <mapper resource="StudentMapper.xml"/>\n    </mappers>\n</configuration>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"StudentMapper.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n\n<mapper namespace="StudentMapper">\n    <select id="selectAll" resultType="student">\n        SELECT * FROM student\n    </select>\n\n    <select id="selectById" resultType="student" parameterType="int">\n        SELECT * FROM student WHERE id = #{id}\n    </select>\n\n    <insert id="insert" parameterType="student">\n        INSERT INTO student VALUES (#{id},#{name},#{age})\n    </insert>\n\n    <update id="update" parameterType="student">\n        UPDATE student SET name = #{name}, age = #{age} WHERE id = #{id}\n    </update>\n\n    <delete id="delete" parameterType="student">\n        DELETE FROM student WHERE id = #{id}\n    </delete>\n\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u63a7\u5236\u5c42\u6d4b\u8bd5\u4ee3\u7801\uff1a\u6839\u636e id \u67e5\u8be2"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\npublic void selectById() throws Exception{\n    //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n    InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");\n\n    //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n    SqlSessionFactory ssf = new SqlSessionFactoryBuilder().build(is);\n\n    //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n    SqlSession sqlSession = ssf.openSession();\n\n    //4.\u6267\u884c\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684sql\u8bed\u53e5\uff0c\u5e76\u63a5\u6536\u7ed3\u679c\n    Student stu = sqlSession.selectOne("StudentMapper.selectById", 3);\n\n    //5.\u5904\u7406\u7ed3\u679c\n    System.out.println(stu);\n\n    //6.\u91ca\u653e\u8d44\u6e90\n    sqlSession.close();\n    is.close();\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u63a7\u5236\u5c42\u6d4b\u8bd5\u4ee3\u7801\uff1a\u65b0\u589e\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\npublic void insert() throws Exception{\n    //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n    //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n    //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n    SqlSession sqlSession = sqlSessionFactory.openSession(true);\n\n    //4.\u6267\u884c\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684sql\u8bed\u53e5\uff0c\u5e76\u63a5\u6536\u7ed3\u679c\n    Student stu = new Student(5, "\u5468\u4e03", 27);\n    int result = sqlSession.insert("StudentMapper.insert", stu);\n\n    //5.\u63d0\u4ea4\u4e8b\u52a1\n    //sqlSession.commit();\n\n    //6.\u5904\u7406\u7ed3\u679c\n    System.out.println(result);\n\n    //7.\u91ca\u653e\u8d44\u6e90\n    sqlSession.close();\n    is.close();\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6279\u91cf\u64cd\u4f5c",children:"\u6279\u91cf\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u4e09\u79cd\u65b9\u5f0f\u5b9e\u73b0\u6279\u91cf\u64cd\u4f5c\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.settings,{children:[" \u6807\u7b7e\u5c5e\u6027\uff1a\u8fd9\u79cd\u65b9\u5f0f\u5c5e\u4e8e",(0,i.jsx)(e.strong,{children:"\u5168\u5c40\u6279\u91cf"})]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<settings>\n    <setting name="defaultExecutorType" value="BATCH"/>\n</settings>\n'})}),"\n",(0,i.jsx)(e.p,{children:"defaultExecutorType\uff1a\u914d\u7f6e\u9ed8\u8ba4\u7684\u6267\u884c\u5668"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"SIMPLE \u5c31\u662f\u666e\u901a\u7684\u6267\u884c\u5668\uff08\u9ed8\u8ba4\uff0c\u6bcf\u6b21\u6267\u884c\u90fd\u8981\u91cd\u65b0\u8bbe\u7f6e\u53c2\u6570\uff09"}),"\n",(0,i.jsx)(e.li,{children:"REUSE \u6267\u884c\u5668\u4f1a\u91cd\u7528\u9884\u5904\u7406\u8bed\u53e5\uff08\u53ea\u9884\u8bbe\u7f6e\u4e00\u6b21\u53c2\u6570\uff0c\u591a\u6b21\u6267\u884c\uff09"}),"\n",(0,i.jsxs)(e.li,{children:["BATCH \u6267\u884c\u5668\u4e0d\u4ec5\u91cd\u7528\u8bed\u53e5\u8fd8\u4f1a\u6267\u884c\u6279\u91cf\u66f4\u65b0\uff08\u53ea\u9488\u5bf9",(0,i.jsx)(e.strong,{children:"\u4fee\u6539\u64cd\u4f5c"}),"\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["SqlSession ",(0,i.jsx)(e.strong,{children:"\u4f1a\u8bdd\u5185\u6279\u91cf"}),"\u64cd\u4f5c\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void testBatch() throws IOException{\n    SqlSessionFactory sqlSessionFactory = getSqlSessionFactory();\n\n    // \u53ef\u4ee5\u6267\u884c\u6279\u91cf\u64cd\u4f5c\u7684sqlSession\n    SqlSession openSession = sqlSessionFactory.openSession(ExecutorType.BATCH);\n    long start = System.currentTimeMillis();\n    try{\n        EmployeeMapper mapper = openSession.getMapper(EmployeeMapper.class);\n        for (int i = 0; i < 10000; i++) {\n            mapper.addEmp(new Employee(UUID.randomUUID().toString().substring(0, 5), "b", "1"));\n        }\n        openSession.commit();\n        long end = System.currentTimeMillis();\n        // \u6279\u91cf\uff1a\uff08\u9884\u7f16\u8bd1sql\u4e00\u6b21==>\u8bbe\u7f6e\u53c2\u6570===>10000\u6b21===>\u6267\u884c1\u6b21\uff08\u7c7b\u4f3c\u7ba1\u9053\uff09\uff09\n        // \u975e\u6279\u91cf\uff1a\uff08\u9884\u7f16\u8bd1sql=\u8bbe\u7f6e\u53c2\u6570=\u6267\u884c\uff09==\u300b10000   \u8017\u65f6\u66f4\u591a\n        System.out.println("\u6267\u884c\u65f6\u957f\uff1a" + (end - start));\n    }finally{\n        openSession.close();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Spring \u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f\uff08applicationContext.xml\uff09\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u914d\u7f6e\u4e00\u4e2a\u53ef\u4ee5\u8fdb\u884c\u6279\u91cf\u6267\u884c\u7684sqlSession  --\x3e\n<bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate">\n    <constructor-arg name="sqlSessionFactory" ref="sqlSessionFactoryBean"/>\n    <constructor-arg name="executorType" value="BATCH"/>\n</bean>\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Autowired\nprivate SqlSession sqlSession;\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u4ee3\u7406\u5f00\u53d1",children:"\u4ee3\u7406\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h3,{id:"\u4ee3\u7406\u89c4\u5219",children:"\u4ee3\u7406\u89c4\u5219"}),"\n",(0,i.jsx)(e.p,{children:"\u5206\u5c42\u601d\u60f3\uff1a\u63a7\u5236\u5c42\uff08controller\uff09\u3001\u4e1a\u52a1\u5c42\uff08service\uff09\u3001\u6301\u4e45\u5c42\uff08dao\uff09"}),"\n",(0,i.jsx)(e.p,{children:"\u8c03\u7528\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(26789).A+"",width:"680",height:"102"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4f20\u7edf\u65b9\u5f0f\u5b9e\u73b0 DAO \u5c42\uff0c\u9700\u8981\u5199\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\u3002\u91c7\u7528 Mybatis \u7684\u4ee3\u7406\u5f00\u53d1\u65b9\u5f0f\u5b9e\u73b0 DAO \u5c42\u7684\u5f00\u53d1\uff0c\u53ea\u9700\u8981\u7f16\u5199 Mapper \u63a5\u53e3\uff08\u76f8\u5f53\u4e8e Dao \u63a5\u53e3\uff09\uff0c\u7531 Mybatis \u6846\u67b6\u6839\u636e\u63a5\u53e3\u5b9a\u4e49\u521b\u5efa\u63a5\u53e3\u7684",(0,i.jsx)(e.strong,{children:"\u52a8\u6001\u4ee3\u7406\u5bf9\u8c61"})]}),"\n",(0,i.jsx)(e.p,{children:"\u63a5\u53e3\u5f00\u53d1\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5b9a\u4e49\u63a5\u53e3"}),"\n",(0,i.jsx)(e.li,{children:"\u64cd\u4f5c\u6570\u636e\u5e93\uff0cMyBatis \u6846\u67b6\u6839\u636e\u63a5\u53e3\uff0c\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u751f\u6210\u4ee3\u7406\u5bf9\u8c61\uff0c\u8d1f\u8d23\u6570\u636e\u5e93\u7684\u64cd\u4f5c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Mapper \u63a5\u53e3\u5f00\u53d1\u9700\u8981\u9075\u5faa\u4ee5\u4e0b\u89c4\u8303\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Mapper.xml \u6587\u4ef6\u4e2d\u7684 namespace \u4e0e DAO \u5c42 mapper \u63a5\u53e3\u7684\u5168\u7c7b\u540d\u76f8\u540c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Mapper.xml \u6587\u4ef6\u4e2d\u7684\u589e\u5220\u6539\u67e5\u6807\u7b7e\u7684id\u5c5e\u6027\u548c DAO \u5c42 Mapper \u63a5\u53e3\u65b9\u6cd5\u540d\u76f8\u540c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Mapper.xml \u6587\u4ef6\u4e2d\u7684\u589e\u5220\u6539\u67e5\u6807\u7b7e\u7684 parameterType \u5c5e\u6027\u548c DAO \u5c42 Mapper \u63a5\u53e3\u65b9\u6cd5\u7684\u53c2\u6570\u76f8\u540c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Mapper.xml \u6587\u4ef6\u4e2d\u7684\u589e\u5220\u6539\u67e5\u6807\u7b7e\u7684 resultType \u5c5e\u6027\u548c DAO \u5c42 Mapper \u63a5\u53e3\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u76f8\u540c"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(34051).A+"",width:"1012",height:"376"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5b9e\u73b0\u539f\u7406",children:"\u5b9e\u73b0\u539f\u7406"}),"\n",(0,i.jsxs)(e.p,{children:["\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\u5f00\u53d1\u6a21\u5f0f\uff0c\u53ea\u7f16\u5199\u4e00\u4e2a\u63a5\u53e3\u4e0d\u5199\u5b9e\u73b0\u7c7b\uff0c\u901a\u8fc7 ",(0,i.jsx)(e.strong,{children:"getMapper()"})," \u65b9\u6cd5\u6700\u7ec8\u83b7\u53d6\u5230 MapperProxy \u4ee3\u7406\u5bf9\u8c61\uff0c\u800c\u8fd9\u4e2a\u4ee3\u7406\u5bf9\u8c61\u662f MyBatis \u4f7f\u7528\u4e86 JDK \u7684\u52a8\u6001\u4ee3\u7406\u6280\u672f\u751f\u6210\u7684"]}),"\n",(0,i.jsxs)(e.p,{children:["\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u5728\u6267\u884c\u65b9\u6cd5\u65f6\u6700\u7ec8\u8c03\u7528\u4e86 ",(0,i.jsx)(e.strong,{children:"MapperMethod.execute()"})," \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u901a\u8fc7 switch case \u8bed\u53e5\u6839\u636e\u64cd\u4f5c\u7c7b\u578b\u6765\u5224\u65ad\u662f\u65b0\u589e\u3001\u4fee\u6539\u3001\u5220\u9664\u3001\u67e5\u8be2\u64cd\u4f5c\uff0c\u6700\u540e\u4e00\u6b65\u56de\u5230\u4e86 MyBatis \u6700\u539f\u751f\u7684 ",(0,i.jsx)(e.strong,{children:"SqlSession \u65b9\u5f0f\u6765\u6267\u884c\u589e\u5220\u6539\u67e5"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public Student selectById(Integer id) {\n    Student stu = null;\n    SqlSession sqlSession = null;\n    InputStream is = null;\n    try{\n        //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n        is = Resources.getResourceAsStream("MyBatisConfig.xml");\n\n        //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n        SqlSessionFactory s = new SqlSessionFactoryBuilder().build(is);\n\n        //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n        sqlSession = s.openSession(true);\n\n        //4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\n        StudentMapper mapper = sqlSession.getMapper(StudentMapper.class); \n\n        //5.\u901a\u8fc7\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u8c03\u7528\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\n        stu = mapper.selectById(id);\n    } catch (Exception e) {\n        e.getMessage();\n    } finally {\n        //6.\u91ca\u653e\u8d44\u6e90\n        if(sqlSession != null) {\n            sqlSession.close();\n        }\n        if(is != null) {\n            try {\n                is.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n    //7.\u8fd4\u56de\u7ed3\u679c\n    return stu;\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u7ed3\u679c\u6620\u5c04",children:"\u7ed3\u679c\u6620\u5c04"}),"\n",(0,i.jsx)(e.h3,{id:"\u76f8\u5173\u6807\u7b7e",children:"\u76f8\u5173\u6807\u7b7e"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.resulttype,{children:"\uff1a\u8fd4\u56de\u7ed3\u679c\u6620\u5c04\u5bf9\u8c61\u7c7b\u578b\uff0c\u548c\u5bf9\u5e94\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u4fdd\u6301\u4e00\u81f4\uff0c\u4f46\u662f\u5982\u679c\u8fd4\u56de\u503c\u662f List \u5219\u548c\u5176\u6cdb\u578b\u4fdd\u6301\u4e00\u81f4"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.resultmap,{children:["\uff1a\u8fd4\u56de\u4e00\u6761\u8bb0\u5f55\u7684 Map\uff0ckey \u662f\u5217\u540d\uff0cvalue \u662f\u5bf9\u5e94\u7684\u503c\uff0c\u7528\u6765\u914d\u7f6e",(0,i.jsx)(e.strong,{children:"\u5b57\u6bb5\u548c\u5bf9\u8c61\u5c5e\u6027"}),"\u7684\u6620\u5c04\u5173\u7cfb\u6807\u7b7e\uff0c\u7ed3\u679c\u6620\u5c04\uff08\u548c resultType \u4e8c\u9009\u4e00\uff09"]})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"id \u5c5e\u6027\uff1a\u552f\u4e00\u6807\u8bc6"}),"\n",(0,i.jsx)(e.li,{children:"type \u5c5e\u6027\uff1a\u5b9e\u4f53\u5bf9\u8c61\u7c7b\u578b"}),"\n",(0,i.jsx)(e.li,{children:"autoMapping \u5c5e\u6027\uff1a\u7ed3\u679c\u81ea\u52a8\u6620\u5c04"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.resultmap,{children:" \u5185\u7684\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u6807\u7b7e\uff1a"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.id,{children:"\uff1a\u914d\u7f6e\u4e3b\u952e\u6620\u5c04\u5173\u7cfb\u6807\u7b7e"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.result,{children:"\uff1a\u914d\u7f6e\u975e\u4e3b\u952e\u6620\u5c04\u5173\u7cfb\u6807\u7b7e"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"column \u5c5e\u6027\uff1a\u8868\u4e2d\u5b57\u6bb5\u540d\u79f0"}),"\n",(0,i.jsx)(e.li,{children:"property \u5c5e\u6027\uff1a \u5b9e\u4f53\u5bf9\u8c61\u53d8\u91cf\u540d\u79f0"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.association,{children:["\uff1a\u914d\u7f6e\u88ab\u5305\u542b",(0,i.jsx)(e.strong,{children:"\u5355\u4e2a\u5bf9\u8c61"}),"\u7684\u6620\u5c04\u5173\u7cfb\u6807\u7b7e\uff0c\u5d4c\u5957\u5c01\u88c5\u7ed3\u679c\u96c6\uff08\u591a\u5bf9\u4e00\u3001\u4e00\u5bf9\u4e00\uff09"]})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"property \u5c5e\u6027\uff1a\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u53d8\u91cf\u540d\uff0c\u8981\u8fdb\u884c\u6620\u5c04\u7684\u5c5e\u6027\u540d"}),"\n",(0,i.jsx)(e.li,{children:"javaType \u5c5e\u6027\uff1a\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8981\u8fdb\u884c\u6620\u5c04\u7684\u5c5e\u6027\u7684\u7c7b\u578b\uff08Java \u4e2d\u7684 Bean \u7c7b\uff09"}),"\n",(0,i.jsx)(e.li,{children:"select \u5c5e\u6027\uff1a\u52a0\u8f7d\u590d\u6742\u7c7b\u578b\u5c5e\u6027\u7684\u6620\u5c04\u8bed\u53e5\u7684 ID\uff0c\u4f1a\u4ece column \u5c5e\u6027\u6307\u5b9a\u7684\u5217\u4e2d\u68c0\u7d22\u6570\u636e\uff0c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u76ee\u6807 select \u8bed\u53e5"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.collection,{children:["\uff1a\u914d\u7f6e\u88ab\u5305\u542b",(0,i.jsx)(e.strong,{children:"\u96c6\u5408\u5bf9\u8c61"}),"\u7684\u6620\u5c04\u5173\u7cfb\u6807\u7b7e\uff0c\u5d4c\u5957\u5c01\u88c5\u7ed3\u679c\u96c6\uff08\u4e00\u5bf9\u591a\u3001\u591a\u5bf9\u591a\uff09"]})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"property \u5c5e\u6027\uff1a\u88ab\u5305\u542b\u96c6\u5408\u5bf9\u8c61\u7684\u53d8\u91cf\u540d"}),"\n",(0,i.jsx)(e.li,{children:"ofType \u5c5e\u6027\uff1a\u96c6\u5408\u4e2d\u4fdd\u5b58\u7684\u5bf9\u8c61\u6570\u636e\u7c7b\u578b"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.discriminator,{children:"\uff1a\u9274\u522b\u5668\uff0c\u7528\u6765\u5224\u65ad\u67d0\u5217\u7684\u503c\uff0c\u6839\u636e\u5f97\u5230\u67d0\u5217\u7684\u4e0d\u540c\u503c\u505a\u51fa\u4e0d\u540c\u81ea\u5b9a\u4e49\u7684\u5c01\u88c5\u884c\u4e3a"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u5c01\u88c5\u89c4\u5219\u53ef\u4ee5\u5c06\u6570\u636e\u5e93\u4e2d\u6bd4\u8f83\u590d\u6742\u7684\u6570\u636e\u7c7b\u578b\u6620\u5c04\u4e3a JavaBean \u4e2d\u7684\u5c5e\u6027"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5d4c\u5957\u67e5\u8be2",children:"\u5d4c\u5957\u67e5\u8be2"}),"\n",(0,i.jsx)(e.p,{children:"\u5b50\u67e5\u8be2\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Blog {\n    private int id;\n    private String msg;\n    private Author author;\n    // set + get\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<resultMap id="blogResult" type="Blog" autoMapping = "true">\n    <association property="author" column="author_id" javaType="Author" select="selectAuthor"/>\n</resultMap>\n\n<select id="selectBlog" resultMap="blogResult">\n    SELECT * FROM BLOG WHERE ID = #{id}\n</select>\n\n<select id="selectAuthor" resultType="Author">\n    SELECT * FROM AUTHOR WHERE ID = #{id}\n</select>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5faa\u73af\u5f15\u7528\uff1a\u901a\u8fc7\u7f13\u5b58\u89e3\u51b3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<resultMap id="blogResult" type="Blog" autoMapping = "true">\n    <id column="id" property="id"/>\n    <collection property="comment" ofType="Comment">\n        <association property="blog" javaType="Blog" resultMap="blogResult"/>\x3c!--y--\x3e\n    </collection>\n</resultMap\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u591a\u8868\u67e5\u8be2",children:"\u591a\u8868\u67e5\u8be2"}),"\n",(0,i.jsx)(e.h4,{id:"\u4e00\u5bf9\u4e00",children:"\u4e00\u5bf9\u4e00"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u5bf9\u4e00\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u51c6\u5907"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-mysql",children:"CREATE TABLE person(\n\tid INT PRIMARY KEY AUTO_INCREMENT,\n\tname VARCHAR(20),\n\tage INT\n);\nINSERT INTO person VALUES (NULL,'\u5f20\u4e09',23),(NULL,'\u674e\u56db',24),(NULL,'\u738b\u4e94',25);\n\nCREATE TABLE card(\n\tid INT PRIMARY KEY AUTO_INCREMENT,\n\tnumber VARCHAR(30),\n\tpid INT,\n\tCONSTRAINT cp_fk FOREIGN KEY (pid) REFERENCES person(id)\n);\nINSERT INTO card VALUES (NULL,'12345',1),(NULL,'23456',2),(NULL,'34567',3);\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"bean \u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Card {\n    private Integer id;     //\u4e3b\u952eid\n    private String number;  //\u8eab\u4efd\u8bc1\u53f7\n    private Person p;       //\u6240\u5c5e\u4eba\u7684\u5bf9\u8c61\n    ......\n}\n\npublic class Person {\n    private Integer id;     //\u4e3b\u952eid\n    private String name;    //\u4eba\u7684\u59d3\u540d\n    private Integer age;    //\u4eba\u7684\u5e74\u9f84\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6587\u4ef6 OneToOneMapper.xml\uff0cMyBatisConfig.xml \u9700\u8981\u5f15\u5165\uff08\u53ef\u4ee5\u628a bean \u5305\u4e0b\u8d77\u522b\u540d\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n\n<mapper namespace="OneToOneMapper">\n\n    \x3c!--\u914d\u7f6e\u5b57\u6bb5\u548c\u5b9e\u4f53\u5bf9\u8c61\u5c5e\u6027\u7684\u6620\u5c04\u5173\u7cfb--\x3e\n    <resultMap id="oneToOne" type="card">\n       \t\x3c!--column \u8868\u4e2d\u5b57\u6bb5\u540d\u79f0\uff0cproperty \u5b9e\u4f53\u5bf9\u8c61\u53d8\u91cf\u540d\u79f0--\x3e\n        <id column="cid" property="id" />\n        <result column="number" property="number" />\n        \x3c!--\n            association\uff1a\u914d\u7f6e\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u6620\u5c04\u5173\u7cfb\n            property\uff1a\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u53d8\u91cf\u540d\n            javaType\uff1a\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u6570\u636e\u7c7b\u578b\n        --\x3e\n        <association property="p" javaType="bean.Person">\n            <id column="pid" property="id" />\n            <result column="name" property="name" />\n            <result column="age" property="age" />\n        </association>\n    </resultMap>\n\n    <select id="selectAll" resultMap="oneToOne"> \x3c!--SQL--\x3e\n        SELECT c.id cid,number,pid,NAME,age FROM card c,person p WHERE c.pid=p.id\n    </select>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6 MyBatisConfig.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!-- mappers\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6 --\x3e\n<mappers>\n    <mapper resource="one_to_one/OneToOneMapper.xml"/>\n    <mapper resource="one_to_many/OneToManyMapper.xml"/>\n    <mapper resource="many_to_many/ManyToManyMapper.xml"/>\n</mappers>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Test01 {\n    @Test\n    public void selectAll() throws Exception{\n        //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n        InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");\n\n        //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n        SqlSessionFactory ssf = new SqlSessionFactoryBuilder().build(is);\n\n        //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n        SqlSession sqlSession = ssf.openSession(true);\n\n        //4.\u83b7\u53d6OneToOneMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\n        OneToOneMapper mapper = sqlSession.getMapper(OneToOneMapper.class);\n\n        //5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\n        List<Card> list = mapper.selectAll();\n\n        //6.\u5904\u7406\u7ed3\u679c\n        for (Card c : list) {\n            System.out.println(c);\n        }\n\n        //7.\u91ca\u653e\u8d44\u6e90\n        sqlSession.close();\n        is.close();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u4e00\u5bf9\u591a",children:"\u4e00\u5bf9\u591a"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u5bf9\u591a\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u51c6\u5907"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-mysql",children:"CREATE TABLE classes(\n\tid INT PRIMARY KEY AUTO_INCREMENT,\n\tname VARCHAR(20)\n);\nINSERT INTO classes VALUES (NULL,'\u7a0b\u5e8f\u4e00\u73ed'),(NULL,'\u7a0b\u5e8f\u4e8c\u73ed')\n\nCREATE TABLE student(\n\tid INT PRIMARY KEY AUTO_INCREMENT,\n\tname VARCHAR(30),\n\tage INT,\n\tcid INT,\n\tCONSTRAINT cs_fk FOREIGN KEY (cid) REFERENCES classes(id)\n);\nINSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,1),(NULL,'\u674e\u56db',24,1),(NULL,'\u738b\u4e94',25,2);\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"bean \u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Classes {\n    private Integer id;     //\u4e3b\u952eid\n    private String name;    //\u73ed\u7ea7\u540d\u79f0\n    private List<Student> students; //\u73ed\u7ea7\u4e2d\u6240\u6709\u5b66\u751f\u5bf9\u8c61\n    ........\n}\npublic class Student {\n    private Integer id;     //\u4e3b\u952eid\n    private String name;    //\u5b66\u751f\u59d3\u540d\n    private Integer age;    //\u5b66\u751f\u5e74\u9f84\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="OneToManyMapper">\n    <resultMap id="oneToMany" type="bean.Classes">\n        <id column="cid" property="id"/>\n        <result column="cname" property="name"/>\n\n        \x3c!--collection\uff1a\u914d\u7f6e\u88ab\u5305\u542b\u7684\u96c6\u5408\u5bf9\u8c61\u6620\u5c04\u5173\u7cfb--\x3e\n        <collection property="students" ofType="bean.Student">\n            <id column="sid" property="id"/>\n            <result column="sname" property="name"/>\n            <result column="sage" property="age"/>\n        </collection>\n    </resultMap>\n    <select id="selectAll" resultMap="oneToMany"> \x3c!--SQL--\x3e\n        SELECT c.id cid,c.name cname,s.id sid,s.name sname,s.age sage FROM classes c,student s WHERE c.id=s.cid\n    </select>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\u7247\u6bb5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//4.\u83b7\u53d6OneToManyMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\nOneToManyMapper mapper = sqlSession.getMapper(OneToManyMapper.class);\n\n//5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\nList<Classes> classes = mapper.selectAll();\n\n//6.\u5904\u7406\u7ed3\u679c\nfor (Classes cls : classes) {\n    System.out.println(cls.getId() + "," + cls.getName());\n    List<Student> students = cls.getStudents();\n    for (Student student : students) {\n        System.out.println("\\t" + student);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u591a\u5bf9\u591a",children:"\u591a\u5bf9\u591a"}),"\n",(0,i.jsx)(e.p,{children:"\u5b66\u751f\u8bfe\u7a0b\u4f8b\u5b50\uff0c\u4e2d\u95f4\u8868\u4e0d\u9700\u8981 bean \u5b9e\u4f53\u7c7b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u51c6\u5907"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-mysql",children:"CREATE TABLE course(\n\tid INT PRIMARY KEY AUTO_INCREMENT,\n\tname VARCHAR(20)\n);\nINSERT INTO course VALUES (NULL,'\u8bed\u6587'),(NULL,'\u6570\u5b66');\n\nCREATE TABLE stu_cr(\n\tid INT PRIMARY KEY AUTO_INCREMENT,\n\tsid INT,\n\tcid INT,\n\tCONSTRAINT sc_fk1 FOREIGN KEY (sid) REFERENCES student(id),\n\tCONSTRAINT sc_fk2 FOREIGN KEY (cid) REFERENCES course(id)\n);\nINSERT INTO stu_cr VALUES (NULL,1,1),(NULL,1,2),(NULL,2,1),(NULL,2,2);\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"bean\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Student {\n    private Integer id;     //\u4e3b\u952eid\n    private String name;    //\u5b66\u751f\u59d3\u540d\n    private Integer age;    //\u5b66\u751f\u5e74\u9f84\n    private List<Course> courses;   // \u5b66\u751f\u6240\u9009\u62e9\u7684\u8bfe\u7a0b\u96c6\u5408\n}\npublic class Course {\n    private Integer id;     //\u4e3b\u952eid\n    private String name;    //\u8bfe\u7a0b\u540d\u79f0\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="ManyToManyMapper">\n    <resultMap id="manyToMany" type="Bean.Student">\n        <id column="sid" property="id"/>\n        <result column="sname" property="name"/>\n        <result column="sage" property="age"/>\n\n        <collection property="courses" ofType="Bean.Course">\n            <id column="cid" property="id"/>\n            <result column="cname" property="name"/>\n        </collection>\n    </resultMap>\n    <select id="selectAll" resultMap="manyToMany"> \x3c!--SQL--\x3e\n        SELECT sc.sid,s.name sname,s.age sage,sc.cid,c.name cname FROM student s,course c,stu_cr sc WHERE sc.sid=s.id AND sc.cid=c.id\n    </select>\n</mapper>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u9274\u522b\u5668",children:"\u9274\u522b\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u9700\u6c42\uff1a\u5982\u679c\u67e5\u8be2\u7ed3\u679c\u662f\u5973\u6027\uff0c\u5219\u628a\u90e8\u95e8\u4fe1\u606f\u67e5\u8be2\u51fa\u6765\uff0c\u5426\u5219\u4e0d\u67e5\u8be2 \uff1b\u5982\u679c\u662f\u7537\u6027\uff0c\u628a last_name \u8fd9\u4e00\u5217\u7684\u503c\u8d4b\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!-- \n    column\uff1a\u6307\u5b9a\u8981\u5224\u65ad\u7684\u5217\u540d \n    javaType\uff1a\u5217\u503c\u5bf9\u5e94\u7684java\u7c7b\u578b\n   --\x3e\n<discriminator javaType="string" column="gender">\n    \x3c!-- \u5973\u751f --\x3e\n    \x3c!-- resultType\u4e0d\u53ef\u7f3a\u5c11\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528resutlMap --\x3e\n    <case value="0" resultType="com.bean.Employee">\n        <association property="dept"\n                     select="com.dao.DepartmentMapper.getDeptById"\n                     column="d_id">\n        </association>\n    </case>\n    \x3c!-- \u7537\u751f --\x3e\n    <case value="1" resultType="com.bean.Employee">\n        <id column="id" property="id"/>\n        <result column="last_name" property="lastName"/>\n        <result column="gender" property="gender"/>\n    </case>\n</discriminator>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5ef6\u8fdf\u52a0\u8f7d",children:"\u5ef6\u8fdf\u52a0\u8f7d"}),"\n",(0,i.jsx)(e.h4,{id:"\u4e24\u79cd\u52a0\u8f7d",children:"\u4e24\u79cd\u52a0\u8f7d"}),"\n",(0,i.jsx)(e.p,{children:"\u7acb\u5373\u52a0\u8f7d\uff1a\u53ea\u8981\u8c03\u7528\u65b9\u6cd5\uff0c\u9a6c\u4e0a\u53d1\u8d77\u67e5\u8be2"}),"\n",(0,i.jsx)(e.p,{children:"\u5ef6\u8fdf\u52a0\u8f7d\uff1a\u5728\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\u624d\u8fdb\u884c\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\u5c31\u4e0d\u52a0\u8f7d\u6570\u636e\uff0c\u5ef6\u8fdf\u52a0\u8f7d\u4e5f\u79f0\u61d2\u52a0\u8f7d"}),"\n",(0,i.jsx)(e.p,{children:"\u4f18\u70b9\uff1a \u5148\u4ece\u5355\u8868\u67e5\u8be2\uff0c\u9700\u8981\u65f6\u518d\u4ece\u5173\u8054\u8868\u53bb\u5173\u8054\u67e5\u8be2\uff0c\u63d0\u9ad8\u6570\u636e\u5e93\u6027\u80fd\uff0c\u56e0\u4e3a\u67e5\u8be2\u5355\u8868\u8981\u6bd4\u5173\u8054\u67e5\u8be2\u591a\u5f20\u8868\u901f\u5ea6\u8981\u5feb\uff0c\u8282\u7701\u8d44\u6e90"}),"\n",(0,i.jsx)(e.p,{children:"\u574f\u5904\uff1a\u53ea\u6709\u5f53\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\uff0c\u624d\u4f1a\u8fdb\u884c\u6570\u636e\u5e93\u67e5\u8be2\uff0c\u8fd9\u6837\u5728\u5927\u6279\u91cf\u6570\u636e\u67e5\u8be2\u65f6\uff0c\u67e5\u8be2\u5de5\u4f5c\u4e5f\u8981\u6d88\u8017\u65f6\u95f4\uff0c\u6240\u4ee5\u53ef\u80fd\u9020\u6210\u7528\u6237\u7b49\u5f85\u65f6\u95f4\u53d8\u957f\uff0c\u9020\u6210\u7528\u6237\u4f53\u9a8c\u4e0b\u964d"}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u6807\u7b7e\u540d"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(e.th,{children:"\u9ed8\u8ba4\u503c"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"lazyLoadingEnabled"}),(0,i.jsxs)(e.td,{children:["\u5ef6\u8fdf\u52a0\u8f7d\u7684\u5168\u5c40\u5f00\u5173\u3002\u5f53\u5f00\u542f\u65f6\uff0c\u6240\u6709\u5173\u8054\u5bf9\u8c61\u90fd\u4f1a\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u7279\u5b9a\u5173\u8054\u5173\u7cfb\u4e2d\u53ef\u901a\u8fc7\u8bbe\u7f6e ",(0,i.jsx)(e.code,{children:"fetchType"})," \u5c5e\u6027\u6765\u8986\u76d6\u8be5\u9879\u7684\u5f00\u5173\u72b6\u6001\u3002"]}),(0,i.jsx)(e.td,{children:"false"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"aggressiveLazyLoading"}),(0,i.jsx)(e.td,{children:"\u5f00\u542f\u65f6\uff0c\u4efb\u4e00\u65b9\u6cd5\u7684\u8c03\u7528\u90fd\u4f1a\u52a0\u8f7d\u8be5\u5bf9\u8c61\u7684\u6240\u6709\u5ef6\u8fdf\u52a0\u8f7d\u5c5e\u6027\u3002\u5426\u5219\u6bcf\u4e2a\u5ef6\u8fdf\u52a0\u8f7d\u5c5e\u6027\u4f1a\u6309\u9700\u52a0\u8f7d\uff08\u53c2\u8003 lazyLoadTriggerMethods\uff09"}),(0,i.jsx)(e.td,{children:"false"})]})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<settings> \n\t<setting name="lazyLoadingEnabled" value="true"/> \n    <setting name="aggressiveLazyLoading" value="false"/> \n</settings>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"assocation",children:"assocation"}),"\n",(0,i.jsx)(e.p,{children:"\u5206\u5e03\u67e5\u8be2\uff1a\u5148\u6309\u7167\u8eab\u4efd id \u67e5\u8be2\u6240\u5c5e\u4eba\u7684 id\u3001\u7136\u540e\u6839\u636e\u6240\u5c5e\u4eba\u7684 id \u53bb\u67e5\u8be2\u4eba\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u8fd9\u5c31\u662f\u5206\u6b65\u67e5\u8be2"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04\u914d\u7f6e\u6587\u4ef6 OneToOneMapper.xml"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u5bf9\u4e00\u6620\u5c04\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"column \u5c5e\u6027\u8868\u793a\u7ed9\u8981\u8c03\u7528\u7684\u5176\u5b83\u7684 select \u6807\u7b7e\u4f20\u5165\u7684\u53c2\u6570"}),"\n",(0,i.jsx)(e.li,{children:"select \u5c5e\u6027\u8868\u793a\u8c03\u7528\u5176\u5b83\u7684 select \u6807\u7b7e"}),"\n",(0,i.jsx)(e.li,{children:'fetchType="lazy" \u8868\u793a\u5ef6\u8fdf\u52a0\u8f7d\uff08\u5c40\u90e8\u914d\u7f6e\uff0c\u53ea\u6709\u914d\u7f6e\u4e86\u8fd9\u4e2a\u7684\u5730\u65b9\u624d\u4f1a\u5ef6\u8fdf\u52a0\u8f7d\uff09'}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="OneToOneMapper">\n    \x3c!--\u914d\u7f6e\u5b57\u6bb5\u548c\u5b9e\u4f53\u5bf9\u8c61\u5c5e\u6027\u7684\u6620\u5c04\u5173\u7cfb--\x3e\n    <resultMap id="oneToOne" type="card">\n        <id column="id" property="id" />\n        <result column="number" property="number" />\n        <association property="p" javaType="bean.Person"\n                     column="pid" \n                     select="one_to_one.PersonMapper.findPersonByid"\n                     fetchType="lazy">\n            \t\t\x3c!--\u9700\u8981\u914d\u7f6e\u65b0\u7684\u6620\u5c04\u6587\u4ef6--\x3e\n        </association>\n    </resultMap>\n\n    <select id="selectAll" resultMap="oneToOne"> \n        SELECT * FROM card \x3c!--\u67e5\u8be2\u5168\u90e8\uff0c\u8d1f\u8d23\u6839\u636e\u6761\u4ef6\u76f4\u63a5\u5168\u90e8\u52a0\u8f7d--\x3e\n    </select>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"PersonMapper.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="one_to_one.PersonMapper">\n    <select id="findPersonByid" parameterType="int" resultType="person">\n        SELECT * FROM person WHERE id=#{pid}\n    </select>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"PersonMapper.java"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface PersonMapper {\n    User findPersonByid(int id);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Test01 {\n    @Test\n    public void selectAll() throws Exception{\n        InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");\n        SqlSessionFactory ssf = new SqlSessionFactoryBuilder().build(is);\n        SqlSession sqlSession = ssf.openSession(true);\n        OneToOneMapper mapper = sqlSession.getMapper(OneToOneMapper.class);\n        // \u8c03\u7528\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\n        List<Card> list = mapper.selectAll();\n        \n      \t// \u4e0d\u80fd\u904d\u5386\uff0c\u904d\u5386\u5c31\u662f\u76f8\u5f53\u4e8e\u4f7f\u7528\u4e86\u8be5\u6570\u636e\uff0c\u9700\u8981\u52a0\u8f7d\uff0c\u4e0d\u904d\u5386\u5c31\u662f\u6ca1\u6709\u4f7f\u7528\u3002\n        \n        // \u91ca\u653e\u8d44\u6e90\n        sqlSession.close();\n        is.close();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"collection",children:"collection"}),"\n",(0,i.jsxs)(e.p,{children:["\u540c\u6837\u5728\u4e00\u5bf9\u591a\u5173\u7cfb\u914d\u7f6e\u7684 ",(0,i.jsxs)(e.collection,{children:[" \u7ed3\u70b9\u4e2d\u914d\u7f6e\u5ef6\u8fdf\u52a0\u8f7d\u7b56\u7565\uff0c",(0,i.jsx)(e.collection,{children:" \u7ed3\u70b9\u4e2d\u4e5f\u6709 select \u5c5e\u6027\u548c column \u5c5e\u6027"})]})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04\u914d\u7f6e\u6587\u4ef6 OneToManyMapper.xml"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u5bf9\u591a\u6620\u5c04\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"column \u662f\u7528\u4e8e\u6307\u5b9a\u4f7f\u7528\u54ea\u4e2a\u5b57\u6bb5\u7684\u503c\u4f5c\u4e3a\u6761\u4ef6\u67e5\u8be2"}),"\n",(0,i.jsx)(e.li,{children:"select \u662f\u7528\u4e8e\u6307\u5b9a\u67e5\u8be2\u8d26\u6237\u7684\u552f\u4e00\u6807\u8bc6\uff08\u8d26\u6237\u7684 dao \u5168\u9650\u5b9a\u7c7b\u540d\u52a0\u4e0a\u65b9\u6cd5\u540d\u79f0\uff09"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="OneToManyMapper">\n    <resultMap id="oneToMany" type="bean.Classes">\n        <id column="id" property="id"/>\n        <result column="name" property="name"/>\n\n        \x3c!--collection\uff1a\u914d\u7f6e\u88ab\u5305\u542b\u7684\u96c6\u5408\u5bf9\u8c61\u6620\u5c04\u5173\u7cfb--\x3e\n        <collection property="students" ofType="bean.Student"\n                    column="id" \n                    select="one_to_one.StudentMapper.findStudentByCid">\n        </collection>\n    </resultMap>\n    <select id="selectAll" resultMap="oneToMany">\n      SELECT * FROM classes\n    </select>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"StudentMapper.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="one_to_one.StudentMapper">\n    <select id="findPersonByCid" parameterType="int" resultType="student">\n        SELECT * FROM person WHERE cid=#{id}\n    </select>\n</mapper>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u6ce8\u89e3\u5f00\u53d1",children:"\u6ce8\u89e3\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h3,{id:"\u5355\u8868\u64cd\u4f5c",children:"\u5355\u8868\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\u53ef\u4ee5\u7b80\u5316\u5f00\u53d1\u64cd\u4f5c\uff0c\u7701\u7565\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u7684\u7f16\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u5e38\u7528\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@Select(\u201c\u67e5\u8be2\u7684 SQL \u8bed\u53e5\u201d)\uff1a\u6267\u884c\u67e5\u8be2\u64cd\u4f5c\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.li,{children:"@Insert(\u201c\u63d2\u5165\u7684 SQL \u8bed\u53e5\u201d)\uff1a\u6267\u884c\u65b0\u589e\u64cd\u4f5c\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.li,{children:"@Update(\u201c\u4fee\u6539\u7684 SQL \u8bed\u53e5\u201d)\uff1a\u6267\u884c\u4fee\u6539\u64cd\u4f5c\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.li,{children:"@Delete(\u201c\u5220\u9664\u7684 SQL \u8bed\u53e5\u201d)\uff1a\u6267\u884c\u5220\u9664\u64cd\u4f5c\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["@Param\uff1a\u5f53 SQL \u8bed\u53e5\u9700\u8981",(0,i.jsx)(e.strong,{children:"\u591a\u4e2a\uff08\u5927\u4e8e1\uff09\u53c2\u6570"}),"\u65f6\uff0c\u7528\u6765\u6307\u5b9a\u53c2\u6570\u7684\u5bf9\u5e94\u89c4\u5219"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u6620\u5c04\u5173\u7cfb\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mappers>\n\t<package name="\u4f7f\u7528\u4e86\u6ce8\u89e3\u7684Mapper\u63a5\u53e3\u6240\u5728\u5305"/>\n</mappers>\n\x3c!--\u6216\u8005--\x3e\n<mappers>\n \t<mapper class="\u5305\u540d.Mapper\u540d"></mapper>\n</mappers>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u589e\u5220\u6539\u67e5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u521b\u5efa Mapper \u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package mapper;\npublic interface StudentMapper {\n    //\u67e5\u8be2\u5168\u90e8\n    @Select("SELECT * FROM student")\n    public abstract List<Student> selectAll();\n\n    //\u65b0\u589e\u6570\u636e\n    @Insert("INSERT INTO student VALUES (#{id},#{name},#{age})")\n    public abstract Integer insert(Student student);\n\n    //\u4fee\u6539\u64cd\u4f5c\n    @Update("UPDATE student SET name=#{name},age=#{age} WHERE id=#{id}")\n    public abstract Integer update(Student student);\n\n    //\u5220\u9664\u64cd\u4f5c\n    @Delete("DELETE FROM student WHERE id=#{id}")\n    public abstract Integer delete(Integer id);\n\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539 MyBatis \u7684\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mappers>\n\t<package name="mapper"/>\n</mappers>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"bean\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Student {\n    private Integer id;\n    private String name;\n    private Integer age;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\npublic void selectAll() throws Exception{\n    //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n    InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");\n\n    //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n    SqlSessionFactory ssf = new SqlSessionFactoryBuilder().build(is);\n\n    //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n    SqlSession sqlSession = ssf.openSession(true);\n\n    //4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\n    StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);\n\n    //5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\n    List<Student> list = mapper.selectAll();\n\n    //6.\u5904\u7406\u7ed3\u679c\n    for (Student student : list) {\n        System.out.println(student);\n    }\n    \n    //7.\u91ca\u653e\u8d44\u6e90\n    sqlSession.close();\n    is.close();\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u591a\u8868\u64cd\u4f5c",children:"\u591a\u8868\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.h4,{id:"\u76f8\u5173\u6ce8\u89e3",children:"\u76f8\u5173\u6ce8\u89e3"}),"\n",(0,i.jsxs)(e.p,{children:["\u5b9e\u73b0\u590d\u6742\u5173\u7cfb\u6620\u5c04\u4e4b\u524d\u6211\u4eec\u53ef\u4ee5\u5728\u6620\u5c04\u6587\u4ef6\u4e2d\u901a\u8fc7\u914d\u7f6e ",(0,i.jsx)(e.resultmap,{children:" \u6765\u5b9e\u73b0\uff0c\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 @Results \u6ce8\u89e3\uff0c@Result \u6ce8\u89e3\uff0c@One \u6ce8\u89e3\uff0c@Many \u6ce8\u89e3\u7ec4\u5408\u5b8c\u6210\u590d\u6742\u5173\u7cfb\u7684\u914d\u7f6e"})]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u6ce8\u89e3"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"@Results"}),(0,i.jsxs)(e.td,{children:["\u4ee3\u66ff ",(0,i.jsxs)(e.resultmap,{children:[" \u6807\u7b7e\uff0c\u6ce8\u89e3\u4e2d\u4f7f\u7528\u5355\u4e2a @Result \u6ce8\u89e3\u6216\u8005 @Result \u96c6\u5408",(0,i.jsx)(e.br,{}),"\u4f7f\u7528\u683c\u5f0f\uff1a@Results({ @Result(), @Result() })\u6216@Results({ @Result() })"]})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"@Result"}),(0,i.jsxs)(e.td,{children:["\u4ee3\u66ff< id> \u548c ",(0,i.jsxs)(e.result,{children:[" \u6807\u7b7e\uff0c@Result \u4e2d\u5c5e\u6027\u4ecb\u7ecd\uff1a",(0,i.jsx)(e.br,{}),"column\uff1a\u6570\u636e\u5e93\u7684\u5217\u540d      property\uff1a\u5c01\u88c5\u7c7b\u7684\u53d8\u91cf\u540d",(0,i.jsx)(e.br,{}),"one\uff1a\u9700\u8981\u4f7f\u7528 @One \u6ce8\u89e3\uff08@Result(one = @One)\uff09",(0,i.jsx)(e.br,{}),"Many\uff1a\u9700\u8981\u4f7f\u7528 @Many \u6ce8\u89e3\uff08@Result(many= @Many)\uff09"]})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"@One(\u4e00\u5bf9\u4e00)"}),(0,i.jsxs)(e.td,{children:["\u4ee3\u66ff ",(0,i.jsxs)(e.association,{children:[" \u6807\u7b7e\uff0c\u591a\u8868\u67e5\u8be2\u7684\u5173\u952e\uff0c\u7528\u6765\u6307\u5b9a\u5b50\u67e5\u8be2\u8fd4\u56de\u5355\u4e00\u5bf9\u8c61",(0,i.jsx)(e.br,{}),"select\uff1a\u6307\u5b9a\u8c03\u7528 Mapper \u63a5\u53e3\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5",(0,i.jsx)(e.br,{}),'\u4f7f\u7528\u683c\u5f0f\uff1a@Result(column="", property="", one=@One(select=""))']})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"@Many(\u591a\u5bf9\u4e00)"}),(0,i.jsxs)(e.td,{children:["\u4ee3\u66ff ",(0,i.jsxs)(e.collection,{children:[" \u6807\u7b7e\uff0c\u591a\u8868\u67e5\u8be2\u7684\u5173\u952e\uff0c\u7528\u6765\u6307\u5b9a\u5b50\u67e5\u8be2\u8fd4\u56de\u5bf9\u8c61\u96c6\u5408",(0,i.jsx)(e.br,{}),"select\uff1a\u6307\u5b9a\u8c03\u7528 Mapper \u63a5\u53e3\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5",(0,i.jsx)(e.br,{}),'\u4f7f\u7528\u683c\u5f0f\uff1a@Result(column="", property="", many=@Many(select=""))']})]})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u4e00\u5bf9\u4e00-1",children:"\u4e00\u5bf9\u4e00"}),"\n",(0,i.jsx)(e.p,{children:"\u8eab\u4efd\u8bc1\u5bf9\u4eba"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"PersonMapper \u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface PersonMapper {\n    //\u6839\u636eid\u67e5\u8be2\n    @Select("SELECT * FROM person WHERE id=#{id}")\n    public abstract Person selectById(Integer id);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"CardMapper\u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface CardMapper {\n    //\u67e5\u8be2\u5168\u90e8\n    @Select("SELECT * FROM card")\n    @Results({\n            @Result(column = "id",property = "id"),\n            @Result(column = "number",property = "number"),\n            @Result(\n                    property = "p",             // \u88ab\u5305\u542b\u5bf9\u8c61\u7684\u53d8\u91cf\u540d\n                    javaType = Person.class,    // \u88ab\u5305\u542b\u5bf9\u8c61\u7684\u5b9e\u9645\u6570\u636e\u7c7b\u578b\n                    column = "pid",  // \u6839\u636e\u67e5\u8be2\u51fa\u7684card\u8868\u4e2d\u7684pid\u5b57\u6bb5\u6765\u67e5\u8be2person\u8868\n                     /* \n                     \tone\u3001@One \u4e00\u5bf9\u4e00\u56fa\u5b9a\u5199\u6cd5\n                        select\u5c5e\u6027\uff1a\u6307\u5b9a\u8c03\u7528\u54ea\u4e2a\u63a5\u53e3\u4e2d\u7684\u54ea\u4e2a\u65b9\u6cd5\n                     */\n                    one = @One(select = "one_to_one.PersonMapper.selectById")\n            )\n    })\n    public abstract List<Card> selectAll();\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b\uff08\u8be6\u7ec6\u4ee3\u7801\u53c2\u8003\u5355\u8868\u64cd\u4f5c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n//2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n//3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n\n//4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\nCardMapper mapper = sqlSession.getMapper(CardMapper.class);\n//5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\nList<Card> list = mapper.selectAll();\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u4e00\u5bf9\u591a-1",children:"\u4e00\u5bf9\u591a"}),"\n",(0,i.jsx)(e.p,{children:"\u73ed\u7ea7\u548c\u5b66\u751f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"StudentMapper\u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface StudentMapper {\n    //\u6839\u636ecid\u67e5\u8be2student\u8868  cid\u662f\u5916\u952e\u7ea6\u675f\u5217\n    @Select("SELECT * FROM student WHERE cid=#{cid}")\n    public abstract List<Student> selectByCid(Integer cid);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ClassesMapper\u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface ClassesMapper {\n    //\u67e5\u8be2\u5168\u90e8\n    @Select("SELECT * FROM classes")\n    @Results({\n            @Result(column = "id", property = "id"),\n            @Result(column = "name", property = "name"),\n            @Result(\n                    property = "students",  //\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u53d8\u91cf\u540d\n                    javaType = List.class,  //\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u5b9e\u9645\u6570\u636e\u7c7b\u578b\n                    column = "id",          //\u6839\u636eid\u5b57\u6bb5\u67e5\u8be2student\u8868\n                    many = @Many(select = "one_to_many.StudentMapper.selectByCid")\n            )\n    })\n    public abstract List<Classes> selectAll();\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\nClassesMapper mapper = sqlSession.getMapper(ClassesMapper.class);\n//5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\nList<Classes> classes = mapper.selectAll();\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u591a\u5bf9\u591a-1",children:"\u591a\u5bf9\u591a"}),"\n",(0,i.jsx)(e.p,{children:"\u5b66\u751f\u548c\u8bfe\u7a0b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"SQL \u67e5\u8be2\u8bed\u53e5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-mysql",children:"SELECT DISTINCT s.id,s.name,s.age FROM student s,stu_cr sc WHERE sc.sid=s.id\nSELECT c.id,c.name FROM stu_cr sc,course c WHERE sc.cid=c.id AND sc.sid=#{id}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"CourseMapper \u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface CourseMapper {\n    //\u6839\u636e\u5b66\u751fid\u67e5\u8be2\u6240\u9009\u8bfe\u7a0b\n    @Select("SELECT c.id,c.name FROM stu_cr sc,course c WHERE sc.cid=c.id AND sc.sid=#{id}")\n    public abstract List<Course> selectBySid(Integer id);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"StudentMapper \u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface StudentMapper {\n    //\u67e5\u8be2\u5168\u90e8\n    @Select("SELECT DISTINCT s.id,s.name,s.age FROM student s,stu_cr sc WHERE sc.sid=s.id")\n    @Results({\n            @Result(column = "id",property = "id"),\n            @Result(column = "name",property = "name"),\n            @Result(column = "age",property = "age"),\n            @Result(\n                    property = "courses",    //\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u53d8\u91cf\u540d\n                    javaType = List.class,  //\u88ab\u5305\u542b\u5bf9\u8c61\u7684\u5b9e\u9645\u6570\u636e\u7c7b\u578b\n                    column = "id", //\u6839\u636e\u67e5\u8be2\u51fa\u7684student\u8868\u4e2d\u7684id\u5b57\u6bb5\u67e5\u8be2\u4e2d\u95f4\u8868\u548c\u8bfe\u7a0b\u8868\n                    many = @Many(select = "many_to_many.CourseMapper.selectBySid")\n            )\n    })\n    public abstract List<Student> selectAll();\n}\n\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\nStudentMapper mapper = sqlSession.getMapper(StudentMapper.class);\n//5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\nList<Student> students = mapper.selectAll();\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u7f13\u5b58\u673a\u5236",children:"\u7f13\u5b58\u673a\u5236"}),"\n",(0,i.jsx)(e.h3,{id:"\u7f13\u5b58\u6982\u8ff0",children:"\u7f13\u5b58\u6982\u8ff0"}),"\n",(0,i.jsx)(e.p,{children:"\u7f13\u5b58\uff1a\u7f13\u5b58\u5c31\u662f\u4e00\u5757\u5185\u5b58\u7a7a\u95f4\uff0c\u4fdd\u5b58\u4e34\u65f6\u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5c06\u6570\u636e\u6e90\uff08\u6570\u636e\u5e93\u6216\u8005\u6587\u4ef6\uff09\u4e2d\u7684\u6570\u636e\u8bfb\u53d6\u51fa\u6765\u5b58\u653e\u5230\u7f13\u5b58\u4e2d\uff0c\u518d\u6b21\u83b7\u53d6\u65f6\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\uff0c\u53ef\u4ee5\u51cf\u5c11\u548c\u6570\u636e\u5e93\u4ea4\u4e92\u7684\u6b21\u6570\uff0c\u63d0\u5347\u7a0b\u5e8f\u7684\u6027\u80fd"}),"\n",(0,i.jsx)(e.p,{children:"\u7f13\u5b58\u9002\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9002\u7528\u4e8e\u7f13\u5b58\u7684\uff1a\u7ecf\u5e38\u67e5\u8be2\u4f46\u4e0d\u7ecf\u5e38\u4fee\u6539\u7684\uff0c\u6570\u636e\u7684\u6b63\u786e\u4e0e\u5426\u5bf9\u6700\u7ec8\u7ed3\u679c\u5f71\u54cd\u4e0d\u5927\u7684"}),"\n",(0,i.jsx)(e.li,{children:"\u4e0d\u9002\u7528\u7f13\u5b58\u7684\uff1a\u7ecf\u5e38\u6539\u53d8\u7684\u6570\u636e , \u654f\u611f\u6570\u636e\uff08\u4f8b\u5982\uff1a\u80a1\u5e02\u7684\u724c\u4ef7\uff0c\u94f6\u884c\u7684\u6c47\u7387\uff0c\u94f6\u884c\u5361\u91cc\u9762\u7684\u94b1\uff09\u7b49\u7b49"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7f13\u5b58\u7c7b\u522b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e00\u7ea7\u7f13\u5b58\uff1aSqlSession \u7ea7\u522b\u7684\u7f13\u5b58\uff0c\u53c8\u53eb\u672c\u5730\u4f1a\u8bdd\u7f13\u5b58\uff0c\u81ea\u5e26\u7684\uff08\u4e0d\u9700\u8981\u914d\u7f6e\uff09\uff0c\u4e00\u7ea7\u7f13\u5b58\u7684\u751f\u547d\u5468\u671f\u4e0e SqlSession \u4e00\u81f4\u3002\u5728\u64cd\u4f5c\u6570\u636e\u5e93\u65f6\u9700\u8981\u6784\u9020 SqlSession \u5bf9\u8c61\uff0c",(0,i.jsx)(e.strong,{children:"\u5728\u5bf9\u8c61\u4e2d\u6709\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08HashMap\uff09\u7528\u4e8e\u5b58\u50a8\u7f13\u5b58\u6570\u636e"}),"\uff0c\u4e0d\u540c\u7684 SqlSession \u4e4b\u95f4\u7684\u7f13\u5b58\u6570\u636e\u533a\u57df\u662f\u4e92\u76f8\u4e0d\u5f71\u54cd\u7684"]}),"\n",(0,i.jsx)(e.li,{children:"\u4e8c\u7ea7\u7f13\u5b58\uff1amapper\uff08namespace\uff09\u7ea7\u522b\u7684\u7f13\u5b58\uff0c\u4e8c\u7ea7\u7f13\u5b58\u7684\u4f7f\u7528\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\uff08\u9700\u8981\u914d\u7f6e\uff09\u3002\u591a\u4e2a SqlSession \u53bb\u64cd\u4f5c\u540c\u4e00\u4e2a Mapper \u7684 SQL \u53ef\u4ee5\u5171\u7528\u4e8c\u7ea7\u7f13\u5b58\uff0c\u4e8c\u7ea7\u7f13\u5b58\u662f\u8de8 SqlSession \u7684"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5f00\u542f\u7f13\u5b58\uff1a\u914d\u7f6e\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d ",(0,i.jsx)(e.settings,{children:" \u6807\u7b7e"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"cacheEnabled\uff1atrue \u8868\u793a\u5168\u5c40\u6027\u5730\u5f00\u542f\u6240\u6709\u6620\u5c04\u5668\u914d\u7f6e\u6587\u4ef6\u4e2d\u5df2\u914d\u7f6e\u7684\u4efb\u4f55\u7f13\u5b58\uff0c\u9ed8\u8ba4 true"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(16664).A+"",width:"1096",height:"770"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,i.jsx)(e.a,{href:"https://www.cnblogs.com/ysocean/p/7342498.html",children:"https://www.cnblogs.com/ysocean/p/7342498.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u4e00\u7ea7\u7f13\u5b58",children:"\u4e00\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u7ea7\u7f13\u5b58\u662f SqlSession \u7ea7\u522b\u7684\u7f13\u5b58"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(41101).A+"",width:"630",height:"346"})}),"\n",(0,i.jsx)(e.p,{children:"\u5de5\u4f5c\u6d41\u7a0b\uff1a\u7b2c\u4e00\u6b21\u53d1\u8d77\u67e5\u8be2\u7528\u6237 id \u4e3a 1 \u7684\u7528\u6237\u4fe1\u606f\uff0c\u5148\u53bb\u627e\u7f13\u5b58\u4e2d\u662f\u5426\u6709 id \u4e3a 1 \u7684\u7528\u6237\u4fe1\u606f\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u4ece\u6570\u636e\u5e93\u67e5\u8be2\u7528\u6237\u4fe1\u606f\uff0c\u5f97\u5230\u7528\u6237\u4fe1\u606f\uff0c\u5c06\u7528\u6237\u4fe1\u606f\u5b58\u50a8\u5230\u4e00\u7ea7\u7f13\u5b58\u4e2d\uff1b\u7b2c\u4e8c\u6b21\u53d1\u8d77\u67e5\u8be2\u7528\u6237 id \u4e3a 1 \u7684\u7528\u6237\u4fe1\u606f\uff0c\u5148\u53bb\u627e\u7f13\u5b58\u4e2d\u662f\u5426\u6709 id \u4e3a 1 \u7684\u7528\u6237\u4fe1\u606f\uff0c\u7f13\u5b58\u4e2d\u6709\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u7ea7\u7f13\u5b58\u7684\u5931\u6548\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"SqlSession \u4e0d\u540c"}),"\n",(0,i.jsx)(e.li,{children:"SqlSession \u76f8\u540c\uff0c\u67e5\u8be2\u6761\u4ef6\u4e0d\u540c\u65f6\uff08\u8fd8\u672a\u7f13\u5b58\u8be5\u6570\u636e\uff09"}),"\n",(0,i.jsxs)(e.li,{children:["SqlSession \u76f8\u540c\uff0c\u624b\u52a8\u6e05\u9664\u4e86\u4e00\u7ea7\u7f13\u5b58\uff0c\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"sqlSession.clearCache()"})]}),"\n",(0,i.jsxs)(e.li,{children:["SqlSession \u76f8\u540c\uff0c\u6267\u884c commit \u64cd\u4f5c\u6216\u8005\u6267\u884c\u63d2\u5165\u3001\u66f4\u65b0\u3001\u5220\u9664\uff0c\u6e05\u7a7a SqlSession \u4e2d\u7684\u4e00\u7ea7\u7f13\u5b58\uff0c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u4e3a\u4e86\u8ba9\u7f13\u5b58\u4e2d\u5b58\u50a8\u7684\u662f\u6700\u65b0\u7684\u4fe1\u606f\uff0c",(0,i.jsx)(e.strong,{children:"\u907f\u514d\u810f\u8bfb"})]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Spring \u6574\u5408 MyBatis \u540e\uff0c\u4e00\u7ea7\u7f13\u5b58\u4f5c\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u672a\u5f00\u542f\u4e8b\u52a1\u7684\u60c5\u51b5\uff0c\u6bcf\u6b21\u67e5\u8be2 Spring \u90fd\u4f1a\u521b\u5efa\u65b0\u7684 SqlSession\uff0c\u56e0\u6b64\u4e00\u7ea7\u7f13\u5b58\u5931\u6548"}),"\n",(0,i.jsx)(e.li,{children:"\u5f00\u542f\u4e8b\u52a1\u7684\u60c5\u51b5\uff0cSpring \u4f7f\u7528 ThreadLocal \u83b7\u53d6\u5f53\u524d\u8d44\u6e90\u7ed1\u5b9a\u540c\u4e00\u4e2a SqlSession\uff0c\u56e0\u6b64\u6b64\u65f6\u4e00\u7ea7\u7f13\u5b58\u662f\u6709\u6548\u7684"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u4e00\u7ea7\u7f13\u5b58\u5b58\u5728"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void testFirstLevelCache(){\n    //1. \u83b7\u53d6sqlSession\u5bf9\u8c61\n    SqlSession sqlSession = SqlSessionFactoryUtils.openSession();\n    //2. \u901a\u8fc7sqlSession\u5bf9\u8c61\u83b7\u53d6UserDao\u63a5\u53e3\u7684\u4ee3\u7406\u5bf9\u8c61\n    UserDao userDao1 = sqlSession.getMapper(UserDao.class);\n    //3. \u8c03\u7528UserDao\u63a5\u53e3\u7684\u4ee3\u7406\u5bf9\u8c61\u7684findById\u65b9\u6cd5\u83b7\u53d6\u4fe1\u606f\n\tUser user1 = userDao1.findById(1);\n\tSystem.out.println(user1);\n    \n    //sqlSession.clearCache() \u6e05\u7a7a\u7f13\u5b58\n    \n   \tUserDao userDao2 = sqlSession.getMapper(UserDao.class);\n    User user = userDao.findById(1);\n    System.out.println(user2);\n    \n    //4.\u6d4b\u8bd5\u4e24\u6b21\u7ed3\u679c\u662f\u5426\u4e00\u6837\n    System.out.println(user1 == user2);//true\n    \n    //5. \u63d0\u4ea4\u4e8b\u52a1\u5173\u95ed\u8d44\u6e90\n    SqlSessionFactoryUtils.commitAndClose(sqlSession);\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u4e8c\u7ea7\u7f13\u5b58",children:"\u4e8c\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-1",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"\u4e8c\u7ea7\u7f13\u5b58\u662f mapper \u7684\u7f13\u5b58\uff0c\u53ea\u8981\u662f\u540c\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff08namespace\uff09\u7684 SqlSession \u5c31\u5171\u4eab\u4e8c\u7ea7\u7f13\u5b58\u7684\u5185\u5bb9\uff0c\u5e76\u4e14\u53ef\u4ee5\u64cd\u4f5c\u4e8c\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4f5c\u7528\u8303\u56f4\u662f\u6574\u4e2a\u5e94\u7528\uff0c\u53ef\u4ee5\u8de8\u7ebf\u7a0b\u4f7f\u7528\uff0c\u9002\u5408\u7f13\u5b58\u4e00\u4e9b\u4fee\u6539\u8f83\u5c11\u7684\u6570\u636e"}),"\n",(0,i.jsxs)(e.p,{children:["\u5de5\u4f5c\u6d41\u7a0b\uff1a\u4e00\u4e2a\u4f1a\u8bdd\u67e5\u8be2\u6570\u636e\uff0c\u8fd9\u4e2a\u6570\u636e\u5c31\u4f1a\u88ab\u653e\u5728\u5f53\u524d\u4f1a\u8bdd\u7684\u4e00\u7ea7\u7f13\u5b58\u4e2d\uff0c\u5982\u679c",(0,i.jsx)(e.strong,{children:"\u4f1a\u8bdd\u5173\u95ed\u6216\u63d0\u4ea4"}),"\u4e00\u7ea7\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u4f1a\u4fdd\u5b58\u5230\u4e8c\u7ea7\u7f13\u5b58"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e8c\u7ea7\u7f13\u5b58\u7684\u57fa\u672c\u4f7f\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5728 MyBatisConfig.xml \u6587\u4ef6\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c",(0,i.jsx)(e.strong,{children:"cacheEnabled \u9ed8\u8ba4\u503c\u4e3a true"}),"\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7701\u7565\u4e0d\u914d\u7f6e"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u914d\u7f6e\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58--\x3e\n<settings>\n    <setting name="cacheEnabled" value="true"/>\n</settings>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e Mapper \u6620\u5c04\u6587\u4ef6"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"<cache>"})," \u6807\u7b7e\u8868\u793a\u5f53\u524d\u8fd9\u4e2a mapper \u6620\u5c04\u5c06\u4f7f\u7528\u4e8c\u7ea7\u7f13\u5b58\uff0c\u533a\u5206\u7684\u6807\u51c6\u5c31\u770b mapper \u7684 namespace \u503c"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="dao.UserDao">\n    \x3c!--\u5f00\u542fuser\u652f\u6301\u4e8c\u7ea7\u7f13\u5b58--\x3e\n   \t<cache eviction="FIFO" flushInterval="6000" readOnly="" size="1024"/>\n\t<cache></cache> \x3c!--\u5219\u8868\u793a\u6240\u6709\u5c5e\u6027\u4f7f\u7528\u9ed8\u8ba4\u503c--\x3e\n</mapper>\n'})}),"\n",(0,i.jsx)(e.p,{children:"eviction\uff08\u6e05\u9664\u7b56\u7565\uff09\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"LRU"})," \u2013 \u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff1a\u79fb\u9664\u6700\u957f\u65f6\u95f4\u4e0d\u88ab\u4f7f\u7528\u7684\u5bf9\u8c61\uff0c\u9ed8\u8ba4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"FIFO"})," \u2013 \u5148\u8fdb\u5148\u51fa\uff1a\u6309\u5bf9\u8c61\u8fdb\u5165\u7f13\u5b58\u7684\u987a\u5e8f\u6765\u79fb\u9664\u5b83\u4eec"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SOFT"})," \u2013 \u8f6f\u5f15\u7528\uff1a\u57fa\u4e8e\u5783\u573e\u56de\u6536\u5668\u72b6\u6001\u548c\u8f6f\u5f15\u7528\u89c4\u5219\u79fb\u9664\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"WEAK"})," \u2013 \u5f31\u5f15\u7528\uff1a\u66f4\u79ef\u6781\u5730\u57fa\u4e8e\u5783\u573e\u6536\u96c6\u5668\u72b6\u6001\u548c\u5f31\u5f15\u7528\u89c4\u5219\u79fb\u9664\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"flushInterval\uff08\u5237\u65b0\u95f4\u9694\uff09\uff1a\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4efb\u610f\u7684\u6b63\u6574\u6570\uff0c \u9ed8\u8ba4\u60c5\u51b5\u662f\u4e0d\u8bbe\u7f6e\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u5237\u65b0\u95f4\u9694\uff0c\u7f13\u5b58\u4ec5\u4ec5\u4f1a\u5728\u8c03\u7528\u8bed\u53e5\u65f6\u5237\u65b0"}),"\n",(0,i.jsx)(e.p,{children:"size\uff08\u5f15\u7528\u6570\u76ee\uff09\uff1a\u7f13\u5b58\u5b58\u653e\u591a\u5c11\u5143\u7d20\uff0c\u9ed8\u8ba4\u503c\u662f 1024"}),"\n",(0,i.jsx)(e.p,{children:"readOnly\uff08\u53ea\u8bfb\uff09\uff1a\u53ef\u4ee5\u88ab\u8bbe\u7f6e\u4e3a true \u6216 false"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53ea\u8bfb\u7684\u7f13\u5b58\u4f1a\u7ed9\u6240\u6709\u8c03\u7528\u8005\u8fd4\u56de\u7f13\u5b58\u5bf9\u8c61\u7684\u76f8\u540c\u5b9e\u4f8b\uff0c\u56e0\u6b64\u8fd9\u4e9b\u5bf9\u8c61\u4e0d\u80fd\u88ab\u4fee\u6539\uff0c\u4fc3\u8fdb\u4e86\u6027\u80fd\u63d0\u5347"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u8bfb\u5199\u7684\u7f13\u5b58\u4f1a\uff08\u901a\u8fc7\u5e8f\u5217\u5316\uff09\u8fd4\u56de\u7f13\u5b58\u5bf9\u8c61\u7684\u62f7\u8d1d\uff0c \u901f\u5ea6\u4e0a\u4f1a\u6162\u4e00\u4e9b\uff0c\u4f46\u662f\u66f4\u5b89\u5168\uff0c\u56e0\u6b64\u9ed8\u8ba4\u503c\u662f false"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"type\uff1a\u6307\u5b9a\u81ea\u5b9a\u4e49\u7f13\u5b58\u7684\u5168\u7c7b\u540d\uff0c\u5b9e\u73b0 Cache \u63a5\u53e3\u5373\u53ef"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8981\u8fdb\u884c\u4e8c\u7ea7\u7f13\u5b58\u7684\u7c7b\u5fc5\u987b\u5b9e\u73b0 java.io.Serializable \u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7528\u5e8f\u5217\u5316\u65b9\u5f0f\u6765\u4fdd\u5b58\u5bf9\u8c61\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User implements Serializable{}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u76f8\u5173\u5c5e\u6027",children:"\u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"select \u6807\u7b7e\u7684 useCache \u5c5e\u6027"}),"\n",(0,i.jsxs)(e.p,{children:["\u6620\u5c04\u6587\u4ef6\u4e2d\u7684 ",(0,i.jsx)(e.code,{children:"<select>"})," \u6807\u7b7e\u4e2d\u8bbe\u7f6e ",(0,i.jsx)(e.code,{children:'useCache="true"'})," \u4ee3\u8868\u5f53\u524d statement \u8981\u4f7f\u7528\u4e8c\u7ea7\u7f13\u5b58\uff08\u9ed8\u8ba4\uff09"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5982\u679c\u6bcf\u6b21\u67e5\u8be2\u90fd\u9700\u8981\u6700\u65b0\u7684\u6570\u636e sql\uff0c\u8981\u8bbe\u7f6e\u6210 useCache=false\uff0c\u7981\u7528\u4e8c\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<select id="findAll" resultType="user" useCache="true">\n    select * from user\n</select>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6bcf\u4e2a\u589e\u5220\u6539\u6807\u7b7e\u90fd\u6709 flushCache \u5c5e\u6027\uff0c\u9ed8\u8ba4\u4e3a true\uff0c\u4ee3\u8868\u5728",(0,i.jsx)(e.strong,{children:"\u6267\u884c\u589e\u5220\u6539\u4e4b\u540e\u5c31\u4f1a\u6e05\u9664\u4e00\u3001\u4e8c\u7ea7\u7f13\u5b58"}),"\uff0c\u4fdd\u8bc1\u7f13\u5b58\u7684\u4e00\u81f4\u6027\uff1b\u800c\u67e5\u8be2\u6807\u7b7e\u9ed8\u8ba4\u503c\u4e3a false\uff0c\u6240\u4ee5\u67e5\u8be2\u4e0d\u4f1a\u6e05\u7a7a\u7f13\u5b58"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["localCacheScope\uff1a\u672c\u5730\u7f13\u5b58\u4f5c\u7528\u57df\uff0c",(0,i.jsx)(e.settings,{children:" \u4e2d\u7684\u914d\u7f6e\u9879\uff0c\u9ed8\u8ba4\u503c\u4e3a SESSION\uff0c\u5f53\u524d\u4f1a\u8bdd\u7684\u6240\u6709\u6570\u636e\u4fdd\u5b58\u5728\u4f1a\u8bdd\u7f13\u5b58\u4e2d\uff0c\u8bbe\u7f6e\u4e3a STATEMENT \u7981\u7528\u4e00\u7ea7\u7f13\u5b58"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6e90\u7801\u89e3\u6790",children:"\u6e90\u7801\u89e3\u6790"}),"\n",(0,i.jsxs)(e.p,{children:["\u4e8b\u52a1\u63d0\u4ea4\u4e8c\u7ea7\u7f13\u5b58\u624d\u751f\u6548\uff1aDefaultSqlSession \u8c03\u7528 commit() \u65f6\u4f1a\u56de\u8c03 ",(0,i.jsx)(e.code,{children:"executor.commit()"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"CachingExecutor#query()\uff1a\u6267\u884c\u67e5\u8be2\u65b9\u6cd5\uff0c\u67e5\u8be2\u51fa\u7684\u6570\u636e\u4f1a\u5148\u653e\u5165 entriesToAddOnCommit \u96c6\u5408\u6682\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u4ece\u4e8c\u7f13\u5b58\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u83b7\u53d6\u4e0d\u5230\u53bb\u4e00\u7ea7\u7f13\u5b58\u83b7\u53d6\nList<E> list = (List<E>) tcm.getObject(cache, key);\nif (list == null) {\n    // \u56de\u8c03 BaseExecutor#query\n    list = delegate.query(ms, parameterObject, rowBounds, resultHandler, key, boundSql);\n    // \u5c06\u6570\u636e\u653e\u5165 entriesToAddOnCommit \u96c6\u5408\u6682\u5b58\uff0c\u6b64\u65f6\u8fd8\u6ca1\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58\n    tcm.putObject(cache, key, list);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["commit()\uff1a\u4e8b\u52a1\u63d0\u4ea4\uff0c",(0,i.jsx)(e.strong,{children:"\u6e05\u7a7a\u4e00\u7ea7\u7f13\u5b58\uff0c\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58"}),"\uff0c\u4e8c\u7ea7\u7f13\u5b58\u4f7f\u7528 TransactionalCacheManager\uff08tcm\uff09\u7ba1\u7406"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void commit(boolean required) throws SQLException {\n    // \u9996\u5148\u8c03\u7528 BaseExecutor#commit \u65b9\u6cd5\uff0c\u3010\u6e05\u7a7a\u4e00\u7ea7\u7f13\u5b58\u3011\n    delegate.commit(required);\n    tcm.commit();\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"TransactionalCacheManager#commit\uff1a\u67e5\u8be2\u51fa\u7684\u6570\u636e\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void commit() {\n    // \u83b7\u53d6\u6240\u6709\u7684\u7f13\u5b58\u4e8b\u52a1\uff0c\u6328\u7740\u8fdb\u884c\u63d0\u4ea4\n    for (TransactionalCache txCache : transactionalCaches.values()) {\n        txCache.commit();\n    }\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void commit() {\n    if (clearOnCommit) {\n        delegate.clear();\n    }\n    // \u5c06 entriesToAddOnCommit \u4e2d\u7684\u6570\u636e\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58\n    flushPendingEntries();\n    // \u6e05\u7a7a\u76f8\u5173\u96c6\u5408\n    reset();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private void flushPendingEntries() {\n    for (Map.Entry<Object, Object> entry : entriesToAddOnCommit.entrySet()) {\n        // \u5c06\u6570\u636e\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58\n        delegate.putObject(entry.getKey(), entry.getValue());\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u589e\u5220\u6539\u64cd\u4f5c\u4f1a\u6e05\u7a7a\u7f13\u5b58\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"update()\uff1aCachingExecutor \u7684\u66f4\u65b0\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public int update(MappedStatement ms, Object parameterObject) throws SQLException {\n    flushCacheIfRequired(ms);\n    // \u56de\u8c03 BaseExecutor#update \u65b9\u6cd5\uff0c\u4e5f\u4f1a\u6e05\u7a7a\u4e00\u7ea7\u7f13\u5b58\n    return delegate.update(ms, parameterObject);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"flushCacheIfRequired()\uff1a\u5224\u65ad\u662f\u5426\u9700\u8981\u6e05\u7a7a\u4e8c\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private void flushCacheIfRequired(MappedStatement ms) {\n    Cache cache = ms.getCache();\n    // \u5224\u65ad\u4e8c\u7ea7\u7f13\u5b58\u662f\u5426\u5b58\u5728\uff0c\u7136\u540e\u5224\u65ad\u6807\u7b7e\u7684 flushCache \u7684\u503c\uff0c\u589e\u5220\u6539\u64cd\u4f5c\u7684 flushCache \u5c5e\u6027\u9ed8\u8ba4\u4e3a true\n    if (cache != null && ms.isFlushCacheRequired()) {\n        // \u6e05\u7a7a\u4e8c\u7ea7\u7f13\u5b58\n        tcm.clear(cache);\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49",children:"\u81ea\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u7f13\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<cache type="com.domain.something.MyCustomCache"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"type \u5c5e\u6027\u6307\u5b9a\u7684\u7c7b\u5fc5\u987b\u5b9e\u73b0 org.apache.ibatis.cache.Cache \u63a5\u53e3\uff0c\u4e14\u63d0\u4f9b\u4e00\u4e2a\u63a5\u53d7 String \u53c2\u6570\u4f5c\u4e3a id \u7684\u6784\u9020\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface Cache {\n  String getId();\n  int getSize();\n  void putObject(Object key, Object value);\n  Object getObject(Object key);\n  boolean hasKey(Object key);\n  Object removeObject(Object key);\n  void clear();\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u7f13\u5b58\u7684\u914d\u7f6e\uff0c\u53ea\u9700\u8981\u5728\u7f13\u5b58\u5b9e\u73b0\u4e2d\u6dfb\u52a0\u516c\u6709\u7684 JavaBean \u5c5e\u6027\uff0c\u7136\u540e\u901a\u8fc7 cache \u5143\u7d20\u4f20\u9012\u5c5e\u6027\u503c\uff0c\u4f8b\u5982\u5728\u7f13\u5b58\u5b9e\u73b0\u4e0a\u8c03\u7528\u4e00\u4e2a\u540d\u4e3a ",(0,i.jsx)(e.code,{children:"setCacheFile(String file)"})," \u7684\u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<cache type="com.domain.something.MyCustomCache">\n  <property name="cacheFile" value="/tmp/my-custom-cache.tmp"/>\n</cache>\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53ef\u4ee5\u4f7f\u7528\u6240\u6709\u7b80\u5355\u7c7b\u578b\u4f5c\u4e3a JavaBean \u5c5e\u6027\u7684\u7c7b\u578b\uff0cMyBatis \u4f1a\u8fdb\u884c\u8f6c\u6362\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u53ef\u4ee5\u4f7f\u7528\u5360\u4f4d\u7b26\uff08\u5982 ",(0,i.jsx)(e.code,{children:"${cache.file}"}),"\uff09\uff0c\u4ee5\u4fbf\u66ff\u6362\u6210\u5728\u914d\u7f6e\u6587\u4ef6\u5c5e\u6027\u4e2d\u5b9a\u4e49\u7684\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["MyBatis \u652f\u6301\u5728\u6240\u6709\u5c5e\u6027\u8bbe\u7f6e\u5b8c\u6bd5\u4e4b\u540e\uff0c\u8c03\u7528\u4e00\u4e2a\u521d\u59cb\u5316\u65b9\u6cd5\uff0c \u5982\u679c\u60f3\u8981\u4f7f\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u53ef\u4ee5\u5728\u81ea\u5b9a\u4e49\u7f13\u5b58\u7c7b\u91cc\u5b9e\u73b0 ",(0,i.jsx)(e.code,{children:"org.apache.ibatis.builder.InitializingObject"})," \u63a5\u53e3"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface InitializingObject {\n  void initialize() throws Exception;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5bf9\u7f13\u5b58\u7684\u914d\u7f6e\uff08\u5982\u6e05\u9664\u7b56\u7565\u3001\u53ef\u8bfb\u6216\u53ef\u8bfb\u5199\u7b49\uff09\uff0c\u4e0d\u80fd\u5e94\u7528\u4e8e\u81ea\u5b9a\u4e49\u7f13\u5b58"}),"\n",(0,i.jsx)(e.p,{children:"\u5bf9\u67d0\u4e00\u547d\u540d\u7a7a\u95f4\u7684\u8bed\u53e5\uff0c\u53ea\u4f1a\u4f7f\u7528\u8be5\u547d\u540d\u7a7a\u95f4\u7684\u7f13\u5b58\u8fdb\u884c\u7f13\u5b58\u6216\u5237\u65b0\uff0c\u5728\u591a\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u5171\u4eab\u76f8\u540c\u7684\u7f13\u5b58\u914d\u7f6e\u548c\u5b9e\u4f8b\uff0c\u53ef\u4ee5\u4f7f\u7528 cache-ref \u5143\u7d20\u6765\u5f15\u7528\u53e6\u4e00\u4e2a\u7f13\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<cache-ref namespace="com.someone.application.data.SomeMapper"/>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u6784\u9020\u8bed\u53e5",children:"\u6784\u9020\u8bed\u53e5"}),"\n",(0,i.jsx)(e.h3,{id:"\u52a8\u6001-sql",children:"\u52a8\u6001 SQL"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-2",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"\u52a8\u6001 SQL \u662f MyBatis \u5f3a\u5927\u7279\u6027\u4e4b\u4e00\uff0c\u903b\u8f91\u590d\u6742\u65f6\uff0cMyBatis \u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0cSQL \u662f\u52a8\u6001\u53d8\u5316\u7684\uff0c\u6240\u4ee5\u5f15\u5165\u52a8\u6001 SQL \u7b80\u5316\u62fc\u88c5 SQL \u7684\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"DynamicSQL \u5305\u542b\u7684\u6807\u7b7e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"if"}),"\n",(0,i.jsx)(e.li,{children:"where"}),"\n",(0,i.jsx)(e.li,{children:"set"}),"\n",(0,i.jsx)(e.li,{children:"choose (when\u3001otherwise)"}),"\n",(0,i.jsx)(e.li,{children:"trim"}),"\n",(0,i.jsx)(e.li,{children:"foreach"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5404\u4e2a\u6807\u7b7e\u90fd\u53ef\u4ee5\u8fdb\u884c\u7075\u6d3b\u5d4c\u5957\u548c\u7ec4\u5408"}),"\n",(0,i.jsx)(e.p,{children:"OGNL\uff1aObject Graphic Navigation Language\uff08\u5bf9\u8c61\u56fe\u5bfc\u822a\u8bed\u8a00\uff09\uff0c\u7528\u4e8e\u5bf9\u6570\u636e\u8fdb\u884c\u8bbf\u95ee"}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,i.jsx)(e.a,{href:"https://www.cnblogs.com/ysocean/p/7289529.html",children:"https://www.cnblogs.com/ysocean/p/7289529.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"where",children:"where"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.where,{children:"\uff1a\u6761\u4ef6\u6807\u7b7e\uff0c\u6709\u52a8\u6001\u6761\u4ef6\u5219\u4f7f\u7528\u8be5\u6807\u7b7e\u4ee3\u66ff WHERE \u5173\u952e\u5b57\uff0c\u5c01\u88c5\u67e5\u8be2\u6761\u4ef6"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5982\u679c\u6807\u7b7e\u8fd4\u56de\u7684\u5185\u5bb9\u662f\u4ee5 AND \u6216 OR \u5f00\u5934\u7684\uff0c\u6807\u7b7e\u5185\u4f1a\u5254\u9664\u6389"}),"\n",(0,i.jsx)(e.p,{children:"\u8868\u7ed3\u6784\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(89140).A+"",width:"834",height:"210"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"if",children:"if"}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<if test=\u201c\u6761\u4ef6\u5224\u65ad\u201d>\n\t\u67e5\u8be2\u6761\u4ef6\u62fc\u63a5\n</if>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u6839\u636e\u5b9e\u4f53\u7c7b\u7684\u4e0d\u540c\u53d6\u503c\uff0c\u4f7f\u7528\u4e0d\u540c\u7684 SQL \u8bed\u53e5\u6765\u8fdb\u884c\u67e5\u8be2\u3002\u6bd4\u5982\u5728 id \u5982\u679c\u4e0d\u4e3a\u7a7a\u65f6\u53ef\u4ee5\u6839\u636e id \u67e5\u8be2\uff0c\u5982\u679cusername \u4e0d\u540c\u7a7a\u65f6\u8fd8\u8981\u52a0\u5165\u7528\u6237\u540d\u4f5c\u4e3a\u6761\u4ef6\uff0c\u8fd9\u79cd\u60c5\u51b5\u5728\u6211\u4eec\u7684\u591a\u6761\u4ef6\u7ec4\u5408\u67e5\u8be2\u4e2d\u7ecf\u5e38\u4f1a\u78b0\u5230\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"UserMapper.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n\n<mapper namespace="mapper.UserMapper">\n    <select id="selectCondition" resultType="user" parameterType="user">\n        SELECT * FROM user\n        <where>\n            <if test="id != null ">\n                id = #{id}\n            </if>\n            <if test="username != null ">\n                AND username = #{username}\n            </if>\n            <if test="sex != null ">\n                AND sex = #{sex}\n            </if>\n        </where>\n    </select>\t\n\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyBatisConfig.xml\uff0c\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mappers>\n    \x3c!--mapper\u5f15\u5165\u6307\u5b9a\u7684\u6620\u5c04\u914d\u7f6e resource\u5c5e\u6027\u6267\u884c\u7684\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0--\x3e\n    <mapper resource="UserMapper.xml"/>\n</mappers>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO \u5c42 Mapper \u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserMapper {\n    //\u591a\u6761\u4ef6\u67e5\u8be2\n    public abstract List<User> selectCondition(Student stu);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9e\u73b0\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class DynamicTest {\n    @Test\n    public void selectCondition() throws Exception{\n        //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n        InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");\n\n        //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n        SqlSessionFactory ssf = new SqlSessionFactoryBuilder().build(is);\n\n        //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n        SqlSession sqlSession = ssf.openSession(true);\n\n        //4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\n        UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n\n        User user = new User();\n        user.setId(2);\n        user.setUsername("\u674e\u56db");\n        //user.setSex(\u7537); AND \u540e\u4f1a\u81ea\u52a8\u5254\u9664\n\n        //5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\n        List<Student> list = mapper.selectCondition(user);\n\n        //6.\u5904\u7406\u7ed3\u679c\n        for (User user : list) {\n            System.out.println(user);\n        }\n        \n        //7.\u91ca\u653e\u8d44\u6e90\n        sqlSession.close();\n        is.close();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"set",children:"set"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.set,{children:"\uff1a\u8fdb\u884c\u66f4\u65b0\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u542b\u6709 set \u5173\u952e\u8bcd\uff0c\u4f7f\u7528\u8be5\u6807\u7b7e"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!-- \u6839\u636e id \u66f4\u65b0 user \u8868\u7684\u6570\u636e --\x3e\n<update id="updateUserById" parameterType="com.ys.po.User">\n    UPDATE user u\n        <set>\n            <if test="username != null and username != \'\'">\n                u.username = #{username},\n            </if>\n            <if test="sex != null and sex != \'\'">\n                u.sex = #{sex}\n            </if>\n        </set>\n     WHERE id=#{id}\n</update>\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u7b2c\u4e00\u4e2a\u6761\u4ef6 username \u4e3a\u7a7a\uff0c\u90a3\u4e48 sql \u8bed\u53e5\u4e3a\uff1aupdate user u set u.sex=? where id=?"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u7b2c\u4e00\u4e2a\u6761\u4ef6\u4e0d\u4e3a\u7a7a\uff0c\u90a3\u4e48 sql \u8bed\u53e5\u4e3a\uff1aupdate user u set u.username = ? ,u.sex = ? where id=?"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"choose",children:"choose"}),"\n",(0,i.jsx)(e.p,{children:"\u5047\u5982\u4e0d\u60f3\u7528\u5230\u6240\u6709\u7684\u67e5\u8be2\u6761\u4ef6\uff0c\u53ea\u8981\u67e5\u8be2\u6761\u4ef6\u6709\u4e00\u4e2a\u6ee1\u8db3\u5373\u53ef\uff0c\u4f7f\u7528 choose \u6807\u7b7e\u53ef\u4ee5\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\uff0c\u7c7b\u4f3c\u4e8e Java \u7684 switch \u8bed\u53e5"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsxs)(e.when,{children:["\uff0c",(0,i.jsx)(e.otherwise,{})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<select id="selectUserByChoose" resultType="user" parameterType="user">\n    SELECT * FROM user\n    <where>\n        <choose>\n            <when test="id !=\'\' and id != null">\n                id=#{id}\n            </when>\n            <when test="username !=\'\' and username != null">\n                AND username=#{username}\n            </when>\n            <otherwise>\n                AND sex=#{sex}\n            </otherwise>\n        </choose>\n    </where>\n</select>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6709\u4e09\u4e2a\u6761\u4ef6\uff0cid\u3001username\u3001sex\uff0c\u53ea\u80fd\u9009\u62e9\u4e00\u4e2a\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679c id \u4e0d\u4e3a\u7a7a\uff0c\u90a3\u4e48\u67e5\u8be2\u8bed\u53e5\u4e3a\uff1aselect * from user where  id=?"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679c id \u4e3a\u7a7a\uff0c\u90a3\u4e48\u770b username \u662f\u5426\u4e3a\u7a7a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u90a3\u4e48\u8bed\u53e5\u4e3a\uff1aselect * from user where username=?"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c username \u4e3a\u7a7a\uff0c\u90a3\u4e48\u67e5\u8be2\u8bed\u53e5\u4e3a select * from user where sex=?"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"trim",children:"trim"}),"\n",(0,i.jsx)(e.p,{children:"trim \u6807\u8bb0\u662f\u4e00\u4e2a\u683c\u5f0f\u5316\u7684\u6807\u8bb0\uff0c\u53ef\u4ee5\u5b8c\u6210 set \u6216\u8005\u662f where \u6807\u8bb0\u7684\u529f\u80fd\uff0c\u81ea\u5b9a\u4e49\u5b57\u7b26\u4e32\u622a\u53d6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"prefix\uff1a\u7ed9\u62fc\u4e32\u540e\u7684\u6574\u4e2a\u5b57\u7b26\u4e32\u52a0\u4e00\u4e2a\u524d\u7f00\uff0ctrim \u6807\u7b7e\u4f53\u4e2d\u662f\u6574\u4e2a\u5b57\u7b26\u4e32\u62fc\u4e32\u540e\u7684\u7ed3\u679c"}),"\n",(0,i.jsx)(e.li,{children:"prefixOverrides\uff1a\u53bb\u6389\u6574\u4e2a\u5b57\u7b26\u4e32\u524d\u9762\u591a\u4f59\u7684\u5b57\u7b26"}),"\n",(0,i.jsx)(e.li,{children:"suffix\uff1a\u7ed9\u62fc\u4e32\u540e\u7684\u6574\u4e2a\u5b57\u7b26\u4e32\u52a0\u4e00\u4e2a\u540e\u7f00"}),"\n",(0,i.jsx)(e.li,{children:"suffixOverrides\uff1a\u53bb\u6389\u6574\u4e2a\u5b57\u7b26\u4e32\u540e\u9762\u591a\u4f59\u7684\u5b57\u7b26"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6539\u5199 if + where \u8bed\u53e5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<select id="selectUserByUsernameAndSex" resultType="user" parameterType="com.ys.po.User">\n    SELECT * FROM user\n    <trim prefix="where" prefixOverrides="and | or">\n        <if test="username != null">\n            AND username=#{username}\n        </if>\n        <if test="sex != null">\n            AND sex=#{sex}\n        </if>\n    </trim>\n</select>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6539\u5199 if + set \u8bed\u53e5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!-- \u6839\u636e id \u66f4\u65b0 user \u8868\u7684\u6570\u636e --\x3e\n<update id="updateUserById" parameterType="com.ys.po.User">\n    UPDATE user u\n    <trim prefix="set" suffixOverrides=",">\n        <if test="username != null and username != \'\'">\n            u.username = #{username},\n        </if>\n        <if test="sex != null and sex != \'\'">\n            u.sex = #{sex},\n        </if>\n    </trim>\n    WHERE id=#{id}\n</update>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"foreach",children:"foreach"}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<foreach>\uff1a\u5faa\u73af\u904d\u5386\u6807\u7b7e\u3002\u9002\u7528\u4e8e\u591a\u4e2a\u53c2\u6570\u6216\u8005\u7684\u5173\u7cfb\u3002\n    <foreach collection=\u201c\u201dopen=\u201c\u201dclose=\u201c\u201ditem=\u201c\u201dseparator=\u201c\u201d>\n\t\t\u83b7\u53d6\u53c2\u6570\n</foreach>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"collection\uff1a\u53c2\u6570\u5bb9\u5668\u7c7b\u578b\uff0c (list-\u96c6\u5408\uff0c array-\u6570\u7ec4)"}),"\n",(0,i.jsx)(e.li,{children:"open\uff1a\u5f00\u59cb\u7684 SQL \u8bed\u53e5"}),"\n",(0,i.jsx)(e.li,{children:"close\uff1a\u7ed3\u675f\u7684 SQL \u8bed\u53e5"}),"\n",(0,i.jsx)(e.li,{children:"item\uff1a\u53c2\u6570\u53d8\u91cf\u540d"}),"\n",(0,i.jsx)(e.li,{children:"separator\uff1a\u5206\u9694\u7b26"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u9700\u6c42\uff1a\u5faa\u73af\u6267\u884c sql \u7684\u62fc\u63a5\u64cd\u4f5c\uff0c",(0,i.jsx)(e.code,{children:"SELECT * FROM user WHERE id IN (1,2,5)"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"UserMapper.xml\u7247\u6bb5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<select id="selectByIds" resultType="user" parameterType="list">\n    SELECT * FROM student\n    <where>\n        <foreach collection="list" open="id IN(" close=")" item="id" separator=",">\n            #{id}\n        </foreach>\n    </where>\n</select>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u4ee3\u7801\u7247\u6bb5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\nUserMapper mapper = sqlSession.getMapper(UserMapper.class);\n\nList<Integer> ids = new ArrayList<>();\nCollections.addAll(list, 1, 2);\n//5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\nList<User> list = mapper.selectByIds(ids);\n\nfor (User user : list) {\n    System.out.println(user);\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"sql\u7247\u6bb5",children:"SQL\u7247\u6bb5"}),"\n",(0,i.jsx)(e.p,{children:"\u5c06\u4e00\u4e9b\u91cd\u590d\u6027\u7684 SQL \u8bed\u53e5\u8fdb\u884c\u62bd\u53d6\uff0c\u4ee5\u8fbe\u5230\u590d\u7528\u7684\u6548\u679c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<sql id=\u201c\u7247\u6bb5\u552f\u4e00\u6807\u8bc6\u201d>\u62bd\u53d6\u7684SQL\u8bed\u53e5</sql>\t\t\x3c!--\u62bd\u53d6\u6807\u7b7e--\x3e\n<include refid=\u201c\u7247\u6bb5\u552f\u4e00\u6807\u8bc6\u201d/>\t\t\t\t\x3c!--\u5f15\u5165\u6807\u7b7e--\x3e\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<sql id="select">SELECT * FROM user</sql>\n\n<select id="selectByIds" resultType="user" parameterType="list">\n    <include refid="select"/>\n    <where>\n        <foreach collection="list" open="id IN(" close=")" item="id" separator=",">\n            #{id}\n        </foreach>\n    </where>\n </select>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u9006\u5411\u5de5\u7a0b",children:"\u9006\u5411\u5de5\u7a0b"}),"\n",(0,i.jsxs)(e.p,{children:["MyBatis \u9006\u5411\u5de5\u7a0b\uff0c\u53ef\u4ee5\u9488\u5bf9",(0,i.jsx)(e.strong,{children:"\u5355\u8868"}),"\u81ea\u52a8\u751f\u6210 MyBatis \u6267\u884c\u6240\u9700\u8981\u7684\u4ee3\u7801\uff08mapper.java\u3001mapper.xml\u3001pojo\u2026\uff09"]}),"\n",(0,i.jsx)(e.p,{children:"generatorConfig.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE generatorConfiguration\n  PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"\n  "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd">\n \n<generatorConfiguration>\n    <context id="testTables" targetRuntime="MyBatis3">\n        <commentGenerator>\n            \x3c!-- \u662f\u5426\u53bb\u9664\u81ea\u52a8\u751f\u6210\u7684\u6ce8\u91ca true\uff1a\u662f \uff1a false:\u5426 --\x3e\n            <property name="suppressAllComments" value="true" />\n        </commentGenerator>\n        \x3c!--\u6570\u636e\u5e93\u8fde\u63a5\u7684\u4fe1\u606f\uff1a\u9a71\u52a8\u7c7b\u3001\u8fde\u63a5\u5730\u5740\u3001\u7528\u6237\u540d\u3001\u5bc6\u7801 --\x3e\n        <jdbcConnection driverClass="com.mysql.jdbc.Driver"\n            connectionURL="jdbc:mysql://localhost:3306/mybatisrelation" userId="root"\n            password="root">\n        </jdbcConnection>\n \n        \x3c!-- \u9ed8\u8ba4false\uff0c\u628aJDBC DECIMAL \u548c NUMERIC \u7c7b\u578b\u89e3\u6790\u4e3a Integer\uff0c\u4e3a true\u65f6\u628aJDBC DECIMAL\u548cNUMERIC\u7c7b\u578b\u89e3\u6790\u4e3ajava.math.BigDecimal --\x3e\n        <javaTypeResolver>\n            <property name="forceBigDecimals" value="false" />\n        </javaTypeResolver>\n \n        \x3c!-- targetProject:\u751f\u6210PO\u7c7b\u7684\u4f4d\u7f6e\uff01\uff01 --\x3e\n        <javaModelGenerator targetPackage="com.ys.po"\n            targetProject=".\\src">\n            \x3c!-- enableSubPackages:\u662f\u5426\u8ba9schema\u4f5c\u4e3a\u5305\u7684\u540e\u7f00 --\x3e\n            <property name="enableSubPackages" value="false" />\n            \x3c!-- \u4ece\u6570\u636e\u5e93\u8fd4\u56de\u7684\u503c\u88ab\u6e05\u7406\u524d\u540e\u7684\u7a7a\u683c --\x3e\n            <property name="trimStrings" value="true" />\n        </javaModelGenerator>\n        \x3c!-- targetProject:mapper\u6620\u5c04\u6587\u4ef6\u751f\u6210\u7684\u4f4d\u7f6e\uff01\uff01 --\x3e\n        <sqlMapGenerator targetPackage="com.ys.mapper"\n            targetProject=".\\src">\n            <property name="enableSubPackages" value="false" />\n        </sqlMapGenerator>\n        \x3c!-- targetPackage\uff1amapper\u63a5\u53e3\u751f\u6210\u7684\u4f4d\u7f6e\uff0c\u91cd\u8981\uff01\uff01 --\x3e\n        <javaClientGenerator type="XMLMAPPER"\n            targetPackage="com.ys.mapper"\n            targetProject=".\\src">\n            <property name="enableSubPackages" value="false" />\n        </javaClientGenerator>\n        \x3c!-- \u6307\u5b9a\u6570\u636e\u5e93\u8868\uff0c\u8981\u751f\u6210\u54ea\u4e9b\u8868\uff0c\u5c31\u5199\u54ea\u4e9b\u8868\uff0c\u8981\u548c\u6570\u636e\u5e93\u4e2d\u5bf9\u5e94\uff0c\u4e0d\u80fd\u5199\u9519\uff01 --\x3e\n        <table tableName="items"></table>\n        <table tableName="orders"></table>\n        <table tableName="orderdetail"></table>\n        <table tableName="user"></table>       \n    </context>\n</generatorConfiguration>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u6210\u4ee3\u7801\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void testGenerator() throws Exception{\n    List<String> warnings = new ArrayList<String>();\n    boolean overwrite = true;\n    //\u6307\u5411\u9006\u5411\u5de5\u7a0b\u914d\u7f6e\u6587\u4ef6\n    File configFile = new File(GeneratorTest.class.\n                               getResource("/generatorConfig.xml").getFile());\n    ConfigurationParser cp = new ConfigurationParser(warnings);\n    Configuration config = cp.parseConfiguration(configFile);\n    DefaultShellCallback callback = new DefaultShellCallback(overwrite);\n    MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config,\n                                                             callback, warnings);\n    myBatisGenerator.generate(null);\n\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,i.jsx)(e.a,{href:"https://www.cnblogs.com/ysocean/p/7360409.html",children:"https://www.cnblogs.com/ysocean/p/7360409.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6784\u5efa-sql",children:"\u6784\u5efa SQL"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u7840\u8bed\u6cd5",children:"\u57fa\u7840\u8bed\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"MyBatis \u63d0\u4f9b\u4e86 org.apache.ibatis.jdbc.SQL \u529f\u80fd\u7c7b\uff0c\u4e13\u95e8\u7528\u4e8e\u6784\u5efa SQL \u8bed\u53e5"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SELECT(String... columns)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u5b57\u6bb5\u62fc\u63a5\u67e5\u8be2\u8bed\u53e5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"FROM(String... tables)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u8868\u540d\u62fc\u63a5\u8bed\u53e5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"WHERE(String... conditions)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u6761\u4ef6\u62fc\u63a5\u8bed\u53e5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"INSERT_INTO(String tableName)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u8868\u540d\u62fc\u63a5\u65b0\u589e\u8bed\u53e5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"INTO_VALUES(String... values)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u503c\u62fc\u63a5\u65b0\u589e\u8bed\u53e5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"UPDATE(String table)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u8868\u540d\u62fc\u63a5\u4fee\u6539\u8bed\u53e5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"DELETE_FROM(String table)"}),(0,i.jsx)(e.td,{children:"\u6839\u636e\u8868\u540d\u62fc\u63a5\u5220\u9664\u8bed\u53e5"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u589e\u5220\u6539\u67e5\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@SelectProvider\uff1a\u751f\u6210\u67e5\u8be2\u7528\u7684 SQL \u8bed\u53e5"}),"\n",(0,i.jsx)(e.li,{children:"@InsertProvider\uff1a\u751f\u6210\u65b0\u589e\u7528\u7684 SQL \u8bed\u53e5"}),"\n",(0,i.jsx)(e.li,{children:"@UpdateProvider\uff1a\u751f\u6210\u4fee\u6539\u7528\u7684 SQL \u8bed\u53e5\u6ce8\u89e3"}),"\n",(0,i.jsxs)(e.li,{children:["@DeleteProvider\uff1a\u751f\u6210\u5220\u9664\u7528\u7684 SQL \u8bed\u53e5\u6ce8\u89e3\u3002\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"type \u5c5e\u6027\uff1a\u751f\u6210 SQL \u8bed\u53e5\u529f\u80fd\u7c7b\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"method \u5c5e\u6027\uff1a\u6307\u5b9a\u8c03\u7528\u65b9\u6cd5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u64cd\u4f5c-1",children:"\u57fa\u672c\u64cd\u4f5c"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyBatisConfig.xml \u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:' \x3c!-- mappers\u5f15\u5165\u6620\u5c04\u914d\u7f6e\u6587\u4ef6 --\x3e\n<mappers>\n    <package name="mapper"/>\n</mappers>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Mapper \u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface StudentMapper {\n    //\u67e5\u8be2\u5168\u90e8\n    @SelectProvider(type = ReturnSql.class, method = "getSelectAll")\n    public abstract List<Student> selectAll();\n\n    //\u65b0\u589e\u6570\u636e\n    @InsertProvider(type = ReturnSql.class, method = "getInsert")\n    public abstract Integer insert(Student student);\n\n    //\u4fee\u6539\u64cd\u4f5c\n    @UpdateProvider(type = ReturnSql.class, method = "getUpdate")\n    public abstract Integer update(Student student);\n\n    //\u5220\u9664\u64cd\u4f5c\n    @DeleteProvider(type = ReturnSql.class, method = "getDelete")\n    public abstract Integer delete(Integer id);\n\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ReturnSQL \u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class ReturnSql {\n    //\u5b9a\u4e49\u65b9\u6cd5\uff0c\u8fd4\u56de\u67e5\u8be2\u7684sql\u8bed\u53e5\n    public String getSelectAll() {\n        return new SQL() {\n            {\n                SELECT("*");\n                FROM("student");\n            }\n        }.toString();\n    }\n\n    //\u5b9a\u4e49\u65b9\u6cd5\uff0c\u8fd4\u56de\u65b0\u589e\u7684sql\u8bed\u53e5\n    public String getInsert(Student stu) {\n        return new SQL() {\n            {\n                INSERT_INTO("student");\n                INTO_VALUES("#{id},#{name},#{age}");\n            }\n        }.toString();\n    }\n\n    //\u5b9a\u4e49\u65b9\u6cd5\uff0c\u8fd4\u56de\u4fee\u6539\u7684sql\u8bed\u53e5\n    public String getUpdate(Student stu) {\n        return new SQL() {\n            {\n                UPDATE("student");\n                SET("name=#{name}","age=#{age}");\n                WHERE("id=#{id}");\n            }\n        }.toString();\n    }\n\n    //\u5b9a\u4e49\u65b9\u6cd5\uff0c\u8fd4\u56de\u5220\u9664\u7684sql\u8bed\u53e5\n    public String getDelete(Integer id) {\n        return new SQL() {\n            {\n                DELETE_FROM("student");\n                WHERE("id=#{id}");\n            }\n        }.toString();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529f\u80fd\u5b9e\u73b0\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class SqlTest {\t\n\t@Test  //\u67e5\u8be2\u5168\u90e8\n    public void selectAll() throws Exception{\n        //1.\u52a0\u8f7d\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\n        InputStream is = Resources.getResourceAsStream("MyBatisConfig.xml");\n\n        //2.\u83b7\u53d6SqlSession\u5de5\u5382\u5bf9\u8c61\n        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);\n\n        //3.\u901a\u8fc7\u5de5\u5382\u5bf9\u8c61\u83b7\u53d6SqlSession\u5bf9\u8c61\n        SqlSession sqlSession = sqlSessionFactory.openSession(true);\n\n        //4.\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\n        StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);\n\n        //5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c\n        List<Student> list = mapper.selectAll();\n\n        //6.\u5904\u7406\u7ed3\u679c\n        for (Student student : list) {\n            System.out.println(student);\n        }\n\n        //7.\u91ca\u653e\u8d44\u6e90\n        sqlSession.close();\n        is.close();\n    }\n    \n    @Test  //\u65b0\u589e\n    public void insert() throws Exception{\n        //1 2 3 4\u83b7\u53d6StudentMapper\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\n        StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);\n\n        //5.\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c ->6 7\n        Student stu = new Student(4,"\u8d75\u516d",26);\n        Integer result = mapper.insert(stu);\n    }\n    \n    @Test //\u4fee\u6539\n    public void update() throws Exception{\n        //1 2 3 4 5\u8c03\u7528\u5b9e\u73b0\u7c7b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\uff0c\u63a5\u6536\u7ed3\u679c ->6 7 \n\t\tStudent stu = new Student(4,"\u8d75\u516dwq",36);\n        Integer result = mapper.update(stu);\n    }\n    @Test //\u5220\u9664\n    public void delete() throws Exception{\n        //1 2 3 4 5 6 7\n        Integer result = mapper.delete(4);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u8fd0\u884c\u539f\u7406",children:"\u8fd0\u884c\u539f\u7406"}),"\n",(0,i.jsx)(e.h3,{id:"\u8fd0\u884c\u673a\u5236",children:"\u8fd0\u884c\u673a\u5236"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(20602).A+"",width:"1009",height:"728"})}),"\n",(0,i.jsx)(e.p,{children:"MyBatis \u8fd0\u884c\u8fc7\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u52a0\u8f7d MyBatis \u5168\u5c40\u914d\u7f6e\u6587\u4ef6\uff0c\u901a\u8fc7 XPath \u65b9\u5f0f\u89e3\u6790 XML \u914d\u7f6e\u6587\u4ef6\uff0c\u9996\u5148\u89e3\u6790\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff0c",(0,i.jsxs)(e.settings,{children:[" \u6807\u7b7e\u4e2d\u914d\u7f6e\u5c5e\u6027\u9879\u6709 defaultExecutorType\uff0c\u7528\u6765\u914d\u7f6e\u6307\u5b9a Executor \u7c7b\u578b\uff0c\u5c06\u914d\u7f6e\u6587\u4ef6\u7684\u4fe1\u606f\u586b\u5145\u5230 Configuration\u5bf9\u8c61\u3002\u6700\u540e\u89e3\u6790\u6620\u5c04\u5668\u914d\u7f6e\u7684\u6620\u5c04\u6587\u4ef6\uff0c\u5e76",(0,i.jsx)(e.strong,{children:"\u6784\u5efa MappedStatement \u5bf9\u8c61\u586b\u5145\u81f3 Configuration"}),"\uff0c\u5c06\u89e3\u6790\u540e\u7684\u6620\u5c04\u5668\u6dfb\u52a0\u5230 mapperRegistry \u4e2d\uff0c\u7528\u4e8e\u83b7\u53d6\u4ee3\u7406"]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u521b\u5efa\u4e00\u4e2a DefaultSqlSession \u5bf9\u8c61\uff0c",(0,i.jsx)(e.strong,{children:"\u6839\u636e\u53c2\u6570\u521b\u5efa\u6307\u5b9a\u7c7b\u578b\u7684 Executor"}),"\uff0c\u4e8c\u7ea7\u7f13\u5b58\u9ed8\u8ba4\u5f00\u542f\uff0c\u628a Executor \u5305\u88c5\u6210\u7f13\u5b58\u6267\u884c\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DefaulSqlSession \u8c03\u7528 getMapper()\uff0c\u901a\u8fc7 JDK \u52a8\u6001\u4ee3\u7406\u83b7\u53d6 Mapper \u63a5\u53e3\u7684\u4ee3\u7406\u5bf9\u8c61 MapperProxy"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6267\u884c SQL \u8bed\u53e5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"MapperProxy.invoke() \u6267\u884c\u4ee3\u7406\u65b9\u6cd5\uff0c\u901a\u8fc7 MapperMethod#execute \u5224\u65ad\u6267\u884c\u7684\u662f\u589e\u5220\u6539\u67e5\u4e2d\u7684\u54ea\u4e2a\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"\u67e5\u8be2\u65b9\u6cd5\u8c03\u7528 sqlSession.selectOne()\uff0c\u4ece Configuration \u4e2d\u83b7\u53d6\u6267\u884c\u8005\u5bf9\u8c61 MappedStatement\uff0c\u7136\u540e Executor \u8c03\u7528 executor.query \u5f00\u59cb\u6267\u884c\u67e5\u8be2\u65b9\u6cd5"}),"\n",(0,i.jsxs)(e.li,{children:["\u9996\u5148\u901a\u8fc7 CachingExecutor \u53bb\u4e8c\u7ea7\u7f13\u5b58\u67e5\u8be2\uff0c\u67e5\u8be2\u4e0d\u5230\u53bb\u4e00\u7ea7\u7f13\u5b58\u67e5\u8be2\uff0c",(0,i.jsx)(e.strong,{children:"\u6700\u540e\u53bb\u6570\u636e\u5e93\u67e5\u8be2\u5e76\u653e\u5165\u4e00\u7ea7\u7f13\u5b58"})]}),"\n",(0,i.jsxs)(e.li,{children:["Configuration \u5bf9\u8c61\u6839\u636e ",(0,i.jsxs)(e.select,{children:[" \u6807\u7b7e\u7684 statementType \u5c5e\u6027\u521b\u5efa StatementHandler \u5bf9\u8c61\uff0c\u5728 StatementHandler \u7684\u6784\u9020\u65b9\u6cd5\u4e2d\uff0c\u521b\u5efa\u4e86 ParameterHandler \u548c ResultSetHandler \u5bf9\u8c61\n\u6700\u540e\u83b7\u53d6 JDBC \u539f\u751f\u7684 Connection \u6570\u636e\u5e93\u8fde\u63a5\u5bf9\u8c61\uff0c\u521b\u5efa Statement \u6267\u884c\u8005\u5bf9\u8c61\uff0c\u7136\u540e\u901a\u8fc7 ParameterHandler \u8bbe\u7f6e\u9884\u7f16\u8bd1\u53c2\u6570\uff0c\u5e95\u5c42\u662f TypeHandler#setParameter \u65b9\u6cd5\uff0c\u7136\u540e\u901a\u8fc7 StatementHandler \u56de\u8c03\u6267\u884c\u8005\u5bf9\u8c61\u6267\u884c\u589e\u5220\u6539\u67e5\uff0c\u6700\u540e\u8c03\u7528 ResultsetHandler \u5904\u7406\u67e5\u8be2\u7ed3\u679c\n\n\n\n\u56db\u5927\u5bf9\u8c61\uff1a\n\nStatementHandler\uff1a\u6267\u884c SQL \u8bed\u53e5\u7684\u5bf9\u8c61\nParameterHandler\uff1a\u8bbe\u7f6e\u9884\u7f16\u8bd1\u53c2\u6570\u7528\u7684\nResultHandler\uff1a\u5904\u7406\u7ed3\u679c\u96c6\nExecutor\uff1a\u6267\u884c\u5668\uff0c\u771f\u6b63\u8fdb\u884c Java \u4e0e\u6570\u636e\u5e93\u4ea4\u4e92\u7684\u5bf9\u8c61\n\n\u53c2\u8003\u89c6\u9891\uff1ahttps://www.bilibili.com/video/BV1mW411M737?p=71\n",(0,i.jsx)(e.hr,{}),'\n\u83b7\u53d6\u5de5\u5382\nSqlSessionFactoryBuilder.build(InputStream, String,  Properties)\uff1a\u6784\u5efa\u5de5\u5382\nXMLConfigBuilder.parse()\uff1a\u89e3\u6790\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u6bcf\u4e2a\u6807\u7b7e\u7684\u4fe1\u606f\uff08XPath\uff09\n\n\nparseConfiguration(parser.evalNode("/configuration"))\uff1a\u8bfb\u53d6\u8282\u70b9\u5185\u6570\u636e\uff0c \u662f MyBatis \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u9876\u5c42\u6807\u7b7e\nsettings = settingsAsProperties(root.evalNode("settings"))\uff1a\u8bfb\u53d6\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684  \u6807\u7b7e\nsettingsElement(settings)\uff1a\u8bbe\u7f6e\u6846\u67b6\u76f8\u5173\u7684\u5c5e\u6027\n\nconfiguration.setCacheEnabled()\uff1a\u8bbe\u7f6e\u7f13\u5b58\u5c5e\u6027\uff0c\u9ed8\u8ba4\u662f true\nconfiguration.setDefaultExecutorType()\uff1a\u8bbe\u7f6e Executor \u7c7b\u578b\u5230 configuration\uff0c\u9ed8\u8ba4\u662f SIMPLE\n\nmapperElement(root.evalNode("mappers"))\uff1a\u89e3\u6790 mappers \u4fe1\u606f\uff0c\u5206\u4e3a package \u548c \u5355\u4e2a\u6ce8\u518c\u4e24\u79cd\n\n\nif...else...\uff1a\u6839\u636e\u6620\u5c04\u65b9\u6cd5\u9009\u62e9\u5408\u9002\u7684\u8bfb\u53d6\u65b9\u5f0f\n\n\nXMLMapperBuilder.parse()\uff1a\u89e3\u6790 mapper \u7684\u6807\u7b7e\u7684\u4fe1\u606f\n\n\nconfigurationElement(parser.evalNode("/mapper"))\uff1a\u89e3\u6790 mapper \u6587\u4ef6\uff0c\u9876\u5c42\u8282\u70b9 \n\n\nbuildStatementFromContext(context.evalNodes("select..."))\uff1a\u89e3\u6790\u6bcf\u4e2a\u64cd\u4f5c\u6807\u7b7e\nXMLStatementBuilder.parseStatementNode()\uff1a\u89e3\u6790\u64cd\u4f5c\u6807\u7b7e\u7684\u6240\u6709\u7684\u5c5e\u6027\nbuilderAssistant.addMappedStatement(...)\uff1a\u5c01\u88c5\u6210 MappedStatement \u5bf9\u8c61\u52a0\u5165 Configuration \u5bf9\u8c61\uff0c\u4ee3\u8868\u4e00\u4e2a\u589e\u5220\u6539\u67e5\u7684\u6807\u7b7e\n\n\n\n\n\n\nClass<?> mapperInterface = Resources.classForName(mapperClass)\uff1a\u52a0\u8f7d Mapper \u63a5\u53e3\n\n\nConfiguration.addMappers()\uff1a\u5c06\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u7684\u6620\u5c04\u5668\u6dfb\u52a0\u5230 mapperRegistry \u4e2d\uff0c\u7528\u6765\u83b7\u53d6\u4ee3\u7406\u5bf9\u8c61\n\n\nMapperAnnotationBuilder parser = new MapperAnnotationBuilder(config, type)\uff1a\u521b\u5efa\u6ce8\u89e3\u89e3\u6790\u5668\n\n\nparser.parse()\uff1a\u89e3\u6790 Mapper \u63a5\u53e3\n\n\nSqlSource sqlSource = getSqlSourceFromAnnotations()\uff1a\u83b7\u53d6 SQL \u7684\u8d44\u6e90\u5bf9\u8c61\n',(0,i.jsx)(e.img,{src:s(55732).A+"",width:"1215",height:"191"}),"\n\n\nbuilderAssistant.addMappedStatement(...)\uff1a\u5c01\u88c5\u6210 MappedStatement \u5bf9\u8c61\u52a0\u5165 Configuration \u5bf9\u8c61\n\n\n\n\n\n\n\n\nreturn configuration\uff1a\u8fd4\u56de\u914d\u7f6e\u5b8c\u6210\u7684 configuration \u5bf9\u8c61\n\n\nreturn new DefaultSqlSessionFactory(config)\uff1a\u8fd4\u56de\u5de5\u5382\u5bf9\u8c61\uff0c\u5305\u542b Configuration \u5bf9\u8c61\n",(0,i.jsx)(e.img,{src:s(22568).A+"",width:"1585",height:"999"}),"\n\u603b\u7ed3\uff1a\u89e3\u6790 XML \u662f\u5bf9 Configuration \u4e2d\u7684\u5c5e\u6027\u8fdb\u884c\u586b\u5145\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u4e00\u4e2a\u7c7b\u4e2d\u521b\u5efa Configuration \u5bf9\u8c61\uff0c\u81ea\u5b9a\u4e49\u5176\u4e2d\u5c5e\u6027\u7684\u503c\u6765\u8fbe\u5230\u914d\u7f6e\u7684\u6548\u679c\n",(0,i.jsx)(e.hr,{}),"\n\u83b7\u53d6\u4f1a\u8bdd\nDefaultSqlSessionFactory.openSession()\uff1a\u83b7\u53d6 Session \u5bf9\u8c61\uff0c\u5e76\u4e14\u521b\u5efa Executor \u5bf9\u8c61\nDefaultSqlSessionFactory.openSessionFromDataSource(...)\uff1aExecutorType \u4e3a Executor \u7684\u7c7b\u578b\uff0cTransactionIsolationLevel \u4e3a\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0cautoCommit \u662f\u5426\u5f00\u542f\u4e8b\u52a1\n\n\ntransactionFactory.newTransaction(DataSource, IsolationLevel, boolean\uff1a\u4e8b\u52a1\u5bf9\u8c61\n\n\nconfiguration.newExecutor(tx, execType)\uff1a\u6839\u636e\u53c2\u6570\u521b\u5efa\u6307\u5b9a\u7c7b\u578b\u7684 Executor\n\n\u6279\u91cf\u64cd\u4f5c\u7b14\u8bb0\u7684\u90e8\u5206\u6709\u8bb2\u89e3\u5230  \u7684\u5c5e\u6027 defaultExecutorType\uff0c\u6839\u636e\u914d\u7f6e\u521b\u5efa\u5bf9\u8c61\n\u4e8c\u7ea7\u7f13\u5b58\u9ed8\u8ba4\u5f00\u542f\uff0c\u4f1a\u5305\u88c5 Executor \u5bf9\u8c61 new CachingExecutor(executor)\n\n\n\nreturn new DefaultSqlSession(configuration, executor, autoCommit)\uff1a\u8fd4\u56de DefaultSqlSession \u5bf9\u8c61\n",(0,i.jsx)(e.img,{src:s(88994).A+"",width:"1665",height:"855"}),"\n",(0,i.jsx)(e.hr,{}),"\n\u83b7\u53d6\u4ee3\u7406\nConfiguration.getMapper(Class, SqlSession)\uff1a\u83b7\u53d6\u4ee3\u7406\u7684 mapper \u5bf9\u8c61\nMapperRegistry.getMapper(Class, SqlSession)\uff1aMapperRegistry \u662f Configuration \u5c5e\u6027\uff0c\u5728\u83b7\u53d6\u5de5\u5382\u5bf9\u8c61\u65f6\u521d\u59cb\u5316\n\n(MapperProxyFactory<T>) knownMappers.get(type)\uff1a\u83b7\u53d6\u63a5\u53e3\u4fe1\u606f\u5c01\u88c5\u4e3a MapperProxyFactory \u5bf9\u8c61\nmapperProxyFactory.newInstance(sqlSession)\uff1a\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\n\nnew MapperProxy<>(sqlSession, mapperInterface, methodCache)\uff1a\u5305\u88c5\u5bf9\u8c61\n\nmethodCache \u662f\u5e76\u53d1\u5b89\u5168\u7684 ConcurrentHashMap \u96c6\u5408\uff0c\u5b58\u653e\u8981\u6267\u884c\u7684\u65b9\u6cd5\nMapperProxy<T> implements InvocationHandler \u8bf4\u660e MapperProxy \u9ed8\u8ba4\u662f\u4e00\u4e2a InvocationHandler \u5bf9\u8c61\n\n\nProxy.newProxyInstance()\uff1aJDK \u52a8\u6001\u4ee3\u7406\u521b\u5efa MapperProxy \u5bf9\u8c61\n\n\n\n",(0,i.jsx)(e.img,{src:s(80630).A+"",width:"1462",height:"824"}),"\n",(0,i.jsx)(e.hr,{}),"\n\u6267\u884cSQL\nMapperProxy.invoke()\uff1a\u6267\u884c SQL \u8bed\u53e5\uff0cObject \u7c7b\u7684\u65b9\u6cd5\u76f4\u63a5\u6267\u884c\npublic Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n    try {\n        // \u5f53\u524d\u65b9\u6cd5\u662f\u5426\u662f\u5c5e\u4e8e Object \u7c7b\u4e2d\u7684\u65b9\u6cd5\n        if (Object.class.equals(method.getDeclaringClass())) {\n            return method.invoke(this, args);\n            // \u5f53\u524d\u65b9\u6cd5\u662f\u5426\u662f\u9ed8\u8ba4\u65b9\u6cd5\n        } else if (isDefaultMethod(method)) {\n            return invokeDefaultMethod(proxy, method, args);\n        }\n    } catch (Throwable t) {\n        throw ExceptionUtil.unwrapThrowable(t);\n    }\n    // \u5305\u88c5\u6210\u4e00\u4e2a MapperMethod \u5bf9\u8c61\u5e76\u521d\u59cb\u5316\u8be5\u5bf9\u8c61\n    final MapperMethod mapperMethod = cachedMapperMethod(method);\n    // \u3010\u6839\u636e switch-case \u5224\u65ad\u4f7f\u7528\u7684\u4ec0\u4e48\u7c7b\u578b\u7684 SQL \u8fdb\u884c\u903b\u8f91\u5904\u7406\u3011\uff0c\u6b64\u5904\u5206\u6790\u67e5\u8be2\u8bed\u53e5\u7684\u67e5\u8be2\u64cd\u4f5c\n    return mapperMethod.execute(sqlSession, args);\n}\n\nsqlSession.selectOne(String, Object)\uff1a\u67e5\u8be2\u6570\u636e\npublic Object execute(SqlSession sqlSession, Object[] args) {\n    //.....\n    // \u89e3\u6790\u4f20\u5165\u7684\u53c2\u6570\n    Object param = method.convertArgsToSqlCommandParam(args);\n    result = sqlSession.selectOne(command.getName(), param);\n}\n// DefaultSqlSession.selectList(String, Object)\npublic <E> List<E> selectList(String statement, Object parameter, RowBounds rowBounds) {\n    // \u83b7\u53d6\u6267\u884c\u8005\u5bf9\u8c61\n    MappedStatement ms = configuration.getMappedStatement(statement);\n    // \u5f00\u59cb\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u53c2\u6570\u901a\u8fc7 wrapCollection() \u5305\u88c5\u6210\u96c6\u5408\u7c7b\n    return executor.query(ms, wrapCollection(parameter), rowBounds, Executor.NO_RESULT_HANDLER);\n}\n\nExecutor#query()\uff1a\n\n\nCachingExecutor.query()\uff1a\u5148\u6267\u884c CachingExecutor \u53bb\u4e8c\u7ea7\u7f13\u5b58\u83b7\u53d6\u6570\u636e\npublic class CachingExecutor implements Executor {\n  private final Executor delegate;\t\t// \u5305\u88c5\u4e86 BaseExecutor\uff0c\u4e8c\u7ea7\u7f13\u5b58\u4e0d\u5b58\u5728\u6570\u636e\u8c03\u7528 BaseExecutor \u67e5\u8be2\n}\n\n\n\nMappedStatement.getBoundSql(parameterObject)\uff1a\u628a parameterObject \u5c01\u88c5\u6210 BoundSql\n\u6784\u9020\u51fd\u6570\u4e2d\u6709\uff1athis.parameterObject = parameterObject\n",(0,i.jsx)(e.img,{src:s(61006).A+"",width:"1011",height:"207"}),"\n\n\nCachingExecutor.createCacheKey()\uff1a\u521b\u5efa\u7f13\u5b58\u5bf9\u8c61\n\n\nms.getCache()\uff1a\u83b7\u53d6\u4e8c\u7ea7\u7f13\u5b58\n\n\ntcm.getObject(cache, key)\uff1a\u5c1d\u8bd5\u4ece\u4e8c\u7ea7\u7f13\u5b58\u4e2d\u83b7\u53d6\u6570\u636e\n\n\n\n\nBaseExecutor.query()\uff1a\u4e8c\u7ea7\u7f13\u5b58\u4e0d\u5b58\u5728\u8be5\u6570\u636e\uff0c\u8c03\u7528\u8be5\u65b9\u6cd5\n\nlocalCache.getObject(key) \uff1a\u5c1d\u8bd5\u4ece\u672c\u5730\u7f13\u5b58\uff08\u4e00\u7ea7\u7f13\u5b58\uff09\u83b7\u53d6\u6570\u636e\n\n\n\nBaseExecutor.queryFromDatabase()\uff1a\u7f13\u5b58\u83b7\u53d6\u6570\u636e\u5931\u8d25\uff0c\u5f00\u59cb\u4ece\u6570\u636e\u5e93\u83b7\u53d6\u6570\u636e\uff0c\u5e76\u653e\u5165\u672c\u5730\u7f13\u5b58\n\n\nSimpleExecutor.doQuery()\uff1a\u6267\u884c query\n\n\nconfiguration.newStatementHandler()\uff1a\u521b\u5efa StatementHandler \u5bf9\u8c61\n\n\u6839\u636e "]})," \u6807\u7b7e\u7684 statementType \u5c5e\u6027\uff0c\u6839\u636e\u5c5e\u6027\u9009\u62e9\u521b\u5efa\u54ea\u79cd\u5bf9\u8c61"]}),"\n",(0,i.jsx)(e.li,{children:"\u5224\u65ad BoundSql \u662f\u5426\u88ab\u521b\u5efa\uff0c\u6ca1\u6709\u521b\u5efa\u4f1a\u91cd\u65b0\u5c01\u88c5\u53c2\u6570\u4fe1\u606f\u5230 BoundSql"}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"StatementHandler \u7684\u6784\u9020\u65b9\u6cd5\u4e2d\uff0c\u521b\u5efa\u4e86 ParameterHandler \u548c ResultSetHandler \u5bf9\u8c61"})}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"interceptorChain.pluginAll(statementHandler)"}),"\uff1a\u62e6\u622a\u5668\u94fe"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"prepareStatement()"}),"\uff1a\u901a\u8fc7 StatementHandler \u521b\u5efa JDBC \u539f\u751f\u7684 Statement \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getConnection()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 JDBC \u7684 Connection \u5bf9\u8c61"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"handler.prepare()"}),"\uff1a\u521d\u59cb\u5316 Statement \u5bf9\u8c61\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"instantiateStatement(Connection connection)"}),"\uff1aConnection  \u4e2d\u7684\u65b9\u6cd5\u5b9e\u4f8b\u5316\u5bf9\u8c61\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u83b7\u53d6\u666e\u901a\u6267\u884c\u8005\u5bf9\u8c61\uff1a",(0,i.jsx)(e.code,{children:"Connection.createStatement()"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u9884\u7f16\u8bd1\u6267\u884c\u8005\u5bf9\u8c61"}),"\uff1a",(0,i.jsx)(e.code,{children:"Connection.prepareStatement()"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"handler.parameterize()"}),"\uff1a\u8fdb\u884c\u53c2\u6570\u7684\u8bbe\u7f6e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ParameterHandler.setParameters()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u901a\u8fc7 ParameterHandler \u8bbe\u7f6e\u53c2\u6570"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"typeHandler.setParameter()"}),"\uff1a\u5e95\u5c42\u901a\u8fc7 TypeHandler \u5b9e\u73b0\uff0c\u56de\u8c03 JDBC \u7684\u63a5\u53e3\u8fdb\u884c\u8bbe\u7f6e"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"StatementHandler.query()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8c03\u7528 JDBC \u539f\u751f\u7684 PreparedStatement \u6267\u884c SQL"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public <E> List<E> query(Statement statement, ResultHandler resultHandler) {\n    // \u83b7\u53d6 SQL \u8bed\u53e5\n    String sql = boundSql.getSql();\n    statement.execute(sql);\n    // \u901a\u8fc7 ResultSetHandler \u5bf9\u8c61\u5c01\u88c5\u7ed3\u679c\u96c6\uff0c\u6620\u5c04\u6210 JavaBean\n    return resultSetHandler.handleResultSets(statement);\n  }\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resultSetHandler.handleResultSets(statement)"}),"\uff1a\u5904\u7406\u7ed3\u679c\u96c6"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"handleResultSet(rsw, resultMap, multipleResults, null)"}),"\uff1a\u5e95\u5c42\u56de\u8c03"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"handleRowValues()"}),"\uff1a\u9010\u884c\u5904\u7406\u6570\u636e\uff0c\u6839\u636e\u662f\u5426\u914d\u7f6e\u4e86 ",(0,i.jsx)(e.resultmap,{children:" \u5c5e\u6027\u9009\u62e9\u662f\u5426\u4f7f\u7528\u7b80\u5355\u7ed3\u679c\u96c6\u6620\u5c04"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9996\u5148\u5224\u65ad\u6570\u636e\u662f\u5426\u88ab\u9650\u5236\u884c\u6570\uff0c\u7136\u540e\u8fdb\u884c\u7ed3\u679c\u96c6\u7684\u6620\u5c04"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6700\u540e\u5c06\u6570\u636e\u5b58\u5165 ResultHandler \u5bf9\u8c61\uff0c\u5e95\u5c42\u5c31\u662f List \u96c6\u5408"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class DefaultResultHandler implements ResultHandler<Object> {\n\tprivate final List<Object> list;\n  \tpublic void handleResult(ResultContext<?> context) {\n    \tlist.add(context.getResultObject());\n  \t}\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return collapseSingleResultList(multipleResults)"}),"\uff1a\u53ef\u80fd\u5b58\u5728\u591a\u4e2a\u7ed3\u679c\u96c6\u7684\u60c5\u51b5"]}),"\n"]}),"\n"]}),"\n"]}),"\n\n\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"localCache.putObject(key, list)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u653e\u5165\u4e00\u7ea7\uff08\u672c\u5730\uff09\u7f13\u5b58"})]}),"\n"]}),"\n\n\n\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return list.get(0)"}),"\uff1a\u8fd4\u56de\u7ed3\u679c\u96c6\u7684\u7b2c\u4e00\u4e2a\u6570\u636e"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(21999).A+"",width:"1423",height:"1106"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u63d2\u4ef6\u4f7f\u7528",children:"\u63d2\u4ef6\u4f7f\u7528"}),"\n",(0,i.jsx)(e.h3,{id:"\u63d2\u4ef6\u539f\u7406",children:"\u63d2\u4ef6\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u73b0\u539f\u7406\uff1a\u63d2\u4ef6\u662f\u6309\u7167\u63d2\u4ef6\u914d\u7f6e\u987a\u5e8f\u521b\u5efa\u5c42\u5c42\u5305\u88c5\u5bf9\u8c61\uff0c\u6267\u884c\u76ee\u6807\u65b9\u6cd5\u7684\u4e4b\u540e\uff0c\u6309\u7167\u9006\u5411\u987a\u5e8f\u6267\u884c\uff08\u6808\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(72887).A+"",width:"1046",height:"442"})}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u56db\u5927\u5bf9\u8c61\u521b\u5efa\u65f6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u6bcf\u4e2a\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\u4e0d\u662f\u76f4\u63a5\u8fd4\u56de\u7684\uff0c\u800c\u662f ",(0,i.jsx)(e.code,{children:"interceptorChain.pluginAll(parameterHandler)"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u83b7\u53d6\u5230\u6240\u6709 Interceptor\uff08\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\uff09\uff0c\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"interceptor.plugin(target)"}),"\u8fd4\u56de target \u5305\u88c5\u540e\u7684\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:["\u63d2\u4ef6\u673a\u5236\u53ef\u4ee5\u4f7f\u7528\u63d2\u4ef6\u4e3a\u76ee\u6807\u5bf9\u8c61\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u4ee3\u7406\u5bf9\u8c61\u53ef\u4ee5",(0,i.jsx)(e.strong,{children:"\u62e6\u622a\u5230\u56db\u5927\u5bf9\u8c61\u7684\u6bcf\u4e00\u4e2a\u6267\u884c"})]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Intercepts(\n\t\t{\n\t\t@Signature(type=StatementHandler.class,method="parameterize",args=java.sql.Statement.class)\n\t\t})\npublic class MyFirstPlugin implements Interceptor{\n\n\t//intercept\uff1a\u62e6\u622a\u76ee\u6807\u5bf9\u8c61\u7684\u76ee\u6807\u65b9\u6cd5\u7684\u6267\u884c\n\t@Override\n\tpublic Object intercept(Invocation invocation) throws Throwable {\n\t\tSystem.out.println("MyFirstPlugin...intercept:" + invocation.getMethod());\n\t\t//\u52a8\u6001\u7684\u6539\u53d8\u4e00\u4e0bsql\u8fd0\u884c\u7684\u53c2\u6570\uff1a\u4ee5\u524d1\u53f7\u5458\u5de5\uff0c\u5b9e\u9645\u4ece\u6570\u636e\u5e93\u67e5\u8be211\u53f7\u5458\u5de5\n\t\tObject target = invocation.getTarget();\n\t\tSystem.out.println("\u5f53\u524d\u62e6\u622a\u5230\u7684\u5bf9\u8c61\uff1a" + target);\n\t\t//\u62ff\u5230\uff1aStatementHandler==>ParameterHandler===>parameterObject\n\t\t//\u62ff\u5230target\u7684\u5143\u6570\u636e\n\t\tMetaObject metaObject = SystemMetaObject.forObject(target);\n\t\tObject value = metaObject.getValue("parameterHandler.parameterObject");\n\t\tSystem.out.println("sql\u8bed\u53e5\u7528\u7684\u53c2\u6570\u662f\uff1a" + value);\n\t\t//\u4fee\u6539\u5b8csql\u8bed\u53e5\u8981\u7528\u7684\u53c2\u6570\n\t\tmetaObject.setValue("parameterHandler.parameterObject", 11);\n\t\t//\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n\t\tObject proceed = invocation.proceed();\n\t\t//\u8fd4\u56de\u6267\u884c\u540e\u7684\u8fd4\u56de\u503c\n\t\treturn proceed;\n\t}\n\n\t// plugin\uff1a\u5305\u88c5\u76ee\u6807\u5bf9\u8c61\u7684\uff0c\u4e3a\u76ee\u6807\u5bf9\u8c61\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\n\t@Override\n\tpublic Object plugin(Object target) {\n\t\t//\u53ef\u4ee5\u501f\u52a9 Plugin \u7684 wrap \u65b9\u6cd5\u6765\u4f7f\u7528\u5f53\u524d Interceptor \u5305\u88c5\u6211\u4eec\u76ee\u6807\u5bf9\u8c61\n\t\tSystem.out.println("MyFirstPlugin...plugin:mybatis\u5c06\u8981\u5305\u88c5\u7684\u5bf9\u8c61" + target);\n\t\tObject wrap = Plugin.wrap(target, this);\n\t\t//\u8fd4\u56de\u4e3a\u5f53\u524dtarget\u521b\u5efa\u7684\u52a8\u6001\u4ee3\u7406\n\t\treturn wrap;\n\t}\n\n\t// setProperties\uff1a\u5c06\u63d2\u4ef6\u6ce8\u518c\u65f6\u7684property\u5c5e\u6027\u8bbe\u7f6e\u8fdb\u6765\n\t@Override\n\tpublic void setProperties(Properties properties) {\n\t\tSystem.out.println("\u63d2\u4ef6\u914d\u7f6e\u7684\u4fe1\u606f\uff1a" + properties);\n\t}\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--plugins\uff1a\u6ce8\u518c\u63d2\u4ef6  --\x3e\n<plugins>\n    <plugin interceptor="mybatis.dao.MyFirstPlugin">\n        <property name="username" value="root"/>\n        <property name="password" value="123456"/>\n    </plugin>\n</plugins>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5206\u9875\u63d2\u4ef6",children:"\u5206\u9875\u63d2\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(56432).A+"",width:"579",height:"282"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5206\u9875\u53ef\u4ee5\u5c06\u5f88\u591a\u6761\u7ed3\u679c\u8fdb\u884c\u5206\u9875\u663e\u793a\u3002\u5982\u679c\u5f53\u524d\u5728\u7b2c\u4e00\u9875\uff0c\u5219\u6ca1\u6709\u4e0a\u4e00\u9875\u3002\u5982\u679c\u5f53\u524d\u5728\u6700\u540e\u4e00\u9875\uff0c\u5219\u6ca1\u6709\u4e0b\u4e00\u9875\uff0c\u9700\u8981\u660e\u786e\u5f53\u524d\u662f\u7b2c\u51e0\u9875\uff0c\u8fd9\u4e00\u9875\u4e2d\u663e\u793a\u591a\u5c11\u6761\u7ed3\u679c\u3002"}),"\n",(0,i.jsx)(e.li,{children:"MyBatis \u662f\u4e0d\u5e26\u5206\u9875\u529f\u80fd\u7684\uff0c\u5982\u679c\u60f3\u5b9e\u73b0\u5206\u9875\u529f\u80fd\uff0c\u9700\u8981\u624b\u52a8\u7f16\u5199 LIMIT \u8bed\u53e5\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u5b9e\u73b0\u5206\u9875\u7684 SQL \u8bed\u53e5\u4e5f\u662f\u4e0d\u540c\uff0c\u624b\u5199\u5206\u9875 \u6210\u672c\u8f83\u9ad8\u3002"}),"\n",(0,i.jsx)(e.li,{children:"PageHelper\uff1a\u7b2c\u4e09\u65b9\u5206\u9875\u52a9\u624b\uff0c\u5c06\u590d\u6742\u7684\u5206\u9875\u64cd\u4f5c\u8fdb\u884c\u5c01\u88c5\uff0c\u4ece\u800c\u8ba9\u5206\u9875\u529f\u80fd\u53d8\u5f97\u975e\u5e38\u7b80\u5355"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5206\u9875\u64cd\u4f5c",children:"\u5206\u9875\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u53d1\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165 PageHelper \u7684 Maven \u5750\u6807"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728 MyBatis \u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e PageHelper \u63d2\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5206\u9875\u52a9\u624b\u7684\u63d2\u4ef6\u914d\u7f6e\u5728\u901a\u7528 Mapper \u4e4b\u524d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<plugins>\n    <plugin interceptor="com.github.pagehelper.PageInterceptor">\n        \x3c!-- \u6307\u5b9a\u65b9\u8a00 --\x3e\n    \t<property name="dialect" value="mysql"/>\n    </plugin> \n</plugins>\n<mappers>.........</mappers>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e0e MySQL \u5206\u9875\u67e5\u8be2\u9875\u6570\u8ba1\u7b97\u516c\u5f0f\u4e0d\u540c"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"static <E> Page<E> startPage(int pageNum, int pageSize)"}),"\uff1apageNum\u7b2c\u51e0\u9875\uff0cpageSize\u9875\u9762\u5927\u5c0f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\npublic void selectAll() {\n    //\u7b2c\u4e00\u9875\uff1a\u663e\u793a2\u6761\u6570\u636e\n    PageHelper.startPage(1,2);\n    List<Student> students = sqlSession.selectList("StudentMapper.selectAll");\n    for (Student student : students) {\n        System.out.println(student);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u53c2\u6570\u83b7\u53d6",children:"\u53c2\u6570\u83b7\u53d6"}),"\n",(0,i.jsx)(e.p,{children:"PageInfo\u6784\u9020\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PageInfo<Student> info = new PageInfo<>(list)"})," : list \u662f SQL \u6267\u884c\u8fd4\u56de\u7684\u7ed3\u679c\u96c6\u5408\uff0c\u53c2\u8003\u4e0a\u4e00\u8282"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"PageInfo\u76f8\u5173API\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"startPage()\uff1a\u8bbe\u7f6e\u5206\u9875\u53c2\u6570"}),"\n",(0,i.jsx)(e.li,{children:"PageInfo\uff1a\u5206\u9875\u76f8\u5173\u53c2\u6570\u529f\u80fd\u7c7b\u3002"}),"\n",(0,i.jsx)(e.li,{children:"getTotal()\uff1a\u83b7\u53d6\u603b\u6761\u6570"}),"\n",(0,i.jsx)(e.li,{children:"getPages()\uff1a\u83b7\u53d6\u603b\u9875\u6570"}),"\n",(0,i.jsx)(e.li,{children:"getPageNum()\uff1a\u83b7\u53d6\u5f53\u524d\u9875"}),"\n",(0,i.jsx)(e.li,{children:"getPageSize()\uff1a\u83b7\u53d6\u6bcf\u9875\u663e\u793a\u6761\u6570"}),"\n",(0,i.jsx)(e.li,{children:"getPrePage()\uff1a\u83b7\u53d6\u4e0a\u4e00\u9875"}),"\n",(0,i.jsx)(e.li,{children:"getNextPage()\uff1a\u83b7\u53d6\u4e0b\u4e00\u9875"}),"\n",(0,i.jsx)(e.li,{children:"isIsFirstPage()\uff1a\u83b7\u53d6\u662f\u5426\u662f\u7b2c\u4e00\u9875"}),"\n",(0,i.jsx)(e.li,{children:"isIsLastPage()\uff1a\u83b7\u53d6\u662f\u5426\u662f\u6700\u540e\u4e00\u9875"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h1,{id:"spring",children:"Spring"}),"\n",(0,i.jsx)(e.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u662f\u5206\u5c42\u7684 JavaSE/EE \u5e94\u7528 full-stack \u8f7b\u91cf\u7ea7\u5f00\u6e90\u6846\u67b6"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(11534).A+"",width:"343",height:"252"})}),"\n",(0,i.jsx)(e.p,{children:"Spring \u4f18\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u65b9\u4fbf\u89e3\u8026\uff0c\u7b80\u5316\u5f00\u53d1"}),"\n",(0,i.jsx)(e.li,{children:"\u65b9\u4fbf\u96c6\u6210\u5404\u79cd\u6846\u67b6"}),"\n",(0,i.jsx)(e.li,{children:"\u65b9\u4fbf\u7a0b\u5e8f\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.li,{children:"AOP \u7f16\u7a0b\u96be\u8fc7\u7684\u652f\u6301"}),"\n",(0,i.jsx)(e.li,{children:"\u58f0\u660e\u5f0f\u4e8b\u52a1\u7684\u652f\u6301"}),"\n",(0,i.jsx)(e.li,{children:"\u964d\u4f4e JavaEE API \u7684\u4f7f\u7528\u96be\u5ea6"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f53\u7cfb\u7ed3\u6784\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(68865).A+"",width:"1130",height:"515"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u89c6\u9891\uff1a",(0,i.jsx)(e.a,{href:"https://space.bilibili.com/37974444",children:"https://space.bilibili.com/37974444"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"ioc",children:"IoC"}),"\n",(0,i.jsx)(e.h3,{id:"\u57fa\u672c\u6982\u8ff0",children:"\u57fa\u672c\u6982\u8ff0"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"IoC\uff08Inversion Of Control\uff09\u63a7\u5236\u53cd\u8f6c\uff0cSpring \u53cd\u5411\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u8981\u4f7f\u7528\u7684\u5916\u90e8\u8d44\u6e90"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Spring \u63a7\u5236\u7684\u8d44\u6e90\u5168\u90e8\u653e\u7f6e\u5728 Spring \u5bb9\u5668\u4e2d\uff0c\u8be5\u5bb9\u5668\u79f0\u4e3a IoC \u5bb9\u5668"}),"\uff08\u5b58\u653e\u5b9e\u4f8b\u5bf9\u8c61\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5b98\u65b9\u7f51\u7ad9\uff1a",(0,i.jsx)(e.code,{children:"https://spring.io/"})," \u2192 Projects \u2192 spring-framework \u2192 LEARN \u2192 Reference Doc"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(63703).A+"",width:"669",height:"242"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8026\u5408\uff08Coupling\uff09\uff1a\u4ee3\u7801\u7f16\u5199\u8fc7\u7a0b\u4e2d\u6240\u4f7f\u7528\u6280\u672f\u7684\u7ed3\u5408\u7d27\u5bc6\u5ea6\uff0c\u7528\u4e8e\u8861\u91cf\u8f6f\u4ef6\u4e2d\u5404\u4e2a\u6a21\u5757\u4e4b\u95f4\u7684\u4e92\u8054\u7a0b\u5ea6"}),"\n",(0,i.jsx)(e.li,{children:"\u5185\u805a\uff08Cohesion\uff09\uff1a\u4ee3\u7801\u7f16\u5199\u8fc7\u7a0b\u4e2d\u5355\u4e2a\u6a21\u5757\u5185\u90e8\u5404\u7ec4\u6210\u90e8\u5206\u95f4\u7684\u8054\u7cfb\uff0c\u7528\u4e8e\u8861\u91cf\u8f6f\u4ef6\u4e2d\u5404\u4e2a\u529f\u80fd\u6a21\u5757\u5185\u90e8\u7684\u529f\u80fd\u8054\u7cfb"}),"\n",(0,i.jsx)(e.li,{children:"\u4ee3\u7801\u7f16\u5199\u7684\u76ee\u6807\uff1a\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\u3002\u540c\u4e00\u4e2a\u6a21\u5757\u5185\u7684\u5404\u4e2a\u5143\u7d20\u4e4b\u95f4\u8981\u9ad8\u5ea6\u7d27\u5bc6\uff0c\u5404\u4e2a\u6a21\u5757\u4e4b\u95f4\u7684\u76f8\u4e92\u4f9d\u5b58\u5ea6\u4e0d\u7d27\u5bc6"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5165\u95e8\u9879\u76ee",children:"\u5165\u95e8\u9879\u76ee"}),"\n",(0,i.jsx)(e.p,{children:"\u6a21\u62df\u4e09\u5c42\u67b6\u6784\u4e2d\u8868\u73b0\u5c42\u8c03\u7528\u4e1a\u52a1\u5c42\u529f\u80fd"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8868\u73b0\u5c42\uff1aUserApp \u6a21\u62df UserServlet\uff08\u4f7f\u7528 main \u65b9\u6cd5\u6a21\u62df\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42\uff1aUserService"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165 spring \u5750\u6807\uff085.1.9.release\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-context</artifactId>\n    <version>5.1.9.RELEASE</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7f16\u5199\u4e1a\u52a1\u5c42\u4e0e\u8868\u73b0\u5c42\uff08\u6a21\u62df\uff09\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b service.UserService\uff0cservice.impl.UserServiceImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserService {\n\t//\u4e1a\u52a1\u65b9\u6cd5  \n\tvoid save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    public void save() {\n        System.out.println("user service running...");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5efa\u7acb Spring \u914d\u7f6e\u6587\u4ef6\uff1aresources.",(0,i.jsx)(e.strong,{children:"applicationContext"}),".xml (\u540d\u5b57\u4e00\u822c\u4f7f\u7528\u8be5\u683c\u5f0f)"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6240\u9700\u8d44\u6e90\uff08Service\uff09\u4e3a Spring \u63a7\u5236\u7684\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!-- 1.\u521b\u5efaspring\u63a7\u5236\u7684\u8d44\u6e90--\x3e\n    <bean id="userService" class="service.impl.UserServiceImpl"/>\n</beans>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8868\u73b0\u5c42\uff08App\uff09\u901a\u8fc7 Spring \u83b7\u53d6\u8d44\u6e90\uff08Service \u5b9e\u4f8b\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserApp {\n    public static void main(String[] args) {\n        //2.\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\n        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n        //3.\u83b7\u53d6\u8d44\u6e90\n        UserService userService = (UserService) ctx.getBean("userService");\n        userService.save();//user service running...\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(46457).A+"",width:"771",height:"159"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"xml\u5f00\u53d1",children:"XML\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h4,{id:"bean",children:"bean"}),"\n",(0,i.jsx)(e.h5,{id:"\u57fa\u672c\u5c5e\u6027",children:"\u57fa\u672c\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsxs)(e.bean,{children:[" \u6807\u7b7e\uff0c",(0,i.jsx)(e.beans,{children:" \u7684\u5b50\u6807\u7b7e"})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5b9a\u4e49 Spring \u4e2d\u7684\u8d44\u6e90\uff0c\u53d7\u6b64\u6807\u7b7e\u5b9a\u4e49\u7684\u8d44\u6e90\u5c06\u53d7\u5230 Spring \u63a7\u5236"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<beans>\n\t<bean />\n</beans>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"id\uff1abean \u7684\u540d\u79f0\uff0c\u901a\u8fc7 id \u503c\u83b7\u53d6 bean (\u9996\u5b57\u6bcd\u5c0f\u5199)"}),"\n",(0,i.jsx)(e.li,{children:"class\uff1abean \u7684\u7c7b\u578b\uff0c\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u7c7b\u540d"}),"\n",(0,i.jsx)(e.li,{children:"name\uff1abean \u7684\u540d\u79f0\uff0c\u53ef\u4ee5\u901a\u8fc7 name \u503c\u83b7\u53d6 bean\uff0c\u7528\u4e8e\u591a\u4eba\u914d\u5408\u65f6\u7ed9 bean \u8d77\u522b\u540d"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="beanId" name="beanName1,beanName2" class="ClassName"></bean>\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'ctx.getBean("beanId") == ctx.getBean("beanName1") == ctx.getBean("beanName2")\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u4f5c\u7528\u8303\u56f4",children:"\u4f5c\u7528\u8303\u56f4"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5b9a\u4e49 bean \u7684\u4f5c\u7528\u8303\u56f4"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean scope="singleton"></bean>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u53d6\u503c\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"singleton\uff1a\u8bbe\u5b9a\u521b\u5efa\u51fa\u7684\u5bf9\u8c61\u4fdd\u5b58\u5728 Spring \u5bb9\u5668\u4e2d\uff0c\u662f\u4e00\u4e2a\u5355\u4f8b\u7684\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"prototype\uff1a\u8bbe\u5b9a\u521b\u5efa\u51fa\u7684\u5bf9\u8c61\u4fdd\u5b58\u5728 Spring \u5bb9\u5668\u4e2d\uff0c\u662f\u4e00\u4e2a\u975e\u5355\u4f8b\uff08\u539f\u578b\uff09\u7684\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"request\u3001session\u3001application\u3001 websocket \uff1a\u8bbe\u5b9a\u521b\u5efa\u51fa\u7684\u5bf9\u8c61\u653e\u7f6e\u5728 web \u5bb9\u5668\u5bf9\u5e94\u7684\u4f4d\u7f6e"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Spring \u5bb9\u5668\u4e2d Bean \u7684",(0,i.jsx)(e.strong,{children:"\u7ebf\u7a0b\u5b89\u5168"}),"\u95ee\u9898\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u539f\u578b Bean\uff0c\u6bcf\u6b21\u521b\u5efa\u4e00\u4e2a\u65b0\u5bf9\u8c61\uff0c\u7ebf\u7a0b\u4e4b\u95f4\u5e76\u4e0d\u5b58\u5728 Bean \u5171\u4eab\uff0c\u6240\u4ee5\u4e0d\u4f1a\u6709\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5355\u4f8b Bean\uff0c\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u4e00\u4e2a\u5355\u4f8b\u5b9e\u4f8b Bean\uff0c\u56e0\u6b64\u662f\u5b58\u5728\u8d44\u6e90\u7684\u7ade\u4e89\uff0c\u5982\u679c\u5355\u4f8b Bean\u662f\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u65e0\u72b6\u6001 Bean"}),"\uff0c\u4e5f\u5c31\u662f\u7ebf\u7a0b\u4e2d\u7684\u64cd\u4f5c\u4e0d\u4f1a\u5bf9 Bean \u7684\u6210\u5458\u6267\u884c\u67e5\u8be2\u4ee5\u5916\u7684\u64cd\u4f5c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5355\u4f8b Bean \u662f\u7ebf\u7a0b\u5b89\u5168\u7684"]}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1a\u5f00\u53d1\u4eba\u5458\u6765\u8fdb\u884c\u7ebf\u7a0b\u5b89\u5168\u7684\u4fdd\u8bc1\uff0c\u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u628a Bean \u7684\u4f5c\u7528\u57df singleton \u6539\u4e3a protopyte"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u751f\u547d\u5468\u671f",children:"\u751f\u547d\u5468\u671f"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5b9a\u4e49 bean \u5bf9\u8c61\u5728\u521d\u59cb\u5316\u6216\u9500\u6bc1\u65f6\u5b8c\u6210\u7684\u5de5\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean init-method="init" destroy-method="destroy></bean>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u53d6\u503c\uff1abean \u5bf9\u5e94\u7684\u7c7b\u4e2d\u5bf9\u5e94\u7684\u5177\u4f53\u65b9\u6cd5\u540d"}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u73b0\u63a5\u53e3\u7684\u65b9\u5f0f\u5b9e\u73b0\u521d\u59cb\u5316\uff0c\u65e0\u9700\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e init-method\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5b9e\u73b0 InitializingBean\uff0c\u5b9a\u4e49\u521d\u59cb\u5316\u903b\u8f91"}),"\n",(0,i.jsx)(e.li,{children:"\u5b9e\u73b0 DisposableBean\uff0c\u5b9a\u4e49\u9500\u6bc1\u903b\u8f91"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\u4e8b\u9879\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5f53 scope=\u201csingleton\u201d \u65f6\uff0cSpring \u5bb9\u5668\u4e2d\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u5bf9\u8c61\uff0cinit \u65b9\u6cd5\u5728\u521b\u5efa\u5bb9\u5668\u65f6\u4ec5\u6267\u884c\u4e00\u6b21"}),"\n",(0,i.jsx)(e.li,{children:"\u5f53 scope=\u201cprototype\u201d \u65f6\uff0cSpring \u5bb9\u5668\u8981\u521b\u5efa\u540c\u4e00\u7c7b\u578b\u7684\u591a\u4e2a\u5bf9\u8c61\uff0cinit \u65b9\u6cd5\u5728\u6bcf\u4e2a\u5bf9\u8c61\u521b\u5efa\u65f6\u5747\u6267\u884c\u4e00\u6b21"}),"\n",(0,i.jsxs)(e.li,{children:["\u5f53 scope=\u201csingleton\u201d \u65f6\uff0c\u5173\u95ed\u5bb9\u5668\uff08",(0,i.jsx)(e.code,{children:".close()"}),"\uff09\u4f1a\u5bfc\u81f4 bean \u5b9e\u4f8b\u7684\u9500\u6bc1\uff0c\u8c03\u7528 destroy \u65b9\u6cd5\u4e00\u6b21"]}),"\n",(0,i.jsx)(e.li,{children:"\u5f53 scope=\u201cprototype\u201d \u65f6\uff0c\u5bf9\u8c61\u7684\u9500\u6bc1\u7531\u5783\u573e\u56de\u6536\u673a\u5236 GC \u63a7\u5236\uff0cdestroy \u65b9\u6cd5\u5c06\u4e0d\u4f1a\u88ab\u6267\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"bean \u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--init-method\u548cdestroy-method\u7528\u4e8e\u63a7\u5236bean\u7684\u751f\u547d\u5468\u671f--\x3e\n<bean id="userService3" scope="prototype" init-method="init" destroy-method="destroy" class="service.impl.UserServiceImpl"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42\u5b9e\u73b0\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService{\n    public UserServiceImpl(){\n        System.out.println(" constructor is running...");\n    }\n\n    public void init(){\n        System.out.println("init....");\n    }\n\n    public void destroy(){\n        System.out.println("destroy....");\n    }\n\n    public void save() {\n        System.out.println("user service running...");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'UserService userService = (UserService)ctx.getBean("userService3");\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u521b\u5efa\u65b9\u5f0f",children:"\u521b\u5efa\u65b9\u5f0f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9759\u6001\u5de5\u5382"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5b9a\u4e49 bean \u5bf9\u8c61\u521b\u5efa\u65b9\u5f0f\uff0c\u4f7f\u7528\u9759\u6001\u5de5\u5382\u7684\u5f62\u5f0f\u521b\u5efa bean\uff0c\u517c\u5bb9\u65e9\u671f\u9057\u7559\u7cfb\u7edf\u7684\u5347\u7ea7\u5de5\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean class="FactoryClassName" factory-method="factoryMethodName"></bean>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u53d6\u503c\uff1a\u5de5\u5382 bean \u4e2d\u7528\u4e8e\u83b7\u53d6\u5bf9\u8c61\u7684\u9759\u6001\u65b9\u6cd5\u540d"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\u4e8b\u9879\uff1aclass \u5c5e\u6027\u5fc5\u987b\u914d\u7f6e\u6210\u9759\u6001\u5de5\u5382\u7684\u7c7b\u540d"}),"\n",(0,i.jsx)(e.p,{children:"bean \u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u9759\u6001\u5de5\u5382\u521b\u5efa bean--\x3e\n<bean id="userService4" class="service.UserServiceFactory" factory-method="getService"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5de5\u5382\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceFactory {\n    public static UserService getService(){\n        System.out.println("factory create object...");\n        return new UserServiceImpl();\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'UserService userService = (UserService)ctx.getBean("userService4");\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9e\u4f8b\u5de5\u5382"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5b9a\u4e49 bean \u5bf9\u8c61\u521b\u5efa\u65b9\u5f0f\uff0c\u4f7f\u7528\u5b9e\u4f8b\u5de5\u5382\u7684\u5f62\u5f0f\u521b\u5efa bean\uff0c\u517c\u5bb9\u65e9\u671f\u9057\u7559\u7cfb\u7edf\u7684\u5347\u7ea7\u5de5\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean factory-bean="factoryBeanId" factory-method="factoryMethodName"></bean>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\u4e8b\u9879\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u5b9e\u4f8b\u5de5\u5382\u521b\u5efa bean \u9996\u5148\u9700\u8981\u5c06\u5b9e\u4f8b\u5de5\u5382\u914d\u7f6e bean\uff0c\u4ea4\u7531 Spring \u8fdb\u884c\u7ba1\u7406"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"factory-bean \u662f\u5b9e\u4f8b\u5de5\u5382\u7684 Id"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"bean \u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u5b9e\u4f8b\u5de5\u5382\u521b\u5efa bean\uff0c\u4f9d\u8d56\u5de5\u5382\u5bf9\u8c61\u5bf9\u5e94\u7684 bean--\x3e\n<bean id="factoryBean" class="service.UserServiceFactory2"/>\n<bean id="userService5" factory-bean="factoryBean" factory-method="getService"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5de5\u5382\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceFactory2 {\n    public UserService getService(){\n        System.out.println(" instance factory create object...");\n        return new UserServiceImpl();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u83b7\u53d6bean",children:"\u83b7\u53d6Bean"}),"\n",(0,i.jsx)(e.p,{children:"ApplicationContext \u5b50\u7c7b\u76f8\u5173API\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"String[] getBeanDefinitionNames()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6 Spring \u5bb9\u5668\u4e2d\u5b9a\u4e49\u7684\u6240\u6709 JavaBean \u7684\u540d\u79f0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"BeanDefinition getBeanDefinition(String beanName)"}),(0,i.jsx)(e.td,{children:"\u8fd4\u56de\u7ed9\u5b9a bean \u540d\u79f0\u7684 BeanDefinition"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"String[] getBeanNamesForType(Class<?> type)"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6 Spring \u5bb9\u5668\u4e2d\u6307\u5b9a\u7c7b\u578b\u7684\u6240\u6709 JavaBean \u7684\u540d\u79f0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Environment getEnvironment()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e0e\u6b64\u7ec4\u4ef6\u5173\u8054\u7684\u73af\u5883"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"di",children:"DI"}),"\n",(0,i.jsx)(e.h5,{id:"\u4f9d\u8d56\u6ce8\u5165",children:"\u4f9d\u8d56\u6ce8\u5165"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"IoC\uff08Inversion Of Control\uff09\u63a7\u5236\u7ffb\u8f6c\uff0cSpring \u53cd\u5411\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u8981\u4f7f\u7528\u7684\u5916\u90e8\u8d44\u6e90"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DI\uff08Dependency Injection\uff09\u4f9d\u8d56\u6ce8\u5165\uff0c\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u4f9d\u8d56\u7684\u8d44\u6e90\u7531 Spring \u4e3a\u5176\u63d0\u4f9b\uff0c\u8d44\u6e90\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f\u7684\u65b9\u5f0f\u79f0\u4e3a\u6ce8\u5165\uff0c\u7b80\u5355\u8bf4\u5c31\u662f\u5229\u7528\u53cd\u5c04\u673a\u5236\u4e3a\u7c7b\u7684\u5c5e\u6027\u8d4b\u503c\u7684\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(47931).A+"",width:"504",height:"247"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"IoC \u548c DI \u7684\u5173\u7cfb\uff1aIoC \u4e0e DI \u662f\u540c\u4e00\u4ef6\u4e8b\u7ad9\u5728\u4e0d\u540c\u89d2\u5ea6\u770b\u5f85\u95ee\u9898"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"set-\u6ce8\u5165",children:"set \u6ce8\u5165"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsxs)(e.property,{children:[" \u6807\u7b7e\uff0c",(0,i.jsx)(e.bean,{children:" \u7684\u5b50\u6807\u7b7e"})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4f7f\u7528 set \u65b9\u6cd5\u7684\u5f62\u5f0f\u4e3a bean \u63d0\u4f9b\u8d44\u6e90"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<bean>\n\t<property />\n    <property />\n    .....\n</bean>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"name\uff1a\u5bf9\u5e94 bean \u4e2d\u7684\u5c5e\u6027\u540d\uff0c\u8981\u6ce8\u5165\u7684\u53d8\u91cf\u540d\uff0c\u8981\u6c42\u8be5\u5c5e\u6027\u5fc5\u987b\u63d0\u4f9b\u53ef\u8bbf\u95ee\u7684 set \u65b9\u6cd5\uff08\u4e25\u683c\u89c4\u8303\u6b64\u540d\u79f0\u662f set \u65b9\u6cd5\u5bf9\u5e94\u540d\u79f0\uff0c\u9996\u5b57\u6bcd\u5fc5\u987b\u5c0f\u5199\uff09"}),"\n",(0,i.jsxs)(e.li,{children:["value\uff1a\u8bbe\u5b9a\u975e\u5f15\u7528\u7c7b\u578b\u5c5e\u6027\u5bf9\u5e94\u7684\u503c\uff0c",(0,i.jsx)(e.strong,{children:"\u4e0d\u80fd\u4e0e ref \u540c\u65f6\u4f7f\u7528"})]}),"\n",(0,i.jsx)(e.li,{children:"ref\uff1a\u8bbe\u5b9a\u5f15\u7528\u7c7b\u578b\u5c5e\u6027\u5bf9\u5e94 bean \u7684 id \uff0c\u4e0d\u80fd\u4e0e value \u540c\u65f6\u4f7f\u7528"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<property name="propertyName" value="propertyValue" ref="beanId"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO \u5c42\uff1a\u8981\u6ce8\u5165\u7684\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserDao {\n    public void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserDaoImpl implements UserDao{\n    public void save(){\n        System.out.println("user dao running...");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service \u4e1a\u52a1\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserService {\n    public void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n\tprivate UserDao userDao;\n    private int num;\n    \n    //1.\u5bf9\u9700\u8981\u8fdb\u884c\u6ce8\u5165\u7684\u53d8\u91cf\u6dfb\u52a0set\u65b9\u6cd5\n    public void setUserDao(UserDao userDao) {\n        this.userDao = userDao;\n    }\n    \n\tpublic void setNum(int num) {\n        this.num = num;\n    }\n    \n    public void save() {\n        System.out.println("user service running..." + num);\n        userDao.save();\n        bookDao.save();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--2.\u5c06\u8981\u6ce8\u5165\u7684\u8d44\u6e90\u58f0\u660e\u4e3abean--\x3e\n<bean id="userDao" class="dao.impl.UserDaoImpl"/>\n\n<bean id="userService" class="service.impl.UserServiceImpl">\n\t\x3c!--3.\u5c06\u8981\u6ce8\u5165\u7684\u5f15\u7528\u7c7b\u578b\u7684\u53d8\u91cf\u901a\u8fc7property\u5c5e\u6027\u8fdb\u884c\u6ce8\u5165\uff0c--\x3e\n    <property name="userDao" ref="userDao"/>\n    <property name="num" value="666"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserApp {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n        UserService userService = (UserService) ctx.getBean("userService");\n        userService.save();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6784\u9020\u6ce8\u5165",children:"\u6784\u9020\u6ce8\u5165"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsxs)(r,{children:[" \u6807\u7b7e\uff0c",(0,i.jsx)(e.bean,{children:" \u7684\u5b50\u6807\u7b7e"})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u7684\u5f62\u5f0f\u4e3a bean \u63d0\u4f9b\u8d44\u6e90\uff0c\u517c\u5bb9\u65e9\u671f\u9057\u7559\u7cfb\u7edf\u7684\u5347\u7ea7\u5de5\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<bean>\n\t<constructor-arg />\n    .....\x3c!--\u4e00\u4e2abean\u53ef\u4ee5\u6709\u591a\u4e2aconstructor-arg\u6807\u7b7e--\x3e\n</bean>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"name\uff1a\u5bf9\u5e94bean\u4e2d\u7684\u6784\u9020\u65b9\u6cd5\u6240\u643a\u5e26\u7684\u53c2\u6570\u540d"}),"\n",(0,i.jsx)(e.li,{children:"value\uff1a\u8bbe\u5b9a\u975e\u5f15\u7528\u7c7b\u578b\u6784\u9020\u65b9\u6cd5\u53c2\u6570\u5bf9\u5e94\u7684\u503c\uff0c\u4e0d\u80fd\u4e0e ref \u540c\u65f6\u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:"ref\uff1a\u8bbe\u5b9a\u5f15\u7528\u7c7b\u578b\u6784\u9020\u65b9\u6cd5\u53c2\u6570\u5bf9\u5e94 bean \u7684 id \uff0c\u4e0d\u80fd\u4e0e value \u540c\u65f6\u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:"type\uff1a\u8bbe\u5b9a\u6784\u9020\u65b9\u6cd5\u53c2\u6570\u7684\u7c7b\u578b\uff0c\u7528\u4e8e\u6309\u7c7b\u578b\u5339\u914d\u53c2\u6570\u6216\u8fdb\u884c\u7c7b\u578b\u6821\u9a8c"}),"\n",(0,i.jsx)(e.li,{children:"index\uff1a\u8bbe\u5b9a\u6784\u9020\u65b9\u6cd5\u53c2\u6570\u7684\u4f4d\u7f6e\uff0c\u7528\u4e8e\u6309\u4f4d\u7f6e\u5339\u914d\u53c2\u6570\uff0c\u53c2\u6570 index \u503c\u4ece 0 \u5f00\u59cb\u8ba1\u6570"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<constructor-arg name="argsName" value="argsValue" />\n<constructor-arg index="arg-index" type="arg-type" ref="beanId"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO \u5c42\uff1a\u8981\u6ce8\u5165\u7684\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserDaoImpl implements UserDao{\n    private String username;\n    private String pwd;\n    private String driver;\n\n    public UserDaoImpl(String driver,String username, String pwd) {\n        this.driver = driver;\n        this.username = username;\n        this.pwd = pwd;\n    }\n    public void save(){\n        System.out.println("user dao running..."+username+" "+pwd+" "+driver);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service \u4e1a\u52a1\u5c42\uff1a\u53c2\u8003 set \u6ce8\u5165"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="userDao" class="dao.impl.UserDaoImpl">\n    \x3c!--\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u8fdb\u884c\u6ce8\u5165\uff0c\u9700\u8981\u4fdd\u969c\u6ce8\u5165\u7684\u5c5e\u6027\u4e0ebean\u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\u4e00\u81f4--\x3e\n\t\x3c!--\u4e00\u81f4\u6307\u987a\u5e8f\u4e00\u81f4\u6216\u7c7b\u578b\u4e00\u81f4\u6216\u4f7f\u7528index\u89e3\u51b3\u8be5\u95ee\u9898--\x3e\n    <constructor-arg index="2" value="123"/>\n    <constructor-arg index="1" value="root"/>\n    <constructor-arg index="0" value="com.mysql.jdbc.Driver"/>\n</bean>\n\n<bean id="userService" class="service.impl.UserServiceImpl">\n    <property name="userDao" ref="userDao"/>\n    <property name="num" value="666"/>\n</bean>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u65b9\u5f0f\u4e8c\uff1a\u4f7f\u7528 UserServiceImpl \u7684\u6784\u9020\u65b9\u6cd5\u6ce8\u5165"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="userService" class="service.impl.UserServiceImpl">\n\t<constructor-arg name="userDao" ref="userDao"/>\n\t<constructor-arg name="num" value="666666"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b\uff1a\u53c2\u8003 set \u6ce8\u5165"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u96c6\u5408\u6ce8\u5165",children:"\u96c6\u5408\u6ce8\u5165"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsxs)(e.array,{children:[" ",(0,i.jsxs)(e.list,{children:[" ",(0,i.jsxs)(e.set,{children:[" ",(0,i.jsxs)(e.map,{children:[" ",(0,i.jsxs)(e.props,{children:["\uff0c",(0,i.jsxs)(e.property,{children:[" \u6216 ",(0,i.jsx)(r,{children:" \u6807\u7b7e\u7684\u5b50\u6807\u7b7e"})]})]})]})]})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6ce8\u5165\u96c6\u5408\u6570\u636e\u7c7b\u578b\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<property>\n\t<list></list>\n</property>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO \u5c42\uff1a\u8981\u6ce8\u5165\u7684\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface BookDao {\n    public void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class BookDaoImpl implements BookDao {\n    private ArrayList al;\n    private Properties properties;\n    private int[] arr;\n    private HashSet hs;\n    private HashMap hm ;\n\n    public void setAl(ArrayList al) {\n        this.al = al;\n    }\n\n    public void setProperties(Properties properties) {\n        this.properties = properties;\n    }\n\n    public void setArr(int[] arr) {\n        this.arr = arr;\n    }\n\n    public void setHs(HashSet hs) {\n        this.hs = hs;\n    }\n\n    public void setHm(HashMap hm) {\n        this.hm = hm;\n    }\n\n    public void save() {\n        System.out.println("book dao running...");\n        System.out.println("ArrayList:" + al);\n        System.out.println("Properties:" + properties);\n        for (int i = 0; i < arr.length; i++) {\n            System.out.println(arr[i]);\n        }\n        System.out.println("HashSet:" + hs);\n        System.out.println("HashMap:" + hm);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service \u4e1a\u52a1\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    private BookDao bookDao;\n    \n    public UserServiceImpl() {}\n    \n\tpublic void setBookDao(BookDao bookDao) {\n        this.bookDao = bookDao;\n    }\n\n    public void save() {\n        System.out.println("user service running..." + num);\n        bookDao.save();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="userService" class="service.impl.UserServiceImpl">\n    <property name="bookDao" ref="bookDao"/>\n</bean>\n\n<bean id="bookDao" class="dao.impl.BookDaoImpl">\n    <property name="al">\n        <list>\n            <value>seazean</value>\n            <value>66666</value>\n        </list>\n    </property>\n    <property name="properties">\n        <props>\n            <prop key="name">seazean666</prop>\n            <prop key="value">666666</prop>\n        </props>\n    </property>\n    <property name="arr">\n        <array>\n            <value>123456</value>\n            <value>66666</value>\n        </array>\n    </property>\n    <property name="hs">\n        <set>\n            <value>seazean</value>\n            <value>66666</value>\n        </set>\n    </property>\n    <property name="hm">\n        <map>\n            <entry key="name" value="seazean66666"/>\n            <entry key="value" value="6666666666"/>\n        </map>\n    </property>\n</bean>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"p",children:"P"}),"\n",(0,i.jsx)(e.p,{children:"\u6807\u7b7e\uff1a<p:propertyName>\uff0c<p:propertyName-ref>"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4e3a bean \u6ce8\u5165\u5c5e\u6027\u503c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean p:propertyName="propertyValue" p:propertyName-ref="beanId"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u542f p \u547d\u4ee4\u7a7a\u95f4\uff1a\u5f00\u542f Spring \u5bf9 p \u547d\u4ee4\u7a7a\u95f4\u7684\u7684\u652f\u6301\uff0c\u5728 beans \u6807\u7b7e\u4e2d\u6dfb\u52a0\u5bf9\u5e94\u7a7a\u95f4\u652f\u6301"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<beans xmlns="http://www.springframework.org/schema/beans"   \t\t\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    \n       xmlns:p="http://www.springframework.org/schema/p"       \n       xsi:schemaLocation="\n\t\thttp://www.springframework.org/schema/beans     \n\t\thttps://www.springframework.org/schema/beans/spring-beans.xsd">\n</beans>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean \n      id="userService"\n      class="service.impl.UserServiceImpl"\n      p:userDao-ref="userDao"\n      p:bookDao-ref="bookDao"\n      p:num="10"\n\t/>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"spel",children:"SpEL"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u63d0\u4f9b\u4e86\u5bf9 EL \u8868\u8fbe\u5f0f\u7684\u652f\u6301\uff0c\u7edf\u4e00\u5c5e\u6027\u6ce8\u5165\u683c\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4e3a bean \u6ce8\u5165\u5c5e\u6027\u503c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<property value="EL">\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u6240\u6709\u5c5e\u6027\u503c\u4e0d\u533a\u5206\u662f\u5426\u5f15\u7528\u7c7b\u578b\uff0c\u7edf\u4e00\u4f7f\u7528value\u8d4b\u503c"}),"\n",(0,i.jsx)(e.p,{children:"\u6240\u6709\u683c\u5f0f\u7edf\u4e00\u4f7f\u7528  value=\u201c#{}\u201d"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5e38\u91cf  #{10}  #{3.14}  #{2e5}  #{\u2018it\u2019}"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u7528 bean  #{beanId}"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u7528 bean \u5c5e\u6027  #{beanId.propertyName}"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u7528 bean \u65b9\u6cd5  beanId.methodName().method2()"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u7528\u9759\u6001\u65b9\u6cd5  T(java.lang.Math).PI"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fd0\u7b97\u7b26\u652f\u6301  #{3 lt 4 == 4 ge 3}"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6b63\u5219\u8868\u8fbe\u5f0f\u652f\u6301  #{user.name matches\u2018[a-z]{6,}\u2019}"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u96c6\u5408\u652f\u6301  #{likes[3]}"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="userService" class="service.impl.UserServiceImpl">\n        <property name="userDao" value="#{userDao}"/>\n        <property name="bookDao" value="#{bookDao}"/>\n        <property name="num" value="#{666666666}"/>\n    </bean>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"prop",children:"prop"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u63d0\u4f9b\u4e86\u8bfb\u53d6\u5916\u90e8 properties \u6587\u4ef6\u7684\u673a\u5236\uff0c\u4f7f\u7528\u8bfb\u53d6\u5230\u7684\u6570\u636e\u4e3a bean \u7684\u5c5e\u6027\u8d4b\u503c"}),"\n",(0,i.jsx)(e.p,{children:"\u64cd\u4f5c\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u51c6\u5907\u5916\u90e8 properties \u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f00\u542f context \u547d\u540d\u7a7a\u95f4\u652f\u6301"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xsi:schemaLocation="\n        http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        https://www.springframework.org/schema/context/spring-context.xsd\n        ">\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u52a0\u8f7d\u6307\u5b9a\u7684 properties \u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<context:property-placeholder location="classpath:data.properties" />\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u52a0\u8f7d\u7684\u6570\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<property name="propertyName" value="${propertiesName}"/>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a\u5982\u679c\u9700\u8981\u52a0\u8f7d\u6240\u6709\u7684 properties \u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"*.properties"})," \u8868\u793a\u52a0\u8f7d\u6240\u6709\u7684 properties \u6587\u4ef6"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a\u8bfb\u53d6\u6570\u636e\u4f7f\u7528 ",(0,i.jsx)(e.strong,{children:"${propertiesName}"})," \u683c\u5f0f\u8fdb\u884c\uff0c\u5176\u4e2d propertiesName \u6307 properties \u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\u540d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"data.properties"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"username=root\npwd=123456\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO \u5c42\uff1a\u6ce8\u5165\u7684\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserDao {\n    public void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserDaoImpl implements UserDao{\n    private String userName;\n    private String password;\n\n    public void setUserName(String userName) {\n        this.userName = userName;\n    }\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public void save(){\n        System.out.println("user dao running..."+userName+" "+password);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service \u4e1a\u52a1\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    private UserDao userDao;\n    public void setUserDao(UserDao userDao) {\n        this.userDao = userDao;\n    }\n    public void save() {\n        System.out.println("user service running...");\n        userDao.save();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<context:property-placeholder location="classpath:*.properties"/>\n\n<bean id="userDao" class="dao.impl.UserDaoImpl">\n    <property name="userName" value="${username}"/>\n    <property name="password" value="${pwd}"/>\n</bean>\n\n<bean id="userService" class="service.impl.UserServiceImpl">\n    <property name="userDao" ref="userDao"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserApp {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n        UserService userService = (UserService) ctx.getBean("userService");\n        userService.save();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"import",children:"import"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsxs)(e.import,{children:["\uff0c",(0,i.jsx)(e.beans,{children:"\u6807\u7b7e\u7684\u5b50\u6807\u7b7e"})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5728\u5f53\u524d\u914d\u7f6e\u6587\u4ef6\u4e2d\u5bfc\u5165\u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u9879"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<beans>\n    <import />\n</beans>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"resource\uff1a\u52a0\u8f7d\u7684\u914d\u7f6e\u6587\u4ef6\u540d"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<import resource=\u201cconfig2.xml"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"Spring \u5bb9\u5668\u52a0\u8f7d\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"applicationContext-book.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="bookDao" class="dao.impl.BookDaoImpl">\n    <property name="num" value="1"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"applicationContext-user.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean id="userDao" class="dao.impl.UserDaoImpl">\n    <property name="userName" value="${username}"/>\n    <property name="password" value="${pwd}"/>\n</bean>\n\n<bean id="userService" class="service.impl.UserServiceImpl">\n    <property name="userDao" ref="userDao"/>\n    <property name="bookDao" ref="bookDao"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<import resource="applicationContext-user.xml"/>\n<import resource="applicationContext-book.xml"/>\n\n<bean id="bookDao" class="com.seazean.dao.impl.BookDaoImpl">\n    <property name="num" value="2"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'new ClassPathXmlApplicationContext("applicationContext-user.xml","applicationContext-book.xml");\nnew ClassPathXmlApplicationContext("applicationContext.xml");\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Spring \u5bb9\u5668\u4e2d\u7684 bean \u5b9a\u4e49\u51b2\u7a81\u95ee\u9898"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540c id \u7684 bean\uff0c\u540e\u5b9a\u4e49\u7684\u8986\u76d6\u5148\u5b9a\u4e49\u7684"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u914d\u7f6e\u6587\u4ef6\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c06\u5bfc\u5165\u7684\u914d\u7f6e\u6587\u4ef6\u590d\u5236\u7c98\u8d34\u5230\u5bf9\u5e94\u4f4d\u7f6e\uff0c\u7a0b\u5e8f\u6267\u884c\u9009\u62e9\u6700\u4e0b\u9762\u7684\u914d\u7f6e\u4f7f\u7528"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u914d\u7f6e\u6587\u4ef6\u7684\u987a\u5e8f\u4e0e\u4f4d\u7f6e\u4e0d\u540c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6700\u7ec8\u7a0b\u5e8f\u8fd0\u884c\u7ed3\u679c\u4e0d\u540c"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u4e09\u65b9\u8d44\u6e90",children:"\u4e09\u65b9\u8d44\u6e90"}),"\n",(0,i.jsx)(e.h5,{id:"druid",children:"Druid"}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e09\u65b9\u8d44\u6e90\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pom.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>druid</artifactId>\n    <version>1.1.16</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u52a0\u8f7ddruid\u8d44\u6e90--\x3e\n<bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">\n    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>\n    <property name="url" value="jdbc:mysql://192.168.2.185:3306/spring_db"/>\n    <property name="username" value="root"/>\n    <property name="password" value="123456"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"App.java"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\nDruidDataSource datasource = (DruidDataSource) ctx.getBean("datasource");\nSystem.out.println(datasource);\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"mybatis-1",children:"Mybatis"}),"\n",(0,i.jsx)(e.p,{children:"Mybatis \u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u6d88\u5931"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u73af\u5883 environment \u8f6c\u6362\u6210\u6570\u636e\u6e90\u5bf9\u8c61"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04 Mapper \u626b\u63cf\u5de5\u4f5c\u4ea4\u7531 Spring \u5904\u7406"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\u522b\u540d\u4ea4\u7531 Spring \u5904\u7406"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["DAO \u63a5\u53e3\u4e0d\u9700\u8981\u521b\u5efa\u5b9e\u73b0\u7c7b\uff0cMyBatis-Spring \u63d0\u4f9b\u4e86\u4e00\u4e2a\u52a8\u6001\u4ee3\u7406\u7684\u5b9e\u73b0 ",(0,i.jsx)(e.strong,{children:"MapperFactoryBean"}),"\uff0c\u8fd9\u4e2a\u7c7b\u53ef\u4ee5\u8ba9\u76f4\u63a5\u6ce8\u5165\u6570\u636e\u6620\u5c04\u5668\u63a5\u53e3\u5230 service \u5c42 bean \u4e2d\uff0c\u5e95\u5c42\u5c06\u4f1a\u52a8\u6001\u4ee3\u7406\u521b\u5efa\u7c7b"]}),"\n",(0,i.jsx)(e.p,{children:"\u6574\u5408\u539f\u7406\uff1a\u5229\u7528 Spring \u6846\u67b6\u7684 SPI \u673a\u5236\uff0c\u5728 META-INF \u76ee\u5f55\u7684 spring.handlers \u4e2d\u7ed9 Spring \u5bb9\u5668\u4e2d\u5bfc\u5165 NamespaceHandler \u7c7b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"NamespaceHandler \u7684 init \u65b9\u6cd5\u6ce8\u518c bean \u4fe1\u606f\u7684\u89e3\u6790\u5668 MapperScannerBeanDefinitionParser"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u89e3\u6790\u5668\u5728 Spring \u5bb9\u5668\u521b\u5efa\u8fc7\u7a0b\u4e2d\u53bb",(0,i.jsx)(e.strong,{children:"\u89e3\u6790 mapperScanner \u6807\u7b7e"}),"\uff0c\u89e3\u6790\u51fa\u7684\u5c5e\u6027\u586b\u5145\u5230 MapperScannerConfigurer \u4e2d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MapperScannerConfigurer \u5b9e\u73b0\u4e86 BeanDefinitionRegistryPostProcessor \u63a5\u53e3\uff0c\u91cd\u5199 postProcessBeanDefinitionRegistry() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u626b\u63cf\u5230 MyBatis \u7684 Mapper"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6ce8\u89e3\u5f00\u53d1-1",children:"\u6ce8\u89e3\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h4,{id:"\u6ce8\u89e3\u9a71\u52a8",children:"\u6ce8\u89e3\u9a71\u52a8"}),"\n",(0,i.jsx)(e.h5,{id:"xml",children:"XML"}),"\n",(0,i.jsx)(e.p,{children:"\u542f\u52a8\u6ce8\u89e3\u626b\u63cf\uff0c\u52a0\u8f7d\u7c7b\u4e2d\u914d\u7f6e\u7684\u6ce8\u89e3\u9879\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<context:component-scan base-package="packageName1,packageName2"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5728\u8fdb\u884c\u5305\u626b\u63cf\u65f6\uff0c\u4f1a\u5bf9\u914d\u7f6e\u7684\u5305\u53ca\u5176\u5b50\u5305\u4e2d\u6240\u6709\u6587\u4ef6\u8fdb\u884c\u626b\u63cf\uff0c\u591a\u4e2a\u5305\u91c7\u7528",(0,i.jsx)(e.code,{children:","}),"\u9694\u5f00"]}),"\n",(0,i.jsx)(e.li,{children:"\u626b\u63cf\u8fc7\u7a0b\u662f\u4ee5\u6587\u4ef6\u5939\u9012\u5f52\u8fed\u4ee3\u7684\u5f62\u5f0f\u8fdb\u884c\u7684"}),"\n",(0,i.jsx)(e.li,{children:"\u626b\u63cf\u8fc7\u7a0b\u4ec5\u8bfb\u53d6\u5408\u6cd5\u7684 Java \u6587\u4ef6"}),"\n",(0,i.jsx)(e.li,{children:"\u626b\u63cf\u65f6\u4ec5\u8bfb\u53d6 Spring \u53ef\u8bc6\u522b\u7684\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.li,{children:"\u626b\u63cf\u7ed3\u675f\u540e\u4f1a\u5c06\u53ef\u8bc6\u522b\u7684\u6709\u6548\u6ce8\u89e3\u8f6c\u5316\u4e3a Spring \u5bf9\u5e94\u7684\u8d44\u6e90\u52a0\u5165 IoC \u5bb9\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u4ece\u52a0\u8f7d\u6548\u7387\u4e0a\u6765\u8bf4\u6ce8\u89e3\u4f18\u4e8e XML \u914d\u7f6e\u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a\u542f\u52a8\u65f6\u4f7f\u7528\u6ce8\u89e3\u7684\u5f62\u5f0f\u66ff\u4ee3 xml \u914d\u7f6e\uff0c\u5c06 Spring \u914d\u7f6e\u6587\u4ef6\u4ece\u5de5\u7a0b\u4e2d\u6d88\u9664\uff0c\u7b80\u5316\u4e66\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u7f3a\u70b9\uff1a\u4e3a\u4e86\u8fbe\u6210\u6ce8\u89e3\u9a71\u52a8\u7684\u76ee\u7684\uff0c\u53ef\u80fd\u4f1a\u5c06\u539f\u5148\u5f88\u7b80\u5355\u7684\u4e66\u5199\uff0c\u53d8\u7684\u66f4\u52a0\u590d\u6742\u3002XML \u4e2d\u914d\u7f6e\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684\u8d44\u6e90\u662f\u5f88\u65b9\u4fbf\u7684\uff0c\u4f46\u4f7f\u7528\u6ce8\u89e3\u9a71\u52a8\u65e0\u6cd5\u5728\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684\u8d44\u6e90\u4e2d\u8fdb\u884c\u7f16\u8f91\uff0c\u56e0\u6b64\u4f1a\u589e\u5927\u5f00\u53d1\u5de5\u4f5c\u91cf"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(74685).A+"",width:"1016",height:"410"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u7eaf\u6ce8\u89e3",children:"\u7eaf\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\u914d\u7f6e\u7c7b"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Configuration\u3001@ComponentScan"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsxs)(e.p,{children:["\u4f5c\u7528\uff1a",(0,i.jsx)(e.strong,{children:"\u8bbe\u7f6e\u5f53\u524d\u7c7b\u4e3a Spring \u6838\u5fc3\u914d\u7f6e\u52a0\u8f7d\u7c7b"})]}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan({"scanPackageName1","scanPackageName2"})\npublic class SpringConfigClassName{\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6838\u5fc3\u914d\u5408\u7c7b\u7528\u4e8e\u66ff\u6362 Spring \u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff0c\u6b64\u7c7b\u53ef\u4ee5\u8bbe\u7f6e\u7a7a\u7684\uff0c\u4e0d\u8bbe\u7f6e\u53d8\u91cf\u4e0e\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.li,{children:["bean \u626b\u63cf\u5de5\u4f5c\u4f7f\u7528\u6ce8\u89e3 @ComponentScan \u66ff\u4ee3\uff0c\u591a\u4e2a\u5305\u7528 ",(0,i.jsx)(e.code,{children:"{} \u548c ,"})," \u9694\u5f00"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u52a0\u8f7d\u7eaf\u6ce8\u89e3\u683c\u5f0f\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff0c\u9700\u8981\u4f7f\u7528 ",(0,i.jsx)(e.strong,{children:"AnnotationConfigApplicationContext"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\npublic class SpringConfig {\n    @Bean\n    public Person person() {\n        return new Person1("lisi", 20);\n    }\n}\n\npublic class MainTest {\n    public static void main(String[] args) {\n        ApplicationContext applicationContext = new \n            \t\tAnnotationConfigApplicationContext(SpringConfig.class);\n        //\u65b9\u5f0f\u4e00\uff1a\u540d\u79f0\u5bf9\u5e94\u7c7b\u540d\n        Person bean = applicationContext.getBean(Person.class);\n        System.out.println(bean);\n\t\t\n        //\u65b9\u5f0f\u4e8c\uff1a\u540d\u79f0\u5bf9\u5e94\u65b9\u6cd5\u540d \n        Person bean1 = (Person) applicationContext.getBean("person1");\t\n        \n        //\u65b9\u6cd5\u4e09\uff1a\u6307\u5b9a\u540d\u79f0@Bean("person2")\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u626b\u63cf\u5668",children:"\u626b\u63cf\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u7ec4\u4ef6\u626b\u63cf\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u6839\u636e\u9700\u6c42\u52a0\u8f7d\u5fc5\u8981\u7684 bean\uff0c\u6392\u9664\u6307\u5b9a bean"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@ComponentScan"}),"\n",(0,i.jsxs)(e.p,{children:["\u7c7b\u578b\uff1a",(0,i.jsx)(e.strong,{children:"\u7c7b\u6ce8\u89e3"})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e Spring \u914d\u7f6e\u52a0\u8f7d\u7c7b\u626b\u63cf\u89c4\u5219"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@ComponentScan(\n    value = {"dao","service"},\t\t\t//\u8bbe\u7f6e\u57fa\u7840\u626b\u63cf\u8def\u5f84\n    excludeFilters =\t\t\t\t\t//\u8bbe\u7f6e\u8fc7\u6ee4\u89c4\u5219\uff0c\u5f53\u524d\u4e3a\u6392\u9664\u8fc7\u6ee4\n\t@ComponentScan.Filter(\t\t\t\t//\u8bbe\u7f6e\u8fc7\u6ee4\u5668\n\t    type= FilterType.ANNOTATION,  \t//\u8bbe\u7f6e\u8fc7\u6ee4\u65b9\u5f0f\u4e3a\u6309\u7167\u6ce8\u89e3\u8fdb\u884c\u8fc7\u6ee4\n\t    classes = Service.class)     \t//\u8bbe\u7f6e\u5177\u4f53\u7684\u8fc7\u6ee4\u9879\uff0c\u8fc7\u6ee4\u6240\u6709@Service\u4fee\u9970\u7684bean\n    )\n)\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"includeFilters\uff1a\u8bbe\u7f6e\u5305\u542b\u6027\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.li,{children:"excludeFilters\uff1a\u8bbe\u7f6e\u6392\u9664\u6027\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.li,{children:"type\uff1a\u8bbe\u7f6e\u8fc7\u6ee4\u5668\u7c7b\u578b"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u6ce8\u89e3",children:"\u57fa\u672c\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h5,{id:"\u8bbe\u7f6e-bean",children:"\u8bbe\u7f6e bean"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Component\u3001@Controller\u3001@Service\u3001@Repository"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\uff0c\u5199\u5728\u7c7b\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u8be5\u7c7b\u4e3a Spring \u7ba1\u7406\u7684 bean"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Component\npublic class ClassName{}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a@Controller\u3001@Service \u3001@Repository \u662f @Component \u7684\u884d\u751f\u6ce8\u89e3\uff0c\u529f\u80fd\u540c @Component"}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"value\uff08\u9ed8\u8ba4\uff09\uff1a\u5b9a\u4e49 bean \u7684\u8bbf\u95ee id"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u4f5c\u7528\u8303\u56f4-1",children:"\u4f5c\u7528\u8303\u56f4"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Scope"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\uff0c\u5199\u5728\u7c7b\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u8be5\u7c7b\u4f5c\u4e3a bean \u5bf9\u5e94\u7684 scope \u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Scope\npublic class ClassName{}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"value\uff08\u9ed8\u8ba4\uff09\uff1a\u5b9a\u4e49 bean \u7684\u4f5c\u7528\u57df\uff0c\u9ed8\u8ba4\u4e3a singleton\uff0c\u975e\u5355\u4f8b\u53d6\u503c prototype"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u751f\u547d\u5468\u671f-1",children:"\u751f\u547d\u5468\u671f"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@PostConstruct\u3001@PreDestroy"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u65b9\u6cd5\u6ce8\u89e3\uff0c\u5199\u5728\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u8be5\u7c7b\u4f5c\u4e3a bean \u5bf9\u5e94\u7684\u751f\u547d\u5468\u671f\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u5b9a\u4e49bean\uff0c\u540e\u9762\u6dfb\u52a0bean\u7684id\n@Component("userService")\n//\u5b9a\u4e49bean\u7684\u4f5c\u7528\u57df\n@Scope("singleton")\npublic class UserServiceImpl implements UserService {\n    //\u521d\u59cb\u5316\n    @PostConstruct\n    public void init(){\n        System.out.println("user service init...");\n    }\n\t//\u9500\u6bc1\n    @PreDestroy\n    public void destroy(){\n        System.out.println("user service destroy...");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u4e2a\u5bf9\u8c61\u7684\u6267\u884c\u987a\u5e8f\uff1aConstructor >> @Autowired\uff08\u6ce8\u5165\u5c5e\u6027\uff09 >> @PostConstruct\uff08\u521d\u59cb\u5316\u903b\u8f91\uff09"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u52a0\u8f7d\u8d44\u6e90",children:"\u52a0\u8f7d\u8d44\u6e90"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Bean"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u65b9\u6cd5\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u8be5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u4f5c\u4e3a Spring \u7ba1\u7406\u7684 bean"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Bean("dataSource")\npublic DruidDataSource createDataSource() {    return \u2026\u2026;    }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u56e0\u4e3a\u7b2c\u4e09\u65b9 bean \u65e0\u6cd5\u5728\u5176\u6e90\u7801\u4e0a\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u7528 @Bean \u89e3\u51b3\u7b2c\u4e09\u65b9 bean \u7684\u5f15\u5165\u95ee\u9898"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8be5\u6ce8\u89e3\u7528\u4e8e\u66ff\u4ee3 XML \u914d\u7f6e\u4e2d\u7684\u9759\u6001\u5de5\u5382\u4e0e\u5b9e\u4f8b\u5de5\u5382\u521b\u5efa bean\uff0c\u4e0d\u533a\u5206\u65b9\u6cd5\u662f\u5426\u4e3a\u9759\u6001\u6216\u975e\u9759\u6001"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@Bean \u6240\u5728\u7684\u7c7b\u5fc5\u987b\u88ab Spring \u626b\u63cf\u52a0\u8f7d\uff0c\u5426\u5219\u8be5\u6ce8\u89e3\u65e0\u6cd5\u751f\u6548"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"value\uff08\u9ed8\u8ba4\uff09\uff1a\u5b9a\u4e49 bean \u7684\u8bbf\u95ee id"}),"\n",(0,i.jsx)(e.li,{children:"initMethod\uff1a\u58f0\u660e\u521d\u59cb\u5316\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"destroyMethod\uff1a\u58f0\u660e\u9500\u6bc1\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5c5e\u6027\u6ce8\u5165",children:"\u5c5e\u6027\u6ce8\u5165"}),"\n",(0,i.jsx)(e.h5,{id:"\u57fa\u672c\u7c7b\u578b",children:"\u57fa\u672c\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Value"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5c5e\u6027\u6ce8\u89e3\u3001\u65b9\u6cd5\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5bf9\u5e94\u5c5e\u6027\u7684\u503c\u6216\u5bf9\u65b9\u6cd5\u8fdb\u884c\u4f20\u53c2"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//@Value("${jdbc.username}")\n@Value("root")\nprivate String username;\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["value \u503c",(0,i.jsx)(e.strong,{children:"\u4ec5\u652f\u6301\u975e\u5f15\u7528\u7c7b\u578b\u6570\u636e"}),"\uff0c\u8d4b\u503c\u65f6\u5bf9\u65b9\u6cd5\u7684\u6240\u6709\u53c2\u6570\u5168\u90e8\u8d4b\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"value \u503c\u652f\u6301\u8bfb\u53d6 properties \u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\u503c\uff0c\u901a\u8fc7\u7c7b\u5c5e\u6027\u5c06 properties \u4e2d\u6570\u636e\u4f20\u5165\u7c7b\u4e2d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"value \u503c\u652f\u6301 SpEL"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@value \u6ce8\u89e3\u5982\u679c\u6dfb\u52a0\u5728\u5c5e\u6027\u4e0a\u65b9\uff0c\u53ef\u4ee5\u7701\u7565 set \u65b9\u6cd5\uff08set \u65b9\u6cd5\u7684\u76ee\u7684\u662f\u4e3a\u5c5e\u6027\u8d4b\u503c\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"value\uff08\u9ed8\u8ba4\uff09\uff1a\u5b9a\u4e49\u5bf9\u5e94\u7684\u5c5e\u6027\u503c\u6216\u53c2\u6570\u503c"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u81ea\u52a8\u88c5\u914d",children:"\u81ea\u52a8\u88c5\u914d"}),"\n",(0,i.jsx)(e.h6,{id:"\u5c5e\u6027\u6ce8\u5165-1",children:"\u5c5e\u6027\u6ce8\u5165"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Autowired\u3001@Qualifier"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5c5e\u6027\u6ce8\u89e3\u3001\u65b9\u6cd5\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5bf9\u5e94\u5c5e\u6027\u7684\u5bf9\u8c61\u3001\u5bf9\u65b9\u6cd5\u8fdb\u884c\u5f15\u7528\u7c7b\u578b\u4f20\u53c2"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Autowired(required = false)\n@Qualifier("userDao")\nprivate UserDao userDao;\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@Autowired \u9ed8\u8ba4\u6309\u7c7b\u578b\u88c5\u914d\uff0c\u6307\u5b9a @Qualifier \u540e\u53ef\u4ee5\u6307\u5b9a\u81ea\u52a8\u88c5\u914d\u7684 bean \u7684 id"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["required\uff1a",(0,i.jsx)(e.strong,{children:"\u4e3a true \uff08\u9ed8\u8ba4\uff09\u8868\u793a\u6ce8\u5165 bean \u65f6\u8be5 bean \u5fc5\u987b\u5b58\u5728"}),"\uff0c\u4e0d\u7136\u5c31\u4f1a\u6ce8\u5165\u5931\u8d25\u629b\u51fa\u5f02\u5e38\uff1b\u4e3a false  \u8868\u793a\u6ce8\u5165\u65f6\u8be5 bean \u5b58\u5728\u5c31\u6ce8\u5165\uff0c\u4e0d\u5b58\u5728\u5c31\u5ffd\u7565\u8df3\u8fc7"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5728\u4f7f\u7528 @Autowired \u65f6\uff0c\u9996\u5148\u5728\u5bb9\u5668\u4e2d\u67e5\u8be2\u5bf9\u5e94\u7c7b\u578b\u7684 bean\uff0c\u5982\u679c\u67e5\u8be2\u7ed3\u679c\u521a\u597d\u4e3a\u4e00\u4e2a\uff0c\u5c31\u5c06\u8be5 bean \u88c5\u914d\u7ed9 @Autowired \u6307\u5b9a\u7684\u6570\u636e\uff0c\u5982\u679c\u67e5\u8be2\u7684\u7ed3\u679c\u4e0d\u6b62\u4e00\u4e2a\uff0c\u90a3\u4e48 @Autowired \u4f1a\u6839\u636e\u540d\u79f0\u6765\u67e5\u627e\uff0c\u5982\u679c\u67e5\u8be2\u7684\u7ed3\u679c\u4e3a\u7a7a\uff0c\u90a3\u4e48\u4f1a\u629b\u51fa\u5f02\u5e38"}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1a\u4f7f\u7528 required = false"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h6,{id:"\u4f18\u5148\u6ce8\u5165",children:"\u4f18\u5148\u6ce8\u5165"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Primary"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u7c7b\u5bf9\u5e94\u7684 bean \u6309\u7c7b\u578b\u88c5\u914d\u65f6\u4f18\u5148\u88c5\u914d"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Primary\npublic class ClassName{}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@Autowired \u9ed8\u8ba4\u6309\u7c7b\u578b\u88c5\u914d\uff0c\u5f53\u51fa\u73b0\u76f8\u540c\u7c7b\u578b\u7684 bean\uff0c\u4f7f\u7528 @Primary \u63d0\u9ad8\u6309\u7c7b\u578b\u81ea\u52a8\u88c5\u914d\u7684\u4f18\u5148\u7ea7\uff0c\u591a\u4e2a @Primary \u4f1a\u5bfc\u81f4\u4f18\u5148\u7ea7\u8bbe\u7f6e\u65e0\u6548"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h6,{id:"\u6ce8\u89e3\u5bf9\u6bd4",children:"\u6ce8\u89e3\u5bf9\u6bd4"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Inject\u3001@Named\u3001@Resource"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@Inject \u4e0e @Named \u662f JSR330 \u89c4\u8303\u4e2d\u7684\u6ce8\u89e3\uff0c\u529f\u80fd\u4e0e @Autowired \u548c @Qualifier \u5b8c\u5168\u76f8\u540c\uff0c\u9002\u7528\u4e8e\u4e0d\u540c\u67b6\u6784\u573a\u666f"}),"\n",(0,i.jsx)(e.li,{children:"@Resource \u662f JSR250 \u89c4\u8303\u4e2d\u7684\u6ce8\u89e3\uff0c\u53ef\u4ee5\u7b80\u5316\u4e66\u5199\u683c\u5f0f"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@Resource \u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"name\uff1a\u8bbe\u7f6e\u6ce8\u5165\u7684 bean \u7684 id"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"type\uff1a\u8bbe\u7f6e\u6ce8\u5165\u7684 bean \u7684\u7c7b\u578b\uff0c\u63a5\u6536\u7684\u53c2\u6570\u4e3a Class \u7c7b\u578b"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@Autowired \u548c @Resource\u4e4b\u95f4\u7684\u533a\u522b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Autowired \u9ed8\u8ba4\u662f",(0,i.jsx)(e.strong,{children:"\u6309\u7167\u7c7b\u578b\u88c5\u914d"}),"\u6ce8\u5165\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b83\u8981\u6c42\u4f9d\u8d56\u5bf9\u8c61\u5fc5\u987b\u5b58\u5728\uff08\u53ef\u4ee5\u8bbe\u7f6e required \u5c5e\u6027\u4e3a false\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Resource \u9ed8\u8ba4",(0,i.jsx)(e.strong,{children:"\u6309\u7167\u540d\u79f0\u88c5\u914d"}),"\u6ce8\u5165\uff0c\u53ea\u6709\u5f53\u627e\u4e0d\u5230\u4e0e\u540d\u79f0\u5339\u914d\u7684 bean \u624d\u4f1a\u6309\u7167\u7c7b\u578b\u6765\u88c5\u914d\u6ce8\u5165"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u9759\u6001\u6ce8\u5165",children:"\u9759\u6001\u6ce8\u5165"}),"\n",(0,i.jsxs)(e.p,{children:["Spring \u5bb9\u5668\u7ba1\u7406\u7684\u90fd\u662f\u5b9e\u4f8b\u5bf9\u8c61\uff0c",(0,i.jsx)(e.strong,{children:"@Autowired \u4f9d\u8d56\u6ce8\u5165\u7684\u90fd\u662f\u5bb9\u5668\u5185\u7684\u5bf9\u8c61\u5b9e\u4f8b"}),"\uff0c\u5728 Java \u4e2d static \u4fee\u9970\u7684\u9759\u6001\u5c5e\u6027\uff08\u53d8\u91cf\u548c\u65b9\u6cd5\uff09\u662f\u5c5e\u4e8e\u7c7b\u7684\uff0c\u800c\u975e\u5c5e\u4e8e\u5b9e\u4f8b\u5bf9\u8c61"]}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u9759\u6001\u53d8\u91cf\u65f6\uff0cSpring \u4e0a\u4e0b\u6587\u5c1a\u672a\u52a0\u8f7d\uff0c\u6240\u4ee5\u7c7b\u52a0\u8f7d\u5668\u4e0d\u4f1a\u5728 Bean \u4e2d\u6b63\u786e\u6ce8\u5165\u9759\u6001\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Component\npublic class TestClass {\n    @Autowired\n    private static Component component;\n\n    // \u8c03\u7528\u9759\u6001\u7ec4\u4ef6\u7684\u65b9\u6cd5\n    public static void testMethod() {\n        component.callTestMethod()\uff1b\n    }  \n}\n// \u7f16\u8bd1\u6b63\u5e38\uff0c\u4f46\u8fd0\u884c\u65f6\u62a5java.lang.NullPointerException\uff0c\u6240\u4ee5\u5728\u8c03\u7528testMethod()\u65b9\u6cd5\u65f6\uff0ccomponent\u53d8\u91cf\u8fd8\u6ca1\u88ab\u521d\u59cb\u5316\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Autowired \u6ce8\u89e3\u5230",(0,i.jsx)(e.strong,{children:"\u7c7b\u7684\u6784\u9020\u51fd\u6570"}),"\u4e0a\uff0cSpring \u626b\u63cf\u5230 Component \u7684 Bean\uff0c\u7136\u540e\u8d4b\u7ed9\u9759\u6001\u53d8\u91cf component"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Component\npublic class TestClass {\n    private static Component component;\n\n    @Autowired\n    public TestClass(Component component) {\n        TestClass.component = component;\n    }\n\n    public static void testMethod() {\n        component.callTestMethod()\uff1b\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Autowired \u6ce8\u89e3\u5230",(0,i.jsx)(e.strong,{children:"\u9759\u6001\u5c5e\u6027\u7684 setter \u65b9\u6cd5"}),"\u4e0a"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 @PostConstruct \u6ce8\u89e3\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5728\u65b9\u6cd5\u5185\u4e3a static \u9759\u6001\u6210\u5458\u8d4b\u503c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 Spring \u6846\u67b6\u5de5\u5177\u7c7b\u83b7\u53d6 bean\uff0c\u5b9a\u4e49\u6210\u5c40\u90e8\u53d8\u91cf\u4f7f\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class TestClass {\n    // \u8c03\u7528\u9759\u6001\u7ec4\u4ef6\u7684\u65b9\u6cd5\n   public static void testMethod() {\n      Component component = SpringApplicationContextUtil.getBean("component");\n      component.callTestMethod();\n   }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,i.jsx)(e.a,{href:"http://jessehzx.top/2018/03/18/spring-autowired-static-field/",children:"http://jessehzx.top/2018/03/18/spring-autowired-static-field/"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6587\u4ef6\u8bfb\u53d6",children:"\u6587\u4ef6\u8bfb\u53d6"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@PropertySource"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u52a0\u8f7d properties \u6587\u4ef6\u4e2d\u7684\u5c5e\u6027\u503c"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@PropertySource(value = "classpath:filename.properties")\npublic class ClassName {\n    @Value("${propertiesAttributeName}")\n    private String attributeName;\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e0d\u652f\u6301 * \u901a\u914d\u7b26\uff0c\u52a0\u8f7d\u540e\uff0c\u6240\u6709 Spring \u63a7\u5236\u7684 bean \u4e2d\u5747\u53ef\u4f7f\u7528\u5bf9\u5e94\u5c5e\u6027\u503c\uff0c\u52a0\u8f7d\u591a\u4e2a\u9700\u8981\u7528 ",(0,i.jsx)(e.code,{children:"{} \u548c ,"})," \u9694\u5f00"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"value\uff08\u9ed8\u8ba4\uff09\uff1a\u8bbe\u7f6e\u52a0\u8f7d\u7684 properties \u6587\u4ef6\u540d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ignoreResourceNotFound\uff1a\u5982\u679c\u8d44\u6e90\u672a\u627e\u5230\uff0c\u662f\u5426\u5ffd\u7565\uff0c\u9ed8\u8ba4\u4e3a false"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u52a0\u8f7d\u63a7\u5236",children:"\u52a0\u8f7d\u63a7\u5236"}),"\n",(0,i.jsx)(e.h5,{id:"\u4f9d\u8d56\u52a0\u8f7d",children:"\u4f9d\u8d56\u52a0\u8f7d"}),"\n",(0,i.jsx)(e.p,{children:"@DependsOn"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@DependsOn"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\u3001\u65b9\u6cd5\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u63a7\u5236 bean \u7684\u52a0\u8f7d\u987a\u5e8f\uff0c\u4f7f\u5176\u5728\u6307\u5b9a bean \u52a0\u8f7d\u5b8c\u6bd5\u540e\u518d\u52a0\u8f7d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@DependsOn("beanId")\npublic class ClassName {\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u5728\u65b9\u6cd5\u4e0a\uff0c\u4f7f @DependsOn \u6307\u5b9a\u7684 bean \u4f18\u5148\u4e8e @Bean \u914d\u7f6e\u7684 bean \u8fdb\u884c\u52a0\u8f7d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u5728\u7c7b\u4e0a\uff0c\u4f7f @DependsOn \u6307\u5b9a\u7684 bean \u4f18\u5148\u4e8e\u5f53\u524d\u7c7b\u4e2d\u6240\u6709 @Bean \u914d\u7f6e\u7684 bean \u8fdb\u884c\u52a0\u8f7d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u5728\u7c7b\u4e0a\uff0c\u4f7f @DependsOn \u6307\u5b9a\u7684 bean \u4f18\u5148\u4e8e @Component \u7b49\u914d\u7f6e\u7684 bean \u8fdb\u884c\u52a0\u8f7d"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"value\uff08\u9ed8\u8ba4\uff09\uff1a\u8bbe\u7f6e\u5f53\u524d bean \u6240\u4f9d\u8d56\u7684 bean \u7684 id"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@Order"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Order"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u7c7b\u578b\uff1a",(0,i.jsx)(e.strong,{children:"\u914d\u7f6e\u7c7b\u6ce8\u89e3"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u63a7\u5236\u914d\u7f6e\u7c7b\u7684\u52a0\u8f7d\u987a\u5e8f\uff0c\u503c\u8d8a\u5c0f\u8d8a\u5148\u52a0\u8f7d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Order(1)\npublic class SpringConfigClassName {\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@Lazy"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Lazy"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\u3001\u65b9\u6cd5\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u63a7\u5236 bean \u7684\u52a0\u8f7d\u65f6\u673a\uff0c\u4f7f\u5176\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u83b7\u53d6\u7684\u65f6\u5019\u52a0\u8f7d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Lazy\npublic class ClassName {\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n",(0,i.jsx)(e.p,{children:"@DependsOn"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5fae\u4fe1\u8ba2\u9605\u53f7\uff0c\u53d1\u5e03\u6d88\u606f\u548c\u8ba2\u9605\u6d88\u606f\u7684 bean \u7684\u52a0\u8f7d\u987a\u5e8f\u63a7\u5236\uff08\u5148\u5f00\u8ba2\u9605\uff0c\u518d\u53d1\u5e03\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53cc 11 \u6d3b\u52a8\uff0c\u96f6\u70b9\u524d\u662f\u7ed3\u7b97\u7b56\u7565 A\uff0c\u96f6\u70b9\u540e\u662f\u7ed3\u7b97\u7b56\u7565 B\uff0c\u7b56\u7565 B \u64cd\u4f5c\u7684\u6570\u636e\u4e3a\u4fc3\u9500\u6570\u636e\uff0c\u7b56\u7565 B \u52a0\u8f7d\u987a\u5e8f\u4e0e\u4fc3\u9500\u6570\u636e\u7684\u52a0\u8f7d\u987a\u5e8f"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@Lazy"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7a0b\u5e8f\u707e\u96be\u51fa\u73b0\u540e\u5bf9\u5e94\u7684\u5e94\u6025\u9884\u6848\u5904\u7406\u662f\u542f\u52a8\u5bb9\u5668\u65f6\u52a0\u8f7d\u65f6\u673a"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@Order"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u591a\u4e2a\u79cd\u7c7b\u7684\u914d\u7f6e\u51fa\u73b0\u540e\uff0c\u4f18\u5148\u52a0\u8f7d\u7cfb\u7edf\u7ea7\u7684\uff0c\u7136\u540e\u52a0\u8f7d\u4e1a\u52a1\u7ea7\u7684\uff0c\u907f\u514d\u7ec6\u7c92\u5ea6\u7684\u52a0\u8f7d\u63a7\u5236"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6574\u5408\u8d44\u6e90",children:"\u6574\u5408\u8d44\u6e90"}),"\n",(0,i.jsx)(e.h5,{id:"\u5bfc\u5165",children:"\u5bfc\u5165"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Import"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5bfc\u5165\u7b2c\u4e09\u65b9 bean \u4f5c\u4e3a Spring \u63a7\u5236\u7684\u8d44\u6e90\uff0c\u8fd9\u4e9b\u7c7b\u90fd\u4f1a\u88ab Spring \u521b\u5efa\u5e76\u653e\u5165 ioc \u5bb9\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\n@Import(OtherClassName.class)\npublic class ClassName {\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@Import \u6ce8\u89e3\u5728\u540c\u4e00\u4e2a\u7c7b\u4e0a\uff0c\u4ec5\u5141\u8bb8\u6dfb\u52a0\u4e00\u6b21\uff0c\u5982\u679c\u9700\u8981\u5bfc\u5165\u591a\u4e2a\uff0c\u4f7f\u7528\u6570\u7ec4\u7684\u5f62\u5f0f\u8fdb\u884c\u8bbe\u5b9a"}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u88ab\u5bfc\u5165\u7684\u7c7b\u4e2d\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528 @Import \u5bfc\u5165\u5176\u4ed6\u8d44\u6e90"}),"\n",(0,i.jsx)(e.li,{children:"@Bean \u6240\u5728\u7684\u7c7b\u53ef\u4ee5\u4f7f\u7528\u5bfc\u5165\u7684\u5f62\u5f0f\u8fdb\u5165 Spring \u5bb9\u5668\uff0c\u65e0\u9700\u58f0\u660e\u4e3a bean"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"druid-1",children:"Druid"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u52a0\u8f7d\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\npublic class JDBCConfig {\n    @Bean("dataSource")\n    public static DruidDataSource getDataSource() {\n        DruidDataSource ds = new DruidDataSource();\n        ds.setDriverClassName("com.mysql.jdbc.Driver");\n        ds.setUrl("jdbc:mysql://192.168.2.185:3306/spring_db");\n        ds.setUsername("root");\n        ds.setPassword("123456");\n        return ds;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan(value = {"service","dao"})\n@Import(JDBCConfig.class)\npublic class SpringConfig {\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'DruidDataSource dataSource = (DruidDataSource) ctx.getBean("dataSource");\nSystem.out.println(dataSource);\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"junit",children:"Junit"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u63a5\u7ba1 Junit \u7684\u8fd0\u884c\u6743\uff0c\u4f7f\u7528 Spring \u4e13\u7528\u7684 Junit \u7c7b\u52a0\u8f7d\u5668\uff0c\u4e3a Junit \u6d4b\u8bd5\u7528\u4f8b\u8bbe\u5b9a\u5bf9\u5e94\u7684 Spring \u5bb9\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ece Spring5.0 \u4ee5\u540e\uff0c\u8981\u6c42 Junit \u7684\u7248\u672c\u5fc5\u987b\u662f4.12\u53ca\u4ee5\u4e0a"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Junit \u4ec5\u7528\u4e8e\u5355\u5143\u6d4b\u8bd5\uff0c\u4e0d\u80fd\u5c06 Junit \u7684\u6d4b\u8bd5\u7c7b\u914d\u7f6e\u6210 Spring \u7684 bean\uff0c\u5426\u5219\u8be5\u914d\u7f6e\u5c06\u4f1a\u88ab\u6253\u5305\u8fdb\u5165\u5de5\u7a0b\u4e2d"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"test / java / service / UserServiceTest"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u8bbe\u5b9aspring\u4e13\u7528\u7684\u7c7b\u52a0\u8f7d\u5668\n@RunWith(SpringJUnit4ClassRunner.class)\n//\u8bbe\u5b9a\u52a0\u8f7d\u7684spring\u4e0a\u4e0b\u6587\u5bf9\u5e94\u7684\u914d\u7f6e\n@ContextConfiguration(classes = SpringConfig.class)\npublic class UserServiceTest {\n    @Autowired\n    private AccountService accountService;\n    @Test\n    public void testFindById() {\n        Account account = accountService.findById(1);\n        Assert.assertEquals("Mike", account.getName());\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"pom.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>junit</groupId>\n    <artifactId>junit</artifactId>\n    <version>4.12</version>\n</dependency>\n<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-test</artifactId>\n    <version>5.1.9.RELEASE</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"ioc\u539f\u7406",children:"IoC\u539f\u7406"}),"\n",(0,i.jsx)(e.h4,{id:"\u6838\u5fc3\u7c7b",children:"\u6838\u5fc3\u7c7b"}),"\n",(0,i.jsx)(e.h5,{id:"beanfactory",children:"BeanFactory"}),"\n",(0,i.jsx)(e.p,{children:"ApplicationContext\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ApplicationContext \u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u63d0\u4f9b\u4e86\u8bbf\u95ee Spring \u5bb9\u5668\u7684 API"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ClassPathXmlApplicationContext \u662f\u4e00\u4e2a\u7c7b\uff0c\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u529f\u80fd"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ApplicationContext \u7684\u9876\u5c42\u63a5\u53e3\u662f BeanFactory"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"BeanFactory \u5b9a\u4e49\u4e86 bean \u76f8\u5173\u7684\u6700\u57fa\u672c\u64cd\u4f5c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ApplicationContext \u5728 BeanFactory \u57fa\u7840\u4e0a\u8ffd\u52a0\u4e86\u82e5\u5e72\u65b0\u529f\u80fd"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"ApplicationContext \u548c BeanFactory\u5bf9\u6bd4\uff1a"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"BeanFactory \u548c ApplicationContext \u662f Spring \u7684\u4e24\u5927\u6838\u5fc3\u63a5\u53e3\uff0c\u90fd\u53ef\u4ee5\u5f53\u505a Spring \u7684\u5bb9\u5668"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"BeanFactory \u662f Spring \u91cc\u9762\u6700\u5e95\u5c42\u7684\u63a5\u53e3\uff0c\u662f IoC \u7684\u6838\u5fc3\uff0c\u5b9a\u4e49\u4e86 IoC \u7684\u57fa\u672c\u529f\u80fd\uff0c\u5305\u542b\u4e86\u5404\u79cd Bean \u7684\u5b9a\u4e49\u3001\u52a0\u8f7d\u3001\u5b9e\u4f8b\u5316\uff0c\u4f9d\u8d56\u6ce8\u5165\u548c\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002ApplicationContext \u63a5\u53e3\u4f5c\u4e3a BeanFactory \u7684\u5b50\u7c7b\uff0c\u9664\u4e86\u63d0\u4f9b BeanFactory \u6240\u5177\u6709\u7684\u529f\u80fd\u5916\uff0c\u8fd8\u63d0\u4f9b\u4e86\u66f4\u5b8c\u6574\u7684\u6846\u67b6\u529f\u80fd\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7ee7\u627f MessageSource\uff0c\u56e0\u6b64\u652f\u6301\u56fd\u9645\u5316"}),"\n",(0,i.jsx)(e.li,{children:"\u8d44\u6e90\u6587\u4ef6\u8bbf\u95ee\uff0c\u5982 URL \u548c\u6587\u4ef6\uff08ResourceLoader\uff09\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u8f7d\u5165\u591a\u4e2a\uff08\u6709\u7ee7\u627f\u5173\u7cfb\uff09\u4e0a\u4e0b\u6587\uff08\u5373\u52a0\u8f7d\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6\uff09 \uff0c\u4f7f\u5f97\u6bcf\u4e00\u4e2a\u4e0a\u4e0b\u6587\u90fd\u4e13\u6ce8\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684\u5c42\u6b21\uff0c\u6bd4\u5982\u5e94\u7528\u7684 web \u5c42"}),"\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u5728\u76d1\u542c\u5668\u4e2d\u6ce8\u518c bean \u7684\u4e8b\u4ef6"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"BeanFactory \u521b\u5efa\u7684 bean \u91c7\u7528\u5ef6\u8fdf\u52a0\u8f7d\u5f62\u5f0f\uff0c\u53ea\u6709\u5728\u4f7f\u7528\u5230\u67d0\u4e2a Bean \u65f6\uff08\u8c03\u7528 getBean\uff09\uff0c\u624d\u5bf9\u8be5 Bean \u8fdb\u884c\u52a0\u8f7d\u5b9e\u4f8b\u5316\uff08Spring \u65e9\u671f\u4f7f\u7528\u8be5\u65b9\u6cd5\u83b7\u53d6 bean\uff09\uff0c\u8fd9\u6837\u5c31\u4e0d\u80fd\u63d0\u524d\u53d1\u73b0\u4e00\u4e9b\u5b58\u5728\u7684 Spring \u7684\u914d\u7f6e\u95ee\u9898\uff1bApplicationContext \u662f\u5728\u5bb9\u5668\u542f\u52a8\u65f6\uff0c\u4e00\u6b21\u6027\u521b\u5efa\u4e86\u6240\u6709\u7684 Bean\uff0c\u5bb9\u5668\u542f\u52a8\u65f6\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0 Spring \u4e2d\u5b58\u5728\u7684\u914d\u7f6e\u9519\u8bef\uff0c\u8fd9\u6837\u6709\u5229\u4e8e\u68c0\u67e5\u6240\u4f9d\u8d56\u5c5e\u6027\u662f\u5426\u6ce8\u5165"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ApplicationContext \u542f\u52a8\u540e\u9884\u8f7d\u5165\u6240\u6709\u7684\u5355\u5b9e\u4f8b Bean\uff0c\u6240\u4ee5\u7a0b\u5e8f\u542f\u52a8\u6162\uff0c\u8fd0\u884c\u65f6\u901f\u5ea6\u5feb"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e24\u8005\u90fd\u652f\u6301 BeanPostProcessor\u3001BeanFactoryPostProcessor \u7684\u4f7f\u7528\uff0c\u4f46\u4e24\u8005\u4e4b\u95f4\u7684\u533a\u522b\u662f\uff1aBeanFactory \u9700\u8981\u624b\u52a8\u6ce8\u518c\uff0c\u800c ApplicationContext \u5219\u662f\u81ea\u52a8\u6ce8\u518c"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"FileSystemXmlApplicationContext\uff1a\u52a0\u8f7d\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4efb\u610f\u4f4d\u7f6e\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u800c ClassPathXmlAC \u53ea\u80fd\u52a0\u8f7d\u7c7b\u8def\u5f84\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(98431).A+"",width:"346",height:"291"})}),"\n",(0,i.jsx)(e.p,{children:"BeanFactory \u7684\u6210\u5458\u5c5e\u6027\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'String FACTORY_BEAN_PREFIX = "&";\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u533a\u5206\u662f FactoryBean \u8fd8\u662f\u521b\u5efa\u7684 Bean\uff0c\u52a0\u4e0a & \u4ee3\u8868\u662f\u5de5\u5382\uff0cgetBean \u5c06\u4f1a\u8fd4\u56de\u5de5\u5382"}),"\n",(0,i.jsxs)(e.li,{children:["FactoryBean\uff1a\u5982\u679c\u67d0\u4e2a bean \u7684\u914d\u7f6e\u975e\u5e38\u590d\u6742\uff0c\u6216\u8005\u60f3\u8981\u4f7f\u7528\u7f16\u7801\u7684\u5f62\u5f0f\u53bb\u6784\u5efa\u5b83\uff0c\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u6784\u5efa\u8be5 bean \u5b9e\u4f8b\u7684\u5de5\u5382\uff0c\u8fd9\u4e2a\u5de5\u5382\u5c31\u662f FactoryBean \u63a5\u53e3\u5b9e\u73b0\u7c7b\uff0cFactoryBean \u63a5\u53e3\u5b9e\u73b0\u7c7b\u4e5f\u662f\u9700\u8981 Spring \u7ba1\u7406\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd9\u91cc\u4ea7\u751f\u4e24\u79cd\u5bf9\u8c61\uff0c\u4e00\u79cd\u662f FactoryBean \u63a5\u53e3\u5b9e\u73b0\u7c7b\uff08IOC \u7ba1\u7406\uff09\uff0c\u53e6\u4e00\u79cd\u662f FactoryBean \u63a5\u53e3\u5185\u90e8\u7ba1\u7406\u7684\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"\u83b7\u53d6 FactoryBean \u63a5\u53e3\u5b9e\u73b0\u7c7b\uff0c\u4f7f\u7528 getBean \u65f6\u4f20\u7684 beanName \u9700\u8981\u5e26 & \u5f00\u5934"}),"\n",(0,i.jsx)(e.li,{children:"\u83b7\u53d6 FactoryBean \u5185\u90e8\u7ba1\u7406\u7684\u5bf9\u8c61\uff0c\u4e0d\u9700\u8981\u5e26 & \u5f00\u5934"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"BeanFactory \u7684\u57fa\u672c\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'Resource res = new ClassPathResource("applicationContext.xml");\nBeanFactory bf = new XmlBeanFactory(res);\nUserService userService = (UserService)bf.getBean("userService");\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"factorybean",children:"FactoryBean"}),"\n",(0,i.jsx)(e.p,{children:"FactoryBean\uff1a\u5bf9\u5355\u4e00\u7684 bean \u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u8fdb\u884c\u5c01\u88c5\uff0c\u8fbe\u5230\u7b80\u5316\u914d\u7f6e\u7684\u76ee\u7684"}),"\n",(0,i.jsx)(e.p,{children:"FactoryBean\u4e0e BeanFactory \u533a\u522b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"FactoryBean\uff1a\u5c01\u88c5\u5355\u4e2a bean \u7684\u521b\u5efa\u8fc7\u7a0b\uff0c\u5c31\u662f\u5de5\u5382\u7684 Bean"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"BeanFactory\uff1aSpring \u5bb9\u5668\u9876\u5c42\u63a5\u53e3\uff0c\u5b9a\u4e49\u4e86 bean \u76f8\u5173\u7684\u83b7\u53d6\u64cd\u4f5c"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"FactoryBean\uff0c\u5b9e\u73b0\u7c7b\u4e00\u822c\u662f MapperFactoryBean\uff0c\u521b\u5efa DAO \u5c42\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class EquipmentDaoImplFactoryBean implements FactoryBean {\n    @Override\t//\u83b7\u53d6Bean\n    public Object getObject() throws Exception {\n        return new EquipmentDaoImpl();\n    }\n    \n    @Override\t//\u83b7\u53d6bean\u7684\u7c7b\u578b\n    public Class<?> getObjectType() {\n        return null;\n    }\n    \n    @Override\t//\u662f\u5426\u5355\u4f8b\n    public boolean isSingleton() {\n        return false;\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MapperFactoryBean \u7ee7\u627f SqlSessionDaoSupport\uff0c\u53ef\u4ee5\u83b7\u53d6 SqlSessionTemplate\uff0c\u5b8c\u6210 MyBatis \u7684\u6574\u5408"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public abstract class SqlSessionDaoSupport extends DaoSupport {\n  \tprivate SqlSessionTemplate sqlSessionTemplate;\n\t// \u83b7\u53d6 SqlSessionTemplate \u5bf9\u8c61\n\tpublic void setSqlSessionFactory(SqlSessionFactory sqlSessionFactory) {\n    \tif (this.sqlSessionTemplate == null || \n        \tsqlSessionFactory != this.sqlSessionTemplate.getSqlSessionFactory()) {\n      \t\tthis.sqlSessionTemplate = createSqlSessionTemplate(sqlSessionFactory);\n    \t}\n  \t}\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8fc7\u6ee4\u5668",children:"\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.h5,{id:"\u6570\u636e\u51c6\u5907",children:"\u6570\u636e\u51c6\u5907"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO \u5c42 UserDao\u3001AccountDao\u3001BookDao\u3001EquipmentDao"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserDao {\n\tpublic void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component("userDao")\npublic class UserDaoImpl implements UserDao {\n    public void save() {\n        System.out.println("user dao running...");\n    }\n\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service \u4e1a\u52a1\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserService {\n    public void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Service("userService")\npublic class UserServiceImpl implements UserService {\n    @Autowired\n    private UserDao userDao;//...........BookDao\u7b49\n\n    public void save() {\n        System.out.println("user service running...");\n        userDao.save();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u8fc7\u6ee4\u5668-1",children:"\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1aTypeFilter"}),"\n",(0,i.jsxs)(e.p,{children:["\u7c7b\u578b\uff1a",(0,i.jsx)(e.strong,{children:"\u63a5\u53e3"})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u81ea\u5b9a\u4e49\u7c7b\u578b\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"config / filter / MyTypeFilter"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class MyTypeFilter implements TypeFilter {\n    @Override\n    /**\n    * metadataReader:\u8bfb\u53d6\u5230\u7684\u5f53\u524d\u6b63\u5728\u626b\u63cf\u7684\u7c7b\u7684\u4fe1\u606f\n    * metadataReaderFactory:\u53ef\u4ee5\u83b7\u53d6\u5230\u4efb\u4f55\u5176\u4ed6\u7c7b\u7684\u4fe1\u606f\n    */\n    //\u52a0\u8f7d\u7684\u7c7b\u6ee1\u8db3\u8981\u6c42\uff0c\u5339\u914d\u6210\u529f\n    public boolean match(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory) throws IOException {\n        //\u83b7\u53d6\u5f53\u524d\u7c7b\u6ce8\u89e3\u7684\u4fe1\u606f\n\t\tAnnotationMetadata am = metadataReader.getAnnotationMetadata();\n\t\t//\u83b7\u53d6\u5f53\u524d\u6b63\u5728\u626b\u63cf\u7684\u7c7b\u7684\u7c7b\u4fe1\u606f\n\t\tClassMetadata classMetadata = metadataReader.getClassMetadata();\n\t\t//\u83b7\u53d6\u5f53\u524d\u7c7b\u8d44\u6e90\uff08\u7c7b\u7684\u8def\u5f84\uff09\n\t\tResource resource = metadataReader.getResource();\n        \n        \n        //\u901a\u8fc7\u7c7b\u7684\u5143\u6570\u636e\u83b7\u53d6\u7c7b\u7684\u540d\u79f0\n        String className = classMetadata.getClassName();\n        //\u5982\u679c\u52a0\u8f7d\u7684\u7c7b\u540d\u6ee1\u8db3\u8fc7\u6ee4\u5668\u8981\u6c42\uff0c\u8fd4\u56de\u5339\u914d\u6210\u529f\n        if(className.equals("service.impl.UserServiceImpl")){\n       \t//\u8fd4\u56detrue\u8868\u793a\u5339\u914d\u6210\u529f\uff0c\u8fd4\u56defalse\u8868\u793a\u5339\u914d\u5931\u8d25\u3002\u6b64\u5904\u4ec5\u786e\u8ba4\u5339\u914d\u7ed3\u679c\uff0c\u4e0d\u4f1a\u786e\u8ba4\u662f\u6392\u9664\u8fd8\u662f\u52a0\u5165\uff0c\u6392\u9664/\u52a0\u5165\u7531\u914d\u7f6e\u9879\u51b3\u5b9a\uff0c\u4e0e\u6b64\u5904\u65e0\u5173\n            return true;\n        }\n        return false;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"SpringConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n//\u8bbe\u7f6e\u6392\u9664bean\uff0c\u6392\u9664\u7684\u89c4\u5219\u662f\u81ea\u5b9a\u4e49\u89c4\u5219\uff08FilterType.CUSTOM\uff09\uff0c\u5177\u4f53\u7684\u89c4\u5219\u5b9a\u4e49\u4e3aMyTypeFilter\n@ComponentScan(\n        value = {"dao","service"},\n        excludeFilters = @ComponentScan.Filter(\n                type= FilterType.CUSTOM,\n                classes = MyTypeFilter.class\n        )\n)\npublic class SpringConfig {\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5bfc\u5165\u5668",children:"\u5bfc\u5165\u5668"}),"\n",(0,i.jsx)(e.p,{children:"bean \u53ea\u6709\u901a\u8fc7\u914d\u7f6e\u624d\u53ef\u4ee5\u8fdb\u5165 Spring \u5bb9\u5668\uff0c\u88ab Spring \u52a0\u8f7d\u5e76\u63a7\u5236"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e bean \u7684\u65b9\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["XML \u6587\u4ef6\u4e2d\u4f7f\u7528 ",(0,i.jsx)(e.bean,{children:" \u6807\u7b7e\u914d\u7f6e"})]}),"\n",(0,i.jsx)(e.li,{children:"\u4f7f\u7528 @Component \u53ca\u884d\u751f\u6ce8\u89e3\u914d\u7f6e"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5668\u53ef\u4ee5\u5feb\u901f\u9ad8\u6548\u5bfc\u5165\u5927\u91cf bean\uff0c\u66ff\u4ee3 @Import({a.class,b.class})\uff0c\u65e0\u9700\u5728\u6bcf\u4e2a\u7c7b\u4e0a\u6dfb\u52a0 @Bean"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a ImportSelector"}),"\n",(0,i.jsxs)(e.p,{children:["\u7c7b\u578b\uff1a",(0,i.jsx)(e.strong,{children:"\u63a5\u53e3"})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u81ea\u5b9a\u4e49bean\u5bfc\u5165\u5668"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"selector / MyImportSelector"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class MyImportSelector implements ImportSelector{\n    @Override\n    public String[] selectImports(AnnotationMetadata importingClassMetadata) {\n//      1.\u7f16\u7a0b\u5f62\u5f0f\u52a0\u8f7d\u4e00\u4e2a\u7c7b\n//      return new String[]{"dao.impl.BookDaoImpl"};\n\n//      2.\u52a0\u8f7dimport.properties\u6587\u4ef6\u4e2d\u7684\u5355\u4e2a\u7c7b\u540d\n//      ResourceBundle bundle = ResourceBundle.getBundle("import");\n//      String className = bundle.getString("className");\n\n//      3.\u52a0\u8f7dimport.properties\u6587\u4ef6\u4e2d\u7684\u591a\u4e2a\u7c7b\u540d\n        ResourceBundle bundle = ResourceBundle.getBundle("import");\n        String className = bundle.getString("className");\n        return className.split(",");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"import.properties"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"#2.\u52a0\u8f7dimport.properties\u6587\u4ef6\u4e2d\u7684\u5355\u4e2a\u7c7b\u540d\n#className=dao.impl.BookDaoImpl\n\n#3.\u52a0\u8f7dimport.properties\u6587\u4ef6\u4e2d\u7684\u591a\u4e2a\u7c7b\u540d\n#className=dao.impl.BookDaoImpl,dao.impl.AccountDaoImpl\n\n#4.\u5bfc\u5165\u5305\u4e2d\u7684\u6240\u6709\u7c7b\npath=dao.impl.*\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"SpringConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan({"dao","service"})\n@Import(MyImportSelector.class)\npublic class SpringConfig {\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6ce8\u518c\u5668",children:"\u6ce8\u518c\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u53d6\u4ee3 ComponentScan \u626b\u63cf\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1aImportBeanDefinitionRegistrar"}),"\n",(0,i.jsxs)(e.p,{children:["\u7c7b\u578b\uff1a",(0,i.jsx)(e.strong,{children:"\u63a5\u53e3"})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u81ea\u5b9a\u4e49 bean \u5b9a\u4e49\u6ce8\u518c\u5668"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"registrar / MyImportBeanDefinitionRegistrar"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {\n/**\n * AnnotationMetadata:\u5f53\u524d\u7c7b\u7684\u6ce8\u89e3\u4fe1\u606f\n * BeanDefinitionRegistry:BeanDefinition\u6ce8\u518c\u7c7b\uff0c\u628a\u6240\u6709\u9700\u8981\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\u7684bean\u8c03\u7528registerBeanDefinition\u624b\u5de5\u6ce8\u518c\u8fdb\u6765\n */\n    @Override\n    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {\n        //\u81ea\u5b9a\u4e49\u6ce8\u518c\u5668\n        //1.\u5f00\u542f\u7c7b\u8def\u5f84bean\u5b9a\u4e49\u626b\u63cf\u5668\uff0c\u9700\u8981\u53c2\u6570bean\u5b9a\u4e49\u6ce8\u518c\u5668BeanDefinitionRegistry\uff0c\u9700\u8981\u5236\u5b9a\u662f\u5426\u4f7f\u7528\u9ed8\u8ba4\u7c7b\u578b\u8fc7\u6ee4\u5668\n        ClassPathBeanDefinitionScanner scanner = new ClassPathBeanDefinitionScanner(registry,false);\n        //2.\u6dfb\u52a0\u5305\u542b\u6027\u52a0\u8f7d\u7c7b\u578b\u8fc7\u6ee4\u5668\uff08\u53ef\u9009\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u6392\u9664\u6027\u52a0\u8f7d\u7c7b\u578b\u8fc7\u6ee4\u5668\uff09\n        scanner.addIncludeFilter(new TypeFilter() {\n            @Override\n            public boolean match(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory) throws IOException {\n                //\u6240\u6709\u5339\u914d\u5168\u90e8\u6210\u529f\uff0c\u6b64\u5904\u5e94\u8be5\u6dfb\u52a0\u5b9e\u9645\u7684\u4e1a\u52a1\u5224\u5b9a\u6761\u4ef6\n                return true;\n            }\n        });\n        //\u8bbe\u7f6e\u626b\u63cf\u8def\u5f84\n        scanner.addExcludeFilter(tf);//\u6392\u9664\n        scanner.scan("dao","service");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"SpringConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\n@Import(MyImportBeanDefinitionRegistrar.class)\npublic class SpringConfig {\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5904\u7406\u5668",children:"\u5904\u7406\u5668"}),"\n",(0,i.jsxs)(e.p,{children:["\u901a\u8fc7\u521b\u5efa\u7c7b",(0,i.jsx)(e.strong,{children:"\u7ee7\u627f\u76f8\u5e94\u7684\u5904\u7406\u5668\u7684\u63a5\u53e3"}),"\uff0c\u91cd\u5199\u540e\u7f6e\u5904\u7406\u7684\u65b9\u6cd5\uff0c\u6765\u5b9e\u73b0",(0,i.jsx)(e.strong,{children:"\u62e6\u622a Bean \u7684\u751f\u547d\u5468\u671f"}),"\u6765\u5b9e\u73b0\u81ea\u5df1\u81ea\u5b9a\u4e49\u7684\u903b\u8f91"]}),"\n",(0,i.jsx)(e.p,{children:"BeanPostProcessor\uff1abean \u540e\u7f6e\u5904\u7406\u5668\uff0cbean \u521b\u5efa\u5bf9\u8c61\u521d\u59cb\u5316\u524d\u540e\u8fdb\u884c\u62e6\u622a\u5de5\u4f5c\u7684"}),"\n",(0,i.jsx)(e.p,{children:"BeanFactoryPostProcessor\uff1abeanFactory \u7684\u540e\u7f6e\u5904\u7406\u5668"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:" \u52a0\u8f7d\u65f6\u673a\uff1a\u5728 BeanFactory \u521d\u59cb\u5316\u4e4b\u540e\u8c03\u7528\uff0c\u6765\u5b9a\u5236\u548c\u4fee\u6539 BeanFactory \u7684\u5185\u5bb9\uff1b\u6240\u6709\u7684 bean \u5b9a\u4e49\u5df2\u7ecf\u4fdd\u5b58\u52a0\u8f7d\u5230 beanFactory\uff0c\u4f46\u662f bean \u7684\u5b9e\u4f8b\u8fd8\u672a\u521b\u5efa\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"  \u6267\u884c\u6d41\u7a0b\uff1a\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"ioc \u5bb9\u5668\u521b\u5efa\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.li,{children:["invokeBeanFactoryPostProcessors(beanFactory)\uff1a\u6267\u884c BeanFactoryPostProcessor\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728 BeanFactory \u4e2d\u627e\u5230\u6240\u6709\u7c7b\u578b\u662f BeanFactoryPostProcessor \u7684\u7ec4\u4ef6\uff0c\u5e76\u6267\u884c\u5b83\u4eec\u7684\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u521d\u59cb\u5316\u521b\u5efa\u5176\u4ed6\u7ec4\u4ef6\u524d\u9762\u6267\u884c"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"BeanDefinitionRegistryPostProcessor\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u52a0\u8f7d\u65f6\u673a\uff1a\u5728\u6240\u6709 bean \u5b9a\u4e49\u4fe1\u606f\u5c06\u8981\u88ab\u52a0\u8f7d\uff0c\u4f46\u662f bean \u5b9e\u4f8b\u8fd8\u672a\u521b\u5efa\uff0c\u4f18\u5148\u4e8e BeanFactoryPostProcessor \u6267\u884c\uff1b\u5229\u7528 BeanDefinitionRegistryPostProcessor \u7ed9\u5bb9\u5668\u4e2d\u518d\u989d\u5916\u6dfb\u52a0\u4e00\u4e9b\u7ec4\u4ef6"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"ioc \u5bb9\u5668\u521b\u5efa\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"refresh() \u2192 invokeBeanFactoryPostProcessors(beanFactory)"}),"\n",(0,i.jsxs)(e.li,{children:["\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\u5230\u6240\u6709\u7684 BeanDefinitionRegistryPostProcessor \u7ec4\u4ef6\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4f9d\u6b21\u89e6\u53d1\u6240\u6709\u7684 postProcessBeanDefinitionRegistry() \u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"\u518d\u6765\u89e6\u53d1 postProcessBeanFactory() \u65b9\u6cd5"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u76d1\u542c\u5668",children:"\u76d1\u542c\u5668"}),"\n",(0,i.jsx)(e.h5,{id:"\u57fa\u672c\u6982\u8ff0-1",children:"\u57fa\u672c\u6982\u8ff0"}),"\n",(0,i.jsx)(e.p,{children:"ApplicationListener\uff1a\u76d1\u542c\u5bb9\u5668\u4e2d\u53d1\u5e03\u7684\u4e8b\u4ef6\uff0c\u5b8c\u6210\u4e8b\u4ef6\u9a71\u52a8\u6a21\u578b\u5f00\u53d1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface ApplicationListener<E extends ApplicationEvent>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6240\u4ee5\u76d1\u542c ApplicationEvent \u53ca\u5176\u4e0b\u9762\u7684\u5b50\u4e8b\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\u76d1\u542c\u5668\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5199\u4e00\u4e2a\u76d1\u542c\u5668\uff08ApplicationListener\u5b9e\u73b0\u7c7b\uff09\u6765\u76d1\u542c\u67d0\u4e2a\u4e8b\u4ef6\uff08ApplicationEvent\u53ca\u5176\u5b50\u7c7b\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u628a\u76d1\u542c\u5668\u52a0\u5165\u5230\u5bb9\u5668 @Component"}),"\n",(0,i.jsxs)(e.li,{children:["\u53ea\u8981\u5bb9\u5668\u4e2d\u6709\u76f8\u5173\u4e8b\u4ef6\u7684\u53d1\u5e03\uff0c\u5c31\u80fd\u76d1\u542c\u5230\u8fd9\u4e2a\u4e8b\u4ef6\uff1b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:" ContextRefreshedEvent\uff1a\u5bb9\u5668\u5237\u65b0\u5b8c\u6210\uff08\u6240\u6709 bean \u90fd\u5b8c\u5168\u521b\u5efa\uff09\u4f1a\u53d1\u5e03\u8fd9\u4e2a\u4e8b\u4ef6\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:" ContextClosedEvent\uff1a\u5173\u95ed\u5bb9\u5668\u4f1a\u53d1\u5e03\u8fd9\u4e2a\u4e8b\u4ef6\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u53d1\u5e03\u4e00\u4e2a\u4e8b\u4ef6\uff1a",(0,i.jsx)(e.code,{children:"applicationContext.publishEvent()"})]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\npublic class MyApplicationListener implements ApplicationListener<ApplicationEvent> {\n\t//\u5f53\u5bb9\u5668\u4e2d\u53d1\u5e03\u6b64\u4e8b\u4ef6\u4ee5\u540e\uff0c\u65b9\u6cd5\u89e6\u53d1\n\t@Override\n\tpublic void onApplicationEvent(ApplicationEvent event) {\n\t\tSystem.out.println("\u6536\u5230\u4e8b\u4ef6\uff1a" + event);\n\t}\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u5b9e\u73b0\u539f\u7406-1",children:"\u5b9e\u73b0\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"ContextRefreshedEvent \u4e8b\u4ef6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5bb9\u5668\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u6267\u884c ",(0,i.jsx)(e.code,{children:"initApplicationEventMulticaster()"}),"\uff1a\u521d\u59cb\u5316\u4e8b\u4ef6\u591a\u64ad\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5148\u53bb\u5bb9\u5668\u4e2d\u67e5\u8be2 ",(0,i.jsx)(e.code,{children:"id = applicationEventMulticaster"})," \u7684\u7ec4\u4ef6\uff0c\u6709\u76f4\u63a5\u8fd4\u56de"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6ca1\u6709\u5c31\u6267\u884c ",(0,i.jsx)(e.code,{children:"this.applicationEventMulticaster = new SimpleApplicationEventMulticaster(beanFactory)"})," \u5e76\u4e14\u52a0\u5165\u5230\u5bb9\u5668\u4e2d"]}),"\n",(0,i.jsx)(e.li,{children:"\u4ee5\u540e\u5728\u5176\u4ed6\u7ec4\u4ef6\u8981\u6d3e\u53d1\u4e8b\u4ef6\uff0c\u81ea\u52a8\u6ce8\u5165\u8fd9\u4e2a applicationEventMulticaster"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5bb9\u5668\u521d\u59cb\u5316\u8fc7\u7a0b\u6267\u884c ",(0,i.jsx)(e.strong,{children:"registerListeners()"})," \u6ce8\u518c\u76d1\u542c\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\u6240\u6709\u76d1\u542c\u5668\uff1a",(0,i.jsx)(e.code,{children:"getBeanNamesForType(ApplicationListener.class, true, false)"})]}),"\n",(0,i.jsx)(e.li,{children:"\u5c06 listener \u6ce8\u518c\u5230 ApplicationEventMulticaster"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bb9\u5668\u5237\u65b0\u5b8c\u6210\uff1afinishRefresh() \u2192 publishEvent(new ContextRefreshedEvent(this))"}),"\n",(0,i.jsx)(e.p,{children:"\u53d1\u5e03 ContextRefreshedEvent \u4e8b\u4ef6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u83b7\u53d6\u4e8b\u4ef6\u7684\u591a\u64ad\u5668\uff08\u6d3e\u53d1\u5668\uff09\uff1agetApplicationEventMulticaster()"}),"\n",(0,i.jsxs)(e.li,{children:["multicastEvent \u6d3e\u53d1\u4e8b\u4ef6\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u83b7\u53d6\u5230\u6240\u6709\u7684 ApplicationListener"}),"\n",(0,i.jsxs)(e.li,{children:["\u904d\u5386 ApplicationListener\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5982\u679c\u6709 Executor\uff0c\u53ef\u4ee5\u4f7f\u7528 Executor \u5f02\u6b65\u6d3e\u53d1 ",(0,i.jsx)(e.code,{children:"Executor executor = getTaskExecutor()"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u6ca1\u6709\u5c31\u540c\u6b65\u6267\u884c listener \u65b9\u6cd5 ",(0,i.jsx)(e.code,{children:"invokeListener(listener, event)"}),"\uff0c\u62ff\u5230 listener \u56de\u8c03 onApplicationEvent"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5bb9\u5668\u5173\u95ed\u4f1a\u53d1\u5e03 ContextClosedEvent"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6ce8\u89e3\u5b9e\u73b0",children:"\u6ce8\u89e3\u5b9e\u73b0"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@EventListener"}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Service\npublic class UserService{\n    @EventListener(classes={ApplicationEvent.class})\n\tpublic void listen(ApplicationEvent event){\n\t\tSystem.out.println("UserService\u3002\u3002\u76d1\u542c\u5230\u7684\u4e8b\u4ef6\uff1a" + event);\n\t}\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u7406\uff1a\u4f7f\u7528 EventListenerMethodProcessor \u5904\u7406\u5668\u6765\u89e3\u6790\u65b9\u6cd5\u4e0a\u7684 @EventListener\uff0cSpring \u626b\u63cf\u4f7f\u7528\u6ce8\u89e3\u7684\u65b9\u6cd5\uff0c\u5e76\u4e3a\u4e4b\u521b\u5efa\u4e00\u4e2a\u76d1\u542c\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.p,{children:"SmartInitializingSingleton \u539f\u7406\uff1aafterSingletonsInstantiated()"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:" \tIOC \u5bb9\u5668\u521b\u5efa\u5bf9\u8c61\u5e76 refresh()\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:" \tfinishBeanFactoryInitialization(beanFactory)\uff1a\u521d\u59cb\u5316\u5269\u4e0b\u7684\u5355\u5b9e\u4f8b bean\n * \u5148\u521b\u5efa\u6240\u6709\u7684\u5355\u5b9e\u4f8b bean\uff1agetBean()\n * \u83b7\u53d6\u6240\u6709\u521b\u5efa\u597d\u7684\u5355\u5b9e\u4f8b bean\uff0c\u5224\u65ad\u662f\u5426\u662f SmartInitializingSingleton \u7c7b\u578b\u7684\uff0c\u5982\u679c\u662f\u5c31\u8c03\u7528 afterSingletonsInstantiated()\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"aop",children:"AOP"}),"\n",(0,i.jsx)(e.h3,{id:"\u57fa\u672c\u6982\u8ff0-2",children:"\u57fa\u672c\u6982\u8ff0"}),"\n",(0,i.jsxs)(e.p,{children:["AOP\uff08Aspect Oriented Programing\uff09\uff1a\u9762\u5411\u5207\u9762\u7f16\u7a0b\uff0c\u4e00\u79cd\u7f16\u7a0b",(0,i.jsx)(e.strong,{children:"\u8303\u5f0f"}),"\uff0c\u6307\u5bfc\u5f00\u53d1\u8005\u5982\u4f55\u7ec4\u7ec7\u7a0b\u5e8f\u7ed3\u6784"]}),"\n",(0,i.jsx)(e.p,{children:"AOP \u5f25\u8865\u4e86 OOP \u7684\u4e0d\u8db3\uff0c\u57fa\u4e8e OOP \u57fa\u7840\u4e4b\u4e0a\u8fdb\u884c\u6a2a\u5411\u5f00\u53d1\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"uOOP \u89c4\u5b9a\u7a0b\u5e8f\u5f00\u53d1\u4ee5\u7c7b\u4e3a\u4e3b\u4f53\u6a21\u578b\uff0c\u4e00\u5207\u56f4\u7ed5\u5bf9\u8c61\u8fdb\u884c\uff0c\u5b8c\u6210\u67d0\u4e2a\u4efb\u52a1\u5148\u6784\u5efa\u6a21\u578b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"uAOP \u7a0b\u5e8f\u5f00\u53d1\u4e3b\u8981\u5173\u6ce8\u57fa\u4e8e OOP \u5f00\u53d1\u4e2d\u7684\u5171\u6027\u529f\u80fd\uff0c\u4e00\u5207\u56f4\u7ed5\u5171\u6027\u529f\u80fd\u8fdb\u884c\uff0c\u5b8c\u6210\u67d0\u4e2a\u4efb\u52a1\u5148\u6784\u5efa\u53ef\u80fd\u9047\u5230\u7684\u6240\u6709\u5171\u6027\u529f\u80fd\uff08\u5f53\u6240\u6709\u529f\u80fd\u90fd\u5f00\u53d1\u51fa\u6765\u4e5f\u5c31\u6ca1\u6709\u5171\u6027\u4e0e\u975e\u5171\u6027\u4e4b\u5206\uff09\uff0c\u5c06\u8f6f\u4ef6\u5f00\u53d1\u7531\u624b\u5de5\u5236\u4f5c\u8d70\u5411\u534a\u81ea\u52a8\u5316/\u5168\u81ea\u52a8\u5316\u9636\u6bb5\uff0c\u5b9e\u73b0\u201c\u63d2\u62d4\u5f0f\u7ec4\u4ef6\u4f53\u7cfb\u7ed3\u6784\u201d\u642d\u5efa"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"AOP \u4f5c\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u91cd\u7528\u6027"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u4ee3\u7801\u7f16\u7801\u66f4\u7b80\u6d01"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u4ee3\u7801\u7ef4\u62a4\u66f4\u9ad8\u6548"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u529f\u80fd\u6269\u5c55\u66f4\u4fbf\u6377"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6838\u5fc3\u6982\u5ff5",children:"\u6838\u5fc3\u6982\u5ff5"}),"\n",(0,i.jsx)(e.h4,{id:"\u6982\u5ff5\u8be6\u89e3",children:"\u6982\u5ff5\u8be6\u89e3"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Joinpoint\uff08\u8fde\u63a5\u70b9\uff09\uff1a\u5c31\u662f\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Pointcut\uff08\u5207\u5165\u70b9\uff09\uff1a\u5c31\u662f\u6316\u6389\u5171\u6027\u529f\u80fd\u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Advice\uff08\u901a\u77e5\uff09\uff1a\u5c31\u662f\u5171\u6027\u529f\u80fd\uff0c\u6700\u7ec8\u4ee5\u4e00\u4e2a\u65b9\u6cd5\u7684\u5f62\u5f0f\u5448\u73b0"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Aspect\uff08\u5207\u9762\uff09\uff1a\u5c31\u662f\u5171\u6027\u529f\u80fd\u4e0e\u6316\u7684\u4f4d\u7f6e\u7684\u5bf9\u5e94\u5173\u7cfb"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Target\uff08\u76ee\u6807\u5bf9\u8c61\uff09\uff1a\u5c31\u662f\u6316\u6389\u529f\u80fd\u7684\u65b9\u6cd5\u5bf9\u5e94\u7684\u7c7b\u4ea7\u751f\u7684\u5bf9\u8c61\uff0c\u8fd9\u79cd\u5bf9\u8c61\u662f\u65e0\u6cd5\u76f4\u63a5\u5b8c\u6210\u6700\u7ec8\u5de5\u4f5c\u7684"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Weaving\uff08\u7ec7\u5165\uff09\uff1a\u5c31\u662f\u5c06\u6316\u6389\u7684\u529f\u80fd\u56de\u586b\u7684\u52a8\u6001\u8fc7\u7a0b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Proxy\uff08\u4ee3\u7406\uff09\uff1a\u76ee\u6807\u5bf9\u8c61\u65e0\u6cd5\u76f4\u63a5\u5b8c\u6210\u5de5\u4f5c\uff0c\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u529f\u80fd\u56de\u586b\uff0c\u901a\u8fc7\u521b\u5efa\u539f\u59cb\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61\u5b9e\u73b0"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Introduction\uff08\u5f15\u5165/\u5f15\u4ecb\uff09\uff1a\u5c31\u662f\u5bf9\u539f\u59cb\u5bf9\u8c61\u65e0\u4e2d\u751f\u6709\u7684\u6dfb\u52a0\u6210\u5458\u53d8\u91cf\u6216\u6210\u5458\u65b9\u6cd5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(62836).A+"",width:"756",height:"283"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(97453).A+"",width:"896",height:"376"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(5858).A+"",width:"898",height:"382"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5165\u95e8\u9879\u76ee-1",children:"\u5165\u95e8\u9879\u76ee"}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u53d1\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f00\u53d1\u9636\u6bb5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5236\u4f5c\u7a0b\u5e8f"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5c06\u975e\u5171\u6027\u529f\u80fd\u5f00\u53d1\u5230\u5bf9\u5e94\u7684\u76ee\u6807\u5bf9\u8c61\u7c7b\u4e2d\uff0c\u5e76\u5236\u4f5c\u6210\u5207\u5165\u70b9\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5c06\u5171\u6027\u529f\u80fd\u72ec\u7acb\u5f00\u53d1\u51fa\u6765\uff0c\u5236\u4f5c\u6210\u901a\u77e5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u58f0\u660e\u5207\u5165\u70b9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u58f0\u660e\u5207\u5165\u70b9\u4e0e\u901a\u77e5\u95f4\u7684\u5173\u7cfb\uff08\u542b\u901a\u77e5\u7c7b\u578b\uff09\uff0c\u5373\u5207\u9762"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u9636\u6bb5\uff08AOP \u5b8c\u6210\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Spring \u5bb9\u5668\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u76d1\u63a7\u6240\u6709\u914d\u7f6e\u7684",(0,i.jsx)(e.strong,{children:"\u5207\u5165\u70b9"}),"\u65b9\u6cd5\u7684\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5f53\u76d1\u63a7\u5230\u5207\u5165\u70b9\u65b9\u6cd5\u88ab\u8fd0\u884c\uff0c",(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u4ee3\u7406\u673a\u5236\uff0c\u52a8\u6001\u521b\u5efa\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u6839\u636e\u901a\u77e5\u7c7b\u522b\uff0c\u5728\u4ee3\u7406\u5bf9\u8c61\u7684\u5bf9\u5e94\u4f4d\u7f6e\u5c06\u901a\u77e5\u5bf9\u5e94\u7684\u529f\u80fd\u7ec7\u5165"}),"\uff0c\u5b8c\u6210\u5b8c\u6574\u7684\u4ee3\u7801\u903b\u8f91\u5e76\u8fd0\u884c"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5750\u6807 pom.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-context</artifactId>\n    <version>5.1.9.RELEASE</version>\n</dependency>\n<dependency>\n    <groupId>org.aspectj</groupId>\n    <artifactId>aspectjweaver</artifactId>\n    <version>1.9.4</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42\u62bd\u53d6\u901a\u7528\u4ee3\u7801  service / UserServiceImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserService {\n    public void save();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    @Override\n    public void save() {\n        //System.out.println("\u5171\u6027\u529f\u80fd");\n        System.out.println("user service running...");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"aop.AOPAdvice"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//1.\u5236\u4f5c\u901a\u77e5\u7c7b\uff0c\u5728\u7c7b\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5\u7528\u4e8e\u5b8c\u6210\u5171\u6027\u529f\u80fd\npublic class AOPAdvice {\n    //\u5171\u6027\u529f\u80fd\u62bd\u53d6\u540e\u804c\u79f0\u72ec\u7acb\u7684\u65b9\u6cd5\n    public void function(){\n        System.out.println("\u5171\u6027\u529f\u80fd");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u628a\u901a\u77e5\u52a0\u5165spring\u5bb9\u5668\u7ba1\u7406\uff0c\u914d\u7f6eaop  applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:aop="http://www.springframework.org/schema/aop"\n       xsi:schemaLocation="\n        http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        https://www.springframework.org/schema/context/spring-context.xsd\n        http://www.springframework.org/schema/aop\n        https://www.springframework.org/schema/aop/spring-aop.xsd\n        ">\n    \x3c!--\u539f\u59cbSpring\u63a7\u5236\u8d44\u6e90--\x3e\n    <bean id="userService" class= "service.impl.UserServiceImpl"/>\n    \x3c!--2.\u914d\u7f6e\u5171\u6027\u529f\u80fd\u6210\u529fspring\u63a7\u5236\u7684\u8d44\u6e90--\x3e\n    <bean id="myAdvice" class="aop.AOPAdvice"/>\n    \x3c!--3.\u5f00\u542fAOP\u547d\u540d\u7a7a\u95f4: beans\u6807\u7b7e\u5185--\x3e\n    \x3c!--4.\u914d\u7f6eAOP--\x3e\n    <aop:config>\n        \x3c!--5.\u914d\u7f6e\u5207\u5165\u70b9--\x3e\n        <aop:pointcut id="pt" expression="execution(* *..*(..))"/>\n        \x3c!--6.\u914d\u7f6e\u5207\u9762\uff08\u5207\u5165\u70b9\u4e0e\u901a\u77e5\u7684\u5173\u7cfb\uff09--\x3e\n        <aop:aspect ref="myAdvice">\n            \x3c!--7.\u914d\u7f6e\u5177\u4f53\u7684\u5207\u5165\u70b9\u5bf9\u5e94\u901a\u77e5\u4e2d\u90a3\u4e2a\u64cd\u4f5c\u65b9\u6cd5--\x3e\n            <aop:before method="function" pointcut-ref="pt"/>\n        </aop:aspect>\n    </aop:config>\n</beans>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n        UserService userService = (UserService) ctx.getBean("userService");\n        userService.save();//\u5148\u8f93\u51fa\u5171\u6027\u529f\u80fd\uff0c\u7136\u540e user service running...\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"xml\u5f00\u53d1-1",children:"XML\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h4,{id:"aspectj",children:"AspectJ"}),"\n",(0,i.jsx)(e.p,{children:"Aspect\uff08\u5207\u9762\uff09\u7528\u4e8e\u63cf\u8ff0\u5207\u5165\u70b9\u4e0e\u901a\u77e5\u95f4\u7684\u5173\u7cfb\uff0c\u662f AOP \u7f16\u7a0b\u4e2d\u7684\u4e00\u4e2a\u6982\u5ff5"}),"\n",(0,i.jsx)(e.p,{children:"AspectJ \u662f\u57fa\u4e8e java \u8bed\u8a00\u5bf9 Aspect \u7684\u5b9e\u73b0"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"aop-1",children:"AOP"}),"\n",(0,i.jsx)(e.h5,{id:"config",children:"config"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:config",children:"aop:config"}),"\uff0c",(0,i.jsx)(e.beans,{children:" \u7684\u5b50\u6807\u7b7e"})]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e AOP"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<beans>\n    <aop:config>\u2026\u2026</aop:config>\n    <aop:config>\u2026\u2026</aop:config>\n    \x3c!--\u4e00\u4e2abeans\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:config\u6807\u7b7e--\x3e\n</beans>\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"pointcut",children:"pointcut"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:pointcut",children:"aop:pointcut"}),"\uff0c\u5f52\u5c5e\u4e8e aop:config \u6807\u7b7e\u548c aop:aspect \u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5207\u5165\u70b9"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:config>\n    <aop:pointcut id="pointcutId" expression="\u2026\u2026"/>\n    <aop:aspect>\n        <aop:pointcut id="pointcutId" expression="\u2026\u2026"/>\n    </aop:aspect>\n</aop:config>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4e00\u4e2a aop:config \u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a aop:pointcut \u6807\u7b7e\uff0c\u4e14\u8be5\u6807\u7b7e\u53ef\u4ee5\u914d\u7f6e\u5728 aop:aspect \u6807\u7b7e\u5185"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"id \uff1a\u8bc6\u522b\u5207\u5165\u70b9\u7684\u540d\u79f0"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"expression \uff1a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"aspect",children:"aspect"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:aspect",children:"aop:aspect"}),"\uff0caop:config \u7684\u5b50\u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5177\u4f53\u7684 AOP \u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9\uff08\u5207\u9762\uff09"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:config>\n    <aop:aspect ref="beanId">\u2026\u2026</aop:aspect>\n    <aop:aspect ref="beanId">\u2026\u2026</aop:aspect>\n    \x3c!--\u4e00\u4e2aaop:config\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:aspect\u6807\u7b7e--\x3e\n</aop:config>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"ref \uff1a\u901a\u77e5\u6240\u5728\u7684 bean \u7684 id"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"pointcut-1",children:"Pointcut"}),"\n",(0,i.jsx)(e.h5,{id:"\u5207\u5165\u70b9",children:"\u5207\u5165\u70b9"}),"\n",(0,i.jsx)(e.p,{children:"\u5207\u5165\u70b9\u63cf\u8ff0\u7684\u662f\u67d0\u4e2a\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u662f\u4e00\u4e2a\u5feb\u901f\u5339\u914d\u65b9\u6cd5\u63cf\u8ff0\u7684\u901a\u914d\u683c\u5f0f\uff0c\u7c7b\u4f3c\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u8868\u8fbe\u5f0f",children:"\u8868\u8fbe\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\u5173\u952e\u5b57(\u8bbf\u95ee\u4fee\u9970\u7b26  \u8fd4\u56de\u503c  \u5305\u540d.\u7c7b\u540d.\u65b9\u6cd5\u540d(\u53c2\u6570)\u5f02\u5e38\u540d)\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u5339\u914dUserService\u4e2d\u53ea\u542b\u6709\u4e00\u4e2a\u53c2\u6570\u7684findById\u65b9\u6cd5\nexecution(public User service.UserService.findById(int))\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\u89e3\u6790\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5173\u952e\u5b57\uff1a\u63cf\u8ff0\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u6a21\u5f0f\uff08\u53c2\u770b\u5173\u952e\u5b57\u5217\u8868\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u8bbf\u95ee\u4fee\u9970\u7b26\uff1a\u65b9\u6cd5\u7684\u8bbf\u95ee\u63a7\u5236\u6743\u9650\u4fee\u9970\u7b26"}),"\n",(0,i.jsx)(e.li,{children:"\u7c7b\u540d\uff1a\u65b9\u6cd5\u6240\u5728\u7684\u7c7b\uff08\u6b64\u5904\u53ef\u4ee5\u914d\u7f6e\u63a5\u53e3\u540d\u79f0\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5f02\u5e38\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e2d\u6307\u5b9a\u629b\u51fa\u7684\u5f02\u5e38"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5173\u952e\u5b57\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"execution \uff1a\u5339\u914d\u6267\u884c\u6307\u5b9a\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"args \uff1a\u5339\u914d\u5e26\u6709\u6307\u5b9a\u53c2\u6570\u7c7b\u578b\u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"within\u3001this\u3001target\u3001@within\u3001@target\u3001@args\u3001@annotation\u3001bean\u3001reference pointcut\u7b49"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u914d\u7b26\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"*\uff1a\u5355\u4e2a\u72ec\u7acb\u7684\u4efb\u610f\u7b26\u53f7\uff0c\u53ef\u4ee5\u72ec\u7acb\u51fa\u73b0\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u524d\u7f00\u6216\u8005\u540e\u7f00\u7684\u5339\u914d\u7b26\u51fa\u73b0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u5339\u914dcom.seazean\u5305\u4e0b\u7684\u4efb\u610f\u5305\u4e2d\u7684UserService\u7c7b\u6216\u63a5\u53e3\u4e2d\u6240\u6709find\u5f00\u5934\u7684\u5e26\u6709\u4e00\u4e2a\u4efb\u610f\u53c2\u6570\u7684\u65b9\u6cd5\nexecution(public * com.seazean.*.UserService.find*(*)\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:".. \uff1a\u591a\u4e2a\u8fde\u7eed\u7684\u4efb\u610f\u7b26\u53f7\uff0c\u53ef\u4ee5\u72ec\u7acb\u51fa\u73b0\uff0c\u5e38\u7528\u4e8e\u7b80\u5316\u5305\u540d\u4e0e\u53c2\u6570"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u5339\u914dcom\u5305\u4e0b\u7684\u4efb\u610f\u5305\u4e2d\u7684UserService\u7c7b\u6216\u63a5\u53e3\u4e2d\u6240\u6709\u540d\u79f0\u4e3afindById\u53c2\u6570\u4efb\u610f\u6570\u91cf\u548c\u7c7b\u578b\u7684\u65b9\u6cd5\nexecution(public User com..UserService.findById(..))\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"+\uff1a\u4e13\u7528\u4e8e\u5339\u914d\u5b50\u7c7b\u7c7b\u578b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u5339\u914d\u4efb\u610f\u5305\u4e0b\u7684Service\u7ed3\u5c3e\u7684\u7c7b\u6216\u8005\u63a5\u53e3\u7684\u5b50\u7c7b\u6216\u8005\u5b9e\u73b0\u7c7b\nexecution(* *..*Service+.*(..))\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"&&\uff1a\u8fde\u63a5\u4e24\u4e2a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u4e24\u4e2a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u540c\u65f6\u6210\u7acb\u7684\u5339\u914d"}),"\n",(0,i.jsx)(e.li,{children:"||\uff1a\u8fde\u63a5\u4e24\u4e2a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u4e24\u4e2a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u6210\u7acb\u4efb\u610f\u4e00\u4e2a\u7684\u5339\u914d"}),"\n",(0,i.jsx)(e.li,{children:"! \uff1a\u8fde\u63a5\u5355\u4e2a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u8be5\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u4e0d\u6210\u7acb\u7684\u5339\u914d"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"execution(* *(..))\t\t//\u524d\u4e09\u4e2a\u90fd\u662f\u5339\u914d\u5168\u90e8\nexecution(* *..*(..))\nexecution(* *..*.*(..))\nexecution(public * *..*.*(..))\nexecution(public int *..*.*(..))\nexecution(public void *..*.*(..))\nexecution(public void com..*.*(..)) \nexecution(public void com..service.*.*(..))\nexecution(public void com.seazean.service.*.*(..))\nexecution(public void com.seazean.service.User*.*(..))\nexecution(public void com.seazean.service.*Service.*(..))\nexecution(public void com.seazean.service.UserService.*(..))\nexecution(public User com.seazean.service.UserService.find*(..))\t//find\u5f00\u5934\nexecution(public User com.seazean.service.UserService.*Id(..))\t\t//I\nexecution(public User com.seazean.service.UserService.findById(..))\nexecution(public User com.seazean.service.UserService.findById(int))\nexecution(public User com.seazean.service.UserService.findById(int,int))\nexecution(public User com.seazean.service.UserService.findById(int,*))\nexecution(public User com.seazean.service.UserService.findById())\nexecution(List com.seazean.service.*Service+.findAll(..))\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u914d\u7f6e\u65b9\u5f0f",children:"\u914d\u7f6e\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"XML \u914d\u7f6e\u89c4\u5219\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f01\u4e1a\u5f00\u53d1\u547d\u540d\u89c4\u8303\u4e25\u683c\u9075\u5faa\u89c4\u8303\u6587\u6863\u8fdb\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5148\u4e3a\u65b9\u6cd5\u914d\u7f6e\u5c40\u90e8\u5207\u5165\u70b9\uff0c\u518d\u62bd\u53d6\u7c7b\u4e2d\u516c\u5171\u5207\u5165\u70b9\uff0c\u6700\u540e\u62bd\u53d6\u5168\u5c40\u5207\u5165\u70b9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u8d70\u67e5\u8fc7\u7a0b\u4e2d\u68c0\u6d4b\u5207\u5165\u70b9\u662f\u5426\u5b58\u5728\u8d8a\u754c\u6027\u5305\u542b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u8d70\u67e5\u8fc7\u7a0b\u4e2d\u68c0\u6d4b\u5207\u5165\u70b9\u662f\u5426\u5b58\u5728\u975e\u5305\u542b\u6027\u8fdb\u9a7b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a AOP \u6267\u884c\u68c0\u6d4b\u7a0b\u5e8f\uff0c\u5728\u5355\u5143\u6d4b\u8bd5\u4e2d\u76d1\u63a7\u901a\u77e5\u88ab\u6267\u884c\u6b21\u6570\u4e0e\u9884\u8ba1\u6b21\u6570\u662f\u5426\u5339\u914d\uff08\u4e0d\u7edd\u5bf9\u6b63\u786e\uff1a\u52a0\u8fdb\u4e00\u4e2a\u4e0d\u8be5\u52a0\u7684\uff0c\u5220\u53bb\u4e00\u4e2a\u4e0d\u8be5\u5220\u7684\u76f8\u5f53\u4e8e\u7ed3\u679c\u4e0d\u53d8\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u5b8c\u6bd5\u7684\u5207\u5165\u70b9\u5982\u679c\u53d1\u751f\u8c03\u6574\u52a1\u5fc5\u8fdb\u884c\u56de\u5f52\u6d4b\u8bd5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:config>\n    \x3c!--1.\u914d\u7f6e\u516c\u5171\u5207\u5165\u70b9--\x3e\n    <aop:pointcut id="pt1" expression="execution(* *(..))"/>\n    <aop:aspect ref="myAdvice">\n        \x3c!--2.\u914d\u7f6e\u5c40\u90e8\u5207\u5165\u70b9--\x3e\n        <aop:pointcut id="pt2" expression="execution(* *(..))"/>\n        \x3c!--\u5f15\u7528\u516c\u5171\u5207\u5165\u70b9--\x3e\n        <aop:before method="logAdvice" pointcut-ref="pt1"/>\n        \x3c!--\u5f15\u7528\u5c40\u90e8\u5207\u5165\u70b9--\x3e\n        <aop:before method="logAdvice" pointcut-ref="pt2"/>\n        \x3c!--3.\u76f4\u63a5\u914d\u7f6e\u5207\u5165\u70b9--\x3e\n        <aop:before method="logAdvice" pointcut="execution(* *(..))"/>\n    </aop:aspect>\n</aop:config>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"advice",children:"Advice"}),"\n",(0,i.jsx)(e.h5,{id:"\u901a\u77e5\u7c7b\u578b",children:"\u901a\u77e5\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"AOP \u7684\u901a\u77e5\u7c7b\u578b\u51715\u79cd\uff1a\u524d\u7f6e\u901a\u77e5\uff0c\u540e\u7f6e\u901a\u77e5\u3001\u8fd4\u56de\u540e\u901a\u77e5\u3001\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u3001\u73af\u7ed5\u901a\u77e5"}),"\n",(0,i.jsx)(e.h6,{id:"before",children:"before"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:before",children:"aop:before"}),"\uff0caop:aspect\u7684\u5b50\u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u524d\u7f6e\u901a\u77e5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u524d\u7f6e\u901a\u77e5"}),"\uff1a\u539f\u59cb\u65b9\u6cd5\u6267\u884c\u524d\u6267\u884c\uff0c\u5982\u679c\u901a\u77e5\u4e2d\u629b\u51fa\u5f02\u5e38\uff0c\u963b\u6b62\u539f\u59cb\u65b9\u6cd5\u8fd0\u884c"]}),"\n",(0,i.jsx)(e.li,{children:"\u5e94\u7528\uff1a\u6570\u636e\u6821\u9a8c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="adviceId">\n    <aop:before method="methodName" pointcut="execution(* *(..))"/>\n    \x3c!--\u4e00\u4e2aaop:aspect\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:before\u6807\u7b7e--\x3e\n</aop:aspect>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"method\uff1a\u5728\u901a\u77e5\u7c7b\u4e2d\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u7c7b\u522b\u5bf9\u5e94\u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pointcut\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u4e0epointcut-ref\u5c5e\u6027\u51b2\u7a81"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pointcut-ref\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9id\uff0c\u4e0epointcut\u5c5e\u6027\u51b2\u7a81"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h6,{id:"after",children:"after"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:after",children:"aop:after"}),"\uff0caop:aspect\u7684\u5b50\u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u540e\u7f6e\u901a\u77e5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u540e\u7f6e\u901a\u77e5"}),"\uff1a\u539f\u59cb\u65b9\u6cd5\u6267\u884c\u540e\u6267\u884c\uff0c\u65e0\u8bba\u539f\u59cb\u65b9\u6cd5\u4e2d\u662f\u5426\u51fa\u73b0\u5f02\u5e38\uff0c\u90fd\u5c06\u6267\u884c\u901a\u77e5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\uff1a\u73b0\u573a\u6e05\u7406"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="adviceId">\n    <aop:after method="methodName" pointcut="execution(* *(..))"/>\n    \x3c!--\u4e00\u4e2aaop:aspect\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:after\u6807\u7b7e--\x3e\n</aop:aspect>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"method\uff1a\u5728\u901a\u77e5\u7c7b\u4e2d\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u7c7b\u522b\u5bf9\u5e94\u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pointcut\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u4e0epointcut-ref\u5c5e\u6027\u51b2\u7a81"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pointcut-ref\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9id\uff0c\u4e0epointcut\u5c5e\u6027\u51b2\u7a81"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h6,{id:"after-r",children:"after-r"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:after-returning",children:"aop:after-returning"}),"\uff0caop:aspect\u7684\u5b50\u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u8fd4\u56de\u540e\u901a\u77e5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u8fd4\u56de\u540e\u901a\u77e5"}),"\uff1a\u539f\u59cb\u65b9\u6cd5\u6b63\u5e38\u6267\u884c\u5b8c\u6bd5\u5e76\u8fd4\u56de\u7ed3\u679c\u540e\u6267\u884c\uff0c\u5982\u679c\u539f\u59cb\u65b9\u6cd5\u4e2d\u629b\u51fa\u5f02\u5e38\uff0c\u65e0\u6cd5\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\uff1a\u8fd4\u56de\u503c\u76f8\u5173\u6570\u636e\u5904\u7406"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="adviceId">\n    <aop:after-returning method="methodName" pointcut="execution(* *(..))"/>\n    \x3c!--\u4e00\u4e2aaop:aspect\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:after-returning\u6807\u7b7e--\x3e\n</aop:aspect>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"method\uff1a\u5728\u901a\u77e5\u7c7b\u4e2d\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u7c7b\u522b\u5bf9\u5e94\u7684\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"pointcut\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u4e0epointcut-ref\u5c5e\u6027\u51b2\u7a81"}),"\n",(0,i.jsx)(e.li,{children:"pointcut-ref\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9id\uff0c\u4e0epointcut\u5c5e\u6027\u51b2\u7a81"}),"\n",(0,i.jsx)(e.li,{children:"returning\uff1a\u8bbe\u7f6e\u63a5\u53d7\u8fd4\u56de\u503c\u7684\u53c2\u6570\uff0c\u4e0e\u901a\u77e5\u7c7b\u4e2d\u5bf9\u5e94\u65b9\u6cd5\u7684\u53c2\u6570\u4e00\u81f4"}),"\n"]}),"\n",(0,i.jsx)(e.h6,{id:"after-t",children:"after-t"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:after-throwing",children:"aop:after-throwing"}),"\uff0caop:aspect\u7684\u5b50\u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5"}),"\uff1a\u539f\u59cb\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\u6267\u884c\uff0c\u5982\u679c\u539f\u59cb\u65b9\u6cd5\u6ca1\u6709\u629b\u51fa\u5f02\u5e38\uff0c\u65e0\u6cd5\u6267\u884c"]}),"\n",(0,i.jsx)(e.li,{children:"\u5e94\u7528\uff1a\u5bf9\u539f\u59cb\u65b9\u6cd5\u4e2d\u51fa\u73b0\u7684\u5f02\u5e38\u4fe1\u606f\u8fdb\u884c\u5904\u7406"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="adviceId">\n    <aop:after-throwing method="methodName" pointcut="execution(* *(..))"/>\n    \x3c!--\u4e00\u4e2aaop:aspect\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:after-throwing\u6807\u7b7e--\x3e\n</aop:aspect>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"method\uff1a\u5728\u901a\u77e5\u7c7b\u4e2d\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u7c7b\u522b\u5bf9\u5e94\u7684\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"pointcut\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u4e0epointcut-ref\u5c5e\u6027\u51b2\u7a81"}),"\n",(0,i.jsx)(e.li,{children:"pointcut-ref\uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9id\uff0c\u4e0epointcut\u5c5e\u6027\u51b2\u7a81"}),"\n",(0,i.jsx)(e.li,{children:"throwing\uff1a\u8bbe\u7f6e\u63a5\u53d7\u5f02\u5e38\u5bf9\u8c61\u7684\u53c2\u6570\uff0c\u4e0e\u901a\u77e5\u7c7b\u4e2d\u5bf9\u5e94\u65b9\u6cd5\u7684\u53c2\u6570\u4e00\u81f4"}),"\n"]}),"\n",(0,i.jsx)(e.h6,{id:"around",children:"around"}),"\n",(0,i.jsxs)(e.p,{children:["\u6807\u7b7e\uff1a",(0,i.jsx)(e.a,{href:"aop:around",children:"aop:around"}),"\uff0caop:aspect\u7684\u5b50\u6807\u7b7e"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u73af\u7ed5\u901a\u77e5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u73af\u7ed5\u901a\u77e5"}),"\uff1a\u5728\u539f\u59cb\u65b9\u6cd5\u6267\u884c\u524d\u540e\u5747\u6709\u5bf9\u5e94\u6267\u884c\u6267\u884c\uff0c\u8fd8\u53ef\u4ee5\u963b\u6b62\u539f\u59cb\u65b9\u6cd5\u7684\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\uff1a\u529f\u80fd\u5f3a\u5927\uff0c\u53ef\u4ee5\u505a\u4efb\u4f55\u4e8b\u60c5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="adviceId">\n    <aop:around method="methodName" pointcut="execution(* *(..))"/>\n    \x3c!--\u4e00\u4e2aaop:aspect\u6807\u7b7e\u4e2d\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2aaop:around\u6807\u7b7e--\x3e\n</aop:aspect>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"method \uff1a\u5728\u901a\u77e5\u7c7b\u4e2d\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u7c7b\u522b\u5bf9\u5e94\u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pointcut \uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u4e0epointcut-ref\u5c5e\u6027\u51b2\u7a81"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pointcut-ref \uff1a\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u5bf9\u5e94\u7684\u5207\u5165\u70b9id\uff0c\u4e0epointcut\u5c5e\u6027\u51b2\u7a81"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u73af\u7ed5\u901a\u77e5\u7684\u5f00\u53d1\u65b9\u5f0f\uff08\u53c2\u8003\u901a\u77e5\u987a\u5e8f\u7ae0\u8282\uff09\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u73af\u7ed5\u901a\u77e5\u662f",(0,i.jsx)(e.strong,{children:"\u5728\u539f\u59cb\u65b9\u6cd5\u7684\u524d\u540e\u6dfb\u52a0\u529f\u80fd"}),"\uff0c\u5728\u73af\u7ed5\u901a\u77e5\u4e2d\uff0c\u5b58\u5728\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u663e\u5f0f\u8c03\u7528"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object around(ProceedingJoinPoint pjp) throws Throwable {\n    Object ret = pjp.proceed();\n    return ret;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u73af\u7ed5\u901a\u77e5\u65b9\u6cd5\u76f8\u5173\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u65b9\u6cd5\u987b\u8bbe\u5b9a Object \u7c7b\u578b\u7684\u8fd4\u56de\u503c\uff0c\u5426\u5219\u4f1a",(0,i.jsx)(e.strong,{children:"\u62e6\u622a"}),"\u539f\u59cb\u65b9\u6cd5\u7684\u8fd4\u56de\u3002\u5982\u679c\u539f\u59cb\u65b9\u6cd5\u8fd4\u56de\u503c\u7c7b\u578b\u4e3a void\uff0c\u901a\u77e5\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u8bbe\u5b9a\u8fd4\u56de\u503c\u7c7b\u578b\u4e3a void\uff0c\u6700\u7ec8\u8fd4\u56de null"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u65b9\u6cd5\u9700\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f4d\u7f6e\u8bbe\u5b9a ProceedingJoinPoint \u5bf9\u8c61\uff0c\u901a\u8fc7\u8be5\u5bf9\u8c61\u8c03\u7528 proceed() \u65b9\u6cd5\uff0c\u5b9e\u73b0",(0,i.jsx)(e.strong,{children:"\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528"}),"\u3002\u5982\u7701\u7565\u8be5\u53c2\u6570\uff0c\u539f\u59cb\u65b9\u6cd5\u5c06\u65e0\u6cd5\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 proceed() \u65b9\u6cd5\u8c03\u7528\u539f\u59cb\u65b9\u6cd5\u65f6\uff0c\u56e0\u65e0\u6cd5\u9884\u77e5\u539f\u59cb\u65b9\u6cd5\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u662f\u5426\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u5f3a\u5236\u629b\u51fa Throwable \u5bf9\u8c61\uff0c\u5c01\u88c5\u539f\u59cb\u65b9\u6cd5\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u5f02\u5e38\u4fe1\u606f"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u901a\u77e5\u987a\u5e8f",children:"\u901a\u77e5\u987a\u5e8f"}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u540c\u4e00\u4e2a\u5207\u5165\u70b9\u914d\u7f6e\u4e86\u591a\u4e2a\u901a\u77e5\u65f6\uff0c\u901a\u77e5\u4f1a\u5b58\u5728\u8fd0\u884c\u7684\u5148\u540e\u987a\u5e8f\uff0c\u8be5\u987a\u5e8f\u4ee5\u901a\u77e5\u914d\u7f6e\u7684\u987a\u5e8f\u4e3a\u51c6\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AOPAdvice"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class AOPAdvice {\n    public void before(){\n        System.out.println("before...);\n    }\n    public void after(){\n        System.out.println("after...");\n    }\n    public void afterReturing(){\n        System.out.println("afterReturing...");\n    }\n    public void afterThrowing(){\n        System.out.println("afterThrowing...");\n    }\n    public Object around(ProceedingJoinPoint pjp) {\n        System.out.println("around before...");\n       \t//\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\n        Object ret = pjp.proceed();\n        System.out.println("around after..."+ret);\n   \t    return ret;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["applicationContext.xml  ",(0,i.jsx)(e.strong,{children:"\u987a\u5e8f\u6267\u884c"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:config>\n    <aop:pointcut id="pt" expression="execution(* *..*(..))"/>\n    <aop:aspect ref="myAdvice">\n\t\t<aop:before method="before" pointcut-ref="pt"/>\n        <aop:after method="after" pointcut-ref="pt"/>\n        <aop:after-returning method="afterReturing" pointcut-ref="pt"/>\n        <aop:after-throwing method="afterThrowing" pointcut-ref="pt"/>\n        <aop:around method="around" pointcut-ref="pt"/>\n    </aop:aspect>\n</aop:config>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u83b7\u53d6\u6570\u636e",children:"\u83b7\u53d6\u6570\u636e"}),"\n",(0,i.jsx)(e.h6,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u901a\u77e5\u65b9\u6cd5\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a JoinPoint\uff0c\u901a\u8fc7\u8be5\u5bf9\u8c61\u8c03\u7528 getArgs() \u65b9\u6cd5\uff0c\u83b7\u53d6\u539f\u59cb\u65b9\u6cd5\u8fd0\u884c\u7684\u53c2\u6570\u6570\u7ec4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void before(JoinPoint jp) throws Throwable {\n    Object[] args = jp.getArgs();\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6240\u6709\u7684\u901a\u77e5\u5747\u53ef\u4ee5\u83b7\u53d6\u53c2\u6570\uff0c\u73af\u7ed5\u901a\u77e5\u4f7f\u7528ProceedingJoinPoint.getArgs()\u65b9\u6cd5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u4e3a\u901a\u77e5\u65b9\u6cd5\u4f20\u9012\u53c2\u6570\uff08\u9501\u5b9a\u901a\u77e5\u53d8\u91cf\u540d\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6d41\u7a0b\u56fe\uff1a",(0,i.jsx)(e.img,{src:s(52330).A+"",width:"702",height:"270"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u89e3\u91ca\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"&amp"})," \u4ee3\u8868\u5e76\u4e14 &"]}),"\n",(0,i.jsx)(e.li,{children:"\u8f93\u51fa\u7ed3\u679c\uff1aa = param1   b = param2"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e09\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u4e3a\u901a\u77e5\u65b9\u6cd5\u4f20\u9012\u53c2\u6570\uff08\u6539\u53d8\u901a\u77e5\u53d8\u91cf\u540d\u7684\u5b9a\u4e49\u987a\u5e8f\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6d41\u7a0b\u56fe\uff1a",(0,i.jsx)(e.img,{src:s(34615).A+"",width:"764",height:"264"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u89e3\u91ca\uff1a\u8f93\u51fa\u7ed3\u679c a = param2   b = param1"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h6,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,i.jsx)(e.p,{children:"\u73af\u7ed5\u901a\u77e5\u548c\u8fd4\u56de\u540e\u901a\u77e5\u53ef\u4ee5\u83b7\u53d6\u8fd4\u56de\u503c\uff0c\u540e\u7f6e\u901a\u77e5\u4e0d\u4e00\u5b9a\uff0c\u5176\u4ed6\u7c7b\u578b\u83b7\u53d6\u4e0d\u5230"}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u9002\u7528\u4e8e\u8fd4\u56de\u540e\u901a\u77e5\uff08after-returning\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u8fd4\u56de\u503c\u53d8\u91cf\u540d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u539f\u59cb\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    @Override\n    public int save() {\n        System.out.println("user service running...");\n        return 100;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AOP \u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="myAdvice">\n    <aop:pointcut id="pt" expression="execution(* *(..))"/>\n    <aop:after-returning method="afterReturning" pointcut-ref="pt" returning="ret"/>\n</aop:aspect>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u77e5\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class AOPAdvice {\n    public void afterReturning(Object ret) {\n        System.out.println("return:" + ret);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e8c\u79cd\uff1a\u9002\u7528\u4e8e\u73af\u7ed5\u901a\u77e5\uff08around\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728\u901a\u77e5\u7c7b\u7684\u65b9\u6cd5\u4e2d\u8c03\u7528\u539f\u59cb\u65b9\u6cd5\u83b7\u53d6\u8fd4\u56de\u503c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u539f\u59cb\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    @Override\n    public int save() {\n        System.out.println("user service running...");\n        return 100;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AOP \u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="myAdvice">\n    <aop:pointcut id="pt" expression="execution(* *(..))  "/>\n    <aop:around method="around" pointcut-ref="pt" />\n</aop:aspect>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u77e5\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class AOPAdvice {    \n\tpublic Object around(ProceedingJoinPoint pjp) throws Throwable {\n        Object ret = pjp.proceed();\n        return ret;\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n        UserService userService = (UserService) ctx.getBean("userService");\n\t\tint ret = userService.save();\n       \tSystem.out.println("app....." + ret);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h6,{id:"\u5f02\u5e38",children:"\u5f02\u5e38"}),"\n",(0,i.jsx)(e.p,{children:"\u73af\u7ed5\u901a\u77e5\u548c\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u53ef\u4ee5\u83b7\u53d6\u5f02\u5e38\uff0c\u540e\u7f6e\u901a\u77e5\u4e0d\u4e00\u5b9a\uff0c\u5176\u4ed6\u7c7b\u578b\u83b7\u53d6\u4e0d\u5230"}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e00\u79cd\uff1a\u9002\u7528\u4e8e\u8fd4\u56de\u540e\u901a\u77e5\uff08after-throwing\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u5f02\u5e38\u5bf9\u8c61\u53d8\u91cf\u540d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u539f\u59cb\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    @Override\n\tpublic void save() {\n        System.out.println("user service running...");\n        int i = 1/0;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AOP \u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="myAdvice">\n\t<aop:pointcut id="pt" expression="execution(* *(..))  "/>\n    <aop:after-throwing method="afterThrowing" pointcut-ref="pt" throwing="t"/>\n</aop:aspect>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u77e5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void afterThrowing(Throwable t){\n    System.out.println(t.getMessage());\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7b2c\u4e8c\u79cd\uff1a\u9002\u7528\u4e8e\u73af\u7ed5\u901a\u77e5\uff08around\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728\u901a\u77e5\u7c7b\u7684\u65b9\u6cd5\u4e2d\u8c03\u7528\u539f\u59cb\u65b9\u6cd5\u6355\u83b7\u5f02\u5e38"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u539f\u59cb\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    @Override\n\tpublic void save() {\n        System.out.println("user service running...");\n        int i = 1/0;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AOP \u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspect ref="myAdvice">\n    <aop:pointcut id="pt" expression="execution(* *(..))  "/>\n    <aop:around method="around" pointcut-ref="pt" />\n</aop:aspect>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u77e5\u7c7b\uff1atry\u2026\u2026catch\u2026\u2026\u6355\u83b7\u5f02\u5e38\u540e\uff0cret\u4e3anull"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public Object around(ProceedingJoinPoint pjp) throws Throwable {\n    Object ret = pjp.proceed();\t//\u5bf9\u6b64\u5904\u8c03\u7528\u8fdb\u884ctry\u2026\u2026catch\u2026\u2026\u6355\u83b7\u5f02\u5e38\uff0c\u6216\u629b\u51fa\u5f02\u5e38\n    /* try {\n            ret = pjp.proceed();\n        } catch (Throwable throwable) {\n            System.out.println("around exception..." + throwable.getMessage());\n        }*/\n    return ret;\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"userService.delete();\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h6,{id:"\u83b7\u53d6\u5168\u90e8",children:"\u83b7\u53d6\u5168\u90e8"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"UserService"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface UserService {\n    public void save(int i, int m);\n\n    public int update();\n\n    public void delete();\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImpl implements UserService {\n    @Override\n    public void save(int i, int m) {\n        System.out.println("user service running..." + i + "," + m);\n    }\n\n    @Override\n    public int update() {\n        System.out.println("user service update running...");\n        return 100;\n    }\n\n    @Override\n    public void delete() {\n        System.out.println("user service delete running...");\n        int i = 1 / 0;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AOPAdvice"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class AOPAdvice {\n    public void before(JoinPoint jp){\n        //\u901a\u8fc7JoinPoint\u53c2\u6570\u83b7\u53d6\u8c03\u7528\u539f\u59cb\u65b9\u6cd5\u6240\u643a\u5e26\u7684\u53c2\u6570\n        Object[] args = jp.getArgs();\n        System.out.println("before..."+args[0]);\n    }\n\n    public void after(JoinPoint jp){\n        Object[] args = jp.getArgs();\n        System.out.println("after..."+args[0]);\n    }\n\n    public void afterReturing(Object ret){\n        System.out.println("afterReturing..."+ret);\n    }\n\n    public void afterThrowing(Throwable t){\n        System.out.println("afterThrowing..."+t.getMessage());\n    }\n\n    public Object around(ProceedingJoinPoint pjp) {\n        System.out.println("around before...");\n        Object ret = null;\n        try {\n            //\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\n            ret = pjp.proceed();\n        } catch (Throwable throwable) {\n            System.out.println("around...exception...."+throwable.getMessage());\n        }\n        System.out.println("around after..."+ret);\n        return ret;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:aop="http://www.springframework.org/schema/aop"\n       xsi:schemaLocation="\n        http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        https://www.springframework.org/schema/context/spring-context.xsd\n        http://www.springframework.org/schema/aop\n        https://www.springframework.org/schema/aop/spring-aop.xsd\n        ">\n    <bean id="userService" class="service.impl.UserServiceImpl"/>\n    <bean id="myAdvice" class="aop.AOPAdvice"/>\n\n    <aop:config>\n        <aop:pointcut id="pt" expression="execution(* *..*(..))"/>\n        <aop:aspect ref="myAdvice">\n            <aop:before method="before" pointcut="pt"/>\n            <aop:around method="around" pointcut-ref="pt"/>\n            <aop:after method="after" pointcut="pt"/>\n            <aop:after-returning method="afterReturning" pointcut-ref="pt" returning="ret"/>\n            <aop:after-throwing method="afterThrowing" pointcut-ref="pt" throwing="t"/>\n        </aop:aspect>\n    </aop:config>\n</beans>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n        UserService userService = (UserService) ctx.getBean("userService");\n//        userService.save(666, 888);\n//        int ret = userService.update();\n//        System.out.println("app....." + ret);\n        userService.delete();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6ce8\u89e3\u5f00\u53d1-2",children:"\u6ce8\u89e3\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h4,{id:"aop\u6ce8\u89e3",children:"AOP\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"AOP \u6ce8\u89e3\u7b80\u5316 XML\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(95816).A+"",width:"1153",height:"358"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\u4e8b\u9879\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5207\u5165\u70b9\u6700\u7ec8\u4f53\u73b0\u4e3a\u4e00\u4e2a\u65b9\u6cd5\uff0c\u65e0\u53c2\u65e0\u8fd4\u56de\u503c\uff0c\u65e0\u5b9e\u9645\u65b9\u6cd5\u4f53\u5185\u5bb9\uff0c\u4f46\u4e0d\u80fd\u662f\u62bd\u8c61\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u7528\u5207\u5165\u70b9\u65f6\u5fc5\u987b\u4f7f\u7528\u65b9\u6cd5\u8c03\u7528\u540d\u79f0\uff0c\u65b9\u6cd5\u540e\u9762\u7684 () \u4e0d\u80fd\u7701\u7565"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5207\u9762\u7c7b\u4e2d\u5b9a\u4e49\u7684\u5207\u5165\u70b9\u53ea\u80fd\u5728\u5f53\u524d\u7c7b\u4e2d\u4f7f\u7528\uff0c\u5982\u679c\u60f3\u5f15\u7528\u5176\u4ed6\u7c7b\u4e2d\u5b9a\u4e49\u7684\u5207\u5165\u70b9\u4f7f\u7528\u201c\u7c7b\u540d.\u65b9\u6cd5\u540d()\u201d\u5f15\u7528"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u5728\u901a\u77e5\u7c7b\u578b\u6ce8\u89e3\u540e\u6dfb\u52a0\u53c2\u6570\uff0c\u5b9e\u73b0 XML \u914d\u7f6e\u4e2d\u7684\u5c5e\u6027\uff0c\u4f8b\u5982 after-returning \u540e\u7684 returning \u6027"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u542f\u52a8\u6ce8\u89e3",children:"\u542f\u52a8\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h5,{id:"xml-1",children:"XML"}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u542f AOP \u6ce8\u89e3\u652f\u6301\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<aop:aspectj-autoproxy/>\n<context:component-scan base-package="aop,config,service"/>\x3c!--\u542f\u52a8Spring\u626b\u63cf--\x3e\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u53d1\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5bfc\u5165\u5750\u6807\uff08\u4f34\u968f spring-context \u5750\u6807\u5bfc\u5165\u5df2\u7ecf\u4f9d\u8d56\u5bfc\u5165\u5b8c\u6210\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5f00\u542f AOP \u6ce8\u89e3\u652f\u6301"}),"\n",(0,i.jsx)(e.li,{children:"\u914d\u7f6e\u5207\u9762 @Aspect"}),"\n",(0,i.jsx)(e.li,{children:"\u5b9a\u4e49\u4e13\u7528\u7684\u5207\u5165\u70b9\u65b9\u6cd5\uff0c\u5e76\u914d\u7f6e\u5207\u5165\u70b9 @Pointcut"}),"\n",(0,i.jsx)(e.li,{children:"\u4e3a\u901a\u77e5\u65b9\u6cd5\u914d\u7f6e\u901a\u77e5\u7c7b\u578b\u53ca\u5bf9\u5e94\u5207\u5165\u70b9 @Before"}),"\n"]}),"\n",(0,i.jsx)(e.h5,{id:"\u7eaf\u6ce8\u89e3-1",children:"\u7eaf\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@EnableAspectJAutoProxy"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1aSpring \u6ce8\u89e3\u914d\u7f6e\u7c7b\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5f53\u524d\u7c7b\u5f00\u542f AOP \u6ce8\u89e3\u9a71\u52a8\u7684\u652f\u6301\uff0c\u52a0\u8f7d AOP \u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan("com.seazean")\n@EnableAspectJAutoProxy\npublic class SpringConfig {\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u6ce8\u89e3-1",children:"\u57fa\u672c\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h5,{id:"aspect-1",children:"Aspect"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@Aspect"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u7c7b\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5f53\u524d\u7c7b\u4e3a\u5207\u9762\u7c7b"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Aspect\npublic class AopAdvice {\n}\n"})}),"\n",(0,i.jsx)(e.h5,{id:"pointcut-2",children:"Pointcut"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@Pointcut"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4f7f\u7528\u5f53\u524d\u65b9\u6cd5\u540d\u4f5c\u4e3a\u5207\u5165\u70b9\u5f15\u7528\u540d\u79f0"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Pointcut("execution(* *(..))")\npublic void pt() {\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a\u88ab\u4fee\u9970\u7684\u65b9\u6cd5\u5ffd\u7565\u5176\u4e1a\u52a1\u529f\u80fd\uff0c\u683c\u5f0f\u8bbe\u5b9a\u4e3a\u65e0\u53c2\u65e0\u8fd4\u56de\u503c\u7684\u65b9\u6cd5\uff0c\u65b9\u6cd5\u4f53\u5185\u7a7a\u5b9e\u73b0\uff08\u975e\u62bd\u8c61\uff09"}),"\n",(0,i.jsx)(e.h5,{id:"before-1",children:"Before"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@Before"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6807\u6ce8\u5f53\u524d\u65b9\u6cd5\u4f5c\u4e3a\u524d\u7f6e\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Before("pt()")\npublic void before(JoinPoint joinPoint){\n    //joinPoint.getArgs();\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a",(0,i.jsx)(e.strong,{children:"\u591a\u4e2a\u53c2\u6570\u65f6\uff0cJoinPoint\u53c2\u6570\u4e00\u5b9a\u8981\u5728\u7b2c\u4e00\u4f4d"})]}),"\n",(0,i.jsx)(e.h5,{id:"after-1",children:"After"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@After"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6807\u6ce8\u5f53\u524d\u65b9\u6cd5\u4f5c\u4e3a\u540e\u7f6e\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@After("pt()")\npublic void after(){\n}\n'})}),"\n",(0,i.jsx)(e.h5,{id:"afterr",children:"AfterR"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@AfterReturning"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6807\u6ce8\u5f53\u524d\u65b9\u6cd5\u4f5c\u4e3a\u8fd4\u56de\u540e\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@AfterReturning(value="pt()", returning = "result")\npublic void afterReturning(Object result) {\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u7279\u6b8a\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["returning \uff1a\u8bbe\u5b9a\u4f7f\u7528\u901a\u77e5\u65b9\u6cd5\u53c2\u6570",(0,i.jsx)(e.strong,{children:"\u63a5\u6536"}),"\u8fd4\u56de\u503c\u7684\u53d8\u91cf\u540d"]}),"\n"]}),"\n",(0,i.jsx)(e.h5,{id:"aftert",children:"AfterT"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@AfterThrowing"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6807\u6ce8\u5f53\u524d\u65b9\u6cd5\u4f5c\u4e3a\u5f02\u5e38\u540e\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@AfterThrowing(value="pt()", throwing = "t")\npublic void afterThrowing(Throwable t){\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u7279\u6b8a\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"throwing \uff1a\u8bbe\u5b9a\u4f7f\u7528\u901a\u77e5\u65b9\u6cd5\u53c2\u6570\u63a5\u6536\u539f\u59cb\u65b9\u6cd5\u4e2d\u629b\u51fa\u7684\u5f02\u5e38\u5bf9\u8c61\u540d"}),"\n"]}),"\n",(0,i.jsx)(e.h5,{id:"around-1",children:"Around"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@Around"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6807\u6ce8\u5f53\u524d\u65b9\u6cd5\u4f5c\u4e3a\u73af\u7ed5\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Around("pt()")\npublic Object around(ProceedingJoinPoint pjp) throws Throwable {\n    Object ret = pjp.proceed();\n    return ret;\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6267\u884c\u987a\u5e8f",children:"\u6267\u884c\u987a\u5e8f"}),"\n",(0,i.jsxs)(e.p,{children:["AOP \u4f7f\u7528 XML \u914d\u7f6e\u60c5\u51b5\u4e0b\uff0c\u901a\u77e5\u7684\u6267\u884c\u987a\u5e8f\u7531\u914d\u7f6e\u987a\u5e8f\u51b3\u5b9a\uff0c\u5728\u6ce8\u89e3\u60c5\u51b5\u4e0b\u7531\u4e8e\u4e0d\u5b58\u5728\u914d\u7f6e\u987a\u5e8f\u7684\u6982\u5ff5\uff0c\u53c2\u7167\u901a\u77e5\u6240\u914d\u7f6e\u7684",(0,i.jsx)(e.strong,{children:"\u65b9\u6cd5\u540d\u5b57\u7b26\u4e32\u5bf9\u5e94\u7684\u7f16\u7801\u503c\u987a\u5e8f"}),"\uff0c\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u5b57\u6bcd\u6392\u5e8f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540c\u4e00\u4e2a\u901a\u77e5\u7c7b\u4e2d\uff0c\u76f8\u540c\u901a\u77e5\u7c7b\u578b\u4ee5\u65b9\u6cd5\u540d\u6392\u5e8f\u4e3a\u51c6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Before("aop.AOPPointcut.pt()")\npublic void aop001Log(){}\n\n@Before("aop.AOPPointcut.pt()")\npublic void aop002Exception(){}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e0d\u540c\u901a\u77e5\u7c7b\u4e2d\uff0c\u4ee5\u7c7b\u540d\u6392\u5e8f\u4e3a\u51c6"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 @Order \u6ce8\u89e3\u901a\u8fc7\u53d8\u66f4 bean \u7684\u52a0\u8f7d\u987a\u5e8f\u6539\u53d8\u901a\u77e5\u7684\u52a0\u8f7d\u987a\u5e8f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Component\n@Aspect\n@Order(1)  //\u5148\u6267\u884c\npublic class AOPAdvice2 {\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Component\n@Aspect\n@Order(2) \npublic class AOPAdvice1 {//\u9ed8\u8ba4\u6267\u884c\u6b64\u901a\u77e5\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"aop-\u539f\u7406",children:"AOP \u539f\u7406"}),"\n",(0,i.jsx)(e.h4,{id:"\u9759\u6001\u4ee3\u7406",children:"\u9759\u6001\u4ee3\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u88c5\u9970\u8005\u6a21\u5f0f\uff08Decorator Pattern\uff09\uff1a\u5728\u4e0d\u60ca\u52a8\u539f\u59cb\u8bbe\u8ba1\u7684\u57fa\u7840\u4e0a\uff0c\u4e3a\u5176\u6dfb\u52a0\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceDecorator implements UserService{\n    private UserService userService;\n    \n    public UserServiceDecorator(UserService userService) {\n        this.userService = userService;\n    }\n    \n    public void save() {\n        //\u539f\u59cb\u8c03\u7528\n        userService.save();\n        //\u589e\u5f3a\u529f\u80fd\uff08\u540e\u7f6e\uff09\n        System.out.println("\u540e\u7f6e\u589e\u5f3a\u529f\u80fd");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"proxy",children:"Proxy"}),"\n",(0,i.jsxs)(e.p,{children:["JDKProxy \u52a8\u6001\u4ee3\u7406\u662f\u9488\u5bf9\u5bf9\u8c61\u505a\u4ee3\u7406\uff0c\u8981\u6c42\u539f\u59cb\u5bf9\u8c61\u5177\u6709\u63a5\u53e3\u5b9e\u73b0\uff0c\u5e76\u5bf9\u63a5\u53e3\u65b9\u6cd5\u8fdb\u884c\u589e\u5f3a\uff0c\u56e0\u4e3a",(0,i.jsx)(e.strong,{children:"\u4ee3\u7406\u7c7b\u7ee7\u627fProxy"})]}),"\n",(0,i.jsx)(e.p,{children:"\u9759\u6001\u4ee3\u7406\u548c\u52a8\u6001\u4ee3\u7406\u7684\u533a\u522b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9759\u6001\u4ee3\u7406\u662f\u5728\u7f16\u8bd1\u65f6\u5c31\u5df2\u7ecf\u5c06\u63a5\u53e3\u3001\u4ee3\u7406\u7c7b\u3001\u88ab\u4ee3\u7406\u7c7b\u7684\u5b57\u8282\u7801\u6587\u4ef6\u786e\u5b9a\u4e0b\u6765"}),"\n",(0,i.jsx)(e.li,{children:"\u52a8\u6001\u4ee3\u7406\u662f\u7a0b\u5e8f\u5728\u8fd0\u884c\u540e\u901a\u8fc7\u53cd\u5c04\u521b\u5efa\u5b57\u8282\u7801\u6587\u4ef6\u4ea4\u7531 JVM \u52a0\u8f7d"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceJDKProxy {\n    public static UserService createUserServiceJDKProxy(UserService userService) {\n        UserService service = (UserService) Proxy.newProxyInstance(\n            userService.getClass().getClassLoader(),//\u83b7\u53d6\u88ab\u4ee3\u7406\u5bf9\u8c61\u7684\u7c7b\u52a0\u8f7d\u5668\n            userService.getClass().getInterfaces(),\t//\u83b7\u53d6\u88ab\u4ee3\u7406\u5bf9\u8c61\u5b9e\u73b0\u7684\u63a5\u53e3\n            new InvocationHandler() {\t\t\t\t//\u5bf9\u539f\u59cb\u65b9\u6cd5\u6267\u884c\u8fdb\u884c\u62e6\u622a\u5e76\u589e\u5f3a\n\t\t\t\t@Override\n\t\t\t\tpublic Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n                    if (method.getName().equals("save")) {\n                        System.out.println("\u524d\u7f6e\u589e\u5f3a");\n                        Object ret = method.invoke(userService, args);\n                        System.out.println("\u540e\u7f6e\u589e\u5f3a");\n                        return ret;\n                    }\n                    return null;\n\t\t\t\t}\n \t\t\t});\n        return service;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"cglib",children:"CGLIB"}),"\n",(0,i.jsx)(e.p,{children:"CGLIB\uff08Code Generation Library\uff09\uff1aCode \u751f\u6210\u7c7b\u5e93"}),"\n",(0,i.jsx)(e.p,{children:"CGLIB \u7279\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["CGLIB \u52a8\u6001\u4ee3\u7406",(0,i.jsx)(e.strong,{children:"\u4e0d\u9650\u5b9a"}),"\u662f\u5426\u5177\u6709\u63a5\u53e3\uff0c\u53ef\u4ee5\u5bf9\u4efb\u610f\u64cd\u4f5c\u8fdb\u884c\u589e\u5f3a"]}),"\n",(0,i.jsx)(e.li,{children:"CGLIB \u52a8\u6001\u4ee3\u7406\u65e0\u9700\u8981\u539f\u59cb\u88ab\u4ee3\u7406\u5bf9\u8c61\uff0c\u52a8\u6001\u521b\u5efa\u51fa\u65b0\u7684\u4ee3\u7406\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.li,{children:["CGLIB ",(0,i.jsx)(e.strong,{children:"\u7ee7\u627f\u88ab\u4ee3\u7406\u7c7b"}),"\uff0c\u5982\u679c\u4ee3\u7406\u7c7b\u662f final \u5219\u4e0d\u80fd\u5b9e\u73b0"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(35716).A+"",width:"490",height:"341"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"CGLIB \u7c7b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"JDKProxy \u4ec5\u5bf9\u63a5\u53e3\u65b9\u6cd5\u505a\u589e\u5f3a\uff0cCGLIB \u5bf9\u6240\u6709\u65b9\u6cd5\u505a\u589e\u5f3a\uff0c\u5305\u62ec Object \u7c7b\u4e2d\u7684\u65b9\u6cd5\uff08toString\u3001hashCode\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u8fd4\u56de\u503c\u7c7b\u578b\u91c7\u7528\u591a\u6001\u5411\u4e0b\u8f6c\u578b\uff0c\u6240\u4ee5\u9700\u8981\u8bbe\u7f6e\u7236\u7c7b\u7c7b\u578b"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u9700\u8981\u5bf9\u65b9\u6cd5\u8fdb\u884c\u5224\u65ad\u662f\u5426\u662f save\uff0c\u6765\u9009\u62e9\u6027\u589e\u5f3a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class UserServiceImplCglibProxy {\n    public static UserService createUserServiceCglibProxy(Class cls){\n        //1.\u521b\u5efaEnhancer\u5bf9\u8c61\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a\u5185\u5b58\u4e2d\u52a8\u6001\u521b\u5efa\u4e86\u4e00\u4e2a\u7c7b\u7684\u5b57\u8282\u7801\uff09\n        Enhancer enhancer = new Enhancer();\n        \n        //2.\u8bbe\u7f6eEnhancer\u5bf9\u8c61\u7684\u7236\u7c7b\u662f\u6307\u5b9a\u7c7b\u578bUserServerImpl\n        enhancer.setSuperclass(cls);\n        \n        //3.\u8bbe\u7f6e\u56de\u8c03\u65b9\u6cd5\n        enhancer.setCallback(new MethodInterceptor() {\n            @Override\n            public Object intercept(Object o, Method m, Object[] args, MethodProxy mp) throws Throwable {\n                //o\u662f\u88ab\u4ee3\u7406\u51fa\u7684\u7c7b\u521b\u5efa\u7684\u5bf9\u8c61\uff0c\u6240\u4ee5\u4f7f\u7528MethodProxy\u8c03\u7528\uff0c\u5e76\u4e14\u662f\u8c03\u7528\u7236\u7c7b\n                //\u901a\u8fc7\u8c03\u7528\u7236\u7c7b\u7684\u65b9\u6cd5\u5b9e\u73b0\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\n                Object ret = methodProxy.invokeSuper(o, args);\n                //\u540e\u7f6e\u589e\u5f3a\u5185\u5bb9,\u9700\u8981\u5224\u65ad\u662f\u90fd\u662fsave\u65b9\u6cd5\n                if (method.getName().equals("save")) {\n                    System.out.println("I love Java");\n                }\n                return ret;\n            }\n        });\n        //\u4f7f\u7528Enhancer\u5bf9\u8c61\u521b\u5efa\u5bf9\u5e94\u7684\u5bf9\u8c61\n        return (UserService)enhancer.create();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Test\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class App {\n    public static void main(String[] args) {\n        UserService userService = UserServiceCglibProxy.createUserServiceCglibProxy(UserServiceImpl.class);\n        userService.save();\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u4ee3\u7406\u9009\u62e9",children:"\u4ee3\u7406\u9009\u62e9"}),"\n",(0,i.jsx)(e.p,{children:"Spirng \u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u7684\u5f62\u5f0f\u63a7\u5236\u4f7f\u7528\u7684\u4ee3\u7406\u5f62\u5f0f\uff0cSpring \u4f1a\u5148\u5224\u65ad\u662f\u5426\u5b9e\u73b0\u4e86\u63a5\u53e3\uff0c\u5982\u679c\u5b9e\u73b0\u4e86\u63a5\u53e3\u5c31\u4f7f\u7528 JDK \u52a8\u6001\u4ee3\u7406\uff0c\u5982\u679c\u6ca1\u6709\u5b9e\u73b0\u63a5\u53e3\u5219\u4f7f\u7528 CGLIB \u52a8\u6001\u4ee3\u7406\uff0c\u901a\u8fc7\u914d\u7f6e\u53ef\u4ee5\u4fee\u6539\u4e3a\u4f7f\u7528 CGLIB"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"XML \u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--XML\u914d\u7f6eAOP--\x3e\n<aop:config proxy-target-class="false"></aop:config>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"XML \u6ce8\u89e3\u652f\u6301"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u6ce8\u89e3\u914d\u7f6eAOP--\x3e\n<aop:aspectj-autoproxy proxy-target-class="false"/>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\u9a71\u52a8"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u4fee\u6539\u4e3a\u4f7f\u7528 cglib \u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\n@EnableAspectJAutoProxy(proxyTargetClass = true)\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JDK \u52a8\u6001\u4ee3\u7406\u548c CGLIB \u52a8\u6001\u4ee3\u7406\u7684\u533a\u522b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"JDK \u52a8\u6001\u4ee3\u7406\u53ea\u80fd\u5bf9\u5b9e\u73b0\u4e86\u63a5\u53e3\u7684\u7c7b\u751f\u6210\u4ee3\u7406\uff0c\u6ca1\u6709\u5b9e\u73b0\u63a5\u53e3\u7684\u7c7b\u4e0d\u80fd\u4f7f\u7528\u3002"}),"\n",(0,i.jsx)(e.li,{children:"CGLIB \u52a8\u6001\u4ee3\u7406\u5373\u4f7f\u88ab\u4ee3\u7406\u7684\u7c7b\u6ca1\u6709\u5b9e\u73b0\u63a5\u53e3\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff0c\u56e0\u4e3a CGLIB \u52a8\u6001\u4ee3\u7406\u662f\u4f7f\u7528\u7ee7\u627f\u88ab\u4ee3\u7406\u7c7b\u7684\u65b9\u5f0f\u8fdb\u884c\u6269\u5c55"}),"\n",(0,i.jsx)(e.li,{children:"CGLIB \u52a8\u6001\u4ee3\u7406\u662f\u901a\u8fc7\u7ee7\u627f\u7684\u65b9\u5f0f\uff0c\u8986\u76d6\u88ab\u4ee3\u7406\u7c7b\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u4ee3\u7406\uff0c\u6240\u4ee5\u5982\u679c\u65b9\u6cd5\u662f\u88ab final \u4fee\u9970\u7684\u8bdd\uff0c\u5c31\u4e0d\u80fd\u8fdb\u884c\u4ee3\u7406"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u7ec7\u5165\u65f6\u673a",children:"\u7ec7\u5165\u65f6\u673a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"AOP\u7ec7\u5165\u65f6\u673a",src:s(8534).A+"",width:"767",height:"371"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u4e8b\u52a1",children:"\u4e8b\u52a1"}),"\n",(0,i.jsx)(e.h3,{id:"\u4e8b\u52a1\u673a\u5236",children:"\u4e8b\u52a1\u673a\u5236"}),"\n",(0,i.jsx)(e.h4,{id:"\u4e8b\u52a1\u4ecb\u7ecd",children:"\u4e8b\u52a1\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"\u4e8b\u52a1\uff1a\u6570\u636e\u5e93\u4e2d\u591a\u4e2a\u64cd\u4f5c\u5408\u5e76\u5728\u4e00\u8d77\u5f62\u6210\u7684\u64cd\u4f5c\u5e8f\u5217\uff0c\u4e8b\u52a1\u7279\u5f81\uff08ACID\uff09"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5f53\u6570\u636e\u5e93\u64cd\u4f5c\u5e8f\u5217\u4e2d\u4e2a\u522b\u64cd\u4f5c\u5931\u8d25\u65f6\uff0c\u63d0\u4f9b\u4e00\u79cd\u65b9\u5f0f\u4f7f\u6570\u636e\u5e93\u72b6\u6001\u6062\u590d\u5230\u6b63\u5e38\u72b6\u6001\uff08",(0,i.jsx)(e.strong,{children:"A"}),"\uff09\uff0c\u4fdd\u969c\u6570\u636e\u5e93\u5373\u4f7f\u5728\u5f02\u5e38\u72b6\u6001\u4e0b\u4ecd\u80fd\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\uff08",(0,i.jsx)(e.strong,{children:"C"}),"\uff09\uff08\u8981\u4e48\u64cd\u4f5c\u524d\u72b6\u6001\uff0c\u8981\u4e48\u64cd\u4f5c\u540e\u72b6\u6001\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5f53\u51fa\u73b0\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u5728\u591a\u4e2a\u8bbf\u95ee\u95f4\u8fdb\u884c\u76f8\u4e92\u9694\u79bb\uff0c\u9632\u6b62\u5e76\u53d1\u8bbf\u95ee\u64cd\u4f5c\u7ed3\u679c\u4e92\u76f8\u5e72\u6270\uff08",(0,i.jsx)(e.strong,{children:"I"}),"\uff09"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Spring \u4e8b\u52a1\u4e00\u822c\u52a0\u5230\u4e1a\u52a1\u5c42\uff0c\u5bf9\u5e94\u7740\u4e1a\u52a1\u7684\u64cd\u4f5c\uff0cSpring \u4e8b\u52a1\u7684\u672c\u8d28\u5176\u5b9e\u5c31\u662f\u6570\u636e\u5e93\u5bf9\u4e8b\u52a1\u7684\u652f\u6301\uff0c\u6ca1\u6709\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u652f\u6301\uff0cSpring \u662f\u65e0\u6cd5\u63d0\u4f9b\u4e8b\u52a1\u529f\u80fd\u7684\uff0cSpring \u53ea\u63d0\u4f9b\u7edf\u4e00\u4e8b\u52a1\u7ba1\u7406\u63a5\u53e3"}),"\n",(0,i.jsxs)(e.p,{children:["Spring \u5728\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0c\u6839\u636e\u5f53\u524d\u73af\u5883\u4e2d\u8bbe\u7f6e\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u8c03\u6574\u6570\u636e\u5e93\u9694\u79bb\u7ea7\u522b\uff0c\u7531\u6b64\u4fdd\u6301\u4e00\u81f4\u3002\u7a0b\u5e8f\u662f\u5426\u652f\u6301\u4e8b\u52a1\u9996\u5148\u53d6\u51b3\u4e8e\u6570\u636e\u5e93 \uff0c\u6bd4\u5982 MySQL \uff0c\u5982\u679c\u662f ",(0,i.jsx)(e.strong,{children:"Innodb \u5f15\u64ce"}),"\uff0c\u662f\u652f\u6301\u4e8b\u52a1\u7684\uff1b\u5982\u679c MySQL \u4f7f\u7528 MyISAM \u5f15\u64ce\uff0c\u90a3\u4ece\u6839\u4e0a\u5c31\u662f\u4e0d\u652f\u6301\u4e8b\u52a1\u7684"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u4fdd\u8bc1\u539f\u5b50\u6027"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8981\u4fdd\u8bc1\u4e8b\u52a1\u7684\u539f\u5b50\u6027\uff0c\u5c31\u9700\u8981\u5728\u5f02\u5e38\u53d1\u751f\u65f6\uff0c\u5bf9\u5df2\u7ecf\u6267\u884c\u7684\u64cd\u4f5c\u8fdb\u884c",(0,i.jsx)(e.strong,{children:"\u56de\u6eda"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u5728 MySQL \u4e2d\uff0c\u6062\u590d\u673a\u5236\u662f\u901a\u8fc7",(0,i.jsx)(e.strong,{children:"\u56de\u6eda\u65e5\u5fd7\uff08undo log\uff09"})," \u5b9e\u73b0\uff0c\u6240\u6709\u4e8b\u52a1\u8fdb\u884c\u7684\u4fee\u6539\u90fd\u4f1a\u5148\u5148\u8bb0\u5f55\u5230\u8fd9\u4e2a\u56de\u6eda\u65e5\u5fd7\u4e2d\uff0c\u7136\u540e\u518d\u6267\u884c\u76f8\u5173\u7684\u64cd\u4f5c\u3002\u5982\u679c\u6267\u884c\u8fc7\u7a0b\u4e2d\u9047\u5230\u5f02\u5e38\u7684\u8bdd\uff0c\u76f4\u63a5\u5229\u7528\u56de\u6eda\u65e5\u5fd7\u4e2d\u7684\u4fe1\u606f\u5c06\u6570\u636e\u56de\u6eda\u5230\u4fee\u6539\u4e4b\u524d\u7684\u6837\u5b50\u5373\u53ef"]}),"\n",(0,i.jsx)(e.li,{children:"\u56de\u6eda\u65e5\u5fd7\u4f1a\u5148\u4e8e\u6570\u636e\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e0a\uff0c\u8fd9\u6837\u4fdd\u8bc1\u4e86\u5373\u4f7f\u9047\u5230\u6570\u636e\u5e93\u7a81\u7136\u5b95\u673a\u7b49\u60c5\u51b5\uff0c\u5f53\u7528\u6237\u518d\u6b21\u542f\u52a8\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u8fd8\u80fd\u591f\u901a\u8fc7\u67e5\u8be2\u56de\u6eda\u65e5\u5fd7\u6765\u56de\u6eda\u5c06\u4e4b\u524d\u672a\u5b8c\u6210\u7684\u4e8b\u52a1"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u9694\u79bb\u7ea7\u522b",children:"\u9694\u79bb\u7ea7\u522b"}),"\n",(0,i.jsx)(e.p,{children:"TransactionDefinition \u63a5\u53e3\u4e2d\u5b9a\u4e49\u4e86\u4e94\u4e2a\u8868\u793a\u9694\u79bb\u7ea7\u522b\u7684\u5e38\u91cf\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"TransactionDefinition.ISOLATION_DEFAULT\uff1a\u4f7f\u7528\u540e\u7aef\u6570\u636e\u5e93\u9ed8\u8ba4\u7684\u9694\u79bb\u7ea7\u522b\uff0cMySQL \u9ed8\u8ba4\u91c7\u7528\u7684 REPEATABLE_READ \u9694\u79bb\u7ea7\u522b\uff0cOracle \u9ed8\u8ba4\u91c7\u7528\u7684 READ_COMMITTED\u9694\u79bb\u7ea7\u522b."}),"\n",(0,i.jsx)(e.li,{children:"TransactionDefinition.ISOLATION_READ_UNCOMMITTED\uff1a\u6700\u4f4e\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5141\u8bb8\u8bfb\u53d6\u5c1a\u672a\u63d0\u4ea4\u7684\u6570\u636e\u53d8\u66f4\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u810f\u8bfb\u3001\u5e7b\u8bfb\u6216\u4e0d\u53ef\u91cd\u590d\u8bfb"}),"\n",(0,i.jsx)(e.li,{children:"TransactionDefinition.ISOLATION_READ_COMMITTED\uff1a\u5141\u8bb8\u8bfb\u53d6\u5e76\u53d1\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u963b\u6b62\u810f\u8bfb\uff0c\u4f46\u662f\u5e7b\u8bfb\u6216\u4e0d\u53ef\u91cd\u590d\u8bfb\u4ecd\u6709\u53ef\u80fd\u53d1\u751f"}),"\n",(0,i.jsx)(e.li,{children:"TransactionDefinition.ISOLATION_REPEATABLE_READ\uff1a\u5bf9\u540c\u4e00\u5b57\u6bb5\u7684\u591a\u6b21\u8bfb\u53d6\u7ed3\u679c\u90fd\u662f\u4e00\u81f4\u7684\uff0c\u9664\u975e\u6570\u636e\u662f\u88ab\u672c\u8eab\u4e8b\u52a1\u81ea\u5df1\u6240\u4fee\u6539\uff0c\u53ef\u4ee5\u963b\u6b62\u810f\u8bfb\u548c\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0c\u4f46\u5e7b\u8bfb\u4ecd\u6709\u53ef\u80fd\u53d1\u751f\u3002"}),"\n",(0,i.jsx)(e.li,{children:"TransactionDefinition.ISOLATION_SERIALIZABLE\uff1a\u6700\u9ad8\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5b8c\u5168\u670d\u4ece ACID \u7684\u9694\u79bb\u7ea7\u522b\u3002\u6240\u6709\u7684\u4e8b\u52a1\u4f9d\u6b21\u9010\u4e2a\u6267\u884c\uff0c\u8fd9\u6837\u4e8b\u52a1\u4e4b\u95f4\u5c31\u5b8c\u5168\u4e0d\u53ef\u80fd\u4ea7\u751f\u5e72\u6270\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u7ea7\u522b\u53ef\u4ee5\u9632\u6b62\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u4ee5\u53ca\u5e7b\u8bfb\u3002\u4f46\u662f\u8fd9\u5c06\u4e25\u91cd\u5f71\u54cd\u7a0b\u5e8f\u7684\u6027\u80fd\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\u4e5f\u4e0d\u4f1a\u7528\u5230\u8be5\u7ea7\u522b"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["MySQL InnoDB \u5b58\u50a8\u5f15\u64ce\u7684\u9ed8\u8ba4\u652f\u6301\u7684\u9694\u79bb\u7ea7\u522b\u662f ",(0,i.jsx)(e.strong,{children:"REPEATABLE-READ\uff08\u53ef\u91cd\u8bfb\uff09"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5206\u5e03\u5f0f\u4e8b\u52a1"}),"\uff1a\u5141\u8bb8\u591a\u4e2a\u72ec\u7acb\u7684\u4e8b\u52a1\u8d44\u6e90\uff08transactional resources\uff09\u53c2\u4e0e\u5230\u4e00\u4e2a\u5168\u5c40\u7684\u4e8b\u52a1\u4e2d\u3002\u4e8b\u52a1\u8d44\u6e90\u901a\u5e38\u662f\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7cfb\u7edf\uff0c\u4f46\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7c7b\u578b\u7684\u8d44\u6e90\uff0c\u5168\u5c40\u4e8b\u52a1\u8981\u6c42\u5728\u5176\u4e2d\u7684\u6240\u6709\u53c2\u4e0e\u7684\u4e8b\u52a1\u8981\u4e48\u90fd\u63d0\u4ea4\uff0c\u8981\u4e48\u90fd\u56de\u6eda\uff0c\u8fd9\u5bf9\u4e8e\u4e8b\u52a1\u539f\u6709\u7684 ACID \u8981\u6c42\u53c8\u6709\u4e86\u63d0\u9ad8"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1\u65f6\uff0cInnoDB \u5b58\u50a8\u5f15\u64ce\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u5fc5\u987b\u8bbe\u7f6e\u4e3a SERIALIZABLE"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u4f20\u64ad\u884c\u4e3a",children:"\u4f20\u64ad\u884c\u4e3a"}),"\n",(0,i.jsx)(e.p,{children:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u662f\u4e3a\u4e86\u89e3\u51b3\u4e1a\u52a1\u5c42\u65b9\u6cd5\u4e4b\u95f4\u4e92\u76f8\u8c03\u7528\u7684\u4e8b\u52a1\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u65b9\u6cd5\u5d4c\u5957\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f53\u4e8b\u52a1\u65b9\u6cd5\u88ab\u53e6\u4e00\u4e2a\u4e8b\u52a1\u65b9\u6cd5\u8c03\u7528\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u4e8b\u52a1\u5e94\u8be5\u5982\u4f55\u4f20\u64ad\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f8b\u5982\uff1a\u65b9\u6cd5\u53ef\u80fd\u7ee7\u7eed\u5728\u73b0\u6709\u4e8b\u52a1\u4e2d\u8fd0\u884c\uff0c\u4e5f\u53ef\u80fd\u5f00\u542f\u4e00\u4e2a\u65b0\u4e8b\u52a1\uff0c\u5e76\u5728\u81ea\u5df1\u7684\u4e8b\u52a1\u4e2d\u8fd0\u884c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u5916\u5c42\u4e8b\u52a1 Service A \u7684 aMethod \u8c03\u7528\u5185\u5c42 Service B \u7684 bMethod\nclass A {\n    @Transactional(propagation=propagation.xxx)\n    public void aMethod {\n        B b = new B();\n        b.bMethod();\n    }\n}\nclass B {\n    @Transactional(propagation=propagation.xxx)\n    public void bMethod {}\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u652f\u6301\u5f53\u524d\u4e8b\u52a1"}),"\u7684\u60c5\u51b5\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_REQUIRED\uff1a \u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\u5219",(0,i.jsx)(e.strong,{children:"\u52a0\u5165\u8be5\u4e8b\u52a1"}),"\uff1b\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5185\u5916\u5c42\u662f\u76f8\u540c\u7684\u4e8b\u52a1\uff0c\u5728 aMethod \u6216\u8005\u5728 bMethod \u5185\u7684\u4efb\u4f55\u5730\u65b9\u51fa\u73b0\u5f02\u5e38\uff0c\u4e8b\u52a1\u90fd\u4f1a\u88ab\u56de\u6eda"}),"\n",(0,i.jsxs)(e.li,{children:["\u5de5\u4f5c\u6d41\u7a0b\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7ebf\u7a0b\u6267\u884c\u5230 serviceA.aMethod() \u65f6\uff0c\u5176\u5b9e\u662f\u6267\u884c\u7684\u4ee3\u7406 serviceA \u5bf9\u8c61\u7684 aMethod"}),"\n",(0,i.jsx)(e.li,{children:"\u9996\u5148\u6267\u884c\u4e8b\u52a1\u589e\u5f3a\u5668\u903b\u8f91\uff08\u73af\u7ed5\u589e\u5f3a\uff09\uff0c\u63d0\u53d6\u4e8b\u52a1\u6807\u7b7e\u5c5e\u6027\uff0c\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u662f\u5426\u7ed1\u5b9a connection \u6570\u636e\u5e93\u8fde\u63a5\u8d44\u6e90\uff0c\u6ca1\u6709\u5c31\u8c03\u7528 datasource.getConnection()\uff0c\u8bbe\u7f6e\u4e8b\u52a1\u63d0\u4ea4\u4e3a\u624b\u52a8\u63d0\u4ea4 autocommit(false)"}),"\n",(0,i.jsx)(e.li,{children:"\u6267\u884c\u5176\u4ed6\u589e\u5f3a\u5668\u7684\u903b\u8f91\uff0c\u7136\u540e\u8c03\u7528 target \u7684\u76ee\u6807\u65b9\u6cd5 aMethod() \u65b9\u6cd5\uff0c\u8fdb\u5165 serviceB \u7684\u903b\u8f91"}),"\n",(0,i.jsx)(e.li,{children:"serviceB \u4e5f\u662f\u5148\u6267\u884c\u4e8b\u52a1\u589e\u5f3a\u5668\u7684\u903b\u8f91\uff0c\u63d0\u53d6\u4e8b\u52a1\u6807\u7b7e\u5c5e\u6027\uff0c\u4f46\u6b64\u65f6\u4f1a\u68c0\u67e5\u5230\u7ebf\u7a0b\u7ed1\u5b9a\u4e86 connection\uff0c\u68c0\u67e5\u6ce8\u89e3\u7684\u4f20\u64ad\u5c5e\u6027\uff0c\u6240\u4ee5\u8c03\u7528 DataSourceUtils.getConnection(datasource) \u5171\u4eab\u8be5\u8fde\u63a5\u8d44\u6e90\uff0c\u6267\u884c\u5b8c\u76f8\u5173\u7684\u589e\u5f3a\u548c SQL \u540e\uff0c\u53d1\u73b0\u4e8b\u52a1\u5e76\u4e0d\u662f\u5f53\u524d\u65b9\u6cd5\u5f00\u542f\u7684\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\u4e0a\u5c42"}),"\n",(0,i.jsx)(e.li,{children:"serviceA.aMethod() \u7ee7\u7eed\u6267\u884c\uff0c\u6267\u884c\u5b8c\u589e\u5f3a\u540e\u8fdb\u884c\u63d0\u4ea4\u4e8b\u52a1\u6216\u56de\u6eda\u4e8b\u52a1"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_SUPPORTS\uff1a \u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219",(0,i.jsx)(e.strong,{children:"\u52a0\u5165\u8be5\u4e8b\u52a1"}),"\uff1b\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u4ee5\u975e\u4e8b\u52a1\u7684\u65b9\u5f0f\u7ee7\u7eed\u8fd0\u884c"]}),"\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_MANDATORY\uff1a \u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219",(0,i.jsx)(e.strong,{children:"\u52a0\u5165\u8be5\u4e8b\u52a1"}),"\uff1b\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u629b\u51fa\u5f02\u5e38"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u4e0d\u652f\u6301\u5f53\u524d\u4e8b\u52a1"}),"\u7684\u60c5\u51b5\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_REQUIRES_NEW\uff1a \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\uff0c\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u628a\u5f53\u524d\u4e8b\u52a1\u6302\u8d77\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5185\u5916\u5c42\u662f\u4e0d\u540c\u7684\u4e8b\u52a1\uff0c\u5982\u679c bMethod \u5df2\u7ecf\u63d0\u4ea4\uff0c\u5982\u679c aMethod \u5931\u8d25\u56de\u6eda \uff0cbMethod \u4e0d\u4f1a\u56de\u6eda"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c bMethod \u5931\u8d25\u56de\u6eda\uff0cServiceB \u629b\u51fa\u7684\u5f02\u5e38\u88ab ServiceA \u6355\u83b7\uff0c\u5982\u679c B \u629b\u51fa\u7684\u5f02\u5e38\u662f A \u4f1a\u56de\u6eda\u7684\u5f02\u5e38\uff0caMethod \u4e8b\u52a1\u9700\u8981\u56de\u6eda\uff0c\u5426\u5219\u4ecd\u7136\u53ef\u4ee5\u63d0\u4ea4"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_NOT_SUPPORTED\uff1a ",(0,i.jsx)(e.strong,{children:"\u4ee5\u975e\u4e8b\u52a1\u65b9\u5f0f\u8fd0\u884c"}),"\uff0c\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u628a\u5f53\u524d\u4e8b\u52a1\u6302\u8d77"]}),"\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_NEVER\uff1a ",(0,i.jsx)(e.strong,{children:"\u4ee5\u975e\u4e8b\u52a1\u65b9\u5f0f\u8fd0\u884c"}),"\uff0c\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u629b\u51fa\u5f02\u5e38"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5176\u4ed6\u60c5\u51b5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["TransactionDefinition.PROPAGATION_NESTED\uff1a \u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u4e8b\u52a1\u4f5c\u4e3a\u5f53\u524d\u4e8b\u52a1\u7684\u5d4c\u5957\u4e8b\u52a1\uff08\u4e24\u4e2a\u4e8b\u52a1\u6ca1\u6709\u5173\u7cfb\uff09\u6765\u8fd0\u884c\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5982\u679c ServiceB \u5f02\u5e38\u56de\u6eda\uff0c\u53ef\u4ee5\u901a\u8fc7 try-catch \u673a\u5236\u6267\u884c ServiceC"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c ServiceB \u63d0\u4ea4\uff0c ServiceA \u53ef\u4ee5\u6839\u636e\u5177\u4f53\u7684\u914d\u7f6e\u51b3\u5b9a\u662f commit \u8fd8\u662f rollback"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5e94\u7528\u573a\u666f"}),"\uff1a\u5728\u67e5\u8be2\u6570\u636e\u7684\u65f6\u5019\u8981\u5411\u6570\u636e\u5e93\u4e2d\u5b58\u50a8\u4e00\u4e9b\u65e5\u5fd7\uff0c\u7cfb\u7edf\u4e0d\u5e0c\u671b\u5b58\u65e5\u5fd7\u7684\u884c\u4e3a\u5f71\u54cd\u5230\u4e3b\u903b\u8f91\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u4f20\u64ad"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"requied\uff1a\u5fc5\u987b\u7684\u3001supports\uff1a\u652f\u6301\u7684\u3001mandatory\uff1a\u5f3a\u5236\u7684\u3001nested\uff1a\u5d4c\u5957\u7684"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8d85\u65f6\u5c5e\u6027",children:"\u8d85\u65f6\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u4e8b\u52a1\u8d85\u65f6\uff0c\u6307\u4e00\u4e2a\u4e8b\u52a1\u6240\u5141\u8bb8\u6267\u884c\u7684\u6700\u957f\u65f6\u95f4\uff0c\u5982\u679c\u8d85\u8fc7\u8be5\u65f6\u95f4\u9650\u5236\u4e8b\u52a1\u8fd8\u6ca1\u6709\u5b8c\u6210\uff0c\u5219\u81ea\u52a8\u56de\u6eda\u4e8b\u52a1\u3002\u5728 TransactionDefinition \u4e2d\u4ee5 int \u7684\u503c\u6765\u8868\u793a\u8d85\u65f6\u65f6\u95f4\uff0c\u5176\u5355\u4f4d\u662f\u79d2\uff0c\u9ed8\u8ba4\u503c\u4e3a -1"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u53ea\u8bfb\u5c5e\u6027",children:"\u53ea\u8bfb\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u5bf9\u4e8e\u53ea\u6709\u8bfb\u53d6\u6570\u636e\u67e5\u8be2\u7684\u4e8b\u52a1\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e8b\u52a1\u7c7b\u578b\u4e3a readonly\uff0c\u5373\u53ea\u8bfb\u4e8b\u52a1\uff1b\u53ea\u8bfb\u4e8b\u52a1\u4e0d\u6d89\u53ca\u6570\u636e\u7684\u4fee\u6539\uff0c\u6570\u636e\u5e93\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u4f18\u5316\u624b\u6bb5\uff0c\u9002\u5408\u7528\u5728\u6709\u591a\u6761\u6570\u636e\u5e93\u67e5\u8be2\u64cd\u4f5c\u7684\u65b9\u6cd5\u4e2d"}),"\n",(0,i.jsx)(e.p,{children:"\u8bfb\u64cd\u4f5c\u4e3a\u4ec0\u4e48\u9700\u8981\u542f\u7528\u4e8b\u52a1\u652f\u6301\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["MySQL  \u9ed8\u8ba4\u5bf9\u6bcf\u4e00\u4e2a\u65b0\u5efa\u7acb\u7684\u8fde\u63a5\u90fd\u542f\u7528\u4e86 ",(0,i.jsx)(e.code,{children:"autocommit"})," \u6a21\u5f0f\uff0c\u5728\u8be5\u6a21\u5f0f\u4e0b\uff0c\u6bcf\u4e00\u4e2a\u53d1\u9001\u5230 MySQL \u670d\u52a1\u5668\u7684 SQL \u8bed\u53e5\u90fd\u4f1a\u5728\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u5355\u72ec"}),"\u7684\u4e8b\u52a1\u4e2d\u8fdb\u884c\u5904\u7406\uff0c\u6267\u884c\u7ed3\u675f\u540e\u4f1a\u81ea\u52a8\u63d0\u4ea4\u4e8b\u52a1\uff0c\u5e76\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6267\u884c\u591a\u6761\u67e5\u8be2\u8bed\u53e5\uff0c\u5982\u679c\u65b9\u6cd5\u52a0\u4e0a\u4e86 ",(0,i.jsx)(e.code,{children:"@Transactional"})," \u6ce8\u89e3\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u6267\u884c\u7684\u6240\u6709 SQL \u4f1a\u88ab\u653e\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u5982\u679c\u58f0\u660e\u4e86\u53ea\u8bfb\u4e8b\u52a1\u7684\u8bdd\uff0c\u6570\u636e\u5e93\u5c31\u4f1a\u53bb\u4f18\u5316\u5b83\u7684\u6267\u884c\uff0c\u5e76\u4e0d\u4f1a\u5e26\u6765\u5176\u4ed6\u7684\u6536\u76ca\u3002\u5982\u679c\u4e0d\u52a0 ",(0,i.jsx)(e.code,{children:"@Transactional"}),"\uff0c\u6bcf\u6761 SQL \u4f1a\u5f00\u542f\u4e00\u4e2a\u5355\u72ec\u7684\u4e8b\u52a1\uff0c\u4e2d\u95f4\u88ab\u5176\u5b83\u4e8b\u52a1\u4fee\u6539\u4e86\u6570\u636e\uff0c\u6bd4\u5982\u5728\u524d\u6761 SQL \u67e5\u8be2\u4e4b\u540e\uff0c\u540e\u6761 SQL \u67e5\u8be2\u4e4b\u524d\uff0c\u6570\u636e\u88ab\u5176\u4ed6\u7528\u6237\u6539\u53d8\uff0c\u5219\u8fd9\u6b21\u6574\u4f53\u7684\u7edf\u8ba1\u67e5\u8be2\u5c06\u4f1a\u51fa",(0,i.jsx)(e.strong,{children:"\u73b0\u8bfb\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u72b6\u6001"})]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6838\u5fc3\u5bf9\u8c61",children:"\u6838\u5fc3\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.h4,{id:"\u4e8b\u52a1\u5bf9\u8c61",children:"\u4e8b\u52a1\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.p,{children:"J2EE \u5f00\u53d1\u4f7f\u7528\u5206\u5c42\u8bbe\u8ba1\u7684\u601d\u60f3\u8fdb\u884c\uff0c\u5bf9\u4e8e\u7b80\u5355\u7684\u4e1a\u52a1\u5c42\u8f6c\u8c03\u6570\u636e\u5c42\u7684\u5355\u4e00\u64cd\u4f5c\uff0c\u4e8b\u52a1\u5f00\u542f\u5728\u4e1a\u52a1\u5c42\u6216\u8005\u6570\u636e\u5c42\u5e76\u65e0\u592a\u5927\u5dee\u522b\uff0c\u5f53\u4e1a\u52a1\u4e2d\u5305\u542b\u591a\u4e2a\u6570\u636e\u5c42\u7684\u8c03\u7528\u65f6\uff0c\u9700\u8981\u5728\u4e1a\u52a1\u5c42\u5f00\u542f\u4e8b\u52a1\uff0c\u5bf9\u6570\u636e\u5c42\u4e2d\u591a\u4e2a\u64cd\u4f5c\u8fdb\u884c\u7ec4\u5408\u5e76\u5f52\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4e8b\u52a1\u8fdb\u884c\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u4e3a\u4e1a\u52a1\u5c42\u63d0\u4f9b\u4e86\u6574\u5957\u7684\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"PlatformTransactionManager"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"TransactionDefinition"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"TransactionStatus"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"ptm",children:"PTM"}),"\n",(0,i.jsx)(e.p,{children:"PlatformTransactionManager\uff0c\u5e73\u53f0\u4e8b\u52a1\u7ba1\u7406\u5668\u5b9e\u73b0\u7c7b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DataSourceTransactionManager  \u9002\u7528\u4e8e Spring JDBC \u6216 MyBatis"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"HibernateTransactionManager  \u9002\u7528\u4e8e Hibernate3.0 \u53ca\u4ee5\u4e0a\u7248\u672c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JpaTransactionManager  \u9002\u7528\u4e8e JPA"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JdoTransactionManager  \u9002\u7528\u4e8e JDO"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JtaTransactionManager  \u9002\u7528\u4e8e JTA"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7ba1\u7406\u5668\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JPA\uff08Java Persistence API\uff09Java EE \u6807\u51c6\u4e4b\u4e00\uff0c\u4e3a POJO \u63d0\u4f9b\u6301\u4e45\u5316\u6807\u51c6\u89c4\u8303\uff0c\u5e76\u89c4\u8303\u4e86\u6301\u4e45\u5316\u5f00\u53d1\u7684\u7edf\u4e00 API\uff0c\u7b26\u5408 JPA \u89c4\u8303\u7684\u5f00\u53d1\u53ef\u4ee5\u5728\u4e0d\u540c\u7684 JPA \u6846\u67b6\u4e0b\u8fd0\u884c"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u975e\u6301\u4e45\u5316\u4e00\u4e2a\u5b57\u6bb5"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"static String transient1; // not persistent because of static\nfinal String transient2 = \u201cSatish\u201d; // not persistent because of final\ntransient String transient3; // not persistent because of transient\n@Transient\nString transient4; // not persistent because of @Transient\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JDO\uff08Java Data Object\uff09\u662f Java \u5bf9\u8c61\u6301\u4e45\u5316\u89c4\u8303\uff0c\u7528\u4e8e\u5b58\u53d6\u67d0\u79cd\u6570\u636e\u5e93\u4e2d\u7684\u5bf9\u8c61\uff0c\u5e76\u63d0\u4f9b\u6807\u51c6\u5316 API\u3002JDBC \u4ec5\u9488\u5bf9\u5173\u7cfb\u6570\u636e\u5e93\u8fdb\u884c\u64cd\u4f5c\uff0cJDO \u53ef\u4ee5\u6269\u5c55\u5230\u5173\u7cfb\u6570\u636e\u5e93\u3001XML\u3001\u5bf9\u8c61\u6570\u636e\u5e93\u7b49\uff0c\u53ef\u79fb\u690d\u6027\u66f4\u5f3a"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JTA\uff08Java Transaction API\uff09Java EE \u6807\u51c6\u4e4b\u4e00\uff0c\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u5206\u5e03\u5f0f\u4e8b\u52a1\u5904\u7406\u3002\u4e0e JDBC \u76f8\u6bd4\uff0cJDBC \u4e8b\u52a1\u5219\u88ab\u9650\u5b9a\u5728\u4e00\u4e2a\u5355\u4e00\u7684\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u800c\u4e00\u4e2a JTA \u4e8b\u52a1\u53ef\u4ee5\u6709\u591a\u4e2a\u53c2\u4e0e\u8005\uff0c\u6bd4\u5982 JDBC \u8fde\u63a5\u3001JDO \u90fd\u53ef\u4ee5\u53c2\u4e0e\u5230\u4e00\u4e2a JTA \u4e8b\u52a1\u4e2d"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6b64\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e8b\u52a1\u7684\u57fa\u672c\u64cd\u4f5c\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"TransactionStatus getTransaction(TransactionDefinition definition)"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void commit(TransactionStatus status)"}),(0,i.jsx)(e.td,{children:"\u63d0\u4ea4\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void rollback(TransactionStatus status)"}),(0,i.jsx)(e.td,{children:"\u56de\u6eda\u4e8b\u52a1"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"definition",children:"Definition"}),"\n",(0,i.jsx)(e.p,{children:"TransactionDefinition \u6b64\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e8b\u52a1\u7684\u57fa\u672c\u4fe1\u606f\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"String getName()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u5b9a\u4e49\u540d\u79f0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isReadOnly()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u7684\u8bfb\u5199\u5c5e\u6027"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int getIsolationLevel()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int getTimeout()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u8d85\u65f6\u65f6\u95f4"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"int getPropagationBehavior()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u7279\u5f81"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"status",children:"Status"}),"\n",(0,i.jsx)(e.p,{children:"TransactionStatus \u6b64\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e8b\u52a1\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u67d0\u4e2a\u65f6\u95f4\u70b9\u4e0a\u7684\u72b6\u6001\u4fe1\u606f\u53ca\u5bf9\u5e94\u7684\u72b6\u6001\u64cd\u4f5c\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isNewTransaction()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u662f\u5426\u5904\u4e8e\u65b0\u5f00\u59cb\u4e8b\u52a1\u72b6\u6001"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"voin flush()"}),(0,i.jsx)(e.td,{children:"\u5237\u65b0\u4e8b\u52a1\u72b6\u6001"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isCompleted()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u662f\u5426\u5904\u4e8e\u5df2\u5b8c\u6210\u72b6\u6001"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean hasSavepoint()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u662f\u5426\u5177\u6709\u56de\u6eda\u50a8\u5b58\u70b9"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"boolean isRollbackOnly()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u4e8b\u52a1\u662f\u5426\u5904\u4e8e\u56de\u6eda\u72b6\u6001"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"void setRollbackOnly()"}),(0,i.jsx)(e.td,{children:"\u8bbe\u7f6e\u4e8b\u52a1\u5904\u4e8e\u56de\u6eda\u72b6\u6001"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u7f16\u7a0b\u5f0f",children:"\u7f16\u7a0b\u5f0f"}),"\n",(0,i.jsx)(e.h4,{id:"\u63a7\u5236\u65b9\u5f0f",children:"\u63a7\u5236\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"\u7f16\u7a0b\u5f0f\u3001\u58f0\u660e\u5f0f\uff08XML\uff09\u3001\u58f0\u660e\u5f0f\uff08\u6ce8\u89e3\uff09"}),"\n",(0,i.jsx)(e.h4,{id:"\u73af\u5883\u51c6\u5907",children:"\u73af\u5883\u51c6\u5907"}),"\n",(0,i.jsx)(e.p,{children:"\u94f6\u884c\u8f6c\u8d26\u4e1a\u52a1"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5305\u88c5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Account implements Serializable {\n    private Integer id;\n    private String name;\n    private Double money;\n    .....\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DAO\u5c42\u63a5\u53e3\uff1aAccountDao"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface AccountDao {\n    //\u5165\u8d26\u64cd\u4f5c\tname:\u5165\u8d26\u7528\u6237\u540d\tmoney:\u5165\u8d26\u91d1\u989d\n    void inMoney(@Param("name") String name, @Param("money") Double money);\n\n    //\u51fa\u8d26\u64cd\u4f5c\tname:\u51fa\u8d26\u7528\u6237\u540d\tmoney:\u51fa\u8d26\u91d1\u989d\n    void outMoney(@Param("name") String name, @Param("money") Double money);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42\u63a5\u53e3\u63d0\u4f9b\u8f6c\u8d26\u64cd\u4f5c\uff1aAccountService"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface AccountService {\n\t//\u8f6c\u8d26\u64cd\u4f5c\toutName:\u51fa\u8d26\u7528\u6237\u540d\tinName:\u5165\u8d26\u7528\u6237\u540d\tmoney:\u8f6c\u8d26\u91d1\u989d\n\tpublic void transfer(String outName,String inName,Double money);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42\u5b9e\u73b0\u63d0\u4f9b\u8f6c\u8d26\u64cd\u4f5c\uff1aAccountServiceImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class AccountServiceImpl implements AccountService {\n    private AccountDao accountDao;\n    public void setAccountDao(AccountDao accountDao) {\n        this.accountDao = accountDao;\n    }\n    @Override\n    public void transfer(String outName,String inName,Double money){\n\t\taccountDao.inMoney(outName,money);\n        accountDao.outMoney(inName,money);\n\t}\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6620\u5c04\u914d\u7f6e\u6587\u4ef6\uff1adao / AccountDao.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mapper namespace="dao.AccountDao">\n    <update id="inMoney">\n        UPDATE account SET money = money + #{money} WHERE name = #{name}\n    </update>\n\n    <update id="outMoney">\n        UPDATE account SET money = money - #{money} WHERE name = #{name}\n    </update>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"jdbc.properties"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"jdbc.driver=com.mysql.jdbc.Driver\njdbc.url=jdbc:mysql://192.168.2.185:3306/spring_db\njdbc.username=root\njdbc.password=1234\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff1aapplicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<context:property-placeholder location="classpath:*.properties"/>\n\n<bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">\n    <property name="driverClassName" value="${jdbc.driver}"/>\n    <property name="url" value="${jdbc.url}"/>\n    <property name="username" value="${jdbc.username}"/>\n    <property name="password" value="${jdbc.password}"/>\n</bean>\n\n<bean id="accountService" class="service.impl.AccountServiceImpl">\n    <property name="accountDao" ref="accountDao"/>\n</bean>\n\n<bean class="org.mybatis.spring.SqlSessionFactoryBean">\n    <property name="dataSource" ref="dataSource"/>\n    <property name="typeAliasesPackage" value="domain"/>\n</bean>\n\x3c!--\u626b\u63cf\u6620\u5c04\u914d\u7f6e\u548cDao--\x3e\n<bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">\n    <property name="basePackage" value="dao"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'ApplicationContext ctx = new ClassPathXmlApplicationContext("ap...xml");\nAccountService accountService = (AccountService) ctx.getBean("accountService");\naccountService.transfer("Jock1", "Jock2", 100d);\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u7f16\u7a0b\u5f0f-1",children:"\u7f16\u7a0b\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"\u7f16\u7a0b\u5f0f\u4e8b\u52a1\u5c31\u662f\u4ee3\u7801\u663e\u5f0f\u7684\u7ed9\u51fa\u4e8b\u52a1\u7684\u5f00\u542f\u548c\u63d0\u4ea4"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539\u4e1a\u52a1\u5c42\u5b9e\u73b0\u63d0\u4f9b\u8f6c\u8d26\u64cd\u4f5c\uff1aAccountServiceImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void transfer(String outName,String inName,Double money){\n    //1.\u521b\u5efa\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\n    DataSourceTransactionManager dstm = new DataSourceTransactionManager();\n    //2.\u4e3a\u4e8b\u52a1\u7ba1\u7406\u5668\u8bbe\u7f6e\u4e0e\u6570\u636e\u5c42\u76f8\u540c\u7684\u6570\u636e\u6e90\n    dstm.setDataSource(dataSource);\n    //3.\u521b\u5efa\u4e8b\u52a1\u5b9a\u4e49\u5bf9\u8c61\n    TransactionDefinition td = new DefaultTransactionDefinition();\n    //4.\u521b\u5efa\u4e8b\u52a1\u72b6\u6001\u5bf9\u8c61\uff0c\u7528\u4e8e\u63a7\u5236\u4e8b\u52a1\u6267\u884c\uff0c\u3010\u5f00\u542f\u4e8b\u52a1\u3011\n    TransactionStatus ts = dstm.getTransaction(td);\n    accountDao.inMoney(inName,money);\n    int i = 1/0;    //\u6a21\u62df\u4e1a\u52a1\u5c42\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u9519\u8bef\n    accountDao.outMoney(outName,money);\n    //5.\u63d0\u4ea4\u4e8b\u52a1\n    dstm.commit(ts);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u6dfb\u52a0\u5c5e\u6027\u6ce8\u5165--\x3e\n<bean id="accountService" class="service.impl.AccountServiceImpl">\n    <property name="accountDao" ref="accountDao"/>\n    <property name="dataSource" ref="dataSource"/>\n</bean>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"aop\u6539\u9020",children:"AOP\u6539\u9020"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5c06\u4e1a\u52a1\u5c42\u7684\u4e8b\u52a1\u5904\u7406\u529f\u80fd\u62bd\u53d6\u51fa\u6765\u5236\u4f5c\u6210 AOP \u901a\u77e5\uff0c\u5229\u7528\u73af\u7ed5\u901a\u77e5\u8fd0\u884c\u671f\u52a8\u6001\u7ec7\u5165"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class TxAdvice {\n    private DataSource dataSource;\n    public void setDataSource(DataSource dataSource) {\n        this.dataSource = dataSource;\n    }\n\n    public Object tx(ProceedingJoinPoint pjp) throws Throwable {\n        //\u5f00\u542f\u4e8b\u52a1\n        PlatformTransactionManager ptm = new DataSourceTransactionManager(dataSource);\n        //\u4e8b\u52a1\u5b9a\u4e49\n        TransactionDefinition td = new DefaultTransactionDefinition();\n        //\u4e8b\u52a1\u72b6\u6001\n        TransactionStatus ts =  ptm.getTransaction(td);\n        //pjp.getArgs()\u6807\u51c6\u5199\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u52a0\uff0c\u540c\u6837\u53ef\u4ee5\u4f20\u9012\u53c2\u6570\n        Object ret = pjp.proceed(pjp.getArgs());\n        \n        //\u63d0\u4ea4\u4e8b\u52a1\n        ptm.commit(ts);\n\n        return ret;\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e applicationContext.xml\uff0c\u8981\u5f00\u542f AOP \u7a7a\u95f4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u4fee\u6539bean\u7684\u5c5e\u6027\u6ce8\u5165--\x3e\n<bean id="accountService" class="service.impl.AccountServiceImpl">\n    <property name="accountDao" ref="accountDao"/>\n</bean>\n\n\x3c!--\u914d\u7f6eAOP\u901a\u77e5\u7c7b\uff0c\u5e76\u6ce8\u5165dataSource--\x3e\n<bean id="txAdvice" class="aop.TxAdvice">\n    <property name="dataSource" ref="dataSource"/>\n</bean>\n\n\x3c!--\u4f7f\u7528\u73af\u7ed5\u901a\u77e5\u5c06\u901a\u77e5\u7c7b\u7ec7\u5165\u5230\u539f\u59cb\u4e1a\u52a1\u5bf9\u8c61\u6267\u884c\u8fc7\u7a0b\u4e2d--\x3e\n<aop:config>\n    <aop:pointcut id="pt" expression="execution(* *..transfer(..))"/>\n    <aop:aspect ref="txAdvice">\n        <aop:around method="tx" pointcut-ref="pt"/>\n    </aop:aspect>\n</aop:config>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539\u4e1a\u52a1\u5c42\u5b9e\u73b0\u63d0\u4f9b\u8f6c\u8d26\u64cd\u4f5c\uff1aAccountServiceImpl"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class AccountServiceImpl implements AccountService {\n    private AccountDao accountDao;\n    public void setAccountDao(AccountDao accountDao) {\n        this.accountDao = accountDao;\n    }\n    @Override\n    public void transfer(String outName,String inName,Double money){\n\t\taccountDao.inMoney(outName,money);\n        //int i = 1 / 0;\n        accountDao.outMoney(inName,money);\n\t}\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u58f0\u660e\u5f0f",children:"\u58f0\u660e\u5f0f"}),"\n",(0,i.jsx)(e.h4,{id:"xml-2",children:"XML"}),"\n",(0,i.jsx)(e.h5,{id:"tx\u4f7f\u7528",children:"tx\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u5220\u9664 TxAdvice \u901a\u77e5\u7c7b\uff0c\u5f00\u542f tx \u547d\u540d\u7a7a\u95f4\uff0c\u914d\u7f6e applicationContext.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u914d\u7f6e\u5e73\u53f0\u4e8b\u52a1\u7ba1\u7406\u5668--\x3e\n<bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">\n    <property name="dataSource" ref="dataSource"/>\n</bean>\n\n\x3c!--\u5b9a\u4e49\u4e8b\u52a1\u7ba1\u7406\u7684\u901a\u77e5\u7c7b--\x3e\n<tx:advice id="txAdvice" transaction-manager="txManager">\n    \x3c!--\u5b9a\u4e49\u63a7\u5236\u7684\u4e8b\u52a1--\x3e\n    <tx:attributes>\n        <tx:method name="transfer" read-only="false"/>\n    </tx:attributes>\n</tx:advice>\n\n\x3c!--\u4f7f\u7528aop:advisor\u5728AOP\u914d\u7f6e\u4e2d\u5f15\u7528\u4e8b\u52a1\u4e13\u5c5e\u901a\u77e5\u7c7b\uff0c\u5e95\u5c42invoke\u8c03\u7528--\x3e\n<aop:config>\n    <aop:pointcut id="pt" expression="execution(* service.*Service.*(..))"/>\n    <aop:advisor advice-ref="txAdvice" pointcut-ref="pt"/>\n</aop:config>\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["aop:advice \u4e0e aop:advisor \u533a\u522b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"aop:advice \u914d\u7f6e\u7684\u901a\u77e5\u7c7b\u53ef\u4ee5\u662f\u666e\u901a Java \u5bf9\u8c61\uff0c\u4e0d\u5b9e\u73b0\u63a5\u53e3\uff0c\u4e5f\u4e0d\u4f7f\u7528\u7ee7\u627f\u5173\u7cfb"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"aop:advisor \u914d\u7f6e\u7684\u901a\u77e5\u7c7b\u5fc5\u987b\u5b9e\u73b0\u901a\u77e5\u63a5\u53e3\uff0c\u5e95\u5c42 invoke \u8c03\u7528"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MethodBeforeAdvice"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"AfterReturningAdvice"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ThrowsAdvice"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"pom.xml \u6587\u4ef6\u5f15\u5165\u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-tx</artifactId>\n    <version>5.1.9.RELEASE</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"tx\u914d\u7f6e",children:"tx\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h6,{id:"advice-1",children:"advice"}),"\n",(0,i.jsx)(e.p,{children:"\u6807\u7b7e\uff1atx:advice\uff0cbeans \u7684\u5b50\u6807\u7b7e"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4e13\u7528\u4e8e\u58f0\u660e\u4e8b\u52a1\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<beans>\n    <tx:advice id="txAdvice" transaction-manager="txManager">\n    </tx:advice>\n</beans>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"id\uff1a\u7528\u4e8e\u914d\u7f6e aop \u65f6\u6307\u5b9a\u901a\u77e5\u5668\u7684 id"}),"\n",(0,i.jsx)(e.li,{children:"transaction-manager\uff1a\u6307\u5b9a\u4e8b\u52a1\u7ba1\u7406\u5668 bean"}),"\n"]}),"\n",(0,i.jsx)(e.h6,{id:"attributes",children:"attributes"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1atx:attributes\uff0ctx:advice \u7684\u5b50\u6807\u7b7e"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5b9a\u4e49\u901a\u77e5\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<tx:advice id="txAdvice" transaction-manager="txManager">\n    <tx:attributes>\n    </tx:attributes>\n</tx:advice>\n'})}),"\n",(0,i.jsx)(e.h6,{id:"method",children:"method"}),"\n",(0,i.jsx)(e.p,{children:"\u6807\u7b7e\uff1atx:method\uff0ctx:attribute \u7684\u5b50\u6807\u7b7e"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5177\u4f53\u7684\u4e8b\u52a1\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<tx:attributes>\n    \x3c!--\u6807\u51c6\u683c\u5f0f--\x3e\n    <tx:method name="*" read-only="false"/>\n    <tx:method name="get*" read-only="true"/>\n    <tx:method name="find*" read-only="true"/>\n</tx:attributes>\n<aop:pointcut id="pt" expression="execution(* service.*Service.*(..))"/>\x3c!--\u6807\u51c6--\x3e\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a\u901a\u5e38\u4e8b\u52a1\u5c5e\u6027\u4f1a\u914d\u7f6e\u591a\u4e2a\uff0c\u5305\u542b 1 \u4e2a\u8bfb\u5199\u7684\u5168\u4e8b\u52a1\u5c5e\u6027\uff0c1 \u4e2a\u53ea\u8bfb\u7684\u67e5\u8be2\u7c7b\u4e8b\u52a1\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u5c5e\u6027\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"name\uff1a\u5f85\u6dfb\u52a0\u4e8b\u52a1\u7684\u65b9\u6cd5\u540d\u8868\u8fbe\u5f0f\uff08\u652f\u6301 * \u901a\u914d\u7b26\uff09"}),"\n",(0,i.jsx)(e.li,{children:"read-only\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u7684\u8bfb\u5199\u5c5e\u6027\uff0ctrue \u4e3a\u53ea\u8bfb\uff0cfalse \u4e3a\u8bfb\u5199"}),"\n",(0,i.jsx)(e.li,{children:"timeout\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u7684\u8d85\u65f6\u65f6\u957f\uff0c\u5355\u4f4d\u79d2\uff0c-1 \u4e3a\u65e0\u9650\u957f"}),"\n",(0,i.jsx)(e.li,{children:"isolation\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u7684\u9694\u79bb\u754c\u522b\uff0c\u8be5\u9694\u79bb\u7ea7\u8bbe\u5b9a\u662f\u57fa\u4e8e Spring \u7684\u8bbe\u5b9a\uff0c\u975e\u6570\u636e\u5e93\u7aef"}),"\n",(0,i.jsxs)(e.li,{children:["no-rollback-for\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u4e2d\u4e0d\u56de\u6eda\u7684\u5f02\u5e38\uff0c\u591a\u4e2a\u5f02\u5e38\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:","})," \u5206\u9694"]}),"\n",(0,i.jsxs)(e.li,{children:["rollback-for\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u4e2d\u5fc5\u56de\u6eda\u7684\u5f02\u5e38\uff0c\u591a\u4e2a\u5f02\u5e38\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:","})," \u5206\u9694"]}),"\n",(0,i.jsx)(e.li,{children:"propagation\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6ce8\u89e3",children:"\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h5,{id:"\u5f00\u542f\u6ce8\u89e3",children:"\u5f00\u542f\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h6,{id:"xml-3",children:"XML"}),"\n",(0,i.jsx)(e.p,{children:"\u6807\u7b7e\uff1atx:annotation-driven"}),"\n",(0,i.jsx)(e.p,{children:"\u5f52\u5c5e\uff1abeans \u6807\u7b7e"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5f00\u542f\u4e8b\u52a1\u6ce8\u89e3\u9a71\u52a8\uff0c\u5e76\u6307\u5b9a\u5bf9\u5e94\u7684\u4e8b\u52a1\u7ba1\u7406\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<tx:annotation-driven transaction-manager="txManager"/>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h6,{id:"\u7eaf\u6ce8\u89e3-2",children:"\u7eaf\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@EnableTransactionManagement"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\uff0cSpring \u6ce8\u89e3\u914d\u7f6e\u7c7b\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5f00\u542f\u6ce8\u89e3\u9a71\u52a8\uff0c\u7b49\u540c XML \u683c\u5f0f\u4e2d\u7684\u6ce8\u89e3\u9a71\u52a8"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan("com.seazean")\n@PropertySource("classpath:jdbc.properties")\n@Import({JDBCConfig.class,MyBatisConfig.class,TransactionManagerConfig.class})\n@EnableTransactionManagement\npublic class SpringConfig {\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class TransactionManagerConfig {\n    @Bean\t\t\t\t\t\t\t\t\t\t\t\t//\u81ea\u52a8\u88c5\u914d\n    public PlatformTransactionManager getTransactionManager(@Autowired DataSource dataSource){\n        return new DataSourceTransactionManager(dataSource);\n    }\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u914d\u7f6e\u6ce8\u89e3",children:"\u914d\u7f6e\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Transactional"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u65b9\u6cd5\u6ce8\u89e3\uff0c\u7c7b\u6ce8\u89e3\uff0c\u63a5\u53e3\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5f53\u524d\u7c7b/\u63a5\u53e3\u4e2d\u6240\u6709\u65b9\u6cd5\u6216\u5177\u4f53\u65b9\u6cd5\u5f00\u542f\u4e8b\u52a1\uff0c\u5e76\u6307\u5b9a\u76f8\u5173\u4e8b\u52a1\u5c5e\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Transactional(\n    readOnly = false,\n    timeout = -1,\n    isolation = Isolation.DEFAULT,\n    rollbackFor = {ArithmeticException.class, IOException.class},\n    noRollbackFor = {},\n    propagation = Propagation.REQUIRES_NEW\n)\npublic void addAccount{} \n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"@Transactional"})," \u6ce8\u89e3\u53ea\u6709\u4f5c\u7528\u5230 public \u65b9\u6cd5\u4e0a\u4e8b\u52a1\u624d\u751f\u6548"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4e0d\u63a8\u8350\u5728\u63a5\u53e3\u4e0a\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"@Transactional"})," \u6ce8\u89e3"]}),"\n",(0,i.jsxs)(e.p,{children:["\u539f\u56e0\uff1a\u5728\u63a5\u53e3\u4e0a\u4f7f\u7528\u6ce8\u89e3\uff0c",(0,i.jsx)(e.strong,{children:"\u53ea\u6709\u5728\u4f7f\u7528\u57fa\u4e8e\u63a5\u53e3\u7684\u4ee3\u7406\uff08JDK\uff09\u65f6\u624d\u4f1a\u751f\u6548\uff0c\u56e0\u4e3a\u6ce8\u89e3\u662f\u4e0d\u80fd\u7ee7\u627f\u7684"}),"\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u5982\u679c\u6b63\u5728\u4f7f\u7528\u57fa\u4e8e\u7c7b\u7684\u4ee3\u7406\uff08CGLIB\uff09\u65f6\uff0c\u90a3\u4e48\u4e8b\u52a1\u7684\u8bbe\u7f6e\u5c06\u4e0d\u80fd\u88ab\u57fa\u4e8e\u7c7b\u7684\u4ee3\u7406\u6240\u8bc6\u522b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6b63\u786e\u7684\u8bbe\u7f6e ",(0,i.jsx)(e.code,{children:"@Transactional"})," \u7684 rollbackFor \u548c propagation \u5c5e\u6027\uff0c\u5426\u5219\u4e8b\u52a1\u53ef\u80fd\u4f1a\u56de\u6eda\u5931\u8d25"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1\u53ea\u6709\u9047\u5230\u8fd0\u884c\u671f\u5f02\u5e38 \u548c Error \u4f1a\u5bfc\u81f4\u4e8b\u52a1\u56de\u6eda\uff0c\u4f46\u662f\u5728\u9047\u5230\u68c0\u67e5\u578b\uff08Checked\uff09\u5f02\u5e38\u65f6\u4e0d\u4f1a\u56de\u6eda"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7ee7\u627f\u81ea RuntimeException \u6216 error \u7684\u662f\u975e\u68c0\u67e5\u578b\u5f02\u5e38\uff0c\u6bd4\u5982\u7a7a\u6307\u9488\u548c\u7d22\u5f15\u8d8a\u754c\uff0c\u800c\u7ee7\u627f\u81ea Exception \u7684\u5219\u662f\u68c0\u67e5\u578b\u5f02\u5e38\uff0c\u6bd4\u5982 IOException\u3001ClassNotFoundException\uff0cRuntimeException \u672c\u8eab\u7ee7\u627f Exception"}),"\n",(0,i.jsx)(e.li,{children:"\u975e\u68c0\u67e5\u578b\u7c7b\u5f02\u5e38\u53ef\u4ee5\u4e0d\u7528\u6355\u83b7\uff0c\u800c\u68c0\u67e5\u578b\u5f02\u5e38\u5219\u5fc5\u987b\u7528 try \u8bed\u53e5\u5757\u628a\u5f02\u5e38\u4ea4\u7ed9\u4e0a\u7ea7\u65b9\u6cd5\uff0c\u8fd9\u6837\u4e8b\u52a1\u624d\u80fd\u6709\u6548"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4e8b\u52a1\u4e0d\u751f\u6548\u7684\u95ee\u9898"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u60c5\u51b5 1\uff1a\u786e\u8ba4\u521b\u5efa\u7684 MySQL \u6570\u636e\u5e93\u8868\u5f15\u64ce\u662f InnoDB\uff0cMyISAM \u4e0d\u652f\u6301\u4e8b\u52a1"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u60c5\u51b5 2\uff1a\u6ce8\u89e3\u5230 protected\uff0cprivate \u65b9\u6cd5\u4e0a\u4e8b\u52a1\u4e0d\u751f\u6548\uff0c\u4f46\u4e0d\u4f1a\u62a5\u9519"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u56e0\uff1a\u7406\u8bba\u4e0a\u800c\u8a00\uff0c\u4e0d\u7528 public \u4fee\u9970\uff0c\u4e5f\u53ef\u4ee5\u7528 aop \u5b9e\u73b0\u4e8b\u52a1\u7684\u529f\u80fd\uff0c\u4f46\u662f\u65b9\u6cd5\u79c1\u6709\u5316\u8ba9\u5176\u4ed6\u4e1a\u52a1\u65e0\u6cd5\u8c03\u7528"}),"\n",(0,i.jsxs)(e.p,{children:["AopUtils.canApply\uff1a",(0,i.jsx)(e.code,{children:"methodMatcher.matches(method, targetClass) --true--\x3e return true"}),"\n",(0,i.jsx)(e.code,{children:"TransactionAttributeSourcePointcut.matches()"})," \uff0cAbstractFallbackTransactionAttributeSource \u4e2d getTransactionAttribute \u65b9\u6cd5\u8c03\u7528\u4e86\u5176\u672c\u8eab\u7684 computeTransactionAttribute \u65b9\u6cd5\uff0c\u5f53\u52a0\u4e86\u4e8b\u52a1\u6ce8\u89e3\u7684\u65b9\u6cd5\u4e0d\u662f public \u65f6\uff0c\u8be5\u65b9\u6cd5\u76f4\u63a5\u8fd4\u56de null\uff0c\u6240\u4ee5\u9020\u6210\u589e\u5f3a\u4e0d\u5339\u914d"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private TransactionAttribute computeTransactionAttribute(Method method, Class<?> targetClass) {\n    // Don't allow no-public methods as required.\n    if (allowPublicMethodsOnly() && !Modifier.isPublic(method.getModifiers())) {\n        return null;\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u60c5\u51b5 3\uff1a\u6ce8\u89e3\u6240\u5728\u7684\u7c7b\u6ca1\u6709\u88ab\u52a0\u8f7d\u6210 Bean"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u60c5\u51b5 4\uff1a\u5728\u4e1a\u52a1\u5c42\u6355\u6349\u5f02\u5e38\u540e\u672a\u5411\u4e0a\u629b\u51fa\uff0c\u4e8b\u52a1\u4e0d\u751f\u6548"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u56e0\uff1a\u5728\u4e1a\u52a1\u5c42\u6355\u6349\u5e76\u5904\u7406\u4e86\u5f02\u5e38\uff08try..catch\uff09\u7b49\u4e8e\u628a\u5f02\u5e38\u5904\u7406\u6389\u4e86\uff0cSpring \u5c31\u4e0d\u77e5\u9053\u8fd9\u91cc\u6709\u9519\uff0c\u4e5f\u4e0d\u4f1a\u4e3b\u52a8\u53bb\u56de\u6eda\u6570\u636e\uff0c\u63a8\u8350\u505a\u6cd5\u662f\u5728\u4e1a\u52a1\u5c42\u7edf\u4e00\u629b\u51fa\u5f02\u5e38\uff0c\u7136\u540e\u5728\u63a7\u5236\u5c42\u7edf\u4e00\u5904\u7406"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u60c5\u51b5 5\uff1a\u9047\u5230\u68c0\u6d4b\u5f02\u5e38\u65f6\uff0c\u4e5f\u65e0\u6cd5\u56de\u6eda"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u56e0\uff1aSpring \u7684\u9ed8\u8ba4\u7684\u4e8b\u52a1\u89c4\u5219\u662f\u9047\u5230\u8fd0\u884c\u5f02\u5e38\uff08RuntimeException\uff09\u548c\u7a0b\u5e8f\u9519\u8bef\uff08Error\uff09\u624d\u4f1a\u56de\u6eda\u3002\u60f3\u9488\u5bf9\u68c0\u6d4b\u5f02\u5e38\u8fdb\u884c\u4e8b\u52a1\u56de\u6eda\uff0c\u53ef\u4ee5\u5728 @Transactional \u6ce8\u89e3\u91cc\u4f7f\u7528 rollbackFor \u5c5e\u6027\u660e\u786e\u6307\u5b9a\u5f02\u5e38"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u60c5\u51b5 6\uff1aSpring \u7684\u4e8b\u52a1\u4f20\u64ad\u7b56\u7565\u5728",(0,i.jsx)(e.strong,{children:"\u5185\u90e8\u65b9\u6cd5"}),"\u8c03\u7528\u65f6\u5c06\u4e0d\u8d77\u4f5c\u7528\uff0c\u5728\u4e00\u4e2a Service \u5185\u90e8\uff0c\u4e8b\u52a1\u65b9\u6cd5\u4e4b\u95f4\u7684\u5d4c\u5957\u8c03\u7528\uff0c\u666e\u901a\u65b9\u6cd5\u548c\u4e8b\u52a1\u65b9\u6cd5\u4e4b\u95f4\u7684\u5d4c\u5957\u8c03\u7528\uff0c\u90fd\u4e0d\u4f1a\u5f00\u542f\u65b0\u7684\u4e8b\u52a1\uff0c\u4e8b\u52a1\u6ce8\u89e3\u8981\u52a0\u5230\u8c03\u7528\u65b9\u6cd5\u4e0a\u624d\u751f\u6548"]}),"\n",(0,i.jsxs)(e.p,{children:["\u539f\u56e0\uff1aSpring \u7684\u4e8b\u52a1\u90fd\u662f\u4f7f\u7528 AOP \u4ee3\u7406\u7684\u6a21\u5f0f\uff0c\u52a8\u6001\u4ee3\u7406 invoke \u540e\u4f1a\u8c03\u7528\u539f\u59cb\u5bf9\u8c61\uff0c\u800c\u539f\u59cb\u5bf9\u8c61\u5728\u53bb\u8c03\u7528\u65b9\u6cd5\u65f6\u662f\u4e0d\u4f1a\u89e6\u53d1\u62e6\u622a\u5668\uff0c\u5c31\u662f",(0,i.jsx)(e.strong,{children:"\u4e00\u4e2a\u65b9\u6cd5\u8c03\u7528\u672c\u5bf9\u8c61\u7684\u53e6\u4e00\u4e2a\u65b9\u6cd5"}),"\uff0c\u6240\u4ee5\u4e8b\u52a1\u4e5f\u5c31\u65e0\u6cd5\u751f\u6548"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Transactional\npublic int add(){\n    update();\n}\n//\u6ce8\u89e3\u6dfb\u52a0\u5728update\u65b9\u6cd5\u4e0a\u65e0\u6548\uff0c\u9700\u8981\u6dfb\u52a0\u5230add()\u65b9\u6cd5\u4e0a\npublic int update(){}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u60c5\u51b5 7\uff1a\u6ce8\u89e3\u5728\u63a5\u53e3\u4e0a\uff0c\u4ee3\u7406\u5bf9\u8c61\u662f CGLIB"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u4f7f\u7528\u6ce8\u89e3",children:"\u4f7f\u7528\u6ce8\u89e3"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Dao \u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public interface AccountDao {\n    @Update("update account set money = money + #{money} where name = #{name}")\n    void inMoney(@Param("name") String name, @Param("money") Double money);\n\n    @Update("update account set money = money - #{money} where name = #{name}")\n    void outMoney(@Param("name") String name, @Param("money") Double money);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface AccountService {\n    //\u5bf9\u5f53\u524d\u65b9\u6cd5\u6dfb\u52a0\u4e8b\u52a1\uff0c\u8be5\u914d\u7f6e\u5c06\u66ff\u6362\u63a5\u53e3\u7684\u914d\u7f6e\n    @Transactional(\n        readOnly = false,\n        timeout = -1,\n        isolation = Isolation.DEFAULT,\n        rollbackFor = {},//java.lang.ArithmeticException.class, IOException.class\n        noRollbackFor = {},\n        propagation = Propagation.REQUIRED\n        )\n    public void transfer(String outName, String inName, Double money);\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class AccountServiceImpl implements AccountService {\n    @Autowired\n    private AccountDao accountDao;\n    public void transfer(String outName, String inName, Double money) {\n        accountDao.inMoney(outName,money);\n        //int i = 1/0;\n        accountDao.outMoney(inName,money);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6dfb\u52a0\u6587\u4ef6 Spring.config\u3001Mybatis.config\u3001JDBCConfig (\u53c2\u8003ioc_Mybatis)\u3001TransactionManagerConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan({"","",""})\n@PropertySource("classpath:jdbc.properties")\n@Import({JDBCConfig.class,MyBatisConfig.class})\n@EnableTransactionManagement\npublic class SpringConfig {\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6a21\u677f\u5bf9\u8c61",children:"\u6a21\u677f\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u6a21\u677f\u5bf9\u8c61\uff1aTransactionTemplate\u3001JdbcTemplate\u3001RedisTemplate\u3001RabbitTemplate\u3001JmsTemplate\u3001HibernateTemplate\u3001RestTemplate"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JdbcTemplate\uff1a\u63d0\u4f9b\u6807\u51c6\u7684 sql \u8bed\u53e5\u64cd\u4f5cAPI"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"NamedParameterJdbcTemplate\uff1a\u63d0\u4f9b\u6807\u51c6\u7684\u5177\u540d sql \u8bed\u53e5\u64cd\u4f5cAPI"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RedisTemplate\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void changeMoney(Integer id, Double money) {\n    redisTemplate.opsForValue().set("account:id:"+id,money);\n}\npublic Double findMondyById(Integer id) {\n    Object money = redisTemplate.opsForValue().get("account:id:" + id);\n    return new Double(money.toString());\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(25771).A+"",width:"711",height:"345"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u539f\u7406",children:"\u539f\u7406"}),"\n",(0,i.jsx)(e.h3,{id:"xml-4",children:"XML"}),"\n",(0,i.jsx)(e.p,{children:"\u4e09\u5927\u5bf9\u8c61\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"BeanDefinition"}),"\uff1a\u662f Spring \u4e2d\u6781\u5176\u91cd\u8981\u7684\u4e00\u4e2a\u6982\u5ff5\uff0c\u5b58\u50a8\u4e86 bean \u5bf9\u8c61\u7684\u6240\u6709\u7279\u5f81\u4fe1\u606f\uff0c\u5982\u662f\u5426\u5355\u4f8b\u3001\u662f\u5426\u61d2\u52a0\u8f7d\u3001factoryBeanName \u7b49\uff0c\u548c bean \u7684\u5173\u7cfb\u5c31\u662f\u7c7b\u4e0e\u5bf9\u8c61\u7684\u5173\u7cfb\uff0c\u4e00\u4e2a\u4e0d\u540c\u7684 bean \u5bf9\u5e94\u4e00\u4e2a BeanDefinition"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"BeanDefinationRegistry"}),"\uff1a\u5b58\u653e BeanDefination \u7684\u5bb9\u5668\uff0c\u662f\u4e00\u79cd\u952e\u503c\u5bf9\u7684\u5f62\u5f0f\uff0c\u901a\u8fc7\u7279\u5b9a\u7684 Bean \u5b9a\u4e49\u7684 id\uff0c\u6620\u5c04\u5230\u76f8\u5e94\u7684 BeanDefination\uff0c",(0,i.jsx)(e.strong,{children:"BeanFactory \u7684\u5b9e\u73b0\u7c7b\u540c\u6837\u7ee7\u627f BeanDefinationRegistry \u63a5\u53e3"}),"\uff0c\u62e5\u6709\u4fdd\u5b58 BD \u7684\u80fd\u529b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"BeanDefinitionReader"}),"\uff1a\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c",(0,i.jsx)(e.strong,{children:"XML \u7528 Dom4j \u89e3\u6790"}),"\uff0c",(0,i.jsx)(e.strong,{children:"\u6ce8\u89e3\u7528 IO \u6d41\u52a0\u8f7d\u89e3\u6790"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'BeanFactory bf = new XmlBeanFactory(new ClassPathResource("applicationContext.xml"));\nUserService userService1 = (UserService)bf.getBean("userService");\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6e90\u7801\u89e3\u6790\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public XmlBeanFactory(Resource resource, BeanFactory parentBeanFactory) {\n    super(parentBeanFactory);\n    this.reader.loadBeanDefinitions(resource);\n}\npublic int loadBeanDefinitions(Resource resource) {\n    //\u5c06 resource \u5305\u88c5\u6210\u5e26\u7f16\u7801\u683c\u5f0f\u7684 EncodedResource\n    //EncodedResource \u4e2d getReader()\u65b9\u6cd5\uff0c\u8c03\u7528java.io\u5305\u4e0b\u7684 \u8f6c\u6362\u6d41 \u521b\u5efa\u6307\u5b9a\u7f16\u7801\u7684\u8f93\u5165\u6d41\u5bf9\u8c61\n    return loadBeanDefinitions(new EncodedResource(resource));\n}\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"XmlBeanDefinitionReader.loadBeanDefinitions()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u628a Resource \u89e3\u6790\u6210 BeanDefinition \u5bf9\u8c61"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"currentResources = this.resourcesCurrentlyBeingLoaded.get()"}),"\uff1a\u62ff\u5230\u5f53\u524d\u7ebf\u7a0b\u5df2\u7ecf\u52a0\u8f7d\u8fc7\u7684\u6240\u6709 EncodedResoure \u8d44\u6e90\uff0c\u7528 ThreadLocal \u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (currentResources == null)"}),"\uff1a\u5224\u65ad currentResources \u662f\u5426\u4e3a\u7a7a\uff0c\u4e3a\u7a7a\u5219\u8fdb\u884c\u521d\u59cb\u5316"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (!currentResources.add(encodedResource))"}),"\uff1a\u5982\u679c\u5df2\u7ecf\u52a0\u8f7d\u8fc7\u8be5\u8d44\u6e90\u4f1a\u62a5\u9519\uff0c\u9632\u6b62\u91cd\u590d\u52a0\u8f7d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"inputSource = new InputSource(inputStream)"}),"\uff1a\u8d44\u6e90\u5bf9\u8c61\u5305\u88c5\u6210 InputSource\uff0cInputSource \u662f ",(0,i.jsx)(e.strong,{children:"SAX"})," \u4e2d\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u7528\u6765\u8fdb\u884c XML \u6587\u4ef6\u7684\u89e3\u6790"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return doLoadBeanDefinitions()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u52a0\u8f7d\u8fd4\u56de"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"currentResources.remove(encodedResource)"}),"\uff1a\u52a0\u8f7d\u5b8c\u6210\u79fb\u9664\u5f53\u524d encodedResource"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"resourcesCurrentlyBeingLoaded.remove()"}),"\uff1aThreadLocal \u4e3a\u7a7a\u65f6\u79fb\u9664\u5143\u7d20\uff0c\u9632\u6b62\u5185\u5b58\u6cc4\u9732"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"XmlBeanDefinitionReader.doLoadBeanDefinitions(inputSource, resource)"}),"\uff1a\u771f\u6b63\u7684\u52a0\u8f7d\u51fd\u6570"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Document doc = doLoadDocument(inputSource, resource)"}),"\uff1a\u8f6c\u6362\u6210\u6709",(0,i.jsx)(e.strong,{children:"\u5c42\u6b21\u7ed3\u6784"}),"\u7684 Document \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getEntityResolver()"}),(0,i.jsx)(e.strong,{children:"\uff1a\u83b7\u53d6\u7528\u6765\u89e3\u6790 DTD\u3001XSD \u7ea6\u675f\u7684\u89e3\u6790\u5668"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getValidationModeForResource(resource)"}),"\uff1a\u83b7\u53d6\u9a8c\u8bc1\u6a21\u5f0f"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"int count = registerBeanDefinitions(doc, resource)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06 Document \u89e3\u6790\u6210 BD \u5bf9\u8c61\uff0c\u6ce8\u518c\uff08\u6dfb\u52a0\uff09\u5230  BeanDefinationRegistry \u4e2d"}),"\uff0c\u8fd4\u56de\u65b0\u6ce8\u518c\u7684\u6570\u91cf"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"createBeanDefinitionDocumentReader()"}),"\uff1a\u521b\u5efa DefaultBeanDefinitionDocumentReader \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getRegistry().getBeanDefinitionCount()"}),"\uff1a\u83b7\u53d6\u89e3\u6790\u524d BeanDefinationRegistry \u4e2d\u7684 bd \u6570\u91cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"registerBeanDefinitions(doc, readerContext)"}),"\uff1a\u6ce8\u518c BD\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.readerContext = readerContext"}),"\uff1a\u4fdd\u5b58\u4e0a\u4e0b\u6587\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"doRegisterBeanDefinitions(doc.getDocumentElement())"}),"\uff1a\u771f\u6b63\u7684\u6ce8\u518c BD \u51fd\u6570\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"doc.getDocumentElement()"}),"\uff1a\u62ff\u51fa\u9876\u5c42\u6807\u7b7e ",(0,i.jsx)(e.beans,{})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return getRegistry().getBeanDefinitionCount() - countBefore"}),"\uff1a\u8fd4\u56de\u65b0\u52a0\u5165\u7684\u6570\u91cf"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions()"}),"\uff1a\u6ce8\u518c BD \u5230 BR"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"createDelegate(getReaderContext(), root, parent)"}),"\uff1abeans \u662f\u6807\u7b7e\u7684\u89e3\u6790\u5668\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"delegate.isDefaultNamespace(root)"}),"\uff1a\u5224\u65ad beans \u6807\u7b7e\u662f\u5426\u662f\u9ed8\u8ba4\u7684\u5c5e\u6027"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"root.getAttribute(PROFILE_ATTRIBUTE)"}),"\uff1a\u89e3\u6790 profile \u5c5e\u6027"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"preProcessXml(root)"}),"\uff1a\u89e3\u6790\u524d\u7f6e\u5904\u7406\uff0c\u81ea\u5b9a\u4e49\u5b9e\u73b0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"parseBeanDefinitions(root, this.delegate)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u89e3\u6790 beans \u6807\u7b7e\u4e2d\u7684\u5b50\u6807\u7b7e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"parseDefaultElement(ele, delegate)"}),"\uff1a\u5982\u679c\u662f\u9ed8\u8ba4\u7684\u6807\u7b7e\uff0c\u7528\u8be5\u65b9\u6cd5\u89e3\u6790\u5b50\u6807\u7b7e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5224\u65ad\u6807\u7b7e\u540d\u79f0\uff0c\u8fdb\u884c\u76f8\u5e94\u7684\u89e3\u6790"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"processBeanDefinition(ele, delegate)"}),"\uff1a"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"delegate.parseCustomElement(ele)"}),"\uff1a\u89e3\u6790\u81ea\u5b9a\u4e49\u7684\u6807\u7b7e"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"postProcessXml(root)"}),"\uff1a\u89e3\u6790\u540e\u7f6e\u5904\u7406"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DefaultBeanDefinitionDocumentReader.processBeanDefinition()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u89e3\u6790 bean \u6807\u7b7e\u5e76\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"delegate.parseBeanDefinitionElement(ele)"}),"\uff1a\u89e3\u6790 bean \u6807\u7b7e\u5c01\u88c5\u4e3a BeanDefinitionHolder"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!StringUtils.hasText(beanName) && !aliases.isEmpty())"}),"\uff1a\u6761\u4ef6\u4e00\u6210\u7acb\u8bf4\u660e name \u6ca1\u6709\u503c\uff0c\u6761\u4ef6\u4e8c\u6210\u7acb\u8bf4\u660e\u522b\u540d\u6709\u503c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanName = aliases.remove(0)"}),"\uff1a\u62ff\u522b\u540d\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f53\u4f5c beanName"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"parseBeanDefinitionElement(ele, beanName, containingBean)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u89e3\u6790 bean \u6807\u7b7e"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"parseState.push(new BeanEntry(beanName))"}),"\uff1a\u5f53\u524d\u89e3\u6790\u5668\u7684\u72b6\u6001\u8bbe\u7f6e\u4e3a BeanEntry"]}),"\n",(0,i.jsx)(e.li,{children:"class \u548c parent \u5c5e\u6027\u5b58\u5728\u4e00\u4e2a\uff0cparent \u662f\u4f5c\u4e3a\u7236\u6807\u7b7e\u4e3a\u4e86\u88ab\u7ee7\u627f"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"createBeanDefinition(className, parent)"}),"\uff1a\u8bbe\u7f6e\u4e86class \u7684 GenericBeanDefinition\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"parseBeanDefinitionAttributes()"}),"\uff1a\u89e3\u6790 bean \u6807\u7b7e\u7684\u5c5e\u6027"]}),"\n",(0,i.jsx)(e.li,{children:"\u63a5\u4e0b\u6765\u89e3\u6790\u5b50\u6807\u7b7e"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanName = this.readerContext.generateBeanName(beanDefinition)"}),"\uff1a\u751f\u6210 className + # + \u5e8f\u53f7\u7684\u540d\u79f0\u8d4b\u503c\u7ed9 beanName"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return new BeanDefinitionHolder(beanDefinition, beanName, aliases)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5305\u88c5\u6210 BeanDefinitionHolder"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registerBeanDefinition(bdHolder, getReaderContext().getRegistry())"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6ce8\u518c\u5230\u5bb9\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"beanName = definitionHolder.getBeanName()"}),"\uff1a\u83b7\u53d6beanName"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.beanDefinitionMap.put(beanName, beanDefinition)"}),"\uff1a\u6dfb\u52a0\u5230\u6ce8\u518c\u4e2d\u5fc3"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getReaderContext().fireComponentRegistered()"}),"\uff1a\u53d1\u9001\u6ce8\u518c\u5b8c\u6210\u4e8b\u4ef6"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u8bf4\u660e\uff1a\u6e90\u7801\u90e8\u5206\u7684\u7b14\u8bb0\u4e0d\u4e00\u5b9a\u9002\u5408\u6240\u6709\u4eba\u9605\u8bfb\uff0c\u4f5c\u8005\u91c7\u7528\u6d41\u6c34\u7ebf\u5f0f\u53bb\u89e3\u6790\u91cd\u8981\u7684\u4ee3\u7801\uff0c\u89e3\u6790\u7684\u7ed3\u6784\u7c7b\u4f3c\u4e8e\u6811\u72b6\uff0c\u5982\u679c\u89c6\u89c9\u75b2\u52b3\u53ef\u4ee5\u53bb\u7f51\u4e0a\u53c2\u8003\u4e00\u4e9b\u535a\u5ba2\u548c\u6d41\u7a0b\u56fe\u5b66\u4e60\u6e90\u7801\u3002"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"ioc-1",children:"IOC"}),"\n",(0,i.jsx)(e.h4,{id:"\u5bb9\u5668\u542f\u52a8",children:"\u5bb9\u5668\u542f\u52a8"}),"\n",(0,i.jsx)(e.p,{children:"Spring IOC \u5bb9\u5668\u662f ApplicationContext \u6216\u8005 BeanFactory\uff0c\u4f7f\u7528\u591a\u4e2a Map \u96c6\u5408\u4fdd\u5b58\u5355\u5b9e\u4f8b Bean\uff0c\u73af\u5883\u4fe1\u606f\u7b49\u8d44\u6e90\uff0c\u4e0d\u540c\u5c42\u7ea7\u6709\u4e0d\u540c\u7684\u5bb9\u5668\uff0c\u6bd4\u5982\u6574\u5408 SpringMVC \u7684\u7236\u5b50\u5bb9\u5668\uff08\u5148\u770b Bean \u90e8\u5206\u7684\u6e90\u7801\u89e3\u6790\u518d\u56de\u770b\u5bb9\u5668\uff09"}),"\n",(0,i.jsx)(e.p,{children:"ClassPathXmlApplicationContext \u4e0e AnnotationConfigApplicationContext \u5dee\u4e0d\u591a\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public AnnotationConfigApplicationContext(Class<?>... annotatedClasses) {\n    this();\n    register(annotatedClasses);// \u89e3\u6790\u914d\u7f6e\u7c7b\uff0c\u5c01\u88c5\u6210\u4e00\u4e2a BeanDefinitionHolder\uff0c\u5e76\u6ce8\u518c\u5230\u5bb9\u5668\n    refresh();// \u52a0\u8f7d\u5237\u65b0\u5bb9\u5668\u4e2d\u7684 Bean\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public AnnotationConfigApplicationContext() {\n    // \u6ce8\u518c Spring \u7684\u6ce8\u89e3\u89e3\u6790\u5668\u5230\u5bb9\u5668\n    this.reader = new AnnotatedBeanDefinitionReader(this);\n    // \u5b9e\u4f8b\u5316\u8def\u5f84\u626b\u63cf\u5668\uff0c\u7528\u4e8e\u5bf9\u6307\u5b9a\u7684\u5305\u76ee\u5f55\u8fdb\u884c\u626b\u63cf\u67e5\u627e bean \u5bf9\u8c61\n    this.scanner = new ClassPathBeanDefinitionScanner(this);\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AbstractApplicationContext.refresh()\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["prepareRefresh()\uff1a\u5237\u65b0\u524d\u7684",(0,i.jsx)(e.strong,{children:"\u9884\u5904\u7406"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.startupDate = System.currentTimeMillis()"}),"\uff1a\u8bbe\u7f6e\u5bb9\u5668\u7684\u542f\u52a8\u65f6\u95f4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"initPropertySources()"}),"\uff1a\u521d\u59cb\u5316\u4e00\u4e9b\u5c5e\u6027\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e2a\u6027\u5316\u7684\u5c5e\u6027\u8bbe\u7f6e\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getEnvironment().validateRequiredProperties()"}),"\uff1a\u68c0\u67e5\u73af\u5883\u53d8\u91cf"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"earlyApplicationEvents= new LinkedHashSet<ApplicationEvent>()"}),"\uff1a\u4fdd\u5b58\u5bb9\u5668\u4e2d\u65e9\u671f\u7684\u4e8b\u4ef6"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["obtainFreshBeanFactory()\uff1a\u83b7\u53d6\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u5168\u65b0\u7684 BeanFactory \u63a5\u53e3\u5b9e\u4f8b"}),"\uff0c\u5982\u679c\u5bb9\u5668\u4e2d\u5b58\u5728\u5de5\u5382\u5b9e\u4f8b\u76f4\u63a5\u9500\u6bc1"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"refreshBeanFactory()"}),"\uff1a\u521b\u5efa BeanFactory\uff0c\u8bbe\u7f6e\u5e8f\u5217\u5316 ID\u3001\u8bfb\u53d6 BeanDefinition \u5e76\u52a0\u8f7d\u5230\u5de5\u5382"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (hasBeanFactory())"}),"\uff1aapplicationContext \u5185\u90e8\u62e5\u6709\u4e00\u4e2a beanFactory \u5b9e\u4f8b\uff0c\u9700\u8981\u5c06\u8be5\u5b9e\u4f8b\u5b8c\u5168\u91ca\u653e\u9500\u6bc1"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"destroyBeans()"}),"\uff1a\u9500\u6bc1\u539f beanFactory \u5b9e\u4f8b\uff0c\u5c06 beanFactory \u5185\u90e8\u7ef4\u62a4\u7684\u5355\u5b9e\u4f8b bean \u5168\u90e8\u6e05\u6389\uff0c\u5982\u679c\u54ea\u4e2a bean \u5b9e\u73b0\u4e86 Disposablejie\u63a5\u53e3\uff0c\u8fd8\u4f1a\u8fdb\u884c bean distroy \u65b9\u6cd5\u7684\u8c03\u7528\u5904\u7406\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.singletonsCurrentlyInDestruction = true"}),"\uff1a\u8bbe\u7f6e\u5f53\u524d beanFactory \u72b6\u6001\u4e3a\u9500\u6bc1\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"String[] disposableBeanNames"}),"\uff1a\u83b7\u53d6\u9500\u6bc1\u96c6\u5408\u4e2d\u7684 bean\uff0c\u5982\u679c\u5f53\u524d bean \u6709",(0,i.jsx)(e.strong,{children:"\u6790\u6784\u51fd\u6570"}),"\u5c31\u4f1a\u5728\u9500\u6bc1\u96c6\u5408"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"destroySingleton(disposableBeanNames[i])"}),"\uff1a\u904d\u5386\u6240\u6709\u7684 disposableBeans\uff0c\u6267\u884c\u9500\u6bc1\u65b9\u6cd5\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"removeSingleton(beanName)"}),"\uff1a\u6e05\u9664\u4e09\u7ea7\u7f13\u5b58\u548c registeredSingletons \u4e2d\u7684\u5f53\u524d beanName \u7684\u6570\u636e"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.disposableBeans.remove(beanName)"}),"\uff1a\u4ece\u9500\u6bc1\u96c6\u5408\u4e2d\u6e05\u9664\uff0c\u6bcf\u4e2a bean \u53ea\u80fd destroy \u4e00\u6b21"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"destroyBean(beanName, disposableBean)"}),"\uff1a\u9500\u6bc1 bean\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"dependentBeanMap \u8bb0\u5f55\u4e86\u4f9d\u8d56\u5f53\u524d bean \u7684\u5176\u4ed6 bean \u4fe1\u606f\uff0c\u56e0\u4e3a\u4f9d\u8d56\u7684\u5bf9\u8c61\u8981\u88ab\u56de\u6536\u4e86\uff0c\u6240\u4ee5\u4f9d\u8d56\u5f53\u524d bean \u7684\u5176\u4ed6\u5bf9\u8c61\u90fd\u8981\u6267\u884c destroySingleton\uff0c\u904d\u5386 dependentBeanMap \u6267\u884c\u9500\u6bc1"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"bean.destroy()"}),"\uff1a\u89e3\u51b3\u5b8c\u6210\u4f9d\u8d56\u540e\uff0c\u6267\u884c DisposableBean \u7684 destroy \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" this.dependenciesForBeanMap.remove(beanName)"}),"\uff1a\u4fdd\u5b58\u5f53\u524d bean \u4f9d\u8d56\u4e86\u8c01\uff0c\u76f4\u63a5\u6e05\u9664"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u8fdb\u884c\u4e00\u4e9b\u96c6\u5408\u548c\u7f13\u5b58\u7684\u6e05\u7406\u5de5\u4f5c"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"closeBeanFactory()"}),"\uff1a\u5c06\u5bb9\u5668\u5185\u90e8\u7684 beanFactory \u8bbe\u7f6e\u4e3a\u7a7a\uff0c\u91cd\u65b0\u521b\u5efa"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"beanFactory = createBeanFactory()"}),"\uff1a\u521b\u5efa\u65b0\u7684 DefaultListableBeanFactory \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"beanFactory.setSerializationId(getId())"}),"\uff1a\u8fdb\u884c ID \u7684\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u6839\u636e ID \u83b7\u53d6 BeanFactory \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"customizeBeanFactory(beanFactory)"}),"\uff1a\u8bbe\u7f6e\u662f\u5426\u5141\u8bb8\u8986\u76d6\u548c\u5faa\u73af\u5f15\u7528"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"loadBeanDefinitions(beanFactory)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u52a0\u8f7d BeanDefinition \u4fe1\u606f\uff0c\u6ce8\u518c BD\u6ce8\u518c\u5230 BeanFactory \u4e2d"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.beanFactory = beanFactory"}),"\uff1a\u628a beanFactory \u586b\u5145\u81f3\u5bb9\u5668\u4e2d"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getBeanFactory()"}),"\uff1a\u8fd4\u56de\u521b\u5efa\u7684 DefaultListableBeanFactory \u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u7ee7\u627f BeanDefinitionRegistry"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["prepareBeanFactory(beanFactory)\uff1a",(0,i.jsx)(e.strong,{children:"BeanFactory \u7684\u9884\u51c6\u5907"}),"\u5de5\u4f5c\uff0c\u5411\u5bb9\u5668\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u7ec4\u4ef6"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"setBeanClassLoader(getClassLoader())"}),"\uff1a\u7ed9\u5f53\u524d bf \u8bbe\u7f6e\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u7c7b\u52a0\u8f7d\u5668"}),"\uff0c\u52a0\u8f7d bd \u7684 class \u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"setBeanExpressionResolver()"}),"\uff1a\u8bbe\u7f6e EL \u8868\u8fbe\u5f0f\u89e3\u6790\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"addPropertyEditorRegistrar"}),"\uff1a\u6dfb\u52a0\u4e00\u4e2a\u5c5e\u6027\u7f16\u8f91\u5668\uff0c\u89e3\u51b3\u5c5e\u6027\u6ce8\u5165\u65f6\u7684\u683c\u5f0f\u8f6c\u6362"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"addBeanPostProcessor()"}),"\uff1a\u6dfb\u52a0\u540e\u5904\u7406\u5668\uff0c\u4e3b\u8981\u7528\u4e8e\u5411 bean \u5185\u90e8\u6ce8\u5165\u4e00\u4e9b\u6846\u67b6\u7ea7\u522b\u7684\u5b9e\u4f8b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ignoreDependencyInterface()"}),"\uff1a\u8bbe\u7f6e\u5ffd\u7565\u81ea\u52a8\u88c5\u914d\u7684\u63a5\u53e3\uff0cbean \u5185\u90e8\u7684\u8fd9\u4e9b\u7c7b\u578b\u7684\u5b57\u6bb5   \u4e0d\u53c2\u4e0e\u4f9d\u8d56\u6ce8\u5165"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"registerResolvableDependency()"}),"\uff1a\u6ce8\u518c\u4e00\u4e9b\u7c7b\u578b\u4f9d\u8d56\u5173\u7cfb"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"addBeanPostProcessor()"}),"\uff1a\u5c06\u914d\u7f6e\u7684\u76d1\u542c\u8005\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\uff0c\u5f53\u524d bean \u5b9e\u73b0 ApplicationListener \u63a5\u53e3\u5c31\u662f\u76d1\u542c\u5668\u4e8b\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"beanFactory.registerSingleton()"}),"\uff1a\u6dfb\u52a0\u4e00\u4e9b\u7cfb\u7edf\u4fe1\u606f"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"postProcessBeanFactory(beanFactory)\uff1aBeanFactory \u51c6\u5907\u5de5\u4f5c\u5b8c\u6210\u540e\u8fdb\u884c\u7684\u540e\u7f6e\u5904\u7406\u5de5\u4f5c\uff0c\u6269\u5c55\u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["invokeBeanFactoryPostProcessors(beanFactory)\uff1a",(0,i.jsx)(e.strong,{children:"\u6267\u884c BeanFactoryPostProcessor \u7684\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"processedBeans = new HashSet<>()"}),"\uff1a\u5b58\u50a8\u5df2\u7ecf\u6267\u884c\u8fc7\u7684 BeanFactoryPostProcessor \u7684 beanName"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (beanFactory instanceof BeanDefinitionRegistry)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5f53\u524d BeanFactory \u662f bd \u7684\u6ce8\u518c\u4e2d\u5fc3\uff0cbd \u5168\u90e8\u6ce8\u518c\u5230 bf"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (BeanFactoryPostProcessor postProcessor : beanFactoryPostProcessors)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684 bf \u540e\u7f6e\u5904\u7406\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (postProcessor instanceof BeanDefinitionRegistryPostProcessor)"}),"\uff1a\u662f Registry \u7c7b\u7684\u540e\u7f6e\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registryProcessor.postProcessBeanDefinitionRegistry(registry)"}),"\uff1a\u5411 bf \u4e2d\u6ce8\u518c\u4e00\u4e9b bd"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registryProcessors.add(registryProcessor)"}),"\uff1a\u6dfb\u52a0\u5230 BeanDefinitionRegistryPostProcessor \u96c6\u5408"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"regularPostProcessors.add(postProcessor)"}),"\uff1a\u6dfb\u52a0\u5230 BeanFactoryPostProcessor \u96c6\u5408"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u903b\u8f91\u5230\u8fd9\u91cc\u5df2\u7ecf\u83b7\u53d6\u5230\u6240\u6709 BeanDefinitionRegistryPostProcessor \u548c BeanFactoryPostProcessor  \u63a5\u53e3\u7c7b\u578b\u7684\u540e\u7f6e\u5904\u7406\u5668"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9996\u5148\u56de\u8c03 BeanDefinitionRegistryPostProcessor \u7c7b\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5 postProcessBeanDefinitionRegistry()"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6\u5b9e\u73b0\u4e86 PriorityOrdered\uff08\u4e3b\u6392\u5e8f\u63a5\u53e3\uff09\u63a5\u53e3\u7684 bdrpp\uff0c\u8fdb\u884c sort \u6392\u5e8f\uff0c\u7136\u540e\u5168\u90e8\u6267\u884c\u5e76\u653e\u5165\u5df2\u7ecf\u5904\u7406\u8fc7\u7684\u96c6\u5408"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u518d\u6267\u884c\u5b9e\u73b0\u4e86 Ordered\uff08\u6b21\u6392\u5e8f\u63a5\u53e3\uff09\u63a5\u53e3\u7684 bdrpp"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6700\u540e\u6267\u884c\u6ca1\u6709\u5b9e\u73b0\u4efb\u4f55\u4f18\u5148\u7ea7\u6216\u8005\u662f\u987a\u5e8f\u63a5\u53e3 bdrpp\uff0c",(0,i.jsx)(e.code,{children:"boolean reiterate = true"})," \u63a7\u5236 while \u662f\u5426\u9700\u8981\u518d\u6b21\u5faa\u73af\uff0c\u5faa\u73af\u5185\u662f\u67e5\u627e\u5e76\u6267\u884c bdrpp \u540e\u5904\u7406\u5668\u7684 registry \u76f8\u5173\u7684\u63a5\u53e3\u65b9\u6cd5\uff0c\u63a5\u53e3\u65b9\u6cd5\u6267\u884c\u4ee5\u540e\u4f1a\u5411 bf \u5185\u6ce8\u518c bd\uff0c\u6ce8\u518c\u7684 bd \u4e5f\u6709\u53ef\u80fd\u662f bdrpp \u7c7b\u578b\uff0c\u6240\u4ee5\u9700\u8981\u8be5\u53d8\u91cf\u63a7\u5236\u5faa\u73af"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"processedBeans.add(ppName)"}),"\uff1a\u5df2\u7ecf\u6267\u884c\u8fc7\u7684\u540e\u7f6e\u5904\u7406\u5668\u5b58\u50a8\u5230\u8be5\u96c6\u5408\u4e2d\uff0c\u9632\u6b62\u91cd\u590d\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" invokeBeanFactoryPostProcessors()"}),"\uff1abdrpp \u7ee7\u627f\u4e86 BeanFactoryPostProcessor\uff0c\u6709 postProcessBeanFactory \u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6267\u884c\u666e\u901a BeanFactoryPostProcessor \u7684\u76f8\u5173 postProcessBeanFactory \u65b9\u6cd5\uff0c\u6309\u7167\u4e3b\u6b21\u65e0\u6b21\u5e8f\u6267\u884c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (processedBeans.contains(ppName))"}),"\uff1a\u4f1a\u8fc7\u6ee4\u6389\u5df2\u7ecf\u6267\u884c\u8fc7\u7684\u540e\u7f6e\u5904\u7406\u5668"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.clearMetadataCache()"}),"\uff1a\u6e05\u9664\u7f13\u5b58\u4e2d\u5408\u5e76\u7684 Bean \u5b9a\u4e49\uff0c\u56e0\u4e3a\u540e\u7f6e\u5904\u7406\u5668\u53ef\u80fd\u66f4\u6539\u4e86\u5143\u6570\u636e"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4ee5\u4e0a\u662f BeanFactory \u7684\u521b\u5efa\u53ca\u9884\u51c6\u5907\u5de5\u4f5c\uff0c\u63a5\u4e0b\u6765\u8fdb\u5165 Bean \u7684\u6d41\u7a0b"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["registerBeanPostProcessors(beanFactory)\uff1a",(0,i.jsx)(e.strong,{children:"\u6ce8\u518c Bean \u7684\u540e\u7f6e\u5904\u7406\u5668"}),"\uff0c\u4e3a\u4e86\u5e72\u9884 Spring \u521d\u59cb\u5316 bean \u7684\u6d41\u7a0b\uff0c\u8fd9\u91cc\u4ec5\u4ec5\u662f\u5411\u5bb9\u5668\u4e2d",(0,i.jsx)(e.strong,{children:"\u6ce8\u5165\u800c\u975e\u4f7f\u7528"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.getBeanNamesForType(BeanPostProcessor.class)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u914d\u7f6e\u4e2d\u5b9e\u73b0\u4e86 BeanPostProcessor \u63a5\u53e3\u7c7b\u578b"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"int beanProcessorTargetCount"}),"\uff1a\u540e\u7f6e\u5904\u7406\u5668\u7684\u6570\u91cf\uff0c\u5df2\u7ecf\u6ce8\u518c\u7684 + \u672a\u6ce8\u518c\u7684 + \u5373\u5c06\u8981\u6dfb\u52a0\u7684\u4e00\u4e2a"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.addBeanPostProcessor(new BeanPostProcessorChecker())"}),"\uff1a\u6dfb\u52a0\u4e00\u4e2a\u68c0\u67e5\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"BeanPostProcessorChecker.postProcessAfterInitialization()"}),"\uff1a\u521d\u59cb\u5316\u540e\u7684\u540e\u5904\u7406\u5668\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"!(bean instanceof BeanPostProcessor) "}),"\uff1a\u5f53\u524d bean \u7c7b\u578b\u662f\u666e\u901a bean\uff0c\u4e0d\u662f\u540e\u7f6e\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"!isInfrastructureBean(beanName)"}),"\uff1a\u6210\u7acb\u8bf4\u660e\u5f53\u524d beanName \u662f\u7528\u6237\u7ea7\u522b\u7684 bean  \u4e0d\u662f Spring \u6846\u67b6\u7684"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.beanFactory.getBeanPostProcessorCount() < this.beanPostProcessorTargetCount"}),"\uff1aBeanFactory \u4e0a\u9762\u6ce8\u518c\u540e\u5904\u7406\u5668\u6570\u91cf < \u540e\u5904\u7406\u5668\u6570\u91cf\uff0c\u8bf4\u660e\u540e\u5904\u7406\u6846\u67b6\u5c1a\u672a\u521d\u59cb\u5316\u5b8c\u6210"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (String ppName : postProcessorNames)"}),"\uff1a\u904d\u5386 PostProcessor \u96c6\u5408\uff0c",(0,i.jsx)(e.strong,{children:"\u6839\u636e\u5b9e\u73b0\u4e0d\u540c\u7684\u987a\u5e8f\u63a5\u53e3\u6dfb\u52a0\u5230\u4e0d\u540c\u96c6\u5408"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"sortPostProcessors(priorityOrderedPostProcessors, beanFactory)"}),"\uff1a\u5b9e\u73b0 PriorityOrdered \u63a5\u53e3\u7684\u540e\u5904\u7406\u5668\u6392\u5e8f"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registerBeanPostProcessors(beanFactory, priorityOrderedPostProcessors)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6ce8\u518c\u5230 beanFactory \u4e2d"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u63a5\u7740\u6392\u5e8f\u6ce8\u518c\u5b9e\u73b0 Ordered \u63a5\u53e3\u7684\u540e\u7f6e\u5904\u7406\u5668\uff0c\u7136\u540e\u6ce8\u518c\u666e\u901a\u7684\uff08 \u6ca1\u6709\u5b9e\u73b0\u4efb\u4f55\u4f18\u5148\u7ea7\u63a5\u53e3\uff09\u540e\u7f6e\u5904\u7406\u5668"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6700\u540e\u6392\u5e8f MergedBeanDefinitionPostProcessor \u7c7b\u578b\u7684\u5904\u7406\u5668\uff0c\u6839\u636e\u5b9e\u73b0\u7684\u6392\u5e8f\u63a5\u53e3\uff0c\u6392\u5e8f\u5b8c\u6ce8\u518c\u5230 beanFactory \u4e2d"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(applicationContext))"}),"\uff1a\u91cd\u65b0\u6ce8\u518c ApplicationListenerDetector \u540e\u5904\u7406\u5668\uff0c\u7528\u4e8e\u5728 Bean \u521b\u5efa\u5b8c\u6210\u540e\u68c0\u67e5\u662f\u5426\u5c5e\u4e8e ApplicationListener \u7c7b\u578b\uff0c\u5982\u679c\u662f\u5c31\u628a Bean \u653e\u5230",(0,i.jsx)(e.strong,{children:"\u76d1\u542c\u5668\u5bb9\u5668"}),"\u4e2d\u4fdd\u5b58\u8d77\u6765"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"initMessageSource()\uff1a\u521d\u59cb\u5316 MessageSource \u7ec4\u4ef6\uff0c\u4e3b\u8981\u7528\u4e8e\u505a\u56fd\u9645\u5316\u529f\u80fd\uff0c\u6d88\u606f\u7ed1\u5b9a\u4e0e\u6d88\u606f\u89e3\u6790"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (beanFactory.containsLocalBean(MESSAGE_SOURCE_BEAN_NAME))"}),"\uff1a\u5bb9\u5668\u662f\u5426\u542b\u6709\u540d\u79f0\u4e3a messageSource \u7684 bean"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"beanFactory.getBean(MESSAGE_SOURCE_BEAN_NAME, MessageSource.class)"}),"\uff1a\u5982\u679c\u6709\u8bc1\u660e\u7528\u6237\u81ea\u5b9a\u4e49\u4e86\u8be5\u7c7b\u578b\u7684 bean\uff0c\u83b7\u53d6\u540e\u76f4\u63a5\u8d4b\u503c\u7ed9 this.messageSource"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"dms = new DelegatingMessageSource()"}),"\uff1a\u5bb9\u5668\u4e2d\u6ca1\u6709\u5c31\u65b0\u5efa\u4e00\u4e2a\u8d4b\u503c"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["initApplicationEventMulticaster()\uff1a",(0,i.jsx)(e.strong,{children:"\u521d\u59cb\u5316\u4e8b\u4ef6\u4f20\u64ad\u5668"}),"\uff0c\u5728\u6ce8\u518c\u76d1\u542c\u5668\u65f6\u4f1a\u7528\u5230"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (beanFactory.containsLocalBean(APPLICATION_EVENT_MULTICASTER_BEAN_NAME))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u7528\u6237\u81ea\u5b9a\u4e49\u4e86\u4e8b\u4ef6\u4f20\u64ad\u5668"}),"\uff0c\u53ef\u4ee5\u5b9e\u73b0 ApplicationEventMulticaster \u63a5\u53e3\u7f16\u5199\u81ea\u5df1\u7684\u4e8b\u4ef6\u4f20\u64ad\u5668\uff0c\u901a\u8fc7 bean \u7684\u65b9\u5f0f\u63d0\u4f9b\u7ed9 Spring"]}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u6709\u5c31\u76f4\u63a5\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\uff1b\u5982\u679c\u6ca1\u6709\u5219\u521b\u5efa\u4e00\u4e2a SimpleApplicationEventMulticaster \u6ce8\u518c"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"onRefresh()\uff1a\u7559\u7ed9\u7528\u6237\u53bb\u5b9e\u73b0\uff0c\u53ef\u4ee5\u786c\u7f16\u7801\u63d0\u4f9b\u4e00\u4e9b\u7ec4\u4ef6\uff0c\u6bd4\u5982\u63d0\u4f9b\u4e00\u4e9b\u76d1\u542c\u5668"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["registerListeners()\uff1a\u6ce8\u518c\u901a\u8fc7\u914d\u7f6e\u63d0\u4f9b\u7684 Listener\uff0c\u8fd9\u4e9b",(0,i.jsx)(e.strong,{children:"\u76d1\u542c\u5668"}),"\u6700\u7ec8\u6ce8\u518c\u5230 ApplicationEventMulticaster \u5185"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (ApplicationListener<?> listener : getApplicationListeners()) "}),"\uff1a\u6ce8\u518c\u7f16\u7801\u5b9e\u73b0\u7684\u76d1\u542c\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getBeanNamesForType(ApplicationListener.class, true, false)"}),"\uff1a\u6ce8\u518c\u901a\u8fc7\u914d\u7f6e\u63d0\u4f9b\u7684 Listener"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"multicastEvent(earlyEvent)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u53d1\u5e03\u524d\u9762\u6b65\u9aa4\u4ea7\u751f\u7684\u4e8b\u4ef6 applicationEvents"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Executor executor = getTaskExecutor()"}),"\uff1a\u83b7\u53d6\u7ebf\u7a0b\u6c60\uff0c\u6709\u7ebf\u7a0b\u6c60\u5c31\u5f02\u6b65\u6267\u884c\uff0c\u6ca1\u6709\u5c31\u540c\u6b65\u6267\u884c"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["finishBeanFactoryInitialization()\uff1a",(0,i.jsx)(e.strong,{children:"\u5b9e\u4f8b\u5316\u975e\u61d2\u52a0\u8f7d\u72b6\u6001\u7684\u5355\u5b9e\u4f8b"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.freezeConfiguration()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u51bb\u7ed3\u914d\u7f6e\u4fe1\u606f"}),"\uff0c\u5c31\u662f\u51bb\u7ed3 BD \u4fe1\u606f\uff0c\u51bb\u7ed3\u540e\u65e0\u6cd5\u518d\u5411 bf \u5185\u6ce8\u518c bd"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.preInstantiateSingletons()"}),"\uff1a\u5b9e\u4f8b\u5316 non-lazy-init singletons"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (String beanName : beanNames)"}),"\uff1a\u904d\u5386\u5bb9\u5668\u5185\u6240\u6709\u7684 beanDefinitionNames"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getMergedLocalBeanDefinition(beanName)"}),"\uff1a\u83b7\u53d6\u4e0e\u7236\u7c7b\u5408\u5e76\u540e\u7684\u5bf9\u8c61\uff08Bean \u2192 \u83b7\u53d6\u6d41\u7a0b\u90e8\u5206\u8be6\u89e3\u6b64\u51fd\u6570\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!bd.isAbstract() && bd.isSingleton() && !bd.isLazyInit())"}),"\uff1aBD \u5bf9\u5e94\u7684 Class \u6ee1\u8db3\u975e\u62bd\u8c61\u3001\u5355\u5b9e\u4f8b\uff0c\u975e\u61d2\u52a0\u8f7d\uff0c\u9700\u8981\u9884\u5148\u5b9e\u4f8b\u5316"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (isFactoryBean(beanName))"}),"\uff1aBD \u5bf9\u5e94\u7684 Class \u662f factoryBean \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getBean(FACTORY_BEAN_PREFIX + beanName)"}),"\uff1a\u83b7\u53d6\u5de5\u5382 FactoryBean \u5b9e\u4f8b\u672c\u8eab"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"isEagerInit"}),"\uff1a\u63a7\u5236 FactoryBean \u5185\u90e8\u7ba1\u7406\u7684 Bean \u662f\u5426\u4e5f\u521d\u59cb\u5316"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getBean(beanName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521d\u59cb\u5316 Bean\uff0c\u83b7\u53d6 Bean \u8be6\u89e3\u6b64\u51fd\u6570"})]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getBean(beanName)"}),"\uff1a\u4e0d\u662f\u5de5\u5382 bean \u76f4\u63a5\u83b7\u53d6"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (String beanName : beanNames)"}),"\uff1a\u68c0\u67e5\u6240\u6709\u7684 Bean \u662f\u5426\u5b9e\u73b0 SmartInitializingSingleton \u63a5\u53e3\uff0c\u5b9e\u73b0\u4e86\u5c31\u6267\u884c afterSingletonsInstantiated()\uff0c\u8fdb\u884c\u4e00\u4e9b\u521b\u5efa\u540e\u7684\u64cd\u4f5c"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"finishRefresh()"}),"\uff1a\u5b8c\u6210\u5237\u65b0\u540e\u505a\u7684\u4e00\u4e9b\u4e8b\u60c5\uff0c\u4e3b\u8981\u662f\u542f\u52a8\u751f\u547d\u5468\u671f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"clearResourceCaches()"}),"\uff1a\u6e05\u7a7a\u4e0a\u4e0b\u6587\u7f13\u5b58"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"initLifecycleProcessor()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521d\u59cb\u5316\u548c\u751f\u547d\u5468\u671f\u6709\u5173\u7684\u540e\u7f6e\u5904\u7406\u5668"}),"\uff0c\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (beanFactory.containsLocalBean(LIFECYCLE_PROCESSOR_BEAN_NAME))"}),"\uff1a\u6210\u7acb\u8bf4\u660e\u81ea\u5b9a\u4e49\u4e86\u751f\u547d\u5468\u671f\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"defaultProcessor = new DefaultLifecycleProcessor()"}),"\uff1aSpring \u9ed8\u8ba4\u63d0\u4f9b\u7684\u751f\u547d\u5468\u671f\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" beanFactory.registerSingleton()"}),"\uff1a\u5c06\u751f\u547d\u5468\u671f\u5904\u7406\u5668\u6ce8\u518c\u5230 bf \u7684\u4e00\u7ea7\u7f13\u5b58\u548c\u6ce8\u518c\u5355\u4f8b\u96c6\u5408\u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getLifecycleProcessor().onRefresh()"}),"\uff1a\u83b7\u53d6\u8be5",(0,i.jsx)(e.strong,{children:"\u751f\u547d\u5468\u671f\u540e\u7f6e\u5904\u7406\u5668\u56de\u8c03 onRefresh()"}),"\uff0c\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"startBeans(true)"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"lifecycleBeans = getLifecycleBeans()"}),"\uff1a\u83b7\u53d6\u5230\u6240\u6709\u5b9e\u73b0\u4e86 Lifecycle \u63a5\u53e3\u7684\u5bf9\u8c61\u5305\u88c5\u5230 Map \u5185\uff0ckey \u662fbeanName\uff0c value \u662f Lifecycle \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"int phase = getPhase(bean)"}),"\uff1a\u83b7\u53d6\u5f53\u524d Lifecycle \u7684 phase \u503c\uff0c\u5f53\u524d\u751f\u547d\u5468\u671f\u5bf9\u8c61\u53ef\u80fd\u4f9d\u8d56\u5176\u4ed6\u751f\u547d\u5468\u671f\u5bf9\u8c61\u7684\u6267\u884c\u7ed3\u679c\uff0c\u6240\u4ee5\u9700\u8981 phase \u51b3\u5b9a\u6267\u884c\u987a\u5e8f\uff0c\u6570\u503c\u8d8a\u4f4e\u7684\u4f18\u5148\u6267\u884c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"LifecycleGroup group = phases.get(phase)"}),"\uff1a\u628a phsae \u76f8\u540c\u7684 Lifecycle \u5b58\u5165 LifecycleGroup"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (group == null)"}),"\uff1agroup \u4e3a\u7a7a\u5219\u521b\u5efa\uff0c\u521d\u59cb\u60c5\u51b5\u4e0b\u662f\u7a7a\u7684"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"group.add(beanName, bean)"}),"\uff1a\u5c06\u5f53\u524d Lifecycle \u6dfb\u52a0\u5230\u5f53\u524d phase \u503c\u4e00\u6837\u7684 group \u5185"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Collections.sort(keys)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6309\u4f18\u5148\u7ea7\u542f\u52a8"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"phases.get(key).start()"}),"\uff1a\u904d\u5386\u6240\u6709\u7684 Lifecycle \u5bf9\u8c61\u5f00\u59cb\u542f\u52a8"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"doStart(this.lifecycleBeans, member.name, this.autoStartupOnly)"}),"\uff1a\u5e95\u5c42\u8c03\u7528\u8be5\u65b9\u6cd5\u542f\u52a8\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"bean = lifecycleBeans.remove(beanName)"}),"\uff1a \u786e\u4fdd Lifecycle \u53ea\u88ab\u542f\u52a8\u4e00\u6b21\uff0c\u5728\u4e00\u4e2a\u5206\u7ec4\u5185\u88ab\u542f\u52a8\u4e86\u5728\u5176\u4ed6\u5206\u7ec4\u5185\u5c31\u770b\u4e0d\u5230 Lifecycle \u4e86"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"dependenciesForBean = getBeanFactory().getDependenciesForBean(beanName)"}),"\uff1a\u83b7\u53d6\u5f53\u524d\u5373\u5c06\u88ab\u542f\u52a8\u7684 Lifecycle \u6240\u4f9d\u8d56\u7684\u5176\u4ed6 beanName\uff0c\u9700\u8981",(0,i.jsx)(e.strong,{children:"\u5148\u542f\u52a8\u6240\u4f9d\u8d56\u7684 bean"}),"\uff0c\u624d\u80fd\u542f\u52a8\u81ea\u8eab"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if ()"}),"\uff1a\u4f20\u5165\u7684\u53c2\u6570 autoStartupOnly \u4e3a true \u8868\u793a\u542f\u52a8 isAutoStartUp \u4e3a true \u7684 SmartLifecycle \u5bf9\u8c61\uff0c\u4e0d\u4f1a\u542f\u52a8\u666e\u901a\u7684\u751f\u547d\u5468\u671f\u7684\u5bf9\u8c61\uff1bfalse \u4ee3\u8868\u5168\u90e8\u542f\u52a8"]}),"\n",(0,i.jsxs)(e.li,{children:["bean.start()\uff1a",(0,i.jsx)(e.strong,{children:"\u8c03\u7528\u542f\u52a8\u65b9\u6cd5"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"publishEvent(new ContextRefreshedEvent(this))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u53d1\u5e03\u5bb9\u5668\u5237\u65b0\u5b8c\u6210\u4e8b\u4ef6"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"liveBeansView.registerApplicationContext(this)"}),"\uff1a\u66b4\u9732 Mbean"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8865\u5145\u751f\u547d\u5468\u671f stop() \u65b9\u6cd5\u7684\u8c03\u7528"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DefaultLifecycleProcessor.stop()\uff1a\u8c03\u7528 DefaultLifecycleProcessor.stopBeans()"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6\u5230\u6240\u6709\u5b9e\u73b0\u4e86 Lifecycle \u63a5\u53e3\u7684\u5bf9\u8c61\u5e76\u6309 phase \u6570\u503c\u5206\u7ec4\u7684"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"keys.sort(Collections.reverseOrder())"}),"\uff1a\u6309 phase \u964d\u5e8f\u6392\u5e8f Lifecycle \u63a5\u53e3\uff0c\u6700\u5148\u542f\u52a8\u7684\u6700\u665a\u5173\u95ed\uff08\u8d23\u4efb\u94fe\uff1f\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"phases.get(key).stop()"}),"\uff1a\u904d\u5386\u6240\u6709\u7684 Lifecycle \u5bf9\u8c61\u5f00\u59cb\u505c\u6b62"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"latch = new CountDownLatch(this.smartMemberCount)"}),"\uff1a\u521b\u5efa CountDownLatch\uff0c\u8bbe\u7f6e latch \u5185\u90e8\u7684\u503c\u4e3a\u5f53\u524d\u5206\u7ec4\u5185\u7684  smartMemberCount \u7684\u6570\u91cf"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"countDownBeanNames = Collections.synchronizedSet(new LinkedHashSet<>())"}),"\uff1a\u4fdd\u5b58\u5f53\u524d\u6b63\u5728\u5904\u7406\u5173\u95ed\u7684smartLifecycle \u7684 BeanName"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (LifecycleGroupMember member : this.members)"}),"\uff1a\u5904\u7406\u672c\u5206\u7ec4\u5185\u9700\u8981\u5173\u95ed\u7684 Lifecycle"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"doStop(this.lifecycleBeans, member.name, latch, countDownBeanNames)"}),"\uff1a\u771f\u6b63\u7684\u505c\u6b62\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getBeanFactory().getDependentBeans(beanName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u4f9d\u8d56\u5f53\u524d Lifecycle \u7684\u5176\u4ed6\u5bf9\u8c61\u7684 beanName"}),"\uff0c\u56e0\u4e3a\u5f53\u524d\u7684 Lifecycle \u5373\u5c06\u8981\u5173\u95ed\u4e86\uff0c\u6240\u6709\u7684\u4f9d\u8d56\u4e86\u5f53\u524d Lifecycle \u7684 bean \u4e5f\u8981\u5173\u95ed"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"countDownBeanNames.add(beanName)"}),"\uff1a\u5c06\u5f53\u524d SmartLifecycle beanName \u6dfb\u52a0\u5230 countDownBeanNames \u96c6\u5408\u5185\uff0c\u8be5\u96c6\u5408\u8868\u793a\u6b63\u5728\u5173\u95ed\u7684 SmartLifecycle"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bean.stop()"}),"\uff1a\u8c03\u7528\u505c\u6b62\u7684\u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u83b7\u53d6bean-1",children:"\u83b7\u53d6Bean"}),"\n",(0,i.jsx)(e.p,{children:"\u5355\u5b9e\u4f8b\uff1a\u5728\u5bb9\u5668\u542f\u52a8\u65f6\u521b\u5efa\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.p,{children:"\u591a\u5b9e\u4f8b\uff1a\u5728\u6bcf\u6b21\u83b7\u53d6\u7684\u65f6\u5019\u521b\u5efa\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.p,{children:["\u83b7\u53d6\u6d41\u7a0b\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 Bean \u65f6\u5148\u4ece\u5355\u4f8b\u6c60\u83b7\u53d6\uff0c\u5982\u679c\u6ca1\u6709\u5219\u8fdb\u884c\u7b2c\u4e8c\u6b21\u83b7\u53d6\uff0c\u5e76\u5e26\u4e0a\u5de5\u5382\u7c7b\u53bb\u521b\u5efa\u5e76\u6dfb\u52a0\u81f3\u5355\u4f8b\u6c60"})]}),"\n",(0,i.jsx)(e.p,{children:"Java \u542f\u52a8 Spring \u4ee3\u7801\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\nUserService userService = (UserService) context.getBean("userService");\n'})}),"\n",(0,i.jsx)(e.p,{children:"AbstractBeanFactory.doGetBean()\uff1a\u83b7\u53d6 Bean\uff0ccontext.getBean() \u8ffd\u8e2a\u5230\u6b64"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanName = transformedBeanName(name)"}),"\uff1aname \u53ef\u80fd\u662f\u4e00\u4e2a\u522b\u540d\uff0c\u91cd\u5b9a\u5411\u51fa\u6765\u771f\u5b9e beanName\uff1b\u4e5f\u53ef\u80fd\u662f\u4e00\u4e2a & \u5f00\u5934\u7684 name\uff0c\u8bf4\u660e\u8981\u83b7\u53d6\u7684 bean \u5b9e\u4f8b\u5bf9\u8c61\uff0c\u662f\u4e00\u4e2a FactoryBean \u5bf9\u8c61\uff08IOC \u539f\u7406 \u2192 \u6838\u5fc3\u7c7b\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"BeanFactoryUtils.transformedBeanName(name)"}),"\uff1a\u5224\u65ad\u662f\u54ea\u79cd name\uff0c\u8fd4\u56de\u622a\u53d6 & \u4ee5\u540e\u7684 name \u5e76\u653e\u5165\u7f13\u5b58\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"transformedBeanNameCache.computeIfAbsent"}),"\uff1a\u7f13\u5b58\u662f\u5e76\u53d1\u5b89\u5168\u96c6\u5408\uff0ckey == null || value == null \u65f6 put \u6210\u529f"]}),"\n",(0,i.jsx)(e.li,{children:"do while \u5faa\u73af\u4e00\u76f4\u53bb\u9664 & \u76f4\u5230\u4e0d\u518d\u542b\u6709 &"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"canonicalName(name)"}),'\uff1aaliasMap \u4fdd\u5b58\u522b\u540d\u4fe1\u606f\uff0c\u5176\u4e2d\u7684 do while \u903b\u8f91\u662f\u8fed\u4ee3\u67e5\u627e\uff0c\u6bd4\u5982 A \u522b\u540d\u53eb\u505a B\uff0c\u4f46\u662f B \u53c8\u6709\u522b\u540d\u53eb C\uff0c aliasMap \u4e3a {"C":"B", "B":"A"}\uff0cget(C) \u6700\u540e\u8fd4\u56de\u7684\u662f  A']}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DefaultSingletonBeanRegistry.getSingleton()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7b2c\u4e00\u6b21\u83b7\u53d6\u4ece\u7f13\u5b58\u6c60\u83b7\u53d6"}),"\uff08\u5faa\u73af\u4f9d\u8d56\u8be6\u89e3\u6b64\u4ee3\u7801\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f13\u5b58\u4e2d\u6709\u6570\u636e\u8fdb\u884c getObjectForBeanInstance() \u83b7\u53d6\u53ef\u4f7f\u7528\u7684 Bean\uff08\u672c\u8282\u7ed3\u675f\u90e8\u5206\u8be6\u89e3\u6b64\u51fd\u6570\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u7f13\u5b58\u4e2d\u6ca1\u6709\u6570\u636e\u8fdb\u884c\u4e0b\u9762\u7684\u903b\u8f91\u8fdb\u884c\u521b\u5efa"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(isPrototypeCurrentlyInCreation(beanName))"}),"\uff1a\u68c0\u67e5 bean \u662f\u5426\u5728\u539f\u578b\uff08Prototype\uff09\u6b63\u5728\u88ab\u521b\u5efa\u7684\u96c6\u5408\u4e2d\uff0c\u5982\u679c\u662f\u5c31\u62a5\u9519\uff0c\u8bf4\u660e\u4ea7\u751f\u4e86\u5faa\u73af\u4f9d\u8d56\uff0c",(0,i.jsx)(e.strong,{children:"\u539f\u578b\u6a21\u5f0f\u89e3\u51b3\u4e0d\u4e86\u5faa\u73af\u4f9d\u8d56"})]}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u56e0\uff1a\u5148\u52a0\u8f7d A\uff0c\u628a A \u52a0\u5165\u96c6\u5408\uff0cA \u4f9d\u8d56 B \u53bb\u52a0\u8f7d B\uff0cB \u53c8\u4f9d\u8d56 A\uff0c\u53bb\u52a0\u8f7d A\uff0c\u53d1\u73b0 A \u5728\u6b63\u5728\u521b\u5efa\u96c6\u5408\u4e2d\uff0c\u4ea7\u751f\u5faa\u73af\u4f9d\u8d56"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"markBeanAsCreated(beanName)"}),"\uff1a\u628a bean \u6807\u8bb0\u4e3a\u5df2\u7ecf\u521b\u5efa\uff0c",(0,i.jsx)(e.strong,{children:"\u9632\u6b62\u5176\u4ed6\u7ebf\u7a0b\u91cd\u65b0\u521b\u5efa Bean"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd = getMergedLocalBeanDefinition(beanName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u5408\u5e76\u7236 BD \u540e\u7684 BD \u5bf9\u8c61"}),"\uff0cBD \u662f\u76f4\u63a5\u7ee7\u627f\u7684\uff0c\u5408\u5e76\u540e\u7684 BD \u4fe1\u606f\u662f\u5305\u542b\u7236\u7c7b\u7684 BD \u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.mergedBeanDefinitions.get(beanName)"}),"\uff1a\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(bd.getParentName()==null)"}),"\uff1abeanName \u5bf9\u5e94 BD \u6ca1\u6709\u7236 BD \u5c31\u4e0d\u7528\u5904\u7406\u7ee7\u627f\uff0c\u5c01\u88c5\u4e3a RootBeanDefinition \u8fd4\u56de"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"parentBeanName = transformedBeanName(bd.getParentName())"}),"\uff1a\u5904\u7406\u7236 BD \u7684 name \u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(!beanName.equals(parentBeanName))"}),"\uff1a\u4e00\u822c\u60c5\u51b5\u7236\u5b50 BD \u7684\u540d\u79f0\u4e0d\u540c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"pbd = getMergedBeanDefinition(parentBeanName)"}),"\uff1a\u9012\u5f52\u8c03\u7528\uff0c\u6700\u7ec8\u8fd4\u56de\u7236 BD \u7684\u7236 BD \u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd = new RootBeanDefinition(pbd)"}),"\uff1a\u6309\u7167\u7236 BD \u4fe1\u606f\u521b\u5efa RootBeanDefinition \u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.overrideFrom(bd)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5b50 BD \u4fe1\u606f\u8986\u76d6 mbd"}),"\uff0c\u56e0\u4e3a\u662f\u8981\u4ee5\u5b50 BD \u4e3a\u57fa\u51c6\uff0c\u4e0d\u5b58\u5728\u7684\u624d\u53bb\u7236 BD \u5bfb\u627e\uff08",(0,i.jsx)(e.strong,{children:"\u7c7b\u4f3c Java \u7ee7\u627f"}),"\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.mergedBeanDefinitions.put(beanName, mbd)"}),"\uff1a\u653e\u5165\u7f13\u5b58"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"checkMergedBeanDefinition()"}),"\uff1a\u5224\u65ad\u5f53\u524d BD \u662f\u5426\u4e3a",(0,i.jsx)(e.strong,{children:"\u62bd\u8c61 BD"}),"\uff0c\u62bd\u8c61 BD \u4e0d\u80fd\u521b\u5efa\u5b9e\u4f8b\uff0c\u53ea\u80fd\u4f5c\u4e3a\u7236 BD \u88ab\u7ee7\u627f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.getDependsOn()"}),"\uff1a\u83b7\u53d6 bean \u6807\u7b7e depends-on"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(dependsOn != null)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u6240\u6709\u7684\u4f9d\u8d56\u52a0\u8f7d\uff0c\u89e3\u51b3\u4e0d\u4e86\u5faa\u73af\u4f9d\u8d56"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"isDependent(beanName, dep)"}),"\uff1a\u5224\u65ad\u5faa\u73af\u4f9d\u8d56\uff0c\u51fa\u73b0\u5faa\u73af\u4f9d\u8d56\u95ee\u9898\u62a5\u9519"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4e24\u4e2a Map\uff1a",(0,i.jsx)(e.code,{children:'<bean name="A" depends-on="B" ...>'})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"dependentBeanMap\uff1a\u8bb0\u5f55\u4f9d\u8d56\u4e86\u5f53\u524d beanName \u7684\u5176\u4ed6 beanName\uff08\u8c01\u4f9d\u8d56\u6211\uff0c\u6211\u8bb0\u5f55\u8c01\uff09"}),"\n",(0,i.jsx)(e.li,{children:"dependenciesForBeanMap\uff1a\u8bb0\u5f55\u5f53\u524d beanName \u4f9d\u8d56\u7684\u5176\u5b83 beanName"}),"\n",(0,i.jsx)(e.li,{children:'\u4ee5 B \u4e3a\u89c6\u89d2 dependentBeanMap {"B"\uff1a{"A"}}\uff0c\u4ee5 A \u4e3a\u89c6\u89d2 dependenciesForBeanMap {"A" :{"B"}}'}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"canonicalName(beanName)"}),"\uff1a\u5904\u7406 bean \u7684 name"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"dependentBeans = this.dependentBeanMap.get(canonicalName)"}),"\uff1a\u83b7\u53d6\u4f9d\u8d56\u4e86\u5f53\u524d bean \u7684 name"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (dependentBeans.contains(dependentBeanName))"}),"\uff1a\u4f9d\u8d56\u4e86\u5f53\u524d bean \u7684\u96c6\u5408\u4e2d\u662f\u5426\u6709\u8be5 name\uff0c\u6709\u5c31\u4ea7\u751f\u5faa\u73af\u4f9d\u8d56"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8fdb\u884c\u9012\u5f52\u5904\u7406\u6240\u6709\u7684\u5f15\u7528\uff1a\u5047\u5982 ",(0,i.jsx)(e.code,{children:'<bean name="A" dp="B"> <bean name="B" dp="C"> <bean name="C" dp="A">'})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"dependentBeanMap={A:{C}, B:{A}, C:{B}} \n// C \u4f9d\u8d56 A     \t\t\u5224\u65ad\u8c01\u4f9d\u8d56\u4e86C\t\t\t\t\u9012\u5f52\u5224\u65ad\t\t\t\t\u8c01\u4f9d\u8d56\u4e86B\nisDependent(C, A)  \u2192 C#dependentBeans={B} \u2192 isDependent(B, A); \u2192 B#dependentBeans={A} //\u8fd4\u56detrue\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registerDependentBean(dep, beanName)"}),"\uff1a\u628a bean \u548c\u4f9d\u8d56\u6ce8\u518c\u5230\u4e24\u4e2a Map \u4e2d\uff0c\u6ce8\u610f\u53c2\u6570\u7684\u4f4d\u7f6e\uff0c\u88ab\u4f9d\u8d56\u7684\u5728\u524d"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getBean(dep)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5148\u52a0\u8f7d\u4f9d\u8d56\u7684 Bean"}),"\uff0c\u53c8\u8fdb\u5165 doGetBean() \u7684\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (mbd.isSingleton())"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5224\u65ad bean \u662f\u5426\u662f\u5355\u4f8b\u7684 bean"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getSingleton(String, ObjectFactory<?>)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7b2c\u4e8c\u6b21\u83b7\u53d6\uff0c\u4f20\u5165\u4e00\u4e2a\u5de5\u5382\u5bf9\u8c61"}),"\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u66f4\u503e\u5411\u4e8e\u521b\u5efa\u5b9e\u4f8b\u5e76\u8fd4\u56de"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"sharedInstance = getSingleton(beanName, () -> {\n    return createBean(beanName, mbd, args);//\u521b\u5efa\uff0c\u8df3\u8f6c\u751f\u547d\u5468\u671f\n    //lambda\u8868\u8fbe\u5f0f\uff0c\u8c03\u7528\u4e86ObjectFactory\u7684getObject()\u65b9\u6cd5\uff0c\u5b9e\u9645\u56de\u8c03\u63a5\u53e3\u5b9e\u73b0\u7684\u662f createBean()\u65b9\u6cd5\u8fdb\u884c\u521b\u5efa\u5bf9\u8c61\n});\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"singletonObjects.get(beanName)"}),"\uff1a\u4ece\u4e00\u7ea7\u7f13\u5b58\u68c0\u67e5\u662f\u5426\u5df2\u7ecf\u88ab\u52a0\u8f7d\uff0c\u5355\u4f8b\u6a21\u5f0f\u590d\u7528\u5df2\u7ecf\u521b\u5efa\u7684 bean"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.singletonsCurrentlyInDestruction"}),"\uff1a\u5bb9\u5668\u9500\u6bc1\u65f6\u4f1a\u8bbe\u7f6e\u8fd9\u4e2a\u5c5e\u6027\u4e3a true\uff0c\u8fd9\u65f6\u5c31\u4e0d\u80fd\u518d\u521b\u5efa bean \u5b9e\u4f8b\u4e86"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beforeSingletonCreation(beanName)"}),"\uff1a\u68c0\u67e5\u6784\u9020\u6ce8\u5165\u7684\u4f9d\u8d56\uff0c",(0,i.jsx)(e.strong,{children:"\u6784\u9020\u53c2\u6570\u6ce8\u5165\u4ea7\u751f\u7684\u5faa\u73af\u4f9d\u8d56\u65e0\u6cd5\u89e3\u51b3"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"!this.singletonsCurrentlyInCreation.add(beanName)"}),"\uff1a\u5c06\u5f53\u524d beanName \u653e\u5165\u5230\u6b63\u5728\u521b\u5efa\u4e2d\u5355\u5b9e\u4f8b\u96c6\u5408\uff0c\u653e\u5165\u6210\u529f\u8bf4\u660e\u6ca1\u6709\u4ea7\u751f\u5faa\u73af\u4f9d\u8d56\uff0c\u5931\u8d25\u5219\u4ea7\u751f\u5faa\u73af\u4f9d\u8d56\uff0c\u8fdb\u5165\u5224\u65ad\u6761\u4ef6\u5185\u7684\u903b\u8f91\u629b\u51fa\u5f02\u5e38"]}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u56e0\uff1a\u52a0\u8f7d A\uff0c\u5411\u6b63\u5728\u521b\u5efa\u96c6\u5408\u4e2d\u6dfb\u52a0\u4e86 {A}\uff0c\u6839\u636e A \u7684\u6784\u9020\u65b9\u6cd5\u5b9e\u4f8b\u5316 A \u5bf9\u8c61\uff0c\u53d1\u73b0 A \u7684\u6784\u9020\u65b9\u6cd5\u4f9d\u8d56 B\uff0c\u7136\u540e\u52a0\u8f7d B\uff0cB \u6784\u9020\u65b9\u6cd5\u7684\u53c2\u6570\u4f9d\u8d56\u4e8e A\uff0c\u53c8\u53bb\u52a0\u8f7d A \u65f6\u6765\u5230\u5f53\u524d\u65b9\u6cd5\uff0c\u56e0\u4e3a\u521b\u5efa\u4e2d\u96c6\u5408\u5df2\u7ecf\u5b58\u5728 A\uff0c\u6240\u4ee5\u6dfb\u52a0\u5931\u8d25"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"singletonObject = singletonFactory.getObject()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa bean"}),"\uff08\u751f\u547d\u5468\u671f\u90e8\u5206\u8be6\u89e3\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u5b8c\u6210\u4ee5\u540e\uff0cBean \u5df2\u7ecf\u521d\u59cb\u5316\u597d\uff0c\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u53ef\u4f7f\u7528\u7684 Bean"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"afterSingletonCreation(beanName)"}),"\uff1a\u4ece\u6b63\u5728\u521b\u5efa\u4e2d\u7684\u96c6\u5408\u4e2d\u79fb\u51fa"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"addSingleton(beanName, singletonObject)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6dfb\u52a0\u4e00\u7ea7\u7f13\u5b58\u5355\u4f8b\u6c60\u4e2d\uff0c\u4ece\u4e8c\u7ea7\u4e09\u7ea7\u7f13\u5b58\u79fb\u9664"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bean = getObjectForBeanInstance"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5355\u5b9e\u4f8b\u53ef\u80fd\u662f\u666e\u901a\u5355\u5b9e\u4f8b\u6216\u8005 FactoryBean"}),"\uff0c\u5982\u679c\u662f FactoryBean \u5b9e\u4f8b\uff0c\u9700\u8981\u5224\u65ad name \u662f\u5e26 & \u8fd8\u662f\u4e0d\u5e26 &\uff0c\u5e26 & \u8bf4\u660e getBean \u83b7\u53d6 FactoryBean \u5bf9\u8c61\uff0c\u5426\u5219\u662f\u83b7\u53d6 FactoryBean \u5185\u90e8\u7ba1\u7406\u7684\u5b9e\u4f8b"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570 name \u662f\u672a\u5904\u7406 & \u7684 name\uff0cbeanName \u662f\u5904\u7406\u8fc7 & \u548c\u522b\u540d\u540e\u7684 name"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(BeanFactoryUtils.isFactoryDereference(name))"}),"\uff1a\u5224\u65ad doGetBean \u4e2d\u53c2\u6570 name \u524d\u662f\u5426\u5e26 &\uff0c\u4e0d\u662f\u5904\u7406\u540e\u7684"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(!(beanInstance instanceof FactoryBean) || BeanFactoryUtils.isFactoryDereference(name))"}),"\uff1aBean \u662f\u666e\u901a\u5355\u5b9e\u4f8b\u6216\u8005\u662f FactoryBean \u5c31\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\uff0c\u5426\u5219\u8fdb\u5165\u4e0b\u9762\u7684\u83b7\u53d6 ",(0,i.jsx)(e.strong,{children:"FactoryBean \u5185\u90e8\u7ba1\u7406\u7684\u5b9e\u4f8b"}),"\u7684\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getCachedObjectForFactoryBean(beanName)"}),"\uff1a\u5c1d\u8bd5\u5230\u7f13\u5b58\u83b7\u53d6\uff0c\u83b7\u53d6\u5230\u76f4\u63a5\u8fd4\u56de\uff0c\u83b7\u53d6\u4e0d\u5230\u8fdb\u884c\u4e0b\u9762\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (mbd == null && containsBeanDefinition(beanName))"}),"\uff1aSpring \u4e2d\u6709\u5f53\u524d beanName \u7684 BeanDefinition \u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd = getMergedLocalBeanDefinition(beanName)"}),"\uff1a\u83b7\u53d6\u5408\u5e76\u540e\u7684 BeanDefinition"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.isSynthetic()"}),"\uff1a\u9ed8\u8ba4\u503c\u662f false \u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u7528\u6237\u5bf9\u8c61\uff0c\u5982\u679c\u662f true \u8868\u793a\u662f\u7cfb\u7edf\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"object = getObjectFromFactoryBean(factory, beanName, !synthetic)"}),"\uff1a\u4ece\u5de5\u5382\u5185\u83b7\u53d6\u5b9e\u4f8b"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"factory.isSingleton() && containsSingleton(beanName)"}),"\uff1a\u5de5\u5382\u5185\u90e8\u7ef4\u62a4\u7684\u5bf9\u8c61\u662f\u5355\u5b9e\u4f8b\u5e76\u4e14\u4e00\u7ea7\u7f13\u5b58\u5b58\u5728\u8be5 bean"]}),"\n",(0,i.jsxs)(e.li,{children:["\u9996\u5148\u53bb\u7f13\u5b58\u4e2d\u83b7\u53d6\uff0c\u83b7\u53d6\u4e0d\u5230\u5c31",(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u5de5\u5382\u83b7\u53d6"}),"\u7136\u540e\u653e\u5165\u7f13\u5b58\uff0c\u8fdb\u884c\u5faa\u73af\u4f9d\u8d56\u5224\u65ad"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"else if (mbd.isPrototype())"}),"\uff1a",(0,i.jsx)(e.strong,{children:"bean \u662f\u539f\u578b\u7684 bean"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beforePrototypeCreation(beanName)"}),"\uff1a\u5f53\u524d\u7ebf\u7a0b\u6b63\u5728\u521b\u5efa\u7684\u539f\u578b\u5bf9\u8c61 beanName \u5b58\u5165 prototypesCurrentlyInCreation"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"curVal = this.prototypesCurrentlyInCreation.get()"}),"\uff1a\u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\u7684\u6b63\u5728\u521b\u5efa\u7684\u539f\u578b\u7c7b\u96c6\u5408"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.prototypesCurrentlyInCreation.set(beanName)"}),"\uff1a\u96c6\u5408\u4e3a\u7a7a\u5c31\u628a\u5f53\u524d beanName \u52a0\u5165"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (curVal instanceof String)"}),"\uff1a\u5df2\u7ecf\u6709\u7ebf\u7a0b\u76f8\u5173\u539f\u578b\u7c7b\u521b\u5efa\u4e86\uff0c\u628a\u5f53\u524d\u7684\u521b\u5efa\u7684\u52a0\u8fdb\u53bb"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"createBean(beanName, mbd, args)"}),"\uff1a\u521b\u5efa\u539f\u578b\u7c7b\u5bf9\u8c61\uff0c\u4e0d\u9700\u8981\u4e09\u7ea7\u7f13\u5b58"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"afterPrototypeCreation(beanName)"}),"\uff1a\u4ece\u6b63\u5728\u521b\u5efa\u4e2d\u7684\u96c6\u5408\u4e2d\u79fb\u9664\u8be5 beanName\uff0c ",(0,i.jsx)(e.strong,{children:"\u4e0e beforePrototypeCreation\u903b\u8f91\u76f8\u53cd"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"convertIfNecessary()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4f9d\u8d56\u68c0\u67e5"}),"\uff0c\u68c0\u67e5\u6240\u9700\u7684\u7c7b\u578b\u662f\u5426\u4e0e\u5b9e\u9645 bean \u5b9e\u4f8b\u7684\u7c7b\u578b\u5339\u914d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return (T) bean"}),"\uff1a\u8fd4\u56de\u521b\u5efa\u5b8c\u6210\u7684 bean"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u751f\u547d\u5468\u671f-2",children:"\u751f\u547d\u5468\u671f"}),"\n",(0,i.jsx)(e.h5,{id:"\u56db\u4e2a\u9636\u6bb5",children:"\u56db\u4e2a\u9636\u6bb5"}),"\n",(0,i.jsx)(e.p,{children:"Bean \u7684\u751f\u547d\u5468\u671f\uff1a\u5b9e\u4f8b\u5316 instantiation\uff0c\u586b\u5145\u5c5e\u6027 populate\uff0c\u521d\u59cb\u5316 initialization\uff0c\u9500\u6bc1 destruction"}),"\n",(0,i.jsx)(e.p,{children:"AbstractAutowireCapableBeanFactory.createBean()\uff1a\u8fdb\u5165 Bean \u751f\u547d\u5468\u671f\u7684\u6d41\u7a0b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resolvedClass = resolveBeanClass(mbd, beanName)"}),"\uff1a\u5224\u65ad mdb \u4e2d\u7684 class \u662f\u5426\u5df2\u7ecf",(0,i.jsx)(e.strong,{children:"\u52a0\u8f7d\u5230 JVM"}),"\uff0c\u5982\u679c\u672a\u52a0\u8f7d\u5219\u4f7f\u7528\u7c7b\u52a0\u8f7d\u5668\u5c06 beanName \u52a0\u8f7d\u5230 JVM\u4e2d\u5e76\u8fd4\u56de class \u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (resolvedClass != null && !mbd.hasBeanClass() && mbd.getBeanClassName() != null)"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u5c01\u88c5 mbd \u5e76\u628a resolveBeanClass \u8bbe\u7f6e\u5230 bd \u4e2d"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e8c\uff1ambd \u5728 resolveBeanClass \u4e4b\u524d\u662f\u5426\u6709 class"}),"\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e09\uff1ambd \u6709 className"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bean = resolveBeforeInstantiation(beanName, mbdToUse)"}),"\uff1a\u5b9e\u4f8b\u5316\u524d\u7684\u540e\u7f6e\u5904\u7406\u5668\u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u5b9e\u4f8b\u5bf9\u8c61\uff08\u4e0d\u662f AOP\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u81ea\u5b9a\u4e49\u7c7b\u7ee7\u627f InstantiationAwareBeanPostProcessor\uff0c\u91cd\u5199 postProcessBeforeInstantiation \u65b9\u6cd5\uff0c",(0,i.jsx)(e.strong,{children:"\u65b9\u6cd5\u903b\u8f91\u4e3a\u521b\u5efa\u5bf9\u8c61"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u5e76\u914d\u7f6e\u6587\u4ef6 ",(0,i.jsx)(e.code,{children:'<bean class="intefacePackage.MyInstantiationAwareBeanPostProcessor">'})," \u5bfc\u5165\u4e3a bean"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6761\u4ef6\u6210\u7acb\uff0c",(0,i.jsx)(e.strong,{children:"\u77ed\u8def\u64cd\u4f5c"}),"\uff0c\u76f4\u63a5 return bean"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object beanInstance = doCreateBean(beanName, mbdToUse, args)"}),"\uff1aDo it"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["AbstractAutowireCapableBeanFactory.",(0,i.jsx)(e.strong,{children:"doCreateBean"}),"(beanName, RootBeanDefinition, Object[] args)\uff1a\u521b\u5efa Bean"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"BeanWrapper instanceWrapper = null"}),"\uff1a",(0,i.jsx)(e.strong,{children:"Spring \u7ed9\u6240\u6709\u521b\u5efa\u7684 Bean \u5b9e\u4f8b\u5305\u88c5\u6210 BeanWrapper"}),"\uff0c\u5185\u90e8\u6700\u6838\u5fc3\u7684\u65b9\u6cd5\u662f\u83b7\u53d6\u5b9e\u4f8b\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u63a5\u53e3\u65b9\u6cd5\uff0c\u6bd4\u5982\u5c5e\u6027\u8bbf\u95ee\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"instanceWrapper = this.factoryBeanInstanceCache.remove(beanName)"}),"\uff1a\u5355\u4f8b\u5bf9\u8c61\u5c1d\u8bd5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\uff0c\u4f1a\u79fb\u9664\u7f13\u5b58"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"createBeanInstance()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u4e2d\u6ca1\u6709\u5b9e\u4f8b\u5c31\u8fdb\u884c\u521b\u5efa\u5b9e\u4f8b"}),"\uff08\u903b\u8f91\u590d\u6742\uff0c\u4e0b\u4e00\u5c0f\u8282\u8be6\u89e3\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!mbd.postProcessed)"}),"\uff1a\u6bcf\u4e2a bean \u53ea\u8fdb\u884c\u4e00\u6b21\u8be5\u903b\u8f91"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"applyMergedBeanDefinitionPostProcessors()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u540e\u7f6e\u5904\u7406\u5668\uff0c\u5408\u5e76 bd \u4fe1\u606f"}),"\uff0c\u63a5\u4e0b\u6765\u8981\u5c5e\u6027\u586b\u5145\u4e86"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AutowiredAnnotationBeanPostProcessor.postProcessMergedBeanDefinition()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u540e\u7f6e\u5904\u7406\u903b\u8f91\uff08@Autowired\uff09"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"metadata = findAutowiringMetadata(beanName, beanType, null)"}),"\uff1a\u63d0\u53d6\u5f53\u524d bean \u6574\u4e2a\u7ee7\u627f\u4f53\u7cfb\u5185\u7684 ",(0,i.jsx)(e.strong,{children:"@Autowired\u3001@Value\u3001@Inject"})," \u4fe1\u606f\uff0c\u5b58\u5165\u4e00\u4e2a InjectionMetadata \u5bf9\u8c61\uff0c\u4fdd\u5b58\u7740\u5f53\u524d bean \u4fe1\u606f\u548c\u8981\u81ea\u52a8\u6ce8\u5165\u7684\u5b57\u6bb5\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private final Class<?> targetClass;\t\t\t\t\t\t\t//\u5f53\u524d bean \nprivate final Collection<InjectedElement> injectedElements;\t//\u8981\u6ce8\u5165\u7684\u4fe1\u606f\u96c6\u5408\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"metadata = buildAutowiringMetadata(clazz)"}),"\uff1a\u67e5\u8be2\u5f53\u524d clazz \u611f\u5174\u8da3\u7684\u6ce8\u89e3\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ReflectionUtils.doWithLocalFields()"}),"\uff1a\u63d0\u53d6",(0,i.jsx)(e.strong,{children:"\u5b57\u6bb5"}),"\u7684\u6ce8\u89e3\u7684\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"findAutowiredAnnotation(field)"}),"\uff1a\u4ee3\u8868\u611f\u5174\u8da3\u7684\u6ce8\u89e3\u5c31\u662f\u90a3\u4e09\u79cd\u6ce8\u89e3\uff0c\u83b7\u53d6\u8fd9\u4e09\u79cd\u6ce8\u89e3\u7684\u5143\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ReflectionUtils.doWithLocalMethods()"}),"\uff1a\u63d0\u53d6",(0,i.jsx)(e.strong,{children:"\u65b9\u6cd5"}),"\u7684\u6ce8\u89e3\u7684\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"do{} while (targetClass != null && targetClass != Object.class)"}),"\uff1a\u5faa\u73af\u4ece\u7236\u7c7b\u4e2d\u89e3\u6790\uff0c\u76f4\u5230 Object \u7c7b"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.injectionMetadataCache.put(cacheKey, metadata)"}),"\uff1a\u5b58\u5165\u7f13\u5b58"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.postProcessed = true"}),"\uff1a\u8bbe\u7f6e\u4e3a true\uff0c\u4e0b\u6b21\u8bbf\u95ee\u8be5\u903b\u8f91\u4e0d\u4f1a\u518d\u8fdb\u5165"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"earlySingletonExposure = (mbd.isSingleton() && this.allowCircularReferences && isSingletonCurrentlyInCreation(beanName)"}),"\uff1a\u5355\u4f8b\u3001\u89e3\u51b3\u5faa\u73af\u5f15\u7528\u3001\u662f\u5426\u5728\u5355\u4f8b\u6b63\u5728\u521b\u5efa\u96c6\u5408\u4e2d"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"if (earlySingletonExposure) {\n    // \u3010\u653e\u5165\u4e09\u7ea7\u7f13\u5b58\u4e00\u4e2a\u5de5\u5382\u5bf9\u8c61\uff0c\u7528\u6765\u83b7\u53d6\u63d0\u524d\u5f15\u7528\u3011\n    addSingletonFactory(beanName, () -> getEarlyBeanReference(beanName, mbd, bean));\n    // lamda \u8868\u8fbe\u5f0f\uff0c\u7528\u6765\u83b7\u53d6\u63d0\u524d\u5f15\u7528\uff0c\u5faa\u73af\u4f9d\u8d56\u90e8\u5206\u8be6\u89e3\u8be5\u903b\u8f91\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" populateBean(beanName, mbd, instanceWrapper)"}),"\uff1a**\u5c5e\u6027\u586b\u5145\uff0c\u4f9d\u8d56\u6ce8\u5165\uff0c\u6574\u4f53\u903b\u8f91\u662f\u5148\u5904\u7406\u6807\u7b7e\u518d\u5904\u7406\u6ce8\u89e3\uff0c\u586b\u5145\u81f3 pvs \u4e2d\uff0c\u6700\u540e\u901a\u8fc7 apply \u65b9\u6cd5\u6700\u540e\u5b8c\u6210\u5c5e\u6027\u4f9d\u8d56\u6ce8\u5165\u5230 BeanWrapper **"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!ibp.postProcessAfterInstantiation(bw.getWrappedInstance(), beanName))"}),"\uff1a\u5b9e\u4f8b\u5316\u540e\u7684\u540e\u7f6e\u5904\u7406\u5668\uff0c\u9ed8\u8ba4\u8fd4\u56de true\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7c7b\u7ee7\u627f InstantiationAwareBeanPostProcessor \u4fee\u6539\u540e\u7f6e\u5904\u7406\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u4e3a false\uff0c\u4f7f continueWithPropertyPopulation \u4e3a false\uff0c",(0,i.jsx)(e.strong,{children:"\u4f1a\u5bfc\u81f4\u76f4\u63a5\u8fd4\u56de\uff0c\u4e0d\u8fdb\u884c\u5c5e\u6027\u7684\u6ce8\u5165"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!continueWithPropertyPopulation)"}),"\uff1a\u81ea\u5b9a\u4e49\u65b9\u6cd5\u8fd4\u56de\u503c\u4f1a\u9020\u6210\u8be5\u6761\u4ef6\u6210\u7acb\uff0c\u903b\u8f91\u4e3a\u76f4\u63a5\u8fd4\u56de\uff0c",(0,i.jsx)(e.strong,{children:"\u4e0d\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"PropertyValues pvs = (mbd.hasPropertyValues() ? mbd.getPropertyValues() : null)"}),"\uff1a\u5904\u7406\u4f9d\u8d56\u6ce8\u5165\u903b\u8f91\u5f00\u59cb"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.getResolvedAutowireMode() == ?"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6839\u636e bean \u6807\u7b7e\u914d\u7f6e\u7684 autowire"})," \u5224\u65ad\u662f BY_NAME \u6216\u8005 BY_TYPE"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"autowireByName(beanName, mbd, bw, newPvs)"}),"\uff1a\u6839\u636e\u5b57\u6bb5\u540d\u79f0\u53bb\u83b7\u53d6\u4f9d\u8d56\u7684 bean\uff0c\u8fd8\u6ca1\u6ce8\u5165\uff0c\u53ea\u662f\u6dfb\u52a0\u5230 pvs"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"propertyNames = unsatisfiedNonSimpleProperties(mbd, bw)"}),"\uff1abean \u5b9e\u4f8b\u4e2d\u6709\u8be5\u5b57\u6bb5\u548c\u8be5\u5b57\u6bb5\u7684 setter \u65b9\u6cd5\uff0c\u4f46\u662f\u5728 bd \u4e2d\u6ca1\u6709 property \u5c5e\u6027"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u62ff\u5230\u914d\u7f6e\u7684 property \u4fe1\u606f\u548c bean \u7684\u6240\u6709\u5b57\u6bb5\u4fe1\u606f"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"pd.getWriteMethod() != null"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5f53\u524d\u5b57\u6bb5\u662f\u5426\u6709 set \u65b9\u6cd5\uff0c\u914d\u7f6e\u7c7b\u6ce8\u5165\u7684\u65b9\u5f0f\u9700\u8981 set \u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"!isExcludedFromDependencyCheck(pd)"}),"\uff1a\u5f53\u524d\u5b57\u6bb5\u7c7b\u578b\u662f\u5426\u5728\u5ffd\u7565\u81ea\u52a8\u6ce8\u5165\u7684\u5217\u8868\u4e2d"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"!pvs.contains(pd.getName()"}),"\uff1a\u5f53\u524d\u5b57\u6bb5\u4e0d\u5728 xml \u6216\u8005\u5176\u4ed6\u65b9\u5f0f\u7684\u914d\u7f6e\u4e2d\uff0c\u4e5f\u5c31\u662f bd \u4e2d\u4e0d\u5b58\u5728\u5bf9\u5e94\u7684 property"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"!BeanUtils.isSimpleProperty(pd.getPropertyType()"}),"\uff1a\u662f\u5426\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c\u5185\u7f6e\u7684\u51e0\u79cd\u6570\u636e\u7c7b\u578b\uff0c\u57fa\u672c\u6570\u636e\u7c7b\u578b\u4e0d\u5141\u8bb8\u81ea\u52a8\u6ce8\u5165"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (containsBean(propertyName))"}),"\uff1aBeanFactory \u4e2d\u5b58\u5728\u5f53\u524d property \u7684 bean \u5b9e\u4f8b\uff0c\u8bf4\u660e\u627e\u5230\u5bf9\u5e94\u7684\u4f9d\u8d56\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getBean(propertyName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u62ff\u5230 propertyName \u5bf9\u5e94\u7684 bean \u5b9e\u4f8b"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"pvs.add(propertyName, bean)"}),"\uff1a\u586b\u5145\u5230 pvs \u4e2d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registerDependentBean(propertyName, beanName))"}),"\uff1a\u6dfb\u52a0\u5230\u4e24\u4e2a\u4f9d\u8d56 Map\uff08dependsOn\uff09\u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"autowireByType(beanName, mbd, bw, newPvs)"}),"\uff1a\u6839\u636e\u5b57\u6bb5\u7c7b\u578b\u53bb\u67e5\u627e\u4f9d\u8d56\u7684 bean"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"desc = new AutowireByTypeDependencyDescriptor(methodParam, eager)"}),"\uff1a\u4f9d\u8d56\u63cf\u8ff0\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"resolveDependency(desc, beanName, autowiredBeanNames, converter)"}),"\uff1a\u6839\u636e\u63cf\u8ff0\u4fe1\u606f\uff0c\u67e5\u627e\u4f9d\u8d56\u5bf9\u8c61\uff0c\u5bb9\u5668\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u5b9e\u4f8b\u4f46\u662f\u6709\u5bf9\u5e94\u7684 BD\uff0c\u4f1a\u8c03\u7528 getBean(Type) \u83b7\u53d6\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"pvs = newPvs"}),"\uff1anewPvs \u662f\u5904\u7406\u4e86\u4f9d\u8d56\u6570\u636e\u540e\u7684 pvs\uff0c\u6240\u4ee5\u8d4b\u503c\u7ed9 pvs"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"hasInstAwareBpps"}),"\uff1a\u8868\u793a\u5f53\u524d\u662f\u5426\u6709 InstantiationAwareBeanPostProcessors \u7684\u540e\u7f6e\u5904\u7406\u5668\uff08Autowired\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"pvsToUse = ibp.postProcessProperties(pvs, bw.getWrappedInstance(), beanName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"@Autowired \u6ce8\u89e3\u7684\u6ce8\u5165"}),"\uff0c\u8fd9\u4e2a\u4f20\u5165\u7684 pvs \u5bf9\u8c61\uff0c\u6700\u540e\u539f\u5c01\u4e0d\u52a8\u7684\u8fd4\u56de\uff0c\u4e0d\u4f1a\u6dfb\u52a0\u4e1c\u897f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"findAutowiringMetadata()"}),"\uff1a\u5305\u88c5\u7740\u5f53\u524d bd \u9700\u8981\u6ce8\u5165\u7684\u6ce8\u89e3\u4fe1\u606f\u96c6\u5408\uff0c",(0,i.jsx)(e.strong,{children:"\u4e09\u79cd\u6ce8\u89e3\u7684\u5143\u6570\u636e"}),"\uff0c\u76f4\u63a5\u7f13\u5b58\u83b7\u53d6"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"InjectionMetadata.InjectedElement.inject()"}),"\uff1a\u904d\u5386\u6ce8\u89e3\u4fe1\u606f\u89e3\u6790\u540e\u6ce8\u5165\u5230 Bean\uff0c\u65b9\u6cd5\u548c\u5b57\u6bb5\u7684\u6ce8\u5165\u5b9e\u73b0\u4e0d\u540c"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ee5\u5b57\u6bb5\u6ce8\u5165\u4e3a\u4f8b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"value = resolveFieldValue(field, bean, beanName)"}),"\uff1a\u5904\u7406\u5b57\u6bb5\u5c5e\u6027\u503c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"value = beanFactory.resolveDependency()"}),"\uff1a\u89e3\u51b3\u4f9d\u8d56"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"result = doResolveDependency()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u771f\u6b63\u5904\u7406\u81ea\u52a8\u6ce8\u5165\u4f9d\u8d56\u7684\u903b\u8f91"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object shortcut = descriptor.resolveShortcut(this)"}),"\uff1a\u9ed8\u8ba4\u8fd4\u56de null"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object value = getAutowireCandidateResolver().getSuggestedValue(descriptor)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 @Value \u7684\u503c"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"converter.convertIfNecessary(value, type, descriptor.getTypeDescriptor())"}),"\uff1a\u5982\u679c value \u4e0d\u662f null\uff0c\u5c31\u76f4\u63a5\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u8fd4\u56de\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"matchingBeans = findAutowireCandidates(beanName, type, descriptor)"}),"\uff1a\u5982\u679c value \u662f\u7a7a\u8bf4\u660e\u5b57\u6bb5\u662f\u5f15\u7528\u7c7b\u578b\uff0c",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 @Autowired \u7684 Bean"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// addCandidateEntry() \u2192 Object beanInstance = descriptor.resolveCandidate()\npublic Object resolveCandidate(String beanName, Class<?> requiredType, BeanFactory beanFactory) throws BeansException {\n\t// \u83b7\u53d6 bean\n    return beanFactory.getBean(beanName);\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ReflectionUtils.makeAccessible(field)"}),"\uff1a\u4fee\u6539\u8bbf\u95ee\u6743\u9650"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"field.set(bean, value)"}),"\uff1a\u83b7\u53d6\u5c5e\u6027\u8bbf\u95ee\u5668\u4e3a\u6b64 field \u5bf9\u8c61\u8d4b\u503c"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"applyPropertyValues()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06\u6240\u6709\u89e3\u6790\u7684 PropertyValues \u7684\u6ce8\u5165\u81f3 BeanWrapper \u5b9e\u4f8b\u4e2d"}),"\uff08\u6df1\u62f7\u8d1d\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (pvs.isEmpty())"}),"\uff1a\u6ce8\u89e3 @Autowired \u548c @Value \u6807\u6ce8\u7684\u4fe1\u606f\u5728\u540e\u7f6e\u5904\u7406\u7684\u903b\u8f91\u6ce8\u5165\u5b8c\u6210\uff0c\u6b64\u5904\u4e3a\u7a7a\u76f4\u63a5\u8fd4\u56de"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4e0b\u9762\u7684\u903b\u8f91\u8fdb\u884c XML \u914d\u7f6e\u7684\u5c5e\u6027\u7684\u6ce8\u5165\uff0c\u9996\u5148\u83b7\u53d6\u8f6c\u6362\u5668\u8fdb\u884c\u6570\u636e\u8f6c\u6362\uff0c\u7136\u540e",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 WriteMethod (set) \u65b9\u6cd5\u8fdb\u884c\u53cd\u5c04\u8c03\u7528"}),"\uff0c\u5b8c\u6210\u5c5e\u6027\u7684\u6ce8\u5165"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"initializeBean(String,Object,RootBeanDefinition)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521d\u59cb\u5316\uff0c\u5206\u4e3a\u914d\u7f6e\u6587\u4ef6\u548c\u5b9e\u73b0\u63a5\u53e3\u4e24\u79cd\u65b9\u5f0f"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"invokeAwareMethods(beanName, bean)"}),"\uff1a\u6839\u636e bean \u662f\u5426\u5b9e\u73b0 Aware \u63a5\u53e3\u6267\u884c\u521d\u59cb\u5316\u7684\u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"wrappedBean = applyBeanPostProcessorsBeforeInitialization"}),"\uff1a\u521d\u59cb\u5316\u524d\u7684\u540e\u7f6e\u5904\u7406\u5668\uff0c\u53ef\u4ee5\u7ee7\u627f\u63a5\u53e3\u91cd\u5199\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"processor.postProcessBeforeInitialization()"}),"\uff1a\u6267\u884c\u540e\u7f6e\u5904\u7406\u7684\u65b9\u6cd5\uff0c\u9ed8\u8ba4\u8fd4\u56de bean \u672c\u8eab"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (current == null) return result"}),"\uff1a\u91cd\u5199\u65b9\u6cd5\u8fd4\u56de null\uff0c\u4f1a\u9020\u6210\u540e\u7f6e\u5904\u7406\u7684\u77ed\u8def\uff0c\u76f4\u63a5\u8fd4\u56de"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"invokeInitMethods(beanName, wrappedBean, mbd)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u53cd\u5c04\u6267\u884c\u521d\u59cb\u5316\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"isInitializingBean = (bean instanceof InitializingBean)"}),'\uff1a\u521d\u59cb\u5316\u65b9\u6cd5\u7684\u5b9a\u4e49\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u81ea\u5b9a\u4e49\u7c7b\u5b9e\u73b0 InitializingBean \u63a5\u53e3\uff0c\u53e6\u4e00\u79cd\u662f\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e <bean id="..." class="..." init-method="init"/ >']}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:'isInitializingBean && (mbd == null || !mbd.isExternallyManagedInitMethod("afterPropertiesSet"))'}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6761\u4ef6\u4e00\uff1a\u5f53\u524d bean \u662f\u4e0d\u662f\u5b9e\u73b0\u4e86 InitializingBean"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6761\u4ef6\u4e8c\uff1aInitializingBean \u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5 afterPropertiesSet\uff0c\u5224\u65ad\u8be5\u65b9\u6cd5\u662f\u5426\u662f\u5bb9\u5668\u5916\u7ba1\u7406\u7684\u65b9\u6cd5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (mbd != null && bean.getClass() != NullBean.class)"}),"\uff1a\u6210\u7acb\u8bf4\u660e\u662f\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(!(\u63a5\u53e3\u6761\u4ef6))"}),"\u8868\u793a",(0,i.jsx)(e.strong,{children:"\u5982\u679c\u901a\u8fc7\u63a5\u53e3\u5b9e\u73b0\u4e86\u521d\u59cb\u5316\u65b9\u6cd5\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u5728\u8c03\u7528\u914d\u7f6e\u7c7b\u4e2d init-method \u5b9a\u4e49\u7684\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"((InitializingBean) bean).afterPropertiesSet()"}),"\uff1a\u8c03\u7528\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"invokeCustomInitMethod"}),"\uff1a\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"initMethodName = mbd.getInitMethodName()"}),"\uff1a\u83b7\u53d6\u65b9\u6cd5\u540d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Method initMethod = ()"}),"\uff1a\u6839\u636e\u65b9\u6cd5\u540d\u83b7\u53d6\u5230 init-method \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" methodToInvoke = ClassUtils.getInterfaceMethodIfPossible(initMethod)"}),"\uff1a\u5c06\u65b9\u6cd5\u8f6c\u6210\u4ece\u63a5\u53e3\u5c42\u9762\u83b7\u53d6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ReflectionUtils.makeAccessible(methodToInvoke)"}),"\uff1a\u8bbf\u95ee\u6743\u9650\u8bbe\u7f6e\u6210\u53ef\u8bbf\u95ee"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" methodToInvoke.invoke(bean)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u53cd\u5c04\u8c03\u7528\u521d\u59cb\u5316\u65b9\u6cd5"}),"\uff0c\u4ee5\u5f53\u524d bean \u4e3a\u89d2\u5ea6\u53bb\u8c03\u7528"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"wrappedBean = applyBeanPostProcessorsAfterInitialization"}),"\uff1a\u521d\u59cb\u5316\u540e\u7684\u540e\u7f6e\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AbstractAutoProxyCreator.postProcessAfterInitialization()"}),"\uff1a\u5982\u679c Bean \u88ab\u5b50\u7c7b\u6807\u8bc6\u4e3a\u8981\u4ee3\u7406\u7684 bean\uff0c\u5219\u4f7f\u7528\u914d\u7f6e\u7684\u62e6\u622a\u5668",(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61"}),"\uff0cAOP \u90e8\u5206\u8be6\u89e3"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5982\u679c\u4e0d\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\uff0c\u521b\u5efa\u52a8\u6001\u4ee3\u7406 bean \u5728\u6b64\u5904\u5b8c\u6210\uff1b\u5426\u5219\u771f\u6b63\u7684\u521b\u5efa\u9636\u6bb5\u662f\u5728\u5c5e\u6027\u586b\u5145\u65f6\u83b7\u53d6\u63d0\u524d\u5f15\u7528\u7684\u9636\u6bb5\uff0c",(0,i.jsx)(e.strong,{children:"\u5faa\u73af\u4f9d\u8d56"}),"\u8be6\u89e3\uff0c\u6e90\u7801\u5206\u6790\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u8be5\u96c6\u5408\u7528\u6765\u907f\u514d\u91cd\u590d\u5c06\u67d0\u4e2a bean \u751f\u6210\u4ee3\u7406\u5bf9\u8c61\uff0c\nprivate final Map<Object, Object> earlyProxyReferences = new ConcurrentHashMap<>(16);\n\npublic Object postProcessAfterInitialization(@Nullable Object bean,String bN){\n    if (bean != null) {\n        // cacheKey \u662f beanName \u6216\u8005\u52a0\u4e0a &\n        Object cacheKey = getCacheKey(bean.getClass(), beanName);y\n            if (this.earlyProxyReferences.remove(cacheKey) != bean) {\n                // \u53bb\u63d0\u524d\u4ee3\u7406\u5f15\u7528\u6c60\u4e2d\u5bfb\u627e\u8be5key\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\u4ee3\u7406\n                // \u5982\u679c\u5b58\u5728\u5219\u8bc1\u660e\u88ab\u4ee3\u7406\u8fc7\uff0c\u5219\u5224\u65ad\u662f\u5426\u662f\u5f53\u524d\u7684 bean\uff0c\u4e0d\u662f\u5219\u521b\u5efa\u4ee3\u7406\n                return wrapIfNecessary(bean, bN, cacheKey);\n            }\n    }\n    return bean;\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (earlySingletonExposure)"}),"\uff1a\u662f\u5426\u5141\u8bb8\u63d0\u524d\u5f15\u7528"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"earlySingletonReference = getSingleton(beanName, false)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4ece\u4e8c\u7ea7\u7f13\u5b58\u83b7\u53d6\u5b9e\u4f8b"}),"\uff0c\u653e\u5165\u4e00\u7ea7\u7f13\u5b58\u662f\u5728 doGetBean \u4e2d\u7684sharedInstance = getSingleton() \u903b\u8f91\u4e2d\uff0c\u6b64\u65f6\u5728 createBean \u7684\u903b\u8f91\u8fd8\u6ca1\u6709\u8fd4\u56de\uff0c\u6240\u4ee5\u4e00\u7ea7\u7f13\u5b58\u6ca1\u6709"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (earlySingletonReference != null)"}),"\uff1a\u5f53\u524d bean \u5b9e\u4f8b\u4ece\u4e8c\u7ea7\u7f13\u5b58\u4e2d\u83b7\u53d6\u5230\u4e86\uff0c\u8bf4\u660e",(0,i.jsx)(e.strong,{children:"\u4ea7\u751f\u4e86\u5faa\u73af\u4f9d\u8d56"}),"\uff0c\u5728\u5c5e\u6027\u586b\u5145\u9636\u6bb5\u4f1a\u63d0\u524d\u8c03\u7528\u4e09\u7ea7\u7f13\u5b58\u4e2d\u7684\u5de5\u5382\u751f\u6210 Bean \u7684\u4ee3\u7406\u5bf9\u8c61\uff08\u6216\u539f\u59cb\u5b9e\u4f8b\uff09\uff0c\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58\u4e2d\uff0c\u7136\u540e\u4f7f\u7528\u539f\u59cb bean \u7ee7\u7eed\u6267\u884c\u521d\u59cb\u5316"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" if (exposedObject == bean)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521d\u59cb\u5316\u540e\u7684 bean == \u521b\u5efa\u7684\u539f\u59cb\u5b9e\u4f8b"}),"\uff0c\u6761\u4ef6\u6210\u7acb\u7684\u4e24\u79cd\u60c5\u51b5\uff1a\u5f53\u524d\u7684\u771f\u5b9e\u5b9e\u4f8b\u4e0d\u9700\u8981\u88ab\u4ee3\u7406\uff1b\u5f53\u524d\u5b9e\u4f8b\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\u5df2\u7ecf\u88ab\u63d0\u524d\u4ee3\u7406\u8fc7\u4e86\uff0c\u521d\u59cb\u5316\u65f6\u7684\u540e\u7f6e\u5904\u7406\u5668\u76f4\u63a5\u8fd4\u56de bean \u539f\u5b9e\u4f8b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"exposedObject = earlySingletonReference"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u628a\u4ee3\u7406\u540e\u7684 Bean \u4f20\u7ed9 exposedObject \u7528\u6765\u8fd4\u56de\uff0c\u56e0\u4e3a\u53ea\u6709\u4ee3\u7406\u5bf9\u8c61\u624d\u5c01\u88c5\u4e86\u62e6\u622a\u5668\u94fe\uff0cmain \u65b9\u6cd5\u4e2d\u7528\u4ee3\u7406\u5bf9\u8c61\u8c03\u7528\u65b9\u6cd5\u65f6\u4f1a\u8fdb\u884c\u589e\u5f3a\uff0c\u4ee3\u7406\u662f\u5bf9\u539f\u59cb\u5bf9\u8c61\u7684\u5305\u88c5\uff0c\u6240\u4ee5\u8fd9\u91cc\u8fd4\u56de\u7684\u4ee3\u7406\u5bf9\u8c61\u4e2d\u542b\u6709\u5b8c\u6574\u7684\u539f\u5b9e\u4f8b\uff08\u5c5e\u6027\u586b\u5145\u548c\u521d\u59cb\u5316\u540e\u7684\uff09\uff0c\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u8fd4\u56de\u540e\u5916\u5c42\u65b9\u6cd5\u4f1a\u5c06\u5f53\u524d Bean \u653e\u5165\u4e00\u7ea7\u7f13\u5b58"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"else if (!this.allowRawInjectionDespiteWrapping && hasDependentBean(beanName))"}),"\uff1a\u662f\u5426\u6709\u5176\u4ed6 bean \u4f9d\u8d56\u5f53\u524d bean\uff0c\u6267\u884c\u5230\u8fd9\u91cc\u8bf4\u660e\u662f\u4e0d\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\u3001\u5b58\u5728\u589e\u5f3a\u4ee3\u7406\u7684\u903b\u8f91\uff0c\u4e5f\u5c31\u662f\u6b63\u5e38\u7684\u903b\u8f91"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"dependentBeans = getDependentBeans(beanName)"}),"\uff1a\u53d6\u5230\u4f9d\u8d56\u5f53\u524d bean \u7684\u5176\u4ed6 beanName"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!removeSingletonIfCreatedForTypeCheckOnly(dependentBean))"}),"\uff1a\u5224\u65ad dependentBean \u662f\u5426\u521b\u5efa\u5b8c\u6210"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (!this.alreadyCreated.contains(beanName))"}),"\uff1a\u6210\u7acb\u5f53\u524d bean \u5c1a\u672a\u521b\u5efa\u5b8c\u6210\uff0c\u5f53\u524d bean \u662f\u4f9d\u8d56exposedObject \u7684 bean\uff0c\u8fd4\u56de true"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return false"}),"\uff1a\u521b\u5efa\u5b8c\u6210\u8fd4\u56de false"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"actualDependentBeans.add(dependentBean)"}),"\uff1a\u521b\u5efa\u5b8c\u6210\u7684 dependentBean \u52a0\u5165\u8be5\u96c6\u5408"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!actualDependentBeans.isEmpty())"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u6709\u4f9d\u8d56\u4e8e\u5f53\u524d bean \u7684 bean \u5b9e\u4f8b\u521b\u5efa\u5b8c\u6210\uff0c\u4f46\u662f\u5f53\u524d\u7684 bean \u8fd8\u6ca1\u521b\u5efa\u5b8c\u6210\u8fd4\u56de\uff0c\u4f9d\u8d56\u5f53\u524d bean \u7684\u5916\u90e8 bean \u6301\u6709\u7684\u662f\u4e0d\u5b8c\u6574\u7684 bean\uff0c\u6240\u4ee5\u9700\u8981\u62a5\u9519"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registerDisposableBeanIfNecessary"}),"\uff1a\u5224\u65ad\u5f53\u524d bean \u662f\u5426\u9700\u8981",(0,i.jsx)(e.strong,{children:"\u6ce8\u518c\u6790\u6784\u51fd\u6570\u56de\u8c03"}),"\uff0c\u5f53\u5bb9\u5668\u9500\u6bc1\u65f6\u8fdb\u884c\u56de\u8c03"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"if (!mbd.isPrototype() && requiresDestruction(bean, mbd))"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679c\u662f\u539f\u578b prototype \u4e0d\u4f1a\u6ce8\u518c\u6790\u6784\u56de\u8c03\uff0c\u4e0d\u4f1a\u56de\u8c03\u8be5\u51fd\u6570\uff0c\u5bf9\u8c61\u7684\u56de\u6536\u7531 JVM \u7684 GC \u673a\u5236\u5b8c\u6210"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"requiresDestruction()\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DisposableBeanAdapter.hasDestroyMethod(bean, mbd)"}),"\uff1abd \u4e2d\u5b9a\u4e49\u4e86 DestroyMethod \u8fd4\u56de true"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"hasDestructionAwareBeanPostProcessors()"}),"\uff1a\u540e\u5904\u7406\u5668\u6846\u67b6\u51b3\u5b9a\u662f\u5426\u8fdb\u884c\u6790\u6784\u56de\u8c03"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"registerDisposableBean()"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8fdb\u5165\u8be5\u65b9\u6cd5\uff0c\u7ed9\u5f53\u524d\u5355\u5b9e\u4f8b\u6ce8\u518c\u56de\u8c03\u9002\u914d\u5668\uff0c\u9002\u914d\u5668\u5185\u6839\u636e\u5f53\u524d bean \u5b9e\u4f8b\u662f\u7ee7\u627f\u63a5\u53e3\uff08DisposableBean\uff09\u8fd8\u662f\u81ea\u5b9a\u4e49\u6807\u7b7e\u6765\u5224\u5b9a\u5177\u4f53\u8c03\u7528\u54ea\u4e2a\u65b9\u6cd5\u5b9e\u73b0"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.disposableBeans.put(beanName, bean)"}),"\uff1a\u5411\u9500\u6bc1\u96c6\u5408\u6dfb\u52a0\u5b9e\u4f8b"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u521b\u5efa\u5b9e\u4f8b",children:"\u521b\u5efa\u5b9e\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:"AbstractAutowireCapableBeanFactory.createBeanInstance(beanName, RootBeanDefinition, Object[] args)"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resolveBeanClass(mbd, beanName)"}),"\uff1a\u786e\u4fdd Bean \u7684 Class \u771f\u6b63\u7684\u88ab\u52a0\u8f7d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5224\u65ad\u7c7b\u7684\u8bbf\u95ee\u6743\u9650\u662f\u4e0d\u662f public\uff0c\u4e0d\u662f\u8fdb\u5165\u4e0b\u4e00\u4e2a\u5224\u65ad\uff0c\u662f\u5426\u5141\u8bb8\u8bbf\u95ee\u7c7b\u7684 non-public \u7684\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u5141\u8bb8\u5219\u62a5\u9519"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Supplier<?> instanceSupplier = mbd.getInstanceSupplier()"}),"\uff1a\u83b7\u53d6\u521b\u5efa\u5b9e\u4f8b\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u6ca1\u6709\u8fdb\u5165\u4e0b\u9762\u7684\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (mbd.getFactoryMethodName() != null)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5224\u65ad bean \u662f\u5426\u8bbe\u7f6e\u4e86 factory-method \u5c5e\u6027\uff0c\u4f18\u5148\u4f7f\u7528"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.bean,{className:"","factory-method":"",children:"\uff0c\u8bbe\u7f6e\u4e86\u8be5\u5c5e\u6027\u8fdb\u5165 factory-method \u65b9\u6cd5\u521b\u5efa\u5b9e\u4f8b"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resolved = false"}),"\uff1a\u4ee3\u8868 bd \u5bf9\u5e94\u7684\u6784\u9020\u4fe1\u606f\u662f\u5426\u5df2\u7ecf\u89e3\u6790\u6210\u53ef\u4ee5\u53cd\u5c04\u8c03\u7528\u7684\u6784\u9020\u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"autowireNecessary = false"}),"\uff1a\u662f\u5426\u81ea\u52a8\u5339\u914d\u6784\u9020\u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(mbd.resolvedConstructorOrFactoryMethod != null)"}),"\uff1a\u83b7\u53d6 bd \u7684\u6784\u9020\u4fe1\u606f\u8f6c\u5316\u6210\u53cd\u5c04\u8c03\u7528\u7684 method \u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"method \u4e3a null \u5219 resolved \u548c autowireNecessary \u90fd\u4e3a\u9ed8\u8ba4\u503c false"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"autowireNecessary = mbd.constructorArgumentsResolved"}),"\uff1a\u6784\u9020\u65b9\u6cd5\u6709\u53c2\u6570\uff0c\u8bbe\u7f6e\u4e3a true"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"bd \u5bf9\u5e94\u7684\u6784\u9020\u4fe1\u606f\u89e3\u6790\u5b8c\u6210\uff0c\u53ef\u4ee5\u76f4\u63a5\u53cd\u5c04\u8c03\u7528\u6784\u9020\u65b9\u6cd5\u4e86"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return autowireConstructor(beanName, mbd, null, null)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6709\u53c2\u6784\u9020"}),"\uff0c\u6839\u636e\u53c2\u6570\u5339\u914d\u6700\u4f18\u7684\u6784\u9020\u5668\u521b\u5efa\u5b9e\u4f8b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return instantiateBean(beanName, mbd)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u65e0\u53c2\u6784\u9020\u65b9\u6cd5\u901a\u8fc7\u53cd\u5c04\u521b\u5efa\u5b9e\u4f8b"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"SimpleInstantiationStrategy.instantiate()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u771f\u6b63\u7528\u6765\u5b9e\u4f8b\u5316\u7684\u51fd\u6570"}),"\uff08\u65e0\u8bba\u5982\u4f55\u90fd\u4f1a\u8d70\u5230\u8fd9\u4e00\u6b65\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!bd.hasMethodOverrides())"}),"\uff1a\u6ca1\u6709\u65b9\u6cd5\u91cd\u5199\u8986\u76d6"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"BeanUtils.instantiateClass(constructorToUse)"}),"\uff1a\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"Constructor.newInstance()"})," \u5b9e\u4f8b\u5316"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"instantiateWithMethodInjection(bd, beanName, owner)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6709\u65b9\u6cd5\u91cd\u5199\u91c7\u7528 CGLIB  \u5b9e\u4f8b\u5316"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"BeanWrapper bw = new BeanWrapperImpl(beanInstance)"}),"\uff1a\u5305\u88c5\u6210 BeanWrapper \u7c7b\u578b\u7684\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return bw"}),"\uff1a\u8fd4\u56de\u5b9e\u4f8b"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ctors = determineConstructorsFromBeanPostProcessors(beanClass, beanName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"@Autowired \u6ce8\u89e3"}),"\uff0c\u5bf9\u5e94\u7684\u540e\u7f6e\u5904\u7406\u5668 AutowiredAnnotationBeanPostProcessor \u903b\u8f91"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u4e86 lookup \u7684\u76f8\u5173\u903b\u8f91"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.candidateConstructorsCache.get(beanClass)"}),"\uff1a\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u6784\u9020\u65b9\u6cd5\uff0c\u7b2c\u4e00\u6b21\u83b7\u53d6\u4e3a null\uff0c\u8fdb\u5165\u4e0b\u9762\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"rawCandidates = beanClass.getDeclaredConstructors()"}),"\uff1a\u83b7\u53d6\u6240\u6709\u7684\u6784\u9020\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Constructor<?> requiredConstructor = null"}),"\uff1a\u552f\u4e00\u7684\u9009\u9879\u6784\u9020\u5668\uff0c",(0,i.jsx)(e.strong,{children:'@Autowired(required = "true")'})," \u65f6\u6709\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (Constructor<?> candidate : rawCandidates)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u6784\u9020\u5668\uff1a"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ann = findAutowiredAnnotation(candidate)"}),"\uff1a\u6709\u4e09\u79cd\u6ce8\u89e3\u4e2d\u7684\u4e00\u4e2a\u4f1a\u8fd4\u56de\u6ce8\u89e3\u7684\u5c5e\u6027"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u904d\u5386 this.autowiredAnnotationTypes \u4e2d\u7684\u4e09\u79cd\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'this.autowiredAnnotationTypes.add(Autowired.class);//\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\nthis.autowiredAnnotationTypes.add(Value.class);\nthis.autowiredAnnotationTypes.add(...ClassUtils.forName("javax.inject.Inject"));\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" AnnotatedElementUtils.getMergedAnnotationAttributes(ao, type)"}),"\uff1a\u83b7\u53d6\u6ce8\u89e3\u7684\u5c5e\u6027"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (attributes != null) return attributes"}),"\uff1a\u4efb\u610f\u4e00\u4e2a\u6ce8\u89e3\u5c5e\u6027\u4e0d\u4e3a\u7a7a\u5c31\u6ce8\u89e3\u8fd4\u56de"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (ann == null)"}),"\uff1a\u6ce8\u89e3\u5c5e\u6027\u4e3a\u7a7a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"userClass = ClassUtils.getUserClass(beanClass)"}),"\uff1a\u5982\u679c\u5f53\u524d beanClass \u662f\u4ee3\u7406\u5bf9\u8c61\uff0c\u65b9\u6cd5\u4e0a\u5c31\u5df2\u7ecf\u6ca1\u6709\u6ce8\u89e3\u4e86\uff0c\u6240\u4ee5",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u539f\u59cb\u7684\u7528\u6237\u7c7b\u578b\u91cd\u65b0\u83b7\u53d6\u8be5\u6784\u9020\u5668\u4e0a\u7684\u6ce8\u89e3\u5c5e\u6027"}),"\uff08",(0,i.jsx)(e.strong,{children:"\u4e8b\u52a1\u6ce8\u89e3\u5931\u6548"}),"\u4e5f\u662f\u8fd9\u4e2a\u539f\u7406\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (ann != null)"}),"\uff1a\u6ce8\u89e3\u5c5e\u6027\u4e0d\u4e3a\u7a7a\u4e86"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"required = determineRequiredStatus(ann)"}),"\uff1a\u83b7\u53d6 required \u5c5e\u6027\u7684\u503c"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"!ann.containsKey(this.requiredParameterName) || "}),"\uff1a\u5224\u65ad\u5c5e\u6027\u662f\u5426\u5305\u542b required\uff0c\u4e0d\u5305\u542b\u8fdb\u5165\u540e\u9762\u903b\u8f91"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.requiredParameterValue == ann.getBoolean(this.requiredParameterName)"}),"\uff1a\u83b7\u53d6\u5c5e\u6027\u503c\u8fd4\u56de"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (required)"}),"\uff1a\u4ee3\u8868\u6ce8\u89e3 @Autowired(required = true)"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!candidates.isEmpty())"}),"\uff1atrue \u4ee3\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u6784\u9020\u96c6\u5408\u4e0d\u662f\u7a7a\u4ee3\u8868\u53ef\u9009\u7684\u6784\u9020\u5668\u4e0d\u552f\u4e00\uff0c\u62a5\u9519"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"requiredConstructor = candidate"}),"\uff1a\u628a\u6784\u9020\u5668\u8d4b\u503c\u7ed9 requiredConstructor"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"candidates.add(candidate)"}),"\uff1a\u628a\u5f53\u524d\u6784\u9020\u65b9\u6cd5\u6dfb\u52a0\u81f3 candidates \u96c6\u5408"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" if(candidate.getParameterCount() == 0)"}),"\uff1a\u5f53\u524d\u904d\u5386\u7684\u6784\u9020\u5668\u7684\u53c2\u6570\u4e3a 0 \u4ee3\u8868\u6ca1\u6709\u53c2\u6570\uff0c\u662f",(0,i.jsx)(e.strong,{children:"\u9ed8\u8ba4\u6784\u9020\u5668"}),"\uff0c\u8d4b\u503c\u7ed9 defaultConstructor"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"candidateConstructors = candidates.toArray(new Constructor<?>[0])"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06\u6784\u9020\u5668\u8f6c\u6210\u6570\u7ec4\u8fd4\u56de"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(ctors != null)"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u4ee3\u8868\u6307\u5b9a\u4e86",(0,i.jsx)(e.strong,{children:"\u6784\u9020\u65b9\u6cd5\u6570\u7ec4"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.getResolvedAutowireMode() == AUTOWIRE_CONSTRUCTOR"}),"\uff1a",(0,i.jsx)(e.bean,{autowire:"",children:" \u6807\u7b7e\u5185 autowiremode \u7684\u5c5e\u6027\u503c\uff0c\u9ed8\u8ba4\u662f no\uff0cAUTOWIRE_CONSTRUCTOR \u4ee3\u8868\u9009\u62e9\u6700\u4f18\u7684\u6784\u9020\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mbd.hasConstructorArgumentValues()"}),"\uff1abean \u4fe1\u606f\u4e2d\u662f\u5426\u914d\u7f6e\u4e86\u6784\u9020\u53c2\u6570\u7684\u503c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"!ObjectUtils.isEmpty(args)"}),"\uff1agetBean \u65f6\uff0c\u6307\u5b9a\u4e86\u53c2\u6570 arg"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return autowireConstructor(beanName, mbd, ctors, args)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u9009\u62e9\u6700\u4f18\u7684\u6784\u9020\u5668\u8fdb\u884c\u521b\u5efa\u5b9e\u4f8b"}),"\uff08\u590d\u6742\uff0c\u4e0d\u5efa\u8bae\u7814\u7a76\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"beanFactory.initBeanWrapper(bw)"}),"\uff1a\u5411 BeanWrapper \u4e2d\u6ce8\u518c\u8f6c\u6362\u5668\uff0c\u5411\u5de5\u5382\u4e2d\u6ce8\u518c\u5c5e\u6027\u7f16\u8f91\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Constructor<?> constructorToUse = null"}),"\uff1a\u5b9e\u4f8b\u5316\u53cd\u5c04\u6784\u9020\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ArgumentsHolder argsHolderToUse"}),"\uff1a\u5b9e\u4f8b\u5316\u65f6\u771f\u6b63\u53bb\u7528\u7684\u53c2\u6570\uff0c\u5e76\u6301\u6709\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"rawArguments \u662f\u8f6c\u6362\u524d\u7684\u53c2\u6570\uff0carguments \u662f\u7c7b\u578b\u8f6c\u6362\u5b8c\u6210\u7684\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object[] argsToUse"}),"\uff1a\u53c2\u6570\u5b9e\u4f8b\u5316\u65f6\u4f7f\u7528\u7684\u53c2\u6570"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object[] argsToResolve"}),"\uff1a\u8868\u793a\u6784\u9020\u5668\u53c2\u6570\u505a\u8f6c\u6362\u540e\u7684\u53c2\u6570\u5f15\u7528"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (constructorToUse != null && mbd.constructorArgumentsResolved)"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e00\u6210\u7acb\u8bf4\u660e\u5f53\u524d bd \u751f\u6210\u7684\u5b9e\u4f8b\u4e0d\u662f\u7b2c\u4e00\u6b21\uff0c\u7f13\u5b58\u4e2d\u6709\u89e3\u6790\u597d\u7684\u6784\u9020\u5668\u65b9\u6cd5\u53ef\u4ee5\u76f4\u63a5\u62ff\u6765\u53cd\u5c04\u8c03\u7528"}),"\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e8c\u6210\u7acb\u8bf4\u660e\u6784\u9020\u5668\u53c2\u6570\u5df2\u7ecf\u89e3\u6790\u8fc7\u4e86"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"argsToUse = resolvePreparedArguments()"}),"\uff1aargsToResolve \u4e0d\u662f\u5b8c\u5168\u89e3\u6790\u597d\u7684\uff0c\u8fd8\u9700\u8981\u7ee7\u7eed\u89e3\u6790"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (constructorToUse == null || argsToUse == null)"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u7f13\u5b58\u673a\u5236\u5931\u8d25\uff0c\u8fdb\u5165\u6784\u9020\u5668\u5339\u914d\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Constructor<?>[] candidates = chosenCtors"}),"\uff1achosenCtors  \u53ea\u6709\u5728\u6784\u9020\u65b9\u6cd5\u4e0a\u6709 autowaire \u4e09\u79cd\u6ce8\u89e3\u65f6\u624d\u6709\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (candidates == null)"}),"\uff1acandidates \u4e3a\u7a7a\u5c31\u6839\u636e beanClass \u662f\u5426\u5141\u8bb8\u8bbf\u95ee\u975e\u516c\u5f00\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u6784\u9020\u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (candidates.length == 1 && explicitArgs == null && !mbd.hasConstructorArgumentValues())"}),"\uff1a\u9ed8\u8ba4\u65e0\u53c2"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bw.setBeanInstance(instantiate())"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u65e0\u53c2\u6784\u9020\u5668\u53cd\u5c04\u8c03\u7528\uff0c\u521b\u5efa\u51fa\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u8bbe\u7f6e\u5230 BeanWrapper \u4e2d\u53bb"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"boolean autowiring"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u9700\u8981\u9009\u62e9\u6700\u4f18\u7684\u6784\u9020\u5668"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"cargs = mbd.getConstructorArgumentValues()"}),"\uff1a\u83b7\u53d6\u53c2\u6570\u503c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resolvedValues = new ConstructorArgumentValues()"}),"\uff1a\u83b7\u53d6\u5df2\u7ecf\u89e3\u6790\u540e\u7684\u6784\u9020\u5668\u53c2\u6570\u503c"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"final Map<Integer, ValueHolder> indexedArgumentValues"}),"\uff1akey \u662f index\uff0c value \u662f\u503c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"final List<ValueHolder> genericArgumentValues"}),"\uff1a\u6ca1\u6709 index \u7684\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"minNrOfArgs = resolveConstructorArguments(..,resolvedValues)"}),"\uff1a\u4ece bd \u4e2d\u89e3\u6790\u5e76\u83b7\u53d6\u6784\u9020\u5668\u53c2\u6570\u7684\u4e2a\u6570"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"valueResolver.resolveValueIfNecessary()"}),"\uff1a\u5c06\u5f15\u7528\u8f6c\u6362\u6210\u771f\u5b9e\u7684\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"resolvedValueHolder.setSource(valueHolder)"}),"\uff1a\u5c06\u5bf9\u8c61\u586b\u5145\u81f3 ValueHolder \u4e2d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" resolvedValues.addIndexedArgumentValue()"}),"\uff1a\u5c06\u53c2\u6570\u503c\u5c01\u88c5\u81f3 resolvedValues \u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AutowireUtils.sortConstructors(candidates)"}),"\uff1a\u6392\u5e8f\u89c4\u5219 public > \u975e\u516c\u5f00\u7684 > \u53c2\u6570\u591a\u7684 > \u53c2\u6570\u5c11\u7684"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" int minTypeDiffWeight = Integer.MAX_VALUE"}),"\uff1a\u503c\u8d8a\u4f4e\u8bf4\u660e\u6784\u9020\u5668",(0,i.jsx)(e.strong,{children:"\u53c2\u6570\u5217\u8868\u7c7b\u578b"}),"\u548c\u6784\u9020\u53c2\u6570\u7684\u5339\u914d\u5ea6\u8d8a\u9ad8"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Set<Constructor<?>> ambiguousConstructors"}),"\uff1a\u6a21\u68f1\u4e24\u53ef\u7684\u6784\u9020\u5668\uff0c\u4e24\u4e2a\u6784\u9020\u5668\u5339\u914d\u5ea6\u76f8\u7b49\u65f6\u653e\u5165"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (Constructor<?> candidate : candidates)"}),"\uff1a\u904d\u5386\u7b5b\u9009\u51fa minTypeDiffWeight \u6700\u4f4e\u7684\u6784\u9020\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Class<?>[] paramTypes = candidate.getParameterTypes()"}),"\uff1a\u83b7\u53d6\u5f53\u524d\u5904\u7406\u7684\u6784\u9020\u5668\u7684\u53c2\u6570\u7c7b\u578b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if()"}),"\uff1acandidates \u662f\u6392\u8fc7\u5e8f\u7684\uff0c\u5f53\u524d\u7b5b\u9009\u51fa\u6765\u7684\u6784\u9020\u5668\u7684\u4f18\u5148\u7ea7\u4e00\u5b9a\u662f\u4f18\u5148\u4e8e\u540e\u9762\u7684 constructor"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (paramTypes.length < minNrOfArgs)"}),"\uff1a\u9700\u6c42\u7684\u5c0f\u4e8e\u7ed9\u7684\uff0c\u4e0d\u5339\u914d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"int typeDiffWeight"}),"\uff1a\u83b7\u53d6\u5339\u914d\u5ea6"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"mbd.isLenientConstructorResolution()"}),"\uff1atrue \u8868\u793a ambiguousConstructors \u5141\u8bb8\u6709\u6570\u636e\uff0cfalse \u4ee3\u8868\u4e0d\u5141\u8bb8\u6709\u6570\u636e\uff0c\u6709\u6570\u636e\u5c31\u62a5\u9519\uff08LenientConstructorResolution\uff1a\u5bbd\u677e\u7684\u6784\u9020\u51fd\u6570\u89e3\u6790\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"argsHolder.getTypeDifferenceWeight(paramTypes)"}),"\uff1a\u9009\u62e9\u53c2\u6570\u8f6c\u6362\u524d\u548c\u8f6c\u6362\u540e\u5339\u914d\u5ea6\u6700\u4f4e\u7684\uff0c\u5faa\u73af\u5411\u7236\u7c7b\u4e2d\u5bfb\u627e\u8be5\u65b9\u6cd5\uff0c\u76f4\u5230\u5bfb\u627e\u5230 Obejct \u7c7b"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" if (typeDiffWeight < minTypeDiffWeight)"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d\u5faa\u73af\u5904\u7406\u7684\u6784\u9020\u5668\u66f4\u4f18"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"else if (constructorToUse != null && typeDiffWeight == minTypeDiffWeight)"}),"\uff1a\u5f53\u524d\u5904\u7406\u7684\u6784\u9020\u5668\u7684\u8ba1\u7b97\u51fa\u6765\u7684 DiffWeight \u4e0e\u4e0a\u4e00\u6b21\u7b5b\u9009\u51fa\u6765\u7684\u6700\u4f18\u6784\u9020\u5668\u7684\u503c\u4e00\u81f4\uff0c\u8bf4\u660e\u6709\u6a21\u68f1\u4e24\u53ef\u7684\u60c5\u51b5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (constructorToUse == null)"}),"\uff1a\u672a\u627e\u5230\u53ef\u4ee5\u4f7f\u7528\u7684\u6784\u9020\u5668\uff0c\u62a5\u9519"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" else if (ambiguousConstructors != null && !mbd.isLenientConstructorResolution())"}),"\uff1a\u6a21\u68f1\u4e24\u53ef\u6709\u6570\u636e\uff0cLenientConstructorResolution == false\uff0c\u6240\u4ee5\u62a5\u9519"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"argsHolderToUse.storeCache(mbd, constructorToUse)"}),"\uff1a\u5339\u914d\u6210\u529f\uff0c\u8fdb\u884c\u7f13\u5b58\uff0c\u65b9\u4fbf\u540e\u6765\u8005\u4f7f\u7528\u8be5 bd \u5b9e\u4f8b\u5316"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" bw.setBeanInstance(instantiate(beanName, mbd, constructorToUse, argsToUse))"}),"\uff1a\u5339\u914d\u6210\u529f\u8c03\u7528 instantiate \u521b\u5efa\u51fa\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u8bbe\u7f6e\u5230 BeanWrapper \u4e2d\u53bb"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return instantiateBean(beanName, mbd)"}),"\uff1a\u9ed8\u8ba4\u8d70\u5230\u8fd9\u91cc"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5faa\u73af\u4f9d\u8d56",children:"\u5faa\u73af\u4f9d\u8d56"}),"\n",(0,i.jsx)(e.h5,{id:"\u5faa\u73af\u5f15\u7528",children:"\u5faa\u73af\u5f15\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u5faa\u73af\u4f9d\u8d56\uff1a\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\u4e4b\u95f4\u5b58\u5728\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u8fd9\u79cd\u4f9d\u8d56\u5173\u7cfb\u6784\u6210\u4e00\u4e2a\u73af\u5f62\u8c03\u7528"}),"\n",(0,i.jsx)(e.p,{children:"Spring \u5faa\u73af\u4f9d\u8d56\u6709\u56db\u79cd\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"DependsOn \u4f9d\u8d56\u52a0\u8f7d\u3010\u65e0\u6cd5\u89e3\u51b3\u3011\uff08\u4e24\u79cd Map\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u539f\u578b\u6a21\u5f0f Prototype \u5faa\u73af\u4f9d\u8d56\u3010\u65e0\u6cd5\u89e3\u51b3\u3011\uff08\u6b63\u5728\u521b\u5efa\u96c6\u5408\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5355\u4f8b Bean \u5faa\u73af\u4f9d\u8d56\uff1a\u6784\u9020\u53c2\u6570\u4ea7\u751f\u4f9d\u8d56\u3010\u65e0\u6cd5\u89e3\u51b3\u3011\uff08\u6b63\u5728\u521b\u5efa\u96c6\u5408\uff0cgetSingleton() \u903b\u8f91\u4e2d\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5355\u4f8b Bean \u5faa\u73af\u4f9d\u8d56\uff1asetter \u4ea7\u751f\u4f9d\u8d56\u3010\u53ef\u4ee5\u89e3\u51b3\u3011"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\uff1a\u63d0\u524d\u5f15\u7528\uff0c\u63d0\u524d\u66b4\u9732\u521b\u5efa\u4e2d\u7684 Bean"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Spring \u5148\u5b9e\u4f8b\u5316 A\uff0c\u62ff\u5230 A \u7684\u6784\u9020\u65b9\u6cd5\u53cd\u5c04\u521b\u5efa\u51fa\u6765 A \u7684\u65e9\u671f\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u88ab\u5305\u88c5\u6210 ObjectFactory \u5bf9\u8c61\uff0c\u653e\u5165\u4e09\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsx)(e.li,{children:"\u5904\u7406 A \u7684\u4f9d\u8d56\u6570\u636e\uff0c\u68c0\u67e5\u53d1\u73b0 A \u4f9d\u8d56 B \u5bf9\u8c61\uff0c\u6240\u4ee5 Spring \u5c31\u4f1a\u53bb\u6839\u636e B \u7c7b\u578b\u5230\u5bb9\u5668\u4e2d\u53bb getBean(B)\uff0c\u8fd9\u91cc\u4ea7\u751f\u9012\u5f52"}),"\n",(0,i.jsx)(e.li,{children:"\u62ff\u5230 B \u7684\u6784\u9020\u65b9\u6cd5\uff0c\u8fdb\u884c\u53cd\u5c04\u521b\u5efa\u51fa\u6765 B \u7684\u65e9\u671f\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u4e5f\u4f1a\u628a B \u5305\u88c5\u6210 ObjectFactory \u5bf9\u8c61\uff0c\u653e\u5230\u4e09\u7ea7\u7f13\u5b58\uff0c\u5904\u7406 B \u7684\u4f9d\u8d56\u6570\u636e\uff0c\u68c0\u67e5\u53d1\u73b0 B \u4f9d\u8d56\u4e86 A \u5bf9\u8c61\uff0c\u7136\u540e Spring \u5c31\u4f1a\u53bb\u6839\u636e A \u7c7b\u578b\u5230\u5bb9\u5668\u4e2d\u53bb getBean(A.class)"}),"\n",(0,i.jsx)(e.li,{children:"\u8fd9\u65f6\u4ece\u4e09\u7ea7\u7f13\u5b58\u4e2d\u83b7\u53d6\u5230 A \u7684\u65e9\u671f\u5bf9\u8c61\u8fdb\u5165\u5c5e\u6027\u586b\u5145"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5faa\u73af\u4f9d\u8d56\u7684\u4e09\u7ea7\u7f13\u5b58\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u4e00\u7ea7\u7f13\u5b58\uff1a\u5b58\u653e\u6240\u6709\u521d\u59cb\u5316\u5b8c\u6210\u5355\u5b9e\u4f8b bean\uff0c\u5355\u4f8b\u6c60\uff0ckey\u662fbeanName\uff0cvalue\u662f\u5bf9\u5e94\u7684\u5355\u5b9e\u4f8b\u5bf9\u8c61\u5f15\u7528\nprivate final Map<String, Object> singletonObjects = new ConcurrentHashMap<>(256);\n\n//\u4e8c\u7ea7\u7f13\u5b58\uff1a\u5b58\u653e\u5b9e\u4f8b\u5316\u672a\u8fdb\u884c\u521d\u59cb\u5316\u7684 Bean\uff0c\u63d0\u524d\u5f15\u7528\u6c60\nprivate final Map<String, Object> earlySingletonObjects = new HashMap<>(16);\n\n/** Cache of singleton factories: bean name to ObjectFactory. 3*/\nprivate final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<>(16);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3a\u4ec0\u4e48\u9700\u8981\u4e09\u7ea7\u7f13\u5b58\uff1f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5faa\u73af\u4f9d\u8d56\u89e3\u51b3\u9700\u8981\u63d0\u524d\u5f15\u7528\u52a8\u6001\u4ee3\u7406\u5bf9\u8c61\uff0cAOP \u52a8\u6001\u4ee3\u7406\u662f\u5728 Bean \u521d\u59cb\u5316\u540e\u7684\u540e\u7f6e\u5904\u7406\u4e2d\u8fdb\u884c\uff0c\u8fd9\u65f6\u7684 bean \u5df2\u7ecf\u662f\u6210\u54c1\u5bf9\u8c61\u3002\u56e0\u4e3a\u9700\u8981\u63d0\u524d\u8fdb\u884c\u52a8\u6001\u4ee3\u7406\uff0c\u4e09\u7ea7\u7f13\u5b58\u7684 ObjectFactory \u63d0\u524d\u4ea7\u751f\u9700\u8981\u4ee3\u7406\u7684\u5bf9\u8c61\uff0c\u628a\u63d0\u524d\u5f15\u7528\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsxs)(e.li,{children:["\u5982\u679c\u53ea\u6709\u4e8c\u7ea7\u7f13\u5b58\uff0c\u63d0\u524d\u5f15\u7528\u5c31\u76f4\u63a5\u653e\u5165\u4e86\u4e00\u7ea7\u7f13\u5b58\uff0c\u7136\u540e Bean \u521d\u59cb\u5316\u5b8c\u6210\u540e\u53c8\u4f1a\u653e\u5165\u4e00\u7ea7\u7f13\u5b58\uff0c\u4ea7\u751f\u6570\u636e\u8986\u76d6\uff0c",(0,i.jsx)(e.strong,{children:"\u5bfc\u81f4\u63d0\u524d\u5f15\u7528\u7684\u5bf9\u8c61\u548c\u4e00\u7ea7\u7f13\u5b58\u4e2d\u7684\u5e76\u4e0d\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61"})]}),"\n",(0,i.jsxs)(e.li,{children:["\u4e00\u7ea7\u7f13\u5b58\u53ea\u80fd\u5b58\u653e\u5b8c\u6574\u7684\u5355\u5b9e\u4f8b\uff0c",(0,i.jsx)(e.strong,{children:"\u4e3a\u4e86\u4fdd\u8bc1 Bean \u7684\u751f\u547d\u5468\u671f\u4e0d\u88ab\u7834\u574f"}),"\uff0c\u4e0d\u80fd\u5c06\u672a\u521d\u59cb\u5316\u7684 Bean \u66b4\u9732\u5230\u4e00\u7ea7\u7f13\u5b58"]}),"\n",(0,i.jsxs)(e.li,{children:["\u82e5\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\uff0c",(0,i.jsx)(e.strong,{children:"\u540e\u7f6e\u5904\u7406\u4e0d\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff0c\u771f\u6b63\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\u7684\u8fc7\u7a0b\u662f\u5728 getBean(B) \u7684\u9636\u6bb5\u4e2d"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e09\u7ea7\u7f13\u5b58\u4e00\u5b9a\u4f1a\u521b\u5efa\u63d0\u524d\u5f15\u7528\u5417\uff1f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u51fa\u73b0\u5faa\u73af\u4f9d\u8d56\u5c31\u4f1a\u53bb\u4e09\u7ea7\u7f13\u5b58\u83b7\u53d6\u63d0\u524d\u5f15\u7528\uff0c\u4e0d\u51fa\u73b0\u5c31\u4e0d\u4f1a\uff0c\u8d70\u6b63\u5e38\u7684\u903b\u8f91\uff0c\u521b\u5efa\u5b8c\u6210\u76f4\u63a5\u653e\u5165\u4e00\u7ea7\u7f13\u5b58"}),"\n",(0,i.jsxs)(e.li,{children:["\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\uff0c\u5c31\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58\uff0c\u5982\u679c\u6ca1\u6709\u589e\u5f3a\u65b9\u6cd5\u5c31\u8fd4\u56de createBeanInstance \u521b\u5efa\u7684\u5b9e\u4f8b\uff0c\u56e0\u4e3a addSingletonFactory \u53c2\u6570\u4e2d\u4f20\u5165\u4e86\u5b9e\u4f8b\u5316\u7684 Bean\uff0c\u5728 singletonFactory.getObject() \u4e2d\u8fd4\u56de\u7ed9 singletonObject\uff0c\u6240\u4ee5",(0,i.jsx)(e.strong,{children:"\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\u5c31\u4e00\u5b9a\u4f1a\u4f7f\u7528\u5de5\u5382"}),"\uff0c\u4f46\u662f\u4e0d\u4e00\u5b9a\u521b\u5efa\u7684\u662f\u4ee3\u7406\u5bf9\u8c61\uff0c\u4e0d\u9700\u8981\u589e\u5f3a\u5c31\u662f\u539f\u59cb\u5bf9\u8c61"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"wrapIfNecessary \u4e00\u5b9a\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\u5417\uff1f\uff08AOP \u52a8\u6001\u4ee3\u7406\u90e8\u5206\u6709\u6e90\u7801\u89e3\u6790\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5b58\u5728\u589e\u5f3a\u5668\u4f1a\u521b\u5efa\u52a8\u6001\u4ee3\u7406\uff0c\u4e0d\u9700\u8981\u589e\u5f3a\u5c31\u4e0d\u9700\u8981\u521b\u5efa\u52a8\u6001\u4ee3\u7406\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"\u5b58\u5728\u5faa\u73af\u4f9d\u8d56\u4f1a\u63d0\u524d\u589e\u5f3a\uff0c\u521d\u59cb\u5316\u540e\u4e0d\u9700\u8981\u589e\u5f3a"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ec0\u4e48\u65f6\u5019\u5c06 Bean \u7684\u5f15\u7528\u63d0\u524d\u66b4\u9732\u7ed9\u7b2c\u4e09\u7ea7\u7f13\u5b58\u7684 ObjectFactory \u6301\u6709\uff1f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9e\u4f8b\u5316\u4e4b\u540e\uff0c\u4f9d\u8d56\u6ce8\u5165\u4e4b\u524d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"createBeanInstance -> addSingletonFactory -> populateBean\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6e90\u7801\u89e3\u6790-1",children:"\u6e90\u7801\u89e3\u6790"}),"\n",(0,i.jsx)(e.p,{children:"\u5047\u5982 A \u4f9d\u8d56 B\uff0cB \u4f9d\u8d56 A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f53 A \u521b\u5efa\u5b9e\u4f8b\u540e\u586b\u5145\u5c5e\u6027\u524d\uff0c\u6267\u884c\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"addSingletonFactory(beanName, () -> getEarlyBeanReference(beanName, mbd, bean))\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u6dfb\u52a0\u7ed9\u5b9a\u7684\u5355\u4f8b\u5de5\u5382\u4ee5\u6784\u5efa\u6307\u5b9a\u7684\u5355\u4f8b\nprotected void addSingletonFactory(String beanName, ObjectFactory<?> singletonFactory) {\n    Assert.notNull(singletonFactory, "Singleton factory must not be null");\n    synchronized (this.singletonObjects) {\n        // \u5355\u4f8b\u6c60\u5305\u542b\u8be5Bean\u8bf4\u660e\u5df2\u7ecf\u521b\u5efa\u5b8c\u6210\uff0c\u4e0d\u9700\u8981\u5faa\u73af\u4f9d\u8d56\n        if (!this.singletonObjects.containsKey(beanName)) {\n            //\u52a0\u5165\u4e09\u7ea7\u7f13\u5b58\n            this.singletonFactories.put(beanName,singletonFactory);\n            this.earlySingletonObjects.remove(beanName);\n            // \u4ece\u4e8c\u7ea7\u7f13\u5b58\u79fb\u9664\uff0c\u56e0\u4e3a\u4e09\u4e2aMap\u4e2d\u90fd\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e0d\u80fd\u540c\u65f6\u5b58\u5728\uff01\n            this.registeredSingletons.add(beanName);\n        }\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u586b\u5145\u5c5e\u6027\u65f6 A \u4f9d\u8d56 B\uff0c\u8fd9\u65f6\u9700\u8981 getBean(B)\uff0c\u4e5f\u4f1a\u628a B \u7684\u5de5\u5382\u653e\u5165\u4e09\u7ea7\u7f13\u5b58\uff0c\u63a5\u7740 B \u586b\u5145\u5c5e\u6027\u65f6\u53d1\u73b0\u4f9d\u8d56 A\uff0c\u53bb\u8fdb\u884c**\u7b2c\u4e00\u6b21 ** getSingleton(A)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object getSingleton(String beanName) {\n    return getSingleton(beanName, true);//\u4e3atrue\u4ee3\u8868\u5141\u8bb8\u62ff\u5230\u65e9\u671f\u5f15\u7528\u3002\n}\nprotected Object getSingleton(String beanName, boolean allowEarlyReference) {\n    // \u5728\u4e00\u7ea7\u7f13\u5b58\u4e2d\u83b7\u53d6 beanName \u5bf9\u5e94\u7684\u5355\u5b9e\u4f8b\u5bf9\u8c61\u3002\n    Object singletonObject = this.singletonObjects.get(beanName);\n    // \u5355\u5b9e\u4f8b\u786e\u5b9e\u5c1a\u672a\u521b\u5efa\uff1b\u5355\u5b9e\u4f8b\u6b63\u5728\u521b\u5efa\uff0c\u53d1\u751f\u4e86\u5faa\u73af\u4f9d\u8d56\n    if (singletonObject == null && isSingletonCurrentlyInCreation(beanName)) {\n        synchronized (this.singletonObjects) {\n            // \u4ece\u4e8c\u7ea7\u7f13\u5b58\u83b7\u53d6\n            singletonObject = this.earlySingletonObjects.get(beanName);\n            // \u4e8c\u7ea7\u7f13\u5b58\u4e0d\u5b58\u5728\uff0c\u5e76\u4e14\u5141\u8bb8\u83b7\u53d6\u65e9\u671f\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u53bb\u4e09\u7ea7\u7f13\u5b58\u67e5\u770b\n            if (singletonObject == null && allowEarlyReference) {\n                ObjectFactory<?> singletonFactory = this.singletonFactories.get(beanName);\n                if (singletonFactory != null) {\n                    // \u4ece\u4e09\u7ea7\u7f13\u5b58\u83b7\u53d6\u5de5\u5382\u5bf9\u8c61\uff0c\u5e76\u5f97\u5230 bean \u7684\u63d0\u524d\u5f15\u7528\n                    singletonObject = singletonFactory.getObject();\n                    // \u3010\u7f13\u5b58\u5347\u7ea7\u3011\uff0c\u653e\u5165\u4e8c\u7ea7\u7f13\u5b58\uff0c\u63d0\u524d\u5f15\u7528\u6c60\n                    this.earlySingletonObjects.put(beanName, singletonObject);\n                    // \u4ece\u4e09\u7ea7\u7f13\u5b58\u79fb\u9664\u8be5\u5bf9\u8c61\n                    this.singletonFactories.remove(beanName);\n                }\n            }\n        }\n    }\n    return singletonObject;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4ece\u4e09\u7ea7\u7f13\u5b58\u83b7\u53d6 A \u7684 Bean\uff1a",(0,i.jsx)(e.code,{children:"singletonFactory.getObject()"}),"\uff0c\u8c03\u7528\u4e86 lambda \u8868\u8fbe\u5f0f\u7684 getEarlyBeanReference \u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object getEarlyBeanReference(Object bean, String beanName) {\n    Object cacheKey = getCacheKey(bean.getClass(), beanName);\n    // \u3010\u5411\u63d0\u524d\u5f15\u7528\u4ee3\u7406\u6c60 earlyProxyReferences \u4e2d\u6dfb\u52a0\u8be5 Bean\uff0c\u9632\u6b62\u5bf9\u8c61\u88ab\u91cd\u65b0\u4ee3\u7406\u3011\n    this.earlyProxyReferences.put(cacheKey, bean);\n    // \u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff0ccreateProxy\n    return wrapIfNecessary(bean, beanName, cacheKey);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["B \u586b\u5145\u4e86 A \u7684\u63d0\u524d\u5f15\u7528\u540e\u4f1a\u7ee7\u7eed\u521d\u59cb\u5316\u76f4\u5230\u5b8c\u6210\uff0c",(0,i.jsx)(e.strong,{children:"\u8fd4\u56de\u539f\u59cb A \u7684\u903b\u8f91\u7ee7\u7eed\u6267\u884c"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"aop-2",children:"AOP"}),"\n",(0,i.jsx)(e.h4,{id:"\u6ce8\u89e3\u539f\u7406",children:"\u6ce8\u89e3\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"@EnableAspectJAutoProxy\uff1aAOP \u6ce8\u89e3\u9a71\u52a8\uff0c\u7ed9\u5bb9\u5668\u4e2d\u5bfc\u5165 AspectJAutoProxyRegistrar"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Import(AspectJAutoProxyRegistrar.class)\npublic @interface EnableAspectJAutoProxy {\n    // \u662f\u5426\u5f3a\u5236\u4f7f\u7528 CGLIB \u521b\u5efa\u4ee3\u7406\u5bf9\u8c61 \n    // \u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f\uff1a<aop:aspectj-autoproxy proxy-target-class="true"/>\n\tboolean proxyTargetClass() default false;\n\t\n    // \u5c06\u5f53\u524d\u4ee3\u7406\u5bf9\u8c61\u66b4\u9732\u5230\u4e0a\u4e0b\u6587\u5185\uff0c\u65b9\u4fbf\u4ee3\u7406\u5bf9\u8c61\u5185\u90e8\u7684\u771f\u5b9e\u5bf9\u8c61\u62ff\u5230\u4ee3\u7406\u5bf9\u8c61\n    // \u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f\uff1a<aop:aspectj-autoproxy expose-proxy="true"/>\n\tboolean exposeProxy() default false;\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["AspectJAutoProxyRegistrar \u5728\u7528\u6765\u5411\u5bb9\u5668\u4e2d\u6ce8\u518c ",(0,i.jsx)(e.strong,{children:"AnnotationAwareAspectJAutoProxyCreator"}),"\uff0c\u4ee5 BeanDefiantion \u5f62\u5f0f\u5b58\u5728\uff0c\u5728\u5bb9\u5668\u521d\u59cb\u5316\u65f6\u52a0\u8f7d\u3002AnnotationAwareAspectJAutoProxyCreator \u95f4\u63a5\u5b9e\u73b0\u4e86 InstantiationAwareBeanPostProcessor\uff0cOrder \u63a5\u53e3\uff0c\u8be5\u7c7b\u4f1a\u5728 Bean \u7684\u5b9e\u4f8b\u5316\u548c\u521d\u59cb\u5316\u7684\u524d\u540e\u8d77\u4f5c\u7528"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5de5\u4f5c\u6d41\u7a0b\uff1a\u521b\u5efa IOC \u5bb9\u5668\uff0c\u8c03\u7528 refresh() \u5237\u65b0\u5bb9\u5668\uff0c",(0,i.jsx)(e.code,{children:"registerBeanPostProcessors(beanFactory)"})," \u9636\u6bb5\uff0c\u901a\u8fc7 getBean() \u521b\u5efa AnnotationAwareAspectJAutoProxyCreator \u5bf9\u8c61\uff0c\u5728\u751f\u547d\u5468\u671f\u7684\u521d\u59cb\u5316\u65b9\u6cd5\u4e2d\u6267\u884c\u56de\u8c03 initBeanFactory() \u65b9\u6cd5\u521d\u59cb\u5316\u6ce8\u518c\u4e09\u4e2a\u5de5\u5177\u7c7b\uff1aBeanFactoryAdvisorRetrievalHelperAdapter\u3001ReflectiveAspectJAdvisorFactory\u3001BeanFactoryAspectJAdvisorsBuilderAdapter"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u540e\u7f6e\u5904\u7406",children:"\u540e\u7f6e\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"Bean \u521d\u59cb\u5316\u5b8c\u6210\u7684\u6267\u884c\u540e\u7f6e\u5904\u7406\u5668\u7684\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object postProcessAfterInitialization(@Nullable Object bean,String bN){\n    if (bean != null) {\n        // cacheKey \u662f \u3010beanName \u6216\u8005\u52a0\u4e0a & \u7684 beanName\u3011\n        Object cacheKey = getCacheKey(bean.getClass(), beanName);\n            if (this.earlyProxyReferences.remove(cacheKey) != bean) {\n                // \u53bb\u63d0\u524d\u4ee3\u7406\u5f15\u7528\u6c60\u4e2d\u5bfb\u627e\u8be5 key\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\u4ee3\u7406\n                // \u5982\u679c\u5b58\u5728\u5219\u8bc1\u660e\u88ab\u4ee3\u7406\u8fc7\uff0c\u5219\u5224\u65ad\u662f\u5426\u662f\u5f53\u524d\u7684 bean\uff0c\u4e0d\u662f\u5219\u521b\u5efa\u4ee3\u7406\n                return wrapIfNecessary(bean, bN, cacheKey);\n            }\n    }\n    return bean;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AbstractAutoProxyCreator.wrapIfNecessary()\uff1a\u6839\u636e\u901a\u77e5\u521b\u5efa\u52a8\u6001\u4ee3\u7406\uff0c\u6ca1\u6709\u901a\u77e5\u76f4\u63a5\u8fd4\u56de\u539f\u5b9e\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected Object wrapIfNecessary(Object bean, String beanName, Object cacheKey) {\n    // \u6761\u4ef6\u4e00\u822c\u4e0d\u6210\u7acb\uff0c\u5f88\u5c11\u4f7f\u7528 TargetSourceCreator \u53bb\u521b\u5efa\u5bf9\u8c61 BeforeInstantiation \u9636\u6bb5\uff0cdoCreateBean \u4e4b\u524d\u7684\u9636\u6bb5\n    if (StringUtils.hasLength(beanName) && this.targetSourcedBeans.contains(beanName)) {\n        return bean;\n    }\n    // advisedBeans \u96c6\u5408\u4fdd\u5b58\u7684\u662f bean \u662f\u5426\u88ab\u589e\u5f3a\u8fc7\u4e86\n    // \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d beanName \u5bf9\u5e94\u7684\u5b9e\u4f8b\u4e0d\u9700\u8981\u88ab\u589e\u5f3a\u5904\u7406\uff0c\u5224\u65ad\u662f\u5728 BeforeInstantiation \u9636\u6bb5\u505a\u7684\n    if (Boolean.FALSE.equals(this.advisedBeans.get(cacheKey))) {\n        return bean;\n    }\n    // \u6761\u4ef6\u4e00\uff1a\u5224\u65ad\u5f53\u524d bean \u7c7b\u578b\u662f\u5426\u662f\u57fa\u7840\u6846\u67b6\u7c7b\u578b\uff0c\u8fd9\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u4e0d\u80fd\u88ab\u589e\u5f3a\n    // \u6761\u4ef6\u4e8c\uff1ashouldSkip \u5224\u65ad\u5f53\u524d beanName \u662f\u5426\u662f .ORIGINAL \u7ed3\u5c3e\uff0c\u5982\u679c\u662f\u5c31\u8df3\u8fc7\u589e\u5f3a\u903b\u8f91\uff0c\u76f4\u63a5\u8fd4\u56de\n    if (isInfrastructureClass(bean.getClass()) || shouldSkip(bean.getClass(), beanName)) {\n        this.advisedBeans.put(cacheKey, Boolean.FALSE);\n        return bean;\n    }\n\n    // \u3010\u67e5\u627e\u9002\u5408\u5f53\u524d bean \u5b9e\u4f8b\u7684\u589e\u5f3a\u65b9\u6cd5\u3011\uff08\u4e0b\u4e00\u8282\u8be6\u89e3\uff09\n    Object[] specificInterceptors = getAdvicesAndAdvisorsForBean(bean.getClass(), beanName, null);\n    // \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u4e0a\u9762\u65b9\u6cd5\u67e5\u8be2\u5230\u9002\u5408\u5f53\u524dclass\u7684\u901a\u77e5\n    if (specificInterceptors != DO_NOT_PROXY) {\n        this.advisedBeans.put(cacheKey, Boolean.TRUE);\n        // \u6839\u636e\u67e5\u8be2\u5230\u7684\u589e\u5f3a\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff08\u4e0b\u4e00\u8282\u8be6\u89e3\uff09\n        // \u53c2\u6570\u4e00\uff1a\u76ee\u6807\u5bf9\u8c61\n        // \u53c2\u6570\u4e8c\uff1abeanName\n        // \u53c2\u6570\u4e09\uff1a\u5339\u914d\u5f53\u524d\u76ee\u6807\u5bf9\u8c61 clazz \u7684 Advisor \u6570\u636e\n        Object proxy = createProxy(\n            bean.getClass(), beanName, specificInterceptors, new SingletonTargetSource(bean));\n        // \u4fdd\u5b58\u4ee3\u7406\u5bf9\u8c61\u7c7b\u578b\n        this.proxyTypes.put(cacheKey, proxy.getClass());\n        // \u8fd4\u56de\u4ee3\u7406\u5bf9\u8c61\n        return proxy;\n    }\n\t// \u6267\u884c\u5230\u8fd9\u91cc\u8bf4\u660e\u6ca1\u6709\u67e5\u5230\u901a\u77e5\uff0c\u5f53\u524d bean \u4e0d\u9700\u8981\u589e\u5f3a\n    this.advisedBeans.put(cacheKey, Boolean.FALSE);\n    // \u3010\u8fd4\u56de\u539f\u59cb\u7684 bean \u5b9e\u4f8b\u3011\n    return bean;\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u83b7\u53d6\u901a\u77e5",children:"\u83b7\u53d6\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"AbstractAdvisorAutoProxyCreator.getAdvicesAndAdvisorsForBean()\uff1a\u67e5\u627e\u9002\u5408\u5f53\u524d\u7c7b\u5b9e\u4f8b\u7684\u589e\u5f3a\uff0c\u5e76\u8fdb\u884c\u6392\u5e8f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected Object[] getAdvicesAndAdvisorsForBean(Class<?> beanClass, String beanName, @Nullable TargetSource targetSource) {\n\t// \u67e5\u8be2\u9002\u5408\u5f53\u524d\u7c7b\u578b\u7684\u589e\u5f3a\u901a\u77e5\n    List<Advisor> advisors = findEligibleAdvisors(beanClass, beanName);\n    if (advisors.isEmpty()) {\n        // \u589e\u5f3a\u4e3a\u7a7a\u76f4\u63a5\u8fd4\u56de null\uff0c\u4e0d\u9700\u8981\u521b\u5efa\u4ee3\u7406\n        return DO_NOT_PROXY;\n    }\n    // \u4e0d\u662f\u7a7a\uff0c\u8f6c\u6210\u6570\u7ec4\u8fd4\u56de\n    return advisors.toArray();\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AbstractAdvisorAutoProxyCreator.findEligibleAdvisors()\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"candidateAdvisors = findCandidateAdvisors()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u5f53\u524d\u5bb9\u5668\u5185\u53ef\u4ee5\u4f7f\u7528\uff08\u6240\u6709\uff09\u7684 advisor"}),"\uff0c\u8c03\u7528\u7684\u662f AnnotationAwareAspectJAutoProxyCreator \u7c7b\u7684\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u65b9\u6cd5\u5bf9\u5e94\u4e00\u4e2a Advisor"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"advisors = super.findCandidateAdvisors()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u67e5\u8be2\u51fa XML \u914d\u7f6e\u7684\u6240\u6709 Advisor \u7c7b\u578b"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"advisorNames = BeanFactoryUtils.beanNamesForTypeIncludingAncestors()"}),"\uff1a\u901a\u8fc7 BF \u67e5\u8be2\u51fa\u6765 BD \u914d\u7f6e\u7684 class \u4e2d \u662f Advisor \u5b50\u7c7b\u7684 BeanName"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"advisors.add()"}),"\uff1a\u4f7f\u7528 Spring \u5bb9\u5668\u83b7\u53d6\u5f53\u524d\u8fd9\u4e2a Advisor \u7c7b\u578b\u7684\u5b9e\u4f8b"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"advisors.addAll(....buildAspectJAdvisors())"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u6240\u6709\u6dfb\u52a0 @Aspect \u6ce8\u89e3\u7c7b\u4e2d\u7684 Advisor"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"buildAspectJAdvisors()"}),"\uff1a\u6784\u5efa\u7684\u65b9\u6cd5\uff0c",(0,i.jsx)(e.strong,{children:"\u628a Advice \u5c01\u88c5\u6210 Advisor"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" beanNames = BeanFactoryUtils.beanNamesForTypeIncludingAncestors(this.beanFactory, Object.class, true, false)"}),"\uff1a\u83b7\u53d6\u51fa\u5bb9\u5668\u5185 Object \u6240\u6709\u7684 beanName\uff0c\u5c31\u662f\u5168\u90e8\u7684"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" for (String beanName : beanNames)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684 beanName\uff0c\u5224\u65ad\u6bcf\u4e2a beanName \u5bf9\u5e94\u7684 Class \u662f\u5426\u662f Aspect \u7c7b\u578b\uff0c\u5c31\u662f\u52a0\u4e86 @Aspect \u6ce8\u89e3\u7684\u7c7b"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"factory = new BeanFactoryAspectInstanceFactory(this.beanFactory, beanName)"}),"\uff1a\u4f7f\u7528\u5de5\u5382\u6a21\u5f0f\u7ba1\u7406 Aspect \u7684\u5143\u6570\u636e\uff0c\u5173\u8054\u7684\u771f\u5b9e @Aspect \u6ce8\u89e3\u7684\u5b9e\u4f8b\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"classAdvisors = this.advisorFactory.getAdvisors(factory)"}),"\uff1a\u6dfb\u52a0\u4e86 @Aspect \u6ce8\u89e3\u7684\u7c7b\u7684\u901a\u77e5\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"aspectClass\uff1a@Aspect \u6807\u7b7e\u7684\u7c7b\u7684 class"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (Method method : getAdvisorMethods(aspectClass))"}),"\uff1a\u904d\u5386",(0,i.jsx)(e.strong,{children:"\u4e0d\u5305\u62ec @Pointcut \u6ce8\u89e3\u7684\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Advisor advisor = getAdvisor(method, lazySingletonAspectInstanceFactory, advisors.size(), aspectName)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06\u5f53\u524d method \u5305\u88c5\u6210 Advisor \u6570\u636e"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AspectJExpressionPointcut expressionPointcut = getPointcut()"}),"\uff1a\u83b7\u53d6\u5207\u70b9\u8868\u8fbe\u5f0f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return new InstantiationModelAwarePointcutAdvisorImpl()"}),"\uff1a\u628a method \u4e2d Advice \u5305\u88c5\u6210 Advisor\uff0cSpring \u4e2d\u6bcf\u4e2a Advisor \u5185\u90e8\u4e00\u5b9a\u662f\u6301\u6709\u4e00\u4e2a Advice \u7684\uff0cAdvice \u5185\u90e8\u6700\u91cd\u8981\u7684\u6570\u636e\u662f\u5f53\u524d method \u548caspectInstanceFactory\uff0c\u5de5\u5382\u7528\u6765\u83b7\u53d6\u5b9e\u4f8b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.instantiatedAdvice = instantiateAdvice(this.declaredPointcut)"}),"\uff1a\u5b9e\u4f8b\u5316 Advice \u5bf9\u8c61\uff0c\u903b\u8f91\u662f\u83b7\u53d6\u6ce8\u89e3\u4fe1\u606f\uff0c\u6839\u636e\u6ce8\u89e3\u7684\u4e0d\u540c\u751f\u6210\u5bf9\u5e94\u7684 Advice \u5bf9\u8c61"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"advisors.addAll(classAdvisors)"}),"\uff1a\u4fdd\u5b58\u901a\u8fc7 @Aspect \u6ce8\u89e3\u5b9a\u4e49\u7684 Advisor \u6570\u636e"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.aspectBeanNames = aspectNames"}),"\uff1a\u5c06\u6240\u6709 @Aspect \u6ce8\u89e3 beanName \u7f13\u5b58\u8d77\u6765\uff0c\u8868\u793a\u63d0\u53d6 Advisor \u5de5\u4f5c\u5b8c\u6210"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return advisors"}),"\uff1a\u8fd4\u56de Advisor \u5217\u8868"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"eligibleAdvisors = findAdvisorsThatCanApply(candidateAdvisors, ...)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u9009\u51fa\u5339\u914d\u5f53\u524d\u7c7b\u7684\u589e\u5f3a"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (candidateAdvisors.isEmpty())"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d Spring \u6ca1\u6709\u53ef\u4ee5\u64cd\u4f5c\u7684 Advisor"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"List<Advisor> eligibleAdvisors = new ArrayList<>()"}),"\uff1a\u5b58\u653e\u5339\u914d\u5f53\u524d beanClass \u7684 Advisors \u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (Advisor candidate : candidateAdvisors)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u6240\u6709\u7684 Advisor"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" if (canApply(candidate, clazz, hasIntroductions))"}),"\uff1a\u5224\u65ad\u904d\u5386\u7684 advisor \u662f\u5426\u5339\u914d\u5f53\u524d\u7684 class\uff0c\u5339\u914d\u5c31\u52a0\u5165\u96c6\u5408"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (advisor instanceof PointcutAdvisor)"}),"\uff1a\u521b\u5efa\u7684 advisor \u662f InstantiationModelAwarePointcutAdvisorImpl \u7c7b\u578b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"PointcutAdvisor pca = (PointcutAdvisor) advisor"}),"\uff1a\u5c01\u88c5\u5f53\u524d Advisor"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return canApply(pca.getPointcut(), targetClass, hasIntroductions)"}),"\uff1a\u91cd\u8f7d\u8be5\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (!pc.getClassFilter().matches(targetClass))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7c7b\u4e0d\u5339\u914d Pointcut \u8868\u8fbe\u5f0f\uff0c\u76f4\u63a5\u8fd4\u56de false"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"methodMatcher = pc.getMethodMatcher()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 Pointcut \u65b9\u6cd5\u5339\u914d\u5668"}),"\uff0c\u7c7b\u5339\u914d\u8fdb\u884c\u7c7b\u4e2d\u65b9\u6cd5\u7684\u5339\u914d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Set<Class<?>> classes"}),"\uff1a\u4fdd\u5b58\u76ee\u6807\u5bf9\u8c61 class \u548c\u76ee\u6807\u5bf9\u8c61\u7236\u7c7b\u8d85\u7c7b\u7684\u63a5\u53e3\u548c\u81ea\u8eab\u5b9e\u73b0\u7684\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (!Proxy.isProxyClass(targetClass))"}),"\uff1a\u5224\u65ad\u5f53\u524d\u5b9e\u4f8b\u662f\u4e0d\u662f\u4ee3\u7406\u7c7b\uff0c\u786e\u4fdd class \u5185\u5b58\u50a8\u7684\u6570\u636e\u5305\u62ec\u76ee\u6807\u5bf9\u8c61\u7684class  \u800c\u4e0d\u662f\u4ee3\u7406\u7c7b\u7684 class"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"for (Class<?> clazz : classes)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u68c0\u67e5\u76ee\u6807 class \u548c\u4e0a\u7ea7\u63a5\u53e3\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u67e5\u770b\u662f\u5426\u4f1a\u88ab\u65b9\u6cd5\u5339\u914d\u5668\u5339\u914d"}),"\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u65b9\u6cd5\u5339\u914d\u6210\u529f\uff0c\u5c31\u8bf4\u660e\u76ee\u6807\u5bf9\u8c61 AOP \u4ee3\u7406\u9700\u8981\u589e\u5f3a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"specificMethod = AopUtils.getMostSpecificMethod(method, targetClass)"}),"\uff1a\u65b9\u6cd5\u53ef\u80fd\u662f\u63a5\u53e3\u7684\uff0c\u5224\u65ad\u5f53\u524d\u7c7b\u6709\u6ca1\u6709\u8be5\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return (specificMethod != method && matchesMethod(specificMethod))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u7c7b\u548c\u65b9\u6cd5\u7684\u5339\u914d"}),"\uff0c\u4e0d\u5305\u62ec\u53c2\u6570"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"extendAdvisors(eligibleAdvisors)"}),"\uff1a\u5728 eligibleAdvisors \u5217\u8868\u7684\u7d22\u5f15 0 \u7684\u4f4d\u7f6e\u6dfb\u52a0 DefaultPointcutAdvisor\uff0c",(0,i.jsx)(e.strong,{children:"\u5c01\u88c5\u4e86 ExposeInvocationInterceptor \u62e6\u622a\u5668"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" eligibleAdvisors = sortAdvisors(eligibleAdvisors)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5bf9\u62e6\u622a\u5668\u8fdb\u884c\u6392\u5e8f"}),"\uff0c\u6570\u503c\u8d8a\u5c0f\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u9ad8\u7684\u6392\u5728\u524d\u9762"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5b9e\u73b0 Ordered \u6216 PriorityOrdered \u63a5\u53e3\uff0cPriorityOrdered \u7684\u7ea7\u522b\u8981\u4f18\u5148\u4e8e Ordered\uff0c\u4f7f\u7528 OrderComparator \u6bd4\u8f83\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u4f7f\u7528 @Order\uff08Spring \u89c4\u8303\uff09\u6216 @Priority\uff08JDK \u89c4\u8303\uff09\u6ce8\u89e3\uff0c\u4f7f\u7528 AnnotationAwareOrderComparator \u6bd4\u8f83\u5668"}),"\n",(0,i.jsx)(e.li,{children:"ExposeInvocationInterceptor \u5b9e\u73b0\u4e86 PriorityOrdered \uff0c\u6240\u4ee5\u603b\u662f\u6392\u5728\u7b2c\u4e00\u4f4d\uff0cMethodBeforeAdviceInterceptor \u6ca1\u5b9e\u73b0\u4efb\u4f55\u63a5\u53e3\uff0c\u6240\u4ee5\u4f18\u5148\u7ea7\u6700\u4f4e\uff0c\u6392\u5728\u6700\u540e"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return eligibleAdvisors"}),"\uff1a\u8fd4\u56de\u62e6\u622a\u5668\u94fe"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u521b\u5efa\u4ee3\u7406",children:"\u521b\u5efa\u4ee3\u7406"}),"\n",(0,i.jsx)(e.p,{children:"AbstractAutoProxyCreator.createProxy()\uff1a\u6839\u636e\u589e\u5f3a\u65b9\u6cd5\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ProxyFactory proxyFactory = new ProxyFactory()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u65e0\u53c2\u6784\u9020 ProxyFactory"}),"\uff0c\u6b64\u5904\u8bb2\u89e3\u4e00\u4e0b\u4e24\u79cd\u6709\u53c2\u6784\u9020\u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"public ProxyFactory(Object target)\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public ProxyFactory(Object target) {\n\t// \u5c06\u76ee\u6807\u5bf9\u8c61\u5c01\u88c5\u6210 SingletonTargetSource \u4fdd\u5b58\u5230\u7236\u7c7b\u7684\u5b57\u6bb5\u4e2d\n   \tsetTarget(target);\n    // \u83b7\u53d6\u76ee\u6807\u5bf9\u8c61 class \u6240\u6709\u63a5\u53e3\u4fdd\u5b58\u5230 AdvisedSupport \u4e2d\u7684 interfaces \u96c6\u5408\u4e2d\n   \tsetInterfaces(ClassUtils.getAllInterfaces(target));\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"ClassUtils.getAllInterfaces(target) \u5e95\u5c42\u8c03\u7528 getAllInterfacesForClassAsSet(java.lang.Class<?>, java.lang.ClassLoader)\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (clazz.isInterface() && isVisible(clazz, classLoader))"}),"\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e00\uff1a\u5224\u65ad\u5f53\u524d\u76ee\u6807\u5bf9\u8c61\u662f\u63a5\u53e3"}),"\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e8c\uff1a\u68c0\u67e5\u7ed9\u5b9a\u7684\u7c7b\u5728\u7ed9\u5b9a\u7684 ClassLoader \u4e2d\u662f\u5426\u53ef\u89c1"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Class<?>[] ifcs = current.getInterfaces()"}),"\uff1a\u62ff\u5230\u81ea\u5df1\u5b9e\u73b0\u7684\u63a5\u53e3\uff0c\u62ff\u4e0d\u5230\u63a5\u53e3\u5b9e\u73b0\u7684\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"current = current.getSuperclass()"}),"\uff1a\u9012\u5f52\u5bfb\u627e\u7236\u7c7b\u7684\u63a5\u53e3\uff0c\u53bb\u83b7\u53d6\u7236\u7c7b\u5b9e\u73b0\u7684\u63a5\u53e3"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"public ProxyFactory(Class<?> proxyInterface, Interceptor interceptor)\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public ProxyFactory(Class<?> proxyInterface, Interceptor interceptor) {\n    // \u6dfb\u52a0\u4e00\u4e2a\u4ee3\u7406\u7684\u63a5\u53e3\n    addInterface(proxyInterface);\n    // \u6dfb\u52a0\u901a\u77e5\uff0c\u5e95\u5c42\u8c03\u7528 addAdvisor\n    addAdvice(interceptor);\n}\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"addAdvisor(pos, new DefaultPointcutAdvisor(advice))"}),"\uff1aSpring \u4e2d Advice \u5bf9\u5e94\u7684\u63a5\u53e3\u5c31\u662f Advisor\uff0cSpring \u4f7f\u7528 Advisor \u5305\u88c5 Advice \u5b9e\u4f8b"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"proxyFactory.copyFrom(this)"}),"\uff1a\u586b\u5145\u4e00\u4e9b\u4fe1\u606f\u5230 proxyFactory"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!proxyFactory.isProxyTargetClass())"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e proxyTargetClass \u4e3a false\uff08\u9ed8\u8ba4\uff09\uff0c\u4e24\u79cd\u914d\u7f6e\u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'<aop:aspectj-autoproxy proxy-target-class="true"/> '}),"\uff1a\u5f3a\u5236\u4f7f\u7528 CGLIB"]}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"@EnableAspectJAutoProxy(proxyTargetClass = true)"})}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (shouldProxyTargetClass(beanClass, beanName))"}),"\uff1a\u5982\u679c bd \u5185\u6709 preserveTargetClass = true \uff0c\u90a3\u4e48\u8fd9\u4e2a bd \u5bf9\u5e94\u7684 class ",(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u4ee3\u7406\u65f6\u5fc5\u987b\u4f7f\u7528 CGLIB"}),"\uff0c\u6761\u4ef6\u6210\u7acb\u8bbe\u7f6e proxyTargetClass \u4e3a true"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"evaluateProxyInterfaces(beanClass, proxyFactory)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6839\u636e\u76ee\u6807\u7c7b\u5224\u5b9a\u662f\u5426\u53ef\u4ee5\u4f7f\u7528 JDK \u52a8\u6001\u4ee3\u7406"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"targetInterfaces = ClassUtils.getAllInterfacesForClass()"}),"\uff1a\u83b7\u53d6\u5f53\u524d\u76ee\u6807\u5bf9\u8c61 class \u548c\u7236\u7c7b\u7684\u5168\u90e8\u5b9e\u73b0\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"boolean hasReasonableProxyInterface = false"}),"\uff1a\u5b9e\u73b0\u7684\u63a5\u53e3\u4e2d\u662f\u5426\u6709\u4e00\u4e2a\u5408\u7406\u7684\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (!isConfigurationCallbackInterface(ifc) && !isInternalLanguageInterface(ifc) && ifc.getMethods().length > 0)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u63a5\u53e3\uff0c\u5982\u679c\u6709\u4efb\u610f\u4e00\u4e2a\u63a5\u53e3\u6ee1\u8db3\u6761\u4ef6\uff0c\u8bbe\u7f6e hRPI \u53d8\u91cf\u4e3a true\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e00\uff1a\u5224\u65ad\u5f53\u524d\u63a5\u53e3\u662f\u5426\u662f Spring \u751f\u547d\u5468\u671f\u5185\u4f1a\u56de\u8c03\u7684\u63a5\u53e3"}),"\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e8c\uff1a\u63a5\u53e3\u4e0d\u80fd\u662f GroovyObject\u3001Factory\u3001MockAccess \u7c7b\u578b\u7684"}),"\n",(0,i.jsx)(e.li,{children:"\u6761\u4ef6\u4e09\uff1a\u627e\u5230\u4e00\u4e2a\u53ef\u4ee5\u4f7f\u7528\u7684\u88ab\u4ee3\u7406\u7684\u63a5\u53e3"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (hasReasonableProxyInterface)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6709\u5408\u7406\u7684\u63a5\u53e3\uff0c\u5c06\u8fd9\u4e9b\u63a5\u53e3\u8bbe\u7f6e\u5230 proxyFactory \u5185"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"proxyFactory.setProxyTargetClass(true)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6ca1\u6709\u5408\u7406\u7684\u4ee3\u7406\u63a5\u53e3\uff0c\u5f3a\u5236\u4f7f\u7528 CGLIB \u521b\u5efa\u5bf9\u8c61"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"advisors = buildAdvisors(beanName, specificInterceptors)"}),"\uff1a\u5339\u914d\u76ee\u6807\u5bf9\u8c61 clazz \u7684 Advisors\uff0c\u586b\u5145\u81f3 ProxyFactory"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"proxyFactory.setPreFiltered(true)"}),"\uff1a\u8bbe\u7f6e\u4e3a true \u8868\u793a\u4f20\u9012\u7ed9 proxyFactory \u7684 Advisors \u4fe1\u606f\u505a\u8fc7\u57fa\u7840\u7c7b\u548c\u65b9\u6cd5\u7684\u5339\u914d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return proxyFactory.getProxy(getProxyClassLoader())"}),"\uff1a\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object getProxy() {\n    return createAopProxy().getProxy();\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"DefaultAopProxyFactory.createAopProxy(AdvisedSupport config)\uff1a\u53c2\u6570\u662f\u4e00\u4e2a\u914d\u7f6e\u5bf9\u8c61\uff0c\u4fdd\u5b58\u7740\u521b\u5efa\u4ee3\u7406\u9700\u8981\u7684\u751f\u4ea7\u8d44\u6599\uff0c\u4f1a\u52a0\u9501\u521b\u5efa\uff0c\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public AopProxy createAopProxy(AdvisedSupport config) throws AopConfigException {\n    // \u6761\u4ef6\u4e8c\u4e3a true \u4ee3\u8868\u5f3a\u5236\u4f7f\u7528 CGLIB \u52a8\u6001\u4ee3\u7406\n    if (config.isOptimize() || config.isProxyTargetClass() || \n        // \u6761\u4ef6\u4e09\uff1a\u88ab\u4ee3\u7406\u5bf9\u8c61\u6ca1\u6709\u5b9e\u73b0\u4efb\u4f55\u63a5\u53e3\u6216\u8005\u53ea\u5b9e\u73b0\u4e86 SpringProxy \u63a5\u53e3\uff0c\u53ea\u80fd\u4f7f\u7528 CGLIB \u52a8\u6001\u4ee3\u7406\n        hasNoUserSuppliedProxyInterfaces(config)) {\n        Class<?> targetClass = config.getTargetClass();\n        if (targetClass == null) {\n            throw new AopConfigException("");\n        }\n        // \u6761\u4ef6\u6210\u7acb\u8bf4\u660e target \u3010\u662f\u63a5\u53e3\u6216\u8005\u662f\u5df2\u7ecf\u88ab\u4ee3\u7406\u8fc7\u7684\u7c7b\u578b\u3011\uff0c\u53ea\u80fd\u4f7f\u7528 JDK \u52a8\u6001\u4ee3\u7406\n        if (targetClass.isInterface() || Proxy.isProxyClass(targetClass)) {\n            return new JdkDynamicAopProxy(config);\t// \u4f7f\u7528 JDK \u52a8\u6001\u4ee3\u7406\n        }\n        return new ObjenesisCglibAopProxy(config);\t// \u4f7f\u7528 CGLIB \u52a8\u6001\u4ee3\u7406\n    }\n    else {\n        return new JdkDynamicAopProxy(config);\t\t// \u3010\u6709\u63a5\u53e3\u7684\u60c5\u51b5\u4e0b\u53ea\u80fd\u4f7f\u7528 JDK \u52a8\u6001\u4ee3\u7406\u3011\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"JdkDynamicAopProxy.getProxy(java.lang.ClassLoader)\uff1a\u83b7\u53d6 JDK \u7684\u4ee3\u7406\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"  public JdkDynamicAopProxy(AdvisedSupport config) throws AopConfigException {\n      // \u914d\u7f6e\u7c7b\u5c01\u88c5\u5230 JdkDynamicAopProxy.advised \u5c5e\u6027\u4e2d\n      this.advised = config;\n  }\n  public Object getProxy(@Nullable ClassLoader classLoader) {\n      // \u83b7\u53d6\u9700\u8981\u4ee3\u7406\u7684\u63a5\u53e3\u6570\u7ec4\n      Class<?>[] proxiedInterfaces = AopProxyUtils.completeProxiedInterfaces(this.advised, true);\n      \n      // \u67e5\u627e\u5f53\u524d\u6240\u6709\u7684\u9700\u8981\u4ee3\u7406\u7684\u63a5\u53e3\uff0c\u770b\u662f\u5426\u6709 equals \u65b9\u6cd5\u548c hashcode \u65b9\u6cd5\uff0c\u5982\u679c\u6709\u5c31\u505a\u4e00\u4e2a\u6807\u8bb0\n      findDefinedEqualsAndHashCodeMethods(proxiedInterfaces);\n      \n      // \u8be5\u65b9\u6cd5\u6700\u7ec8\u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u7c7b\u5bf9\u8c61\n      return Proxy.newProxyInstance(classLoader, proxiedInterfaces, this);\n      // classLoader\uff1a\u7c7b\u52a0\u8f7d\u5668  proxiedInterfaces\uff1a\u751f\u6210\u7684\u4ee3\u7406\u7c7b\uff0c\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\u96c6\u5408\n      // this JdkDynamicAopProxy \u5b9e\u73b0\u4e86 InvocationHandler\n  }\n"})}),"\n",(0,i.jsx)(e.p,{children:"AopProxyUtils.completeProxiedInterfaces(this.advised, true)\uff1a\u83b7\u53d6\u4ee3\u7406\u7684\u63a5\u53e3\u6570\u7ec4\uff0c\u5e76\u6dfb\u52a0 SpringProxy \u63a5\u53e3"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"specifiedInterfaces = advised.getProxiedInterfaces()"}),"\uff1a\u4ece ProxyFactory \u4e2d\u62ff\u5230\u6240\u6709\u7684 target \u63d0\u53d6\u51fa\u6765\u7684\u63a5\u53e3\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (specifiedInterfaces.length == 0)"}),"\uff1a\u5982\u679c\u6ca1\u6709\u5b9e\u73b0\u63a5\u53e3\uff0c\u68c0\u67e5\u5f53\u524d target \u662f\u4e0d\u662f\u63a5\u53e3\u6216\u8005\u5df2\u7ecf\u662f\u4ee3\u7406\u7c7b\uff0c\u5c01\u88c5\u5230 ProxyFactory \u7684 interfaces \u96c6\u5408\u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" addSpringProxy = !advised.isInterfaceProxied(SpringProxy.class)"}),"\uff1a\u5224\u65ad\u76ee\u6807\u5bf9\u8c61\u6240\u6709\u63a5\u53e3\u4e2d\u662f\u5426\u6709 SpringProxy \u63a5\u53e3\uff0c\u6ca1\u6709\u7684\u8bdd\u9700\u8981\u6dfb\u52a0\uff0c\u8fd9\u4e2a\u63a5\u53e3",(0,i.jsx)(e.strong,{children:"\u6807\u8bc6\u8fd9\u4e2a\u4ee3\u7406\u7c7b\u578b\u662f Spring \u7ba1\u7406\u7684"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"addAdvised = !advised.isOpaque() && !advised.isInterfaceProxied(Advised.class)"}),"\uff1a\u5224\u65ad\u76ee\u6807\u5bf9\u8c61\u7684\u6240\u6709\u63a5\u53e3\uff0c\u662f\u5426\u5df2\u7ecf\u6709 Advised \u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" addDecoratingProxy = (decoratingProxy && !advised.isInterfaceProxied(DecoratingProxy.class))"}),"\uff1a\u5224\u65ad\u76ee\u6807\u5bf9\u8c61\u7684\u6240\u6709\u63a5\u53e3\uff0c\u662f\u5426\u5df2\u7ecf\u6709 DecoratingProxy \u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"int nonUserIfcCount = 0"}),"\uff1a\u975e\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u63a5\u53e3\u6570\u91cf\uff0c\u63a5\u4e0b\u6765\u8981\u6dfb\u52a0\u4e0a\u9762\u7684\u4e09\u4e2a\u63a5\u53e3\u4e86"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"proxiedInterfaces = new Class<?>[specifiedInterfaces.length + nonUserIfcCount]"}),"\uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 class \u6570\u7ec4\uff0c\u957f\u5ea6\u662f\u539f\u76ee\u6807\u5bf9\u8c61\u63d0\u53d6\u51fa\u6765\u7684\u63a5\u53e3\u6570\u91cf\u548c Spring \u8ffd\u52a0\u7684\u6570\u91cf\uff0c\u7136\u540e\u8fdb\u884c ",(0,i.jsx)(e.strong,{children:"System.arraycopy \u62f7\u8d1d\u5230\u65b0\u6570\u7ec4\u4e2d"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"int index = specifiedInterfaces.length"}),"\uff1a\u83b7\u53d6\u539f\u76ee\u6807\u5bf9\u8c61\u63d0\u53d6\u51fa\u6765\u7684\u63a5\u53e3\u6570\u91cf\uff0c\u5f53\u4f5c index"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if(addSpringProxy)"}),"\uff1a\u6839\u636e\u4e0a\u9762\u4e09\u4e2a\u5e03\u5c14\u503c\u628a\u63a5\u53e3\u6dfb\u52a0\u5230\u65b0\u6570\u7ec4\u4e2d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return proxiedInterfaces"}),"\uff1a\u8fd4\u56de\u8ffd\u52a0\u540e\u7684\u63a5\u53e3\u96c6\u5408"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"JdkDynamicAopProxy.findDefinedEqualsAndHashCodeMethods()\uff1a\u67e5\u627e\u5728\u4efb\u4f55\u5b9a\u4e49\u5728\u63a5\u53e3\u4e2d\u7684 equals \u548c hashCode \u65b9\u6cd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"for (Class<?> proxiedInterface : proxiedInterfaces)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u63a5\u53e3\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" Method[] methods = proxiedInterface.getDeclaredMethods()"}),"\uff1a\u83b7\u53d6\u63a5\u53e3\u4e2d\u7684\u6240\u6709\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"for (Method method : methods)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u65b9\u6cd5\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (AopUtils.isEqualsMethod(method))"}),"\uff1a\u5f53\u524d\u65b9\u6cd5\u662f equals \u65b9\u6cd5\uff0c\u628a equalsDefined \u7f6e\u4e3a true"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (AopUtils.isHashCodeMethod(method))"}),"\uff1a\u5f53\u524d\u65b9\u6cd5\u662f hashCode \u65b9\u6cd5\uff0c\u628a hashCodeDefined \u7f6e\u4e3a true"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (this.equalsDefined && this.hashCodeDefined)"}),"\uff1a\u5982\u679c\u6709\u4e00\u4e2a\u63a5\u53e3\u4e2d\u6709\u8fd9\u4e24\u79cd\u65b9\u6cd5\uff0c\u76f4\u63a5\u8fd4\u56de"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u65b9\u6cd5\u589e\u5f3a",children:"\u65b9\u6cd5\u589e\u5f3a"}),"\n",(0,i.jsx)(e.p,{children:"main() \u51fd\u6570\u4e2d\u8c03\u7528\u7528\u6237\u65b9\u6cd5\uff0c\u4f1a\u8fdb\u5165\u4ee3\u7406\u5bf9\u8c61\u7684 invoke \u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"JdkDynamicAopProxy \u7c7b\u4e2d\u7684 invoke \u65b9\u6cd5\u662f\u771f\u6b63\u6267\u884c\u4ee3\u7406\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// proxy\uff1a\u4ee3\u7406\u5bf9\u8c61\uff0cmethod\uff1a\u76ee\u6807\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0cargs\uff1a\u76ee\u6807\u5bf9\u8c61\u65b9\u6cd5\u5bf9\u5e94\u7684\u53c2\u6570\npublic Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n    Object oldProxy = null;\n    boolean setProxyContext = false;\n\n    // advised \u5c31\u662f\u521d\u59cb\u5316 JdkDynamicAopProxy \u5bf9\u8c61\u65f6\u4f20\u5165\u7684\u53d8\u91cf\n    TargetSource targetSource = this.advised.targetSource;\n    Object target = null;\n\n    try {\n        // \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u4ee3\u7406\u7c7b\u5b9e\u73b0\u7684\u63a5\u53e3\u6ca1\u6709\u5b9a\u4e49 equals \u65b9\u6cd5\uff0c\u5e76\u4e14\u5f53\u524d method \u8c03\u7528 equals \u65b9\u6cd5\uff0c\n        // \u5c31\u8c03\u7528 JdkDynamicAopProxy \u63d0\u4f9b\u7684 equals \u65b9\u6cd5\n        if (!this.equalsDefined && AopUtils.isEqualsMethod(method)) {\n            return equals(args[0]);\n        } //.....\n\n        Object retVal;\n\t\t// \u9700\u4e0d\u9700\u8981\u66b4\u9732\u5f53\u524d\u4ee3\u7406\u5bf9\u8c61\u5230 AOP \u4e0a\u4e0b\u6587\u5185\n        if (this.advised.exposeProxy) {\n            // \u3010\u628a\u4ee3\u7406\u5bf9\u8c61\u8bbe\u7f6e\u5230\u4e0a\u4e0b\u6587\u73af\u5883\u3011\n            oldProxy = AopContext.setCurrentProxy(proxy);\n            setProxyContext = true;\n        }\n\n        // \u6839\u636e targetSource \u83b7\u53d6\u771f\u6b63\u7684\u4ee3\u7406\u5bf9\u8c61\n        target = targetSource.getTarget();\n        Class<?> targetClass = (target != null ? target.getClass() : null);\n\n        // \u67e5\u627e\u3010\u9002\u5408\u8be5\u65b9\u6cd5\u7684\u589e\u5f3a\u3011\uff0c\u9996\u5148\u4ece\u7f13\u5b58\u4e2d\u67e5\u627e\uff0c\u67e5\u627e\u4e0d\u5230\u8fdb\u5165\u4e3b\u65b9\u6cd5\u3010\u4e0b\u6587\u8be6\u89e3\u3011\n        List<Object> chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass);\n\n\t\t// \u62e6\u622a\u5668\u94fe\u662f\u7a7a\uff0c\u8bf4\u660e\u5f53\u524d method \u4e0d\u9700\u8981\u88ab\u589e\u5f3a\n        if (chain.isEmpty()) {\n            Object[] argsToUse = AopProxyUtils.adaptArgumentsIfNecessary(method, args);\n            retVal = AopUtils.invokeJoinpointUsingReflection(target, method, argsToUse);\n        }\n        else {\n            // \u6709\u5339\u914d\u5f53\u524d method \u7684\u65b9\u6cd5\u62e6\u622a\u5668\uff0c\u8981\u505a\u589e\u5f3a\u5904\u7406\uff0c\u628a\u65b9\u6cd5\u4fe1\u606f\u5c01\u88c5\u5230\u65b9\u6cd5\u8c03\u7528\u5668\u91cc\n            MethodInvocation invocation =\n                new ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain);\n            // \u3010\u62e6\u622a\u5668\u94fe\u9a71\u52a8\u65b9\u6cd5\uff0c\u6838\u5fc3\u3011\n            retVal = invocation.proceed();\n        }\n\n        Class<?> returnType = method.getReturnType();\n        if (retVal != null && retVal == target &&\n            returnType != Object.class && returnType.isInstance(proxy) &&\n            !RawTargetAccess.class.isAssignableFrom(method.getDeclaringClass())) {\n          \t// \u5982\u679c\u76ee\u6807\u65b9\u6cd5\u8fd4\u56de\u76ee\u6807\u5bf9\u8c61\uff0c\u8fd9\u91cc\u505a\u4e2a\u666e\u901a\u66ff\u6362\u8fd4\u56de\u4ee3\u7406\u5bf9\u8c61\n            retVal = proxy;\n        }\n        \n        // \u8fd4\u56de\u6267\u884c\u7684\u7ed3\u679c\n        return retVal;\n    }\n    finally {\n        if (target != null && !targetSource.isStatic()) {\n            targetSource.releaseTarget(target);\n        }\n        // \u5982\u679c\u5141\u8bb8\u4e86\u63d0\u524d\u66b4\u9732\uff0c\u8fd9\u91cc\u9700\u8981\u8bbe\u7f6e\u4e3a\u521d\u59cb\u72b6\u6001\n        if (setProxyContext) {\n            // \u5f53\u524d\u4ee3\u7406\u5bf9\u8c61\u5df2\u7ecf\u5b8c\u6210\u5de5\u4f5c\uff0c\u3010\u628a\u539f\u59cb\u5bf9\u8c61\u8bbe\u7f6e\u56de\u4e0a\u4e0b\u6587\u3011\n            AopContext.setCurrentProxy(oldProxy);\n        }\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["this.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass)\uff1a\u67e5\u627e\u9002\u5408\u8be5\u65b9\u6cd5\u7684\u589e\u5f3a\uff0c\u9996\u5148\u4ece\u7f13\u5b58\u4e2d\u67e5\u627e\uff0c\u83b7\u53d6\u901a\u77e5\u65f6\u662f\u4ece\u5168\u90e8\u589e\u5f3a\u4e2d\u83b7\u53d6\u9002\u5408\u5f53\u524d\u7c7b\u7684\uff0c\u8fd9\u91cc\u662f",(0,i.jsx)(e.strong,{children:"\u4ece\u5f53\u524d\u7c7b\u7684\u4e2d\u83b7\u53d6\u9002\u5408\u5f53\u524d\u65b9\u6cd5\u7684\u589e\u5f3a"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AdvisorAdapterRegistry registry = GlobalAdvisorAdapterRegistry.getInstance()"}),"\uff1a\u5411\u5bb9\u5668\u6ce8\u518c\u9002\u914d\u5668\uff0c",(0,i.jsx)(e.strong,{children:"\u53ef\u4ee5\u5c06\u975e Advisor \u7c7b\u578b\u7684\u589e\u5f3a\uff0c\u5305\u88c5\u6210\u4e3a Advisor\uff0c\u5c06 Advisor \u7c7b\u578b\u7684\u589e\u5f3a\u63d0\u53d6\u51fa\u6765\u5bf9\u5e94\u7684 MethodInterceptor"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"instance = new DefaultAdvisorAdapterRegistry()"}),"\uff1a\u8be5\u5bf9\u8c61\u5411\u5bb9\u5668\u4e2d\u6ce8\u518c\u4e86 MethodBeforeAdviceAdapter\u3001AfterReturningAdviceAdapter\u3001ThrowsAdviceAdapter \u4e09\u4e2a\u9002\u914d\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Advisor \u4e2d\u6301\u6709 Advice \u5bf9\u8c61"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public interface Advisor {\n\tAdvice getAdvice();\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"advisors = config.getAdvisors()"}),"\uff1a\u83b7\u53d6 ProxyFactory \u5185\u90e8\u6301\u6709\u7684\u589e\u5f3a\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"interceptorList = new ArrayList<>(advisors.length)"}),"\uff1a\u62e6\u622a\u5668\u5217\u8868\u6709 5 \u4e2a\uff0c1 \u4e2a ExposeInvocation\u548c 4 \u4e2a\u589e\u5f3a\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"actualClass = (targetClass != null ? targetClass : method.getDeclaringClass())"}),"\uff1a\u771f\u5b9e\u7684\u76ee\u6807\u5bf9\u8c61\u7c7b\u578b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Boolean hasIntroductions = null"}),"\uff1a\u5f15\u4ecb\u589e\u5f3a\uff0c\u4e0d\u5173\u5fc3"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (Advisor advisor : advisors)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u6240\u6709\u7684 advisor \u589e\u5f3a"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (advisor instanceof PointcutAdvisor)"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d Advisor \u662f\u5305\u542b\u5207\u70b9\u4fe1\u606f\u7684\uff0c\u8fdb\u5165\u5339\u914d\u903b\u8f91"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"pointcutAdvisor = (PointcutAdvisor) advisor"}),"\uff1a\u8f6c\u6210\u53ef\u4ee5\u83b7\u53d6\u5230\u5207\u70b9\u4fe1\u606f\u7684\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if(config.isPreFiltered() || pointcutAdvisor.getPointcut().getClassFilter().matches(actualClass))"}),"\uff1a\u5f53\u524d\u4ee3\u7406\u88ab\u9884\u5904\u7406\uff0c\u6216\u8005\u5f53\u524d\u88ab\u4ee3\u7406\u7684 class \u5bf9\u8c61\u5339\u914d\u5f53\u524d Advisor \u6210\u529f\uff0c\u53ea\u662f class \u5339\u914d\u6210\u529f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mm = pointcutAdvisor.getPointcut().getMethodMatcher()"}),"\uff1a\u83b7\u53d6\u5207\u70b9\u7684\u65b9\u6cd5\u5339\u914d\u5668\uff0c\u4e0d\u8003\u8651\u5f15\u4ecb\u589e\u5f3a"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"match = mm.matches(method, actualClass)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u9759\u6001\u5339\u914d\u6210\u529f\u8fd4\u56de true\uff0c\u53ea\u5173\u6ce8\u4e8e\u5904\u7406\u7c7b\u53ca\u5176\u65b9\u6cd5\uff0c\u4e0d\u8003\u8651\u53c2\u6570"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (match)"}),"\uff1a\u5982\u679c\u9759\u6001\u5207\u70b9\u68c0\u67e5\u662f\u5339\u914d\u7684\uff0c\u5728\u8fd0\u884c\u7684\u65f6\u5019\u624d\u8fdb\u884c",(0,i.jsx)(e.strong,{children:"\u52a8\u6001\u5207\u70b9\u68c0\u67e5\uff0c\u4f1a\u8003\u8651\u53c2\u6570\u5339\u914d"}),"\uff08\u4ee3\u8868\u4f20\u5165\u4e86\u53c2\u6570\uff09\u3002\u5982\u679c\u9759\u6001\u5339\u914d\u5931\u8d25\uff0c\u76f4\u63a5\u4e0d\u9700\u8981\u8fdb\u884c\u53c2\u6570\u5339\u914d\uff0c\u63d0\u9ad8\u4e86\u5de5\u4f5c\u6548\u7387"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"interceptors = registry.getInterceptors(advisor)"}),"\uff1a\u63d0\u53d6\u51fa\u5f53\u524d advisor \u5185\u6301\u6709\u7684 advice \u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Advice advice = advisor.getAdvice()"}),"\uff1a\u83b7\u53d6\u589e\u5f3a\u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (advice instanceof MethodInterceptor)"}),"\uff1a\u5f53\u524d advice \u662f MethodInterceptor \u76f4\u63a5\u52a0\u5165\u96c6\u5408"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (AdvisorAdapter adapter : this.adapters)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u4e09\u4e2a\u9002\u914d\u5668\u8fdb\u884c\u5339\u914d"}),"\uff08\u521d\u59cb\u5316\u65f6\u521b\u5efa\u7684\uff09\uff0c\u5339\u914d\u6210\u529f\u521b\u5efa\u5bf9\u5e94\u7684\u62e6\u622a\u5668\u8fd4\u56de\uff0c\u4ee5 MethodBeforeAdviceAdapter \u4e3a\u4f8b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (adapter.supportsAdvice(advice))"}),"\uff1a\u5224\u65ad\u5f53\u524d advice \u662f\u5426\u662f\u5bf9\u5e94\u7684 MethodBeforeAdvice"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"interceptors.add(adapter.getInterceptor(advisor))"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u5c31\u5f80\u62e6\u622a\u5668\u94fe\u4e2d\u6dfb\u52a0 advisor"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"advice = (MethodBeforeAdvice) advisor.getAdvice()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u589e\u5f3a\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return new MethodBeforeAdviceInterceptor(advice)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c01\u88c5\u6210 MethodBeforeAdviceInterceptor \u8fd4\u56de"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"interceptorList.add(new InterceptorAndDynamicMethodMatcher(interceptor, mm))"}),"\uff1a\u5411\u62e6\u622a\u5668\u94fe\u6dfb\u52a0\u52a8\u6001\u5339\u914d\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"interceptorList.addAll(Arrays.asList(interceptors))"}),"\uff1a\u5c06\u5f53\u524d advisor \u5185\u90e8\u7684\u65b9\u6cd5\u62e6\u622a\u5668\u8ffd\u52a0\u5230 interceptorList"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"interceptors = registry.getInterceptors(advisor)"}),"\uff1a\u8fdb\u5165 else \u7684\u903b\u8f91\uff0c\u8bf4\u660e\u5f53\u524d Advisor \u5339\u914d\u5168\u90e8 class \u7684\u5168\u90e8 method\uff0c\u5168\u90e8\u52a0\u5165\u5230 interceptorList"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return interceptorList"}),"\uff1a\u8fd4\u56de method \u65b9\u6cd5\u7684\u62e6\u622a\u5668\u94fe"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["retVal = invocation.proceed()\uff1a",(0,i.jsx)(e.strong,{children:"\u62e6\u622a\u5668\u94fe\u9a71\u52a8\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (this.currentInterceptorIndex == this.interceptorsAndDynamicMethodMatchers.size() - 1)"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u65b9\u6cd5\u62e6\u622a\u5668\u5168\u90e8\u90fd\u5df2\u7ecf\u8c03\u7528\u8fc7\u4e86\uff08index \u4ece - 1 \u5f00\u59cb\u7d2f\u52a0\uff09\uff0c\u63a5\u4e0b\u6765\u9700\u8981\u6267\u884c\u76ee\u6807\u5bf9\u8c61\u7684\u76ee\u6807\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return invokeJoinpoint()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8c03\u7528\u8fde\u63a5\u70b9\uff08\u76ee\u6807\uff09\u65b9\u6cd5"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.interceptorsAndDynamicMethodMatchers.get(++this.currentInterceptorIndex)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u4e0b\u4e00\u4e2a\u65b9\u6cd5\u62e6\u622a\u5668"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (interceptorOrInterceptionAdvice instanceof InterceptorAndDynamicMethodMatcher)"}),"\uff1a\u9700\u8981\u8fd0\u884c\u65f6\u5339\u914d"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (dm.methodMatcher.matches(this.method, targetClass, this.arguments))"}),"\uff1a\u5224\u65ad\u662f\u5426\u5339\u914d\u6210\u529f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return dm.interceptor.invoke(this)"}),"\uff1a\u5339\u914d\u6210\u529f\uff0c\u6267\u884c\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return proceed()"}),"\uff1a\u5339\u914d\u5931\u8d25\u8df3\u8fc7\u5f53\u524d\u62e6\u622a\u5668"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(this)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4e00\u822c\u65b9\u6cd5\u62e6\u622a\u5668\u90fd\u4f1a\u6267\u884c\u5230\u8be5\u65b9\u6cd5\uff0c\u6b64\u65b9\u6cd5\u5185\u7ee7\u7eed\u6267\u884c proceed() \u5b8c\u6210\u8d23\u4efb\u94fe\u7684\u9a71\u52a8\uff0c\u76f4\u5230\u6700\u540e\u4e00\u4e2a  MethodBeforeAdviceInterceptor \u8c03\u7528\u524d\u7f6e\u901a\u77e5\uff0c\u7136\u540e\u8c03\u7528 mi.proceed()\uff0c\u53d1\u73b0\u662f\u6700\u540e\u4e00\u4e2a\u62e6\u622a\u5668\u5c31\u76f4\u63a5\u6267\u884c\u8fde\u63a5\u70b9\uff08\u76ee\u6807\u65b9\u6cd5\uff09\uff0creturn \u5230\u4e0a\u4e00\u4e2a\u62e6\u622a\u5668\u7684 mi.proceed() \u5904\uff0c\u4f9d\u6b21\u8fd4\u56de\u5230\u8d23\u4efb\u94fe\u7684\u4e0a\u4e00\u4e2a\u62e6\u622a\u5668\u6267\u884c\u901a\u77e5\u65b9\u6cd5"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u56fe\u793a\u5148\u4ece\u4e0a\u5f80\u4e0b\u5efa\u7acb\u94fe\uff0c\u7136\u540e\u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u6267\u884c\uff0c\u8d23\u4efb\u94fe\u6a21\u5f0f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6b63\u5e38\u6267\u884c\uff1a\uff08\u73af\u7ed5\u901a\u77e5\uff09\u2192 \u524d\u7f6e\u901a\u77e5 \u2192 \u76ee\u6807\u65b9\u6cd5 \u2192 \u540e\u7f6e\u901a\u77e5 \u2192 \u8fd4\u56de\u901a\u77e5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u51fa\u73b0\u5f02\u5e38\uff1a\uff08\u73af\u7ed5\u901a\u77e5\uff09\u2192 \u524d\u7f6e\u901a\u77e5 \u2192 \u76ee\u6807\u65b9\u6cd5 \u2192 \u540e\u7f6e\u901a\u77e5 \u2192 \u5f02\u5e38\u901a\u77e5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MethodBeforeAdviceInterceptor \u6e90\u7801\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object invoke(MethodInvocation mi) throws Throwable {\n    // \u5148\u6267\u884c\u901a\u77e5\u65b9\u6cd5\uff0c\u518d\u9a71\u52a8\u8d23\u4efb\u94fe\n    this.advice.before(mi.getMethod(), mi.getArguments(), mi.getThis());\n    // \u5f00\u59cb\u9a71\u52a8\u76ee\u6807\u65b9\u6cd5\u6267\u884c\uff0c\u6267\u884c\u5b8c\u540e\u8fd4\u56de\u5230\u8fd9\uff0c\u7136\u540e\u7ee7\u7eed\u5411\u4e0a\u5c42\u8fd4\u56de\n    return mi.proceed();\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AfterReturningAdviceInterceptor \u6e90\u7801\uff1a\u6ca1\u6709\u4efb\u4f55\u5f02\u5e38\u5904\u7406\u673a\u5236\uff0c\u76f4\u63a5\u629b\u7ed9\u4e0a\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object invoke(MethodInvocation mi) throws Throwable {\n    // \u5148\u9a71\u52a8\u8d23\u4efb\u94fe\uff0c\u518d\u6267\u884c\u901a\u77e5\u65b9\u6cd5\n    Object retVal = mi.proceed();\n    this.advice.afterReturning(retVal, mi.getMethod(), mi.getArguments(), mi.getThis());\n    return retVal;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AspectJAfterThrowingAdvice \u6267\u884c\u5f02\u5e38\u5904\u7406\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object invoke(MethodInvocation mi) throws Throwable {\n    try {\n        // \u9ed8\u8ba4\u76f4\u63a5\u9a71\u52a8\u8d23\u4efb\u94fe\n        return mi.proceed();\n    }\n    catch (Throwable ex) {\n        // \u51fa\u73b0\u9519\u8bef\u624d\u6267\u884c\u8be5\u65b9\u6cd5\n        if (shouldInvokeOnThrowing(ex)) {\n            invokeAdviceMethod(getJoinPointMatch(), null, ex);\n        }\n        throw ex;\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(89213).A+"",width:"1134",height:"634"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u89c6\u9891\uff1a",(0,i.jsx)(e.a,{href:"https://www.bilibili.com/video/BV1gW411W7wy",children:"https://www.bilibili.com/video/BV1gW411W7wy"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u4e8b\u52a1-1",children:"\u4e8b\u52a1"}),"\n",(0,i.jsx)(e.h4,{id:"\u89e3\u6790\u65b9\u6cd5",children:"\u89e3\u6790\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.h5,{id:"\u6807\u7b7e\u89e3\u6790",children:"\u6807\u7b7e\u89e3\u6790"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<tx:annotation-driven transaction-manager="txManager"/>\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5bb9\u5668\u542f\u52a8\u65f6\u4f1a\u6839\u636e\u6ce8\u89e3\u6ce8\u518c\u5bf9\u5e94\u7684\u89e3\u6790\u5668\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class TxNamespaceHandler extends NamespaceHandlerSupport {\n    public void init() {\n\t\tregisterBeanDefinitionParser("advice", new TxAdviceBeanDefinitionParser());\n        // \u6ce8\u518c\u89e3\u6790\u5668\n\t\tregisterBeanDefinitionParser("annotation-driven", new AnnotationDrivenBeanDefinitionParser());\n\t\tregisterBeanDefinitionParser("jta-transaction-manager", new JtaTransactionManagerBeanDefinitionParser());\n\t}\n}\nprotected final void registerBeanDefinitionParser(String elementName, BeanDefinitionParser parser) {\n    this.parsers.put(elementName, parser);\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6\u5bf9\u5e94\u7684\u89e3\u6790\u5668 NamespaceHandlerSupport#findParserForElement\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private BeanDefinitionParser findParserForElement(Element element, ParserContext parserContext) {\n    String localName = parserContext.getDelegate().getLocalName(element);\n    // \u83b7\u53d6\u5bf9\u5e94\u7684\u89e3\u6790\u5668\n    BeanDefinitionParser parser = this.parsers.get(localName);\n\t// ...\n    return parser;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8c03\u7528\u89e3\u6790\u5668\u7684\u65b9\u6cd5\u5bf9 XML \u6587\u4ef6\u8fdb\u884c\u89e3\u6790\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public BeanDefinition parse(Element element, ParserContext parserContext) {\n\t// \u5411Spring\u5bb9\u5668\u6ce8\u518c\u4e86\u4e00\u4e2a BD -> TransactionalEventListenerFactory.class\n    registerTransactionalEventListenerFactory(parserContext);\n    String mode = element.getAttribute("mode");\n    if ("aspectj".equals(mode)) {\n        // mode="aspectj"\n        registerTransactionAspect(element, parserContext);\n        if (ClassUtils.isPresent("javax.transaction.Transactional", getClass().getClassLoader())) {\n            registerJtaTransactionAspect(element, parserContext);\n        }\n    }\n    else {\n        // mode="proxy"\uff0c\u9ed8\u8ba4\u903b\u8f91\uff0c\u4e0d\u914d\u7f6e mode \u65f6\n        // \u7528\u6765\u5411\u5bb9\u5668\u4e2d\u6ce8\u5165\u4e00\u4e9b BeanDefinition\uff0c\u5305\u62ec\u4e8b\u52a1\u589e\u5f3a\u5668\u3001\u4e8b\u52a1\u62e6\u622a\u5668\u3001\u6ce8\u89e3\u89e3\u6790\u5668\n        AopAutoProxyConfigurer.configureAutoProxyCreator(element, parserContext);\n    }\n    return null;\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6ce8\u89e3\u89e3\u6790",children:"\u6ce8\u89e3\u89e3\u6790"}),"\n",(0,i.jsx)(e.p,{children:"@EnableTransactionManagement \u5bfc\u5165 TransactionManagementConfigurationSelector\uff0c\u8be5\u7c7b\u7ed9 Spring \u5bb9\u5668\u4e2d\u4e24\u4e2a\u7ec4\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected String[] selectImports(AdviceMode adviceMode) {\n    switch (adviceMode) {\n        // \u5bfc\u5165 AutoProxyRegistrar \u548c ProxyTransactionManagementConfiguration\uff08\u9ed8\u8ba4\uff09\n        case PROXY:\n            return new String[] {AutoProxyRegistrar.class.getName(),\n                                 ProxyTransactionManagementConfiguration.class.getName()};\n        // \u5bfc\u5165 AspectJTransactionManagementConfiguration\uff08\u4e0e\u58f0\u660e\u5f0f\u4e8b\u52a1\u65e0\u5173\uff09\n        case ASPECTJ:\n            return new String[] {determineTransactionAspectClass()};\n        default:\n            return null;\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["AutoProxyRegistrar\uff1a\u7ed9\u5bb9\u5668\u4e2d\u6ce8\u518c InfrastructureAdvisorAutoProxyCreator\uff0c",(0,i.jsx)(e.strong,{children:"\u5229\u7528\u540e\u7f6e\u5904\u7406\u5668\u673a\u5236\u62e6\u622a bean \u4ee5\u540e\u5305\u88c5\u5e76\u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61"}),"\uff0c\u4ee3\u7406\u5bf9\u8c61\u4e2d\u4fdd\u5b58\u6240\u6709\u7684\u62e6\u622a\u5668\uff0c\u5229\u7528\u62e6\u622a\u5668\u7684\u94fe\u5f0f\u673a\u5236\u4f9d\u6b21\u8fdb\u5165\u6bcf\u4e00\u4e2a\u62e6\u622a\u5668\u4e2d\u8fdb\u884c\u62e6\u622a\u6267\u884c\uff08\u5c31\u662f AOP \u539f\u7406\uff09"]}),"\n",(0,i.jsx)(e.p,{children:"ProxyTransactionManagementConfiguration\uff1a\u662f\u4e00\u4e2a Spring \u7684\u4e8b\u52a1\u914d\u7f6e\u7c7b\uff0c\u6ce8\u518c\u4e86\u4e09\u4e2a Bean\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"BeanFactoryTransactionAttributeSourceAdvisor\uff1a\u4e8b\u52a1\u9a71\u52a8\uff0c\u5229\u7528\u6ce8\u89e3 @Bean \u628a\u8be5\u7c7b\u6ce8\u5165\u5230\u5bb9\u5668\u4e2d\uff0c\u8be5\u589e\u5f3a\u5668\u6709\u4e24\u4e2a\u5b57\u6bb5\uff1a"}),"\n",(0,i.jsxs)(e.li,{children:["TransactionAttributeSource\uff1a\u89e3\u6790\u4e8b\u52a1\u6ce8\u89e3\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u771f\u5b9e\u7c7b\u578b\u662f AnnotationTransactionAttributeSource\uff0c\u6784\u9020\u65b9\u6cd5\u4e2d\u6ce8\u518c\u4e86\u4e09\u4e2a",(0,i.jsx)(e.strong,{children:"\u6ce8\u89e3\u89e3\u6790\u5668"}),"\uff0c\u89e3\u6790 Spring\u3001JTA\u3001Ejb3 \u4e09\u79cd\u7c7b\u578b\u7684\u4e8b\u52a1\u6ce8\u89e3"]}),"\n",(0,i.jsxs)(e.li,{children:["TransactionInterceptor\uff1a",(0,i.jsx)(e.strong,{children:"\u4e8b\u52a1\u62e6\u622a\u5668"}),"\uff0c\u4ee3\u7406\u5bf9\u8c61\u6267\u884c\u62e6\u622a\u5668\u65b9\u6cd5\u65f6\uff0c\u8c03\u7528 TransactionInterceptor \u7684 invoke \u65b9\u6cd5\uff0c\u5e95\u5c42\u8c03\u7528TransactionAspectSupport.invokeWithinTransaction()\uff0c\u901a\u8fc7 PlatformTransactionManager \u63a7\u5236\u7740\u4e8b\u52a1\u7684\u63d0\u4ea4\u548c\u56de\u6eda\uff0c\u6240\u4ee5\u4e8b\u52a1\u7684\u5e95\u5c42\u539f\u7406\u5c31\u662f\u901a\u8fc7 AOP \u52a8\u6001\u7ec7\u5165\uff0c\u8fdb\u884c\u4e8b\u52a1\u5f00\u542f\u548c\u63d0\u4ea4"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u89e3\u89e3\u6790\u5668 SpringTransactionAnnotationParser ",(0,i.jsx)(e.strong,{children:"\u89e3\u6790 @Transactional \u6ce8\u89e3"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'protected TransactionAttribute parseTransactionAnnotation(AnnotationAttributes attributes) {\n    RuleBasedTransactionAttribute rbta = new RuleBasedTransactionAttribute();\n\t// \u4ece\u6ce8\u89e3\u4fe1\u606f\u4e2d\u83b7\u53d6\u4f20\u64ad\u884c\u4e3a\n    Propagation propagation = attributes.getEnum("propagation");\n    rbta.setPropagationBehavior(propagation.value());\n    // \u83b7\u53d6\u9694\u79bb\u754c\u522b\n    Isolation isolation = attributes.getEnum("isolation");\n    rbta.setIsolationLevel(isolation.value());\n    rbta.setTimeout(attributes.getNumber("timeout").intValue());\n    // \u4ece\u6ce8\u89e3\u4fe1\u606f\u4e2d\u83b7\u53d6 readOnly \u53c2\u6570\n    rbta.setReadOnly(attributes.getBoolean("readOnly"));\n    // \u4ece\u6ce8\u89e3\u4fe1\u606f\u4e2d\u83b7\u53d6 value \u4fe1\u606f\u5e76\u4e14\u8bbe\u7f6e qualifier\uff0c\u8868\u793a\u5f53\u524d\u4e8b\u52a1\u6307\u5b9a\u4f7f\u7528\u7684\u3010\u4e8b\u52a1\u7ba1\u7406\u5668\u3011\n    rbta.setQualifier(attributes.getString("value"));\n\t// \u3010\u5b58\u653e\u7684\u662f rollback \u6761\u4ef6\u3011\uff0c\u56de\u6eda\u89c4\u5219\u653e\u5728\u8fd9\u4e2a\u96c6\u5408\n    List<RollbackRuleAttribute> rollbackRules = new ArrayList<>();\n    // \u8868\u793a\u4e8b\u52a1\u78b0\u5230\u54ea\u4e9b\u6307\u5b9a\u7684\u5f02\u5e38\u624d\u8fdb\u884c\u56de\u6eda\uff0c\u4e0d\u6307\u5b9a\u7684\u8bdd\u9ed8\u8ba4\u662f RuntimeException/Error \u975e\u68c0\u67e5\u578b\u5f02\u5e38\u83dc\u56de\u6eda\n    for (Class<?> rbRule : attributes.getClassArray("rollbackFor")) {\n        rollbackRules.add(new RollbackRuleAttribute(rbRule));\n    }\n    // \u4e0e rollbackFor \u529f\u80fd\u76f8\u540c\n    for (String rbRule : attributes.getStringArray("rollbackForClassName")) {\n        rollbackRules.add(new RollbackRuleAttribute(rbRule));\n    }\n    // \u8868\u793a\u4e8b\u52a1\u78b0\u5230\u6307\u5b9a\u7684 exception \u5b9e\u73b0\u5bf9\u8c61\u4e0d\u8fdb\u884c\u56de\u6eda\uff0c\u5426\u5219\u78b0\u5230\u5176\u4ed6\u7684class\u5c31\u8fdb\u884c\u56de\u6eda\n    for (Class<?> rbRule : attributes.getClassArray("noRollbackFor")) {\n        rollbackRules.add(new NoRollbackRuleAttribute(rbRule));\n    }\n    for (String rbRule : attributes.getStringArray("noRollbackForClassName")) {\n        rollbackRules.add(new NoRollbackRuleAttribute(rbRule));\n    }\n    // \u8bbe\u7f6e\u56de\u6eda\u89c4\u5219\n    rbta.setRollbackRules(rollbackRules);\n\n    return rbta;\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u9a71\u52a8\u65b9\u6cd5",children:"\u9a71\u52a8\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"TransactionInterceptor \u4e8b\u52a1\u62e6\u622a\u5668\u7684\u6838\u5fc3\u9a71\u52a8\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Object invoke(MethodInvocation invocation) throws Throwable {\n    // targetClass \u662f\u9700\u8981\u88ab\u4e8b\u52a1\u589e\u5f3a\u5668\u589e\u5f3a\u7684\u76ee\u6807\u7c7b\uff0cinvocation.getThis() \u2192 \u76ee\u6807\u5bf9\u8c61 \u2192 \u76ee\u6807\u7c7b\n    Class<?> targetClass = (invocation.getThis() != null ? AopUtils.getTargetClass(invocation.getThis()) : null);\n\t// \u53c2\u6570\u4e00\u662f\u76ee\u6807\u65b9\u6cd5\uff0c\u53c2\u6570\u4e8c\u662f\u76ee\u6807\u7c7b\uff0c\u53c2\u6570\u4e09\u662f\u65b9\u6cd5\u5f15\u7528\uff0c\u7528\u6765\u89e6\u53d1\u9a71\u52a8\u65b9\u6cd5\n    return invokeWithinTransaction(invocation.getMethod(), targetClass, invocation::proceed);\n}\n\nprotected Object invokeWithinTransaction(Method method, @Nullable Class<?> targetClass,\n                                         final InvocationCallback invocation) throws Throwable {\n\n    // \u4e8b\u52a1\u5c5e\u6027\u6e90\u4fe1\u606f\n    TransactionAttributeSource tas = getTransactionAttributeSource();\n    //  \u63d0\u53d6 @Transactional \u6ce8\u89e3\u4fe1\u606f\uff0ctxAttr \u662f\u6ce8\u89e3\u4fe1\u606f\u7684\u627f\u8f7d\u5bf9\u8c61\n    final TransactionAttribute txAttr = (tas != null ? tas.getTransactionAttribute(method, targetClass) : null);\n    // \u83b7\u53d6 Spring \u914d\u7f6e\u7684\u4e8b\u52a1\u7ba1\u7406\u5668\n    // \u9996\u5148\u4f1a\u68c0\u67e5\u662f\u5426\u901a\u8fc7XML\u6216\u6ce8\u89e3\u914d\u7f6e qualifier\uff0c\u6ca1\u6709\u5c31\u5c1d\u8bd5\u53bb\u5bb9\u5668\u83b7\u53d6\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a DatasourceTransactionManager\n    final PlatformTransactionManager tm = determineTransactionManager(txAttr);\n    // \u6743\u9650\u5b9a\u7c7b\u540d.\u65b9\u6cd5\u540d\uff0c\u8be5\u503c\u7528\u6765\u5f53\u505a\u4e8b\u52a1\u540d\u79f0\u4f7f\u7528\n    final String joinpointIdentification = methodIdentification(method, targetClass, txAttr);\n    \n\t// \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u662f\u3010\u58f0\u660e\u5f0f\u4e8b\u52a1\u3011\n    if (txAttr == null || !(tm instanceof CallbackPreferringPlatformTransactionManager)) {\n    \t// \u7528\u6765\u3010\u5f00\u542f\u4e8b\u52a1\u3011\n        TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);\n\n        Object retVal;\n        try {\n            // This is an \u3010around advice\u3011: Invoke the next interceptor in the chain.\n            // \u73af\u7ed5\u901a\u77e5\uff0c\u6267\u884c\u76ee\u6807\u65b9\u6cd5\uff08\u65b9\u6cd5\u5f15\u7528\u65b9\u5f0f\uff0cinvocation::proceed\uff0c\u8fd8\u662f\u8c03\u7528 proceed\uff09\n            retVal = invocation.proceedWithInvocation();\n        }\n        catch (Throwable ex) {\n            //  \u6267\u884c\u4e1a\u52a1\u4ee3\u7801\u65f6\u629b\u51fa\u5f02\u5e38\uff0c\u6267\u884c\u56de\u6eda\u903b\u8f91\n            completeTransactionAfterThrowing(txInfo, ex);\n            throw ex;\n        }\n        finally {\n            // \u6e05\u7406\u4e8b\u52a1\u7684\u4fe1\u606f\n            cleanupTransactionInfo(txInfo);\n        }\n        // \u63d0\u4ea4\u4e8b\u52a1\u7684\u5165\u53e3\n        commitTransactionAfterReturning(txInfo);\n        return retVal;\n    }\n    else {\n       // \u7f16\u7a0b\u5f0f\u4e8b\u52a1\uff0c\u7701\u7565\n    }\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5f00\u542f\u4e8b\u52a1",children:"\u5f00\u542f\u4e8b\u52a1"}),"\n",(0,i.jsx)(e.h5,{id:"\u4e8b\u52a1\u7ed1\u5b9a",children:"\u4e8b\u52a1\u7ed1\u5b9a"}),"\n",(0,i.jsx)(e.p,{children:"\u521b\u5efa\u4e8b\u52a1\u7684\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'protected TransactionInfo createTransactionIfNecessary(@Nullable PlatformTransactionManager tm,\n                                                       @Nullable TransactionAttribute txAttr, \n                                                       final String joinpointIdentification) {\n\n    // If no name specified, apply method identification as transaction name.\n    if (txAttr != null && txAttr.getName() == null) {\n        // \u4e8b\u52a1\u7684\u540d\u79f0\uff1a \u7c7b\u7684\u6743\u9650\u5b9a\u540d.\u65b9\u6cd5\u540d\n        txAttr = new DelegatingTransactionAttribute(txAttr) {\n            @Override\n            public String getName() {\n                return joinpointIdentification;\n            }\n        };\n    }\n    TransactionStatus status = null;\n    if (txAttr != null) {\n        if (tm != null) {\n            // \u901a\u8fc7\u4e8b\u52a1\u7ba1\u7406\u5668\u6839\u636e\u4e8b\u52a1\u5c5e\u6027\u521b\u5efa\u4e8b\u52a1\u72b6\u6001\u5bf9\u8c61\uff0c\u4e8b\u52a1\u72b6\u6001\u5bf9\u8c61\u4e00\u822c\u60c5\u51b5\u4e0b\u5305\u88c5\u7740 \u4e8b\u52a1\u5bf9\u8c61\uff0c\u5f53\u7136\u4e5f\u6709\u53ef\u80fd\u662fnull\n            // \u65b9\u6cd5\u4e0a\u7684\u6ce8\u89e3\u4e3a @Transactional(propagation = NOT_SUPPORTED || propagation = NEVER) \u65f6\n            // \u3010\u4e0b\u4e00\u5c0f\u8282\u8be6\u89e3\u3011\n            status = tm.getTransaction(txAttr);\n        }\n        else {\n            if (logger.isDebugEnabled()) {\n                logger.debug("Skipping transactional joinpoint [" + joinpointIdentification +\n                             "] because no transaction manager has been configured");\n            }\n        }\n    }\n    // \u5305\u88c5\u6210\u4e00\u4e2a\u4e0a\u5c42\u7684\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5bf9\u8c61\n    return prepareTransactionInfo(tm, txAttr, joinpointIdentification, status);\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"TransactionAspectSupport#prepareTransactionInfo\uff1a\u4e3a\u4e8b\u52a1\u7684\u5c5e\u6027\u548c\u72b6\u6001\u51c6\u5907\u4e00\u4e2a\u4e8b\u52a1\u4fe1\u606f\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TransactionInfo txInfo = new TransactionInfo(tm, txAttr, joinpointIdentification)"}),"\uff1a\u521b\u5efa\u4e8b\u52a1\u4fe1\u606f\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"txInfo.newTransactionStatus(status)"}),"\uff1a\u586b\u5145\u4e8b\u52a1\u7684\u72b6\u6001\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"txInfo.bindToThread()"}),"\uff1a\u5229\u7528 ThreadLocal ",(0,i.jsx)(e.strong,{children:"\u628a\u5f53\u524d\u4e8b\u52a1\u4fe1\u606f\u7ed1\u5b9a\u5230\u5f53\u524d\u7ebf\u7a0b"}),"\uff0c\u4e0d\u540c\u7684\u4e8b\u52a1\u4fe1\u606f\u4f1a\u5f62\u6210\u4e00\u4e2a\u6808\u7684\u7ed3\u6784\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.oldTransactionInfo = transactionInfoHolder.get()"}),"\uff1a\u83b7\u53d6\u5176\u4ed6\u4e8b\u52a1\u7684\u4fe1\u606f\u5b58\u5165 oldTransactionInfo"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"transactionInfoHolder.set(this)"}),"\uff1a\u5c06\u5f53\u524d\u7684\u4e8b\u52a1\u4fe1\u606f\u8bbe\u7f6e\u5230 ThreadLocalMap \u4e2d"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u4e8b\u52a1\u521b\u5efa",children:"\u4e8b\u52a1\u521b\u5efa"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public final TransactionStatus getTransaction(@Nullable TransactionDefinition definition) throws TransactionException {\n    // \u83b7\u53d6\u4e8b\u52a1\u7684\u5bf9\u8c61\n    Object transaction = doGetTransaction();\n    boolean debugEnabled = logger.isDebugEnabled();\n\n    if (definition == null) {\n        // Use defaults if no transaction definition given.\n        definition = new DefaultTransactionDefinition();\n    }\n\t// \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d\u662f\u4e8b\u52a1\u91cd\u5165\u7684\u60c5\u51b5\uff0c\u4e8b\u52a1\u4e2d\u6709 ConnectionHolder \u5bf9\u8c61\n    if (isExistingTransaction(transaction)) {\n        // a\u65b9\u6cd5\u5f00\u542f\u4e8b\u52a1\uff0ca\u65b9\u6cd5\u5185\u8c03\u7528b\u65b9\u6cd5\uff0cb\u65b9\u6cd5\u4ecd\u7136\u52a0\u4e86 @Transactional \u6ce8\u89e3\uff0c\u9700\u8981\u68c0\u67e5\u4f20\u64ad\u884c\u4e3a\n        return handleExistingTransaction(definition, transaction, debugEnabled);\n    }\n    \n\t// \u903b\u8f91\u5230\u8fd9\u8bf4\u660e\u5f53\u524d\u7ebf\u7a0b\u6ca1\u6709\u8fde\u63a5\u8d44\u6e90\uff0c\u4e00\u4e2a\u8fde\u63a5\u5bf9\u5e94\u4e00\u4e2a\u4e8b\u52a1\uff0c\u6ca1\u6709\u8fde\u63a5\u5c31\u76f8\u5f53\u4e8e\u6ca1\u6709\u5f00\u542f\u4e8b\u52a1\n    // \u68c0\u67e5\u4e8b\u52a1\u7684\u5ef6\u8fdf\u5c5e\u6027\n    if (definition.getTimeout() < TransactionDefinition.TIMEOUT_DEFAULT) {\n        throw new InvalidTimeoutException("Invalid transaction timeout", definition.getTimeout());\n    }\n\n    // \u4f20\u64ad\u884c\u4e3a\u662f MANDATORY\uff0c\u6ca1\u6709\u4e8b\u52a1\u5c31\u629b\u51fa\u5f02\u5e38\n    if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_MANDATORY) {\n        throw new IllegalTransactionStateException();\n    }\n    // \u9700\u8981\u5f00\u542f\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a\n    else if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRED ||\n             definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRES_NEW ||\n             definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NESTED) {\n        // \u4ec0\u4e48\u4e5f\u6ca1\u6302\u8d77\uff0c\u56e0\u4e3a\u7ebf\u7a0b\u5e76\u6ca1\u6709\u7ed1\u5b9a\u4e8b\u52a1\n        SuspendedResourcesHolder suspendedResources = suspend(null);\n        try {\n            // \u662f\u5426\u652f\u6301\u540c\u6b65\u7ebf\u7a0b\u4e8b\u52a1\uff0c\u4e00\u822c\u662f true\n            boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);\n            // \u65b0\u5efa\u4e00\u4e2a\u4e8b\u52a1\u72b6\u6001\u4fe1\u606f\n            DefaultTransactionStatus status = newTransactionStatus(\n                definition, transaction, true, newSynchronization, debugEnabled, suspendedResources);\n            // \u3010\u542f\u52a8\u4e8b\u52a1\u3011\n            doBegin(transaction, definition);\n            // \u8bbe\u7f6e\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u53d8\u91cf\uff0c\u65b9\u4fbf\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u83b7\u53d6\u5f53\u524d\u4e8b\u52a1\u7684\u4e00\u4e9b\u6838\u5fc3\u7684\u5c5e\u6027\uff0cinitSynchronization() \u542f\u52a8\u540c\u6b65\n            prepareSynchronization(status, definition);\n            return status;\n        }\n        catch (RuntimeException | Error ex) {\n            // \u6062\u590d\u73b0\u573a\n            resume(null, suspendedResources);\n            throw ex;\n        }\n    }\n    // \u4e0d\u652f\u6301\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a\n    else {\n        // Create "empty" transaction: no actual transaction, but potentially synchronization.\n        boolean newSynchronization = (getTransactionSynchronization() == SYNCHRONIZATION_ALWAYS);\n        // \u521b\u5efa\u4e8b\u52a1\u72b6\u6001\u5bf9\u8c61\n        // \u53c2\u65702 transaction \u662f null \u8bf4\u660e\u5f53\u524d\u4e8b\u52a1\u72b6\u6001\u662f\u672a\u624b\u52a8\u5f00\u542f\u4e8b\uff0c\u7ebf\u7a0b\u4e0a\u672a\u7ed1\u5b9a\u4efb\u4f55\u7684\u8fde\u63a5\u8d44\u6e90\uff0c\u4e1a\u52a1\u7a0b\u5e8f\u6267\u884c\u65f6\u9700\u8981\u5148\u53bb datasource \u83b7\u53d6\u7684 conn\uff0c\u662f\u81ea\u52a8\u63d0\u4ea4\u4e8b\u52a1\u7684\uff0c\u4e0d\u9700\u8981 Spring \u518d\u63d0\u4ea4\u4e8b\u52a1\n        // \u53c2\u65706 suspendedResources \u662f null \u8bf4\u660e\u5f53\u524d\u4e8b\u52a1\u72b6\u6001\u672a\u6302\u8d77\u4efb\u4f55\u4e8b\u52a1\uff0c\u5f53\u524d\u4e8b\u52a1\u6267\u884c\u5230\u540e\u7f6e\u5904\u7406\u65f6\u4e0d\u9700\u8981\u6062\u590d\u73b0\u573a\n        return prepareTransactionStatus(definition, null, true, newSynchronization, debugEnabled, null);\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"DataSourceTransactionManager#doGetTransaction\uff1a\u771f\u6b63\u83b7\u53d6\u4e8b\u52a1\u7684\u65b9\u6cd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DataSourceTransactionObject txObject = new DataSourceTransactionObject()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u4e8b\u52a1\u5bf9\u8c61"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.setSavepointAllowed(isNestedAllowed())"}),"\uff1a\u8bbe\u7f6e\u4e8b\u52a1\u5bf9\u8c61\u662f\u5426\u652f\u6301\u4fdd\u5b58\u70b9\uff0c\u7531\u4e8b\u52a1\u7ba1\u7406\u5668\u63a7\u5236\uff08\u9ed8\u8ba4\u4e0d\u652f\u6301\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ConnectionHolder conHolder = TransactionSynchronizationManager.getResource(obtainDataSource())"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ece ThreadLocal \u4e2d\u83b7\u53d6 conHolder \u8d44\u6e90\uff0c\u53ef\u80fd\u62ff\u5230 null \u6216\u8005\u4e0d\u662f null"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u662f null\uff1a\u4e3e\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Transaction\npublic void a() {...b.b()....}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e0d\u662f null\uff1a\u6267\u884c b \u65b9\u6cd5\u4e8b\u52a1\u589e\u5f3a\u7684\u524d\u7f6e\u903b\u8f91\u65f6\uff0c\u53ef\u4ee5\u62ff\u5230 a \u653e\u8fdb\u53bb\u7684 conHolder \u8d44\u6e90"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Transaction\npublic void b() {....}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.setConnectionHolder(conHolder, false)"}),"\uff1a\u5c06 ConnectionHolder \u4fdd\u5b58\u5230\u4e8b\u52a1\u5bf9\u8c61\u5185\uff0c\u53c2\u6570\u4e8c\u662f false \u4ee3\u8868\u8fde\u63a5\u8d44\u6e90\u662f\u4e0a\u5c42\u4e8b\u52a1\u5171\u4eab\u7684\uff0c\u4e0d\u662f\u65b0\u5efa\u7684\u8fde\u63a5\u8d44\u6e90"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return txObject"}),"\uff1a\u8fd4\u56de\u4e8b\u52a1\u7684\u5bf9\u8c61"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"DataSourceTransactionManager#doBegin\uff1a\u4e8b\u52a1\u5f00\u542f\u7684\u903b\u8f91"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject = (DataSourceTransactionObject) transaction"}),"\uff1a\u5f3a\u8f6c\u4e3a\u4e8b\u52a1\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e8b\u52a1\u4e2d\u6ca1\u6709\u6570\u636e\u5e93\u8fde\u63a5\u8d44\u6e90\u5c31\u8981\u5206\u914d\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Connection newCon = obtainDataSource().getConnection()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 JDBC \u539f\u751f\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5bf9\u8c61"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.setConnectionHolder(new ConnectionHolder(newCon), true)"}),"\uff1a\u4ee3\u8868\u662f\u65b0\u5f00\u542f\u7684\u4e8b\u52a1\uff0c\u65b0\u5efa\u7684\u8fde\u63a5\u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"previousIsolationLevel = DataSourceUtils.prepareConnectionForTransaction(con, definition)"}),"\uff1a\u4fee\u6539\u8fde\u63a5\u5c5e\u6027"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (definition != null && definition.isReadOnly())"}),"\uff1a\u6ce8\u89e3\uff08\u6216 XML\uff09\u914d\u7f6e\u4e86\u53ea\u8bfb\u5c5e\u6027\uff0c\u9700\u8981\u8bbe\u7f6e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (..definition.getIsolationLevel() != TransactionDefinition.ISOLATION_DEFAULT)"}),"\uff1a\u6ce8\u89e3\u914d\u7f6e\u4e86\u9694\u79bb\u7ea7\u522b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"int currentIsolation = con.getTransactionIsolation()"}),"\uff1a\u83b7\u53d6\u8fde\u63a5\u7684\u9694\u79bb\u754c\u522b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"previousIsolationLevel = currentIsolation"}),"\uff1a\u4fdd\u5b58\u4e4b\u524d\u7684\u9694\u79bb\u754c\u522b\uff0c\u8fd4\u56de\u8be5\u503c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" con.setTransactionIsolation(definition.getIsolationLevel())"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06\u5f53\u524d\u8fde\u63a5\u8bbe\u7f6e\u4e3a\u914d\u7f6e\u7684\u9694\u79bb\u754c\u522b"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.setPreviousIsolationLevel(previousIsolationLevel)"}),"\uff1a\u5c06 Conn \u539f\u6765\u7684\u9694\u79bb\u7ea7\u522b\u4fdd\u5b58\u5230\u4e8b\u52a1\u5bf9\u8c61\uff0c\u4e3a\u4e86\u91ca\u653e Conn \u65f6\u91cd\u7f6e\u56de\u539f\u72b6\u6001"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (con.getAutoCommit())"}),"\uff1a\u9ed8\u8ba4\u4f1a\u6210\u7acb\uff0c\u8bf4\u660e\u8fd8\u6ca1\u5f00\u542f\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.setMustRestoreAutoCommit(true)"}),"\uff1a\u4fdd\u5b58 Conn \u539f\u6765\u7684\u4e8b\u52a1\u72b6\u6001"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"con.setAutoCommit(false)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5f00\u542f\u4e8b\u52a1\uff0cJDBC \u539f\u751f\u7684\u65b9\u5f0f"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.getConnectionHolder().setTransactionActive(true)"}),"\uff1a\u8868\u793a Holder \u6301\u6709\u7684 Conn \u5df2\u7ecf\u624b\u52a8\u5f00\u542f\u4e8b\u52a1\u4e86"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"TransactionSynchronizationManager.bindResource(obtainDataSource(), txObject.getConnectionHolder())"}),"\uff1a\u5c06 ConnectionHolder \u5bf9\u8c61\u7ed1\u5b9a\u5230 ThreadLocal \u5185\uff0c\u6570\u636e\u6e90\u4e3a key\uff0c\u4e3a\u4e86\u65b9\u4fbf\u83b7\u53d6\u624b\u52a8\u5f00\u542f\u4e8b\u52a1\u7684\u8fde\u63a5\u5bf9\u8c61\u53bb\u6267\u884c SQL"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u4e8b\u52a1\u91cd\u5165",children:"\u4e8b\u52a1\u91cd\u5165"}),"\n",(0,i.jsx)(e.p,{children:"\u4e8b\u52a1\u91cd\u5165\u7684\u6838\u5fc3\u5904\u7406\u903b\u8f91\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'private TransactionStatus handleExistingTransaction( TransactionDefinition definition, \n                                                    Object transaction, boolean debugEnabled){\n\t// \u4f20\u64ad\u884c\u4e3a\u662f PROPAGATION_NEVER\uff0c\u9700\u8981\u4ee5\u975e\u4e8b\u52a1\u65b9\u5f0f\u6267\u884c\u64cd\u4f5c\uff0c\u5982\u679c\u5f53\u524d\u4e8b\u52a1\u5b58\u5728\u5219\u3010\u629b\u51fa\u5f02\u5e38\u3011\n    if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NEVER) {\n        throw new IllegalTransactionStateException();\n    }\n\t// \u4f20\u64ad\u884c\u4e3a\u662f PROPAGATION_NOT_SUPPORTED\uff0c\u4ee5\u975e\u4e8b\u52a1\u65b9\u5f0f\u8fd0\u884c\uff0c\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u3010\u628a\u5f53\u524d\u4e8b\u52a1\u6302\u8d77\u3011\n    if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NOT_SUPPORTED) {\n        // \u6302\u8d77\u4e8b\u52a1\n        Object suspendedResources = suspend(transaction);\n        boolean newSynchronization = (getTransactionSynchronization() == SYNCHRONIZATION_ALWAYS);\n        // \u521b\u5efa\u4e00\u4e2a\u975e\u4e8b\u52a1\u7684\u4e8b\u52a1\u72b6\u6001\u5bf9\u8c61\u8fd4\u56de\n        return prepareTransactionStatus(definition, null, false, newSynchronization, debugEnabled, suspendedResources);\n    }\n\t// \u5f00\u542f\u65b0\u4e8b\u7269\u7684\u903b\u8f91\n    if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRES_NEW) {\n        // \u3010\u6302\u8d77\u5f53\u524d\u4e8b\u52a1\u3011\n        SuspendedResourcesHolder suspendedResources = suspend(transaction);\n       \t// \u3010\u5f00\u542f\u65b0\u4e8b\u7269\u3011\n    }\n\t// \u4f20\u64ad\u884c\u4e3a\u662f PROPAGATION_NESTED\uff0c\u5d4c\u5957\u4e8b\u52a1\n    if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NESTED) {\n        // Spring \u9ed8\u8ba4\u4e0d\u652f\u6301\u5185\u5d4c\u4e8b\u52a1\n        // \u3010\u5f00\u542f\u65b9\u5f0f\u3011\uff1a<property name="nestedTransactionAllowed" value="true">\n        if (!isNestedTransactionAllowed()) {\n            throw new NestedTransactionNotSupportedException();\n        }\n        \n        if (useSavepointForNestedTransaction()) {\n            //  \u4e3a\u5f53\u524d\u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a TransactionStatus \u5bf9\u8c61\uff0c\n            DefaultTransactionStatus status =\n                prepareTransactionStatus(definition, transaction, false, false, debugEnabled, null);\n            // \u521b\u5efa\u4e00\u4e2a JDBC \u7684\u4fdd\u5b58\u70b9\n            status.createAndHoldSavepoint();\n            // \u4e0d\u9700\u8981\u4f7f\u7528\u540c\u6b65\uff0c\u76f4\u63a5\u8fd4\u56de\n            return status;\n        }\n        else {\n            // Usually only for JTA transaction\uff0c\u5f00\u542f\u4e00\u4e2a\u65b0\u4e8b\u52a1\n        }\n    }\n\n    // Assumably PROPAGATION_SUPPORTS or PROPAGATION_REQUIRED\uff0c\u3010\u4f7f\u7528\u5f53\u524d\u7684\u4e8b\u52a1\u3011\n    boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);\n    return prepareTransactionStatus(definition, transaction, false, newSynchronization, debugEnabled, null);\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6302\u8d77\u6062\u590d",children:"\u6302\u8d77\u6062\u590d"}),"\n",(0,i.jsxs)(e.p,{children:["AbstractPlatformTransactionManager#suspend\uff1a",(0,i.jsx)(e.strong,{children:"\u6302\u8d77\u4e8b\u52a1"}),"\uff0c\u5e76\u83b7\u5f97\u4e00\u4e2a\u4e0a\u4e0b\u6587\u4fe1\u606f\u5bf9\u8c61"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected final SuspendedResourcesHolder suspend(@Nullable Object transaction) {\n    // \u4e8b\u52a1\u662f\u540c\u6b65\u72b6\u6001\u7684\n    if (TransactionSynchronizationManager.isSynchronizationActive()) {\n        List<TransactionSynchronization> suspendedSynchronizations = doSuspendSynchronization();\n        try {\n            Object suspendedResources = null;\n            if (transaction != null) {\n                // do it\n                suspendedResources = doSuspend(transaction);\n            }\n            //\u5c06\u4e0a\u5c42\u4e8b\u52a1\u7ed1\u5b9a\u5728\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u7684\u53d8\u91cf\u5168\u90e8\u53d6\u51fa\u6765\n            //...\n            // \u901a\u8fc7\u88ab\u6302\u8d77\u7684\u8d44\u6e90\u548c\u4e0a\u5c42\u4e8b\u52a1\u7684\u4e0a\u4e0b\u6587\u53d8\u91cf\uff0c\u521b\u5efa\u4e00\u4e2a\u3010SuspendedResourcesHolder\u3011\u8fd4\u56de\n            return new SuspendedResourcesHolder(suspendedResources, suspendedSynchronizations, \n                                                name, readOnly, isolationLevel, wasActive);\n        } //...\n}\nprotected Object doSuspend(Object transaction) {\n    DataSourceTransactionObject txObject = (DataSourceTransactionObject) transaction;\n    // \u5c06\u5f53\u524d\u65b9\u6cd5\u7684\u4e8b\u52a1\u5bf9\u8c61 connectionHolder \u5c5e\u6027\u7f6e\u4e3a null\uff0c\u4e0d\u548c\u4e0a\u5c42\u5171\u4eab\u8d44\u6e90\n    // \u5f53\u524d\u65b9\u6cd5\u6709\u53ef\u80fd\u662f\u4e0d\u5f00\u542f\u4e8b\u52a1\u6216\u8005\u8981\u5f00\u542f\u4e00\u4e2a\u72ec\u7acb\u7684\u4e8b\u52a1\n    txObject.setConnectionHolder(null);\n    // \u3010\u89e3\u7ed1\u5728\u7ebf\u7a0b\u4e0a\u7684\u4e8b\u52a1\u3011\n    return TransactionSynchronizationManager.unbindResource(obtainDataSource());\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["AbstractPlatformTransactionManager#resume\uff1a",(0,i.jsx)(e.strong,{children:"\u6062\u590d\u73b0\u573a"}),"\uff0c\u6839\u636e\u6302\u8d77\u8d44\u6e90\u53bb\u6062\u590d\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected final void resume(Object transaction, SuspendedResourcesHolder resourcesHolder) {\n    if (resourcesHolder != null) {\n        // \u83b7\u53d6\u88ab\u6302\u8d77\u7684\u4e8b\u52a1\u8d44\u6e90\n        Object suspendedResources = resourcesHolder.suspendedResources;\n        if (suspendedResources != null) {\n            //\u7ed1\u5b9a\u4e0a\u4e00\u4e2a\u4e8b\u52a1\u7684 ConnectionHolder \u5230\u7ebf\u7a0b\u4e0a\u4e0b\u6587\n            doResume(transaction, suspendedResources);\n        }\n        List<TransactionSynchronization> suspendedSynchronizations = resourcesHolder.suspendedSynchronizations;\n        if (suspendedSynchronizations != null) {\n            //....\n            // \u5c06\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u53d8\u91cf\u6062\u590d\u4e3a\u4e0a\u4e00\u4e2a\u4e8b\u52a1\u7684\u6302\u8d77\u73b0\u573a\n            doResumeSynchronization(suspendedSynchronizations);\n        }\n    }\n}\nprotected void doResume(@Nullable Object transaction, Object suspendedResources) {\n    // doSuspend \u7684\u9006\u52a8\u4f5c\uff0c\u3010\u7ed1\u5b9a\u8d44\u6e90\u3011\n    TransactionSynchronizationManager.bindResource(obtainDataSource(), suspendedResources);\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u63d0\u4ea4\u56de\u6eda",children:"\u63d0\u4ea4\u56de\u6eda"}),"\n",(0,i.jsx)(e.h5,{id:"\u56de\u6eda\u65b9\u5f0f",children:"\u56de\u6eda\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected void completeTransactionAfterThrowing(@Nullable TransactionInfo txInfo, Throwable ex) {\n    // \u4e8b\u52a1\u72b6\u6001\u4fe1\u606f\u4e0d\u4e3a\u7a7a\u8fdb\u5165\u903b\u8f91\n    if (txInfo != null && txInfo.getTransactionStatus() != null) {\n        // \u6761\u4ef6\u4e8c\u6210\u7acb \u8bf4\u660e\u76ee\u6807\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38\u9700\u8981\u56de\u6eda\u4e8b\u52a1\n        if (txInfo.transactionAttribute != null && txInfo.transactionAttribute.rollbackOn(ex)) {\n            try {\n                // \u4e8b\u52a1\u7ba1\u7406\u5668\u7684\u56de\u6eda\u65b9\u6cd5\n                txInfo.getTransactionManager().rollback(txInfo.getTransactionStatus());\n            }\n            catch (TransactionSystemException ex2) {}\n        }\n        else {\n            // \u6267\u884c\u5230\u8fd9\u91cc\uff0c\u8bf4\u660e\u5f53\u524d\u4e8b\u52a1\u867d\u7136\u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u4f46\u662f\u8be5\u5f02\u5e38\u5e76\u4e0d\u4f1a\u5bfc\u81f4\u6574\u4e2a\u4e8b\u52a1\u56de\u6eda\n            try {\n                // \u63d0\u4ea4\u4e8b\u52a1\n                txInfo.getTransactionManager().commit(txInfo.getTransactionStatus());\n            }\n            catch (TransactionSystemException ex2) {}\n        }\n    }\n}\npublic boolean rollbackOn(Throwable ex) {\n    // \u7ee7\u627f\u81ea RuntimeException \u6216 error \u7684\u662f\u3010\u975e\u68c0\u67e5\u578b\u5f02\u5e38\u3011\uff0c\u624d\u4f1a\u5f52\u6eda\u4e8b\u52a1\n    // \u5982\u679c\u914d\u7f6e\u4e86\u5176\u4ed6\u56de\u6eda\u9519\u8bef\uff0c\u4f1a\u83b7\u53d6\u5230\u56de\u6eda\u89c4\u5219 rollbackRules \u8fdb\u884c\u5224\u65ad\n    return (ex instanceof RuntimeException || ex instanceof Error);\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public final void rollback(TransactionStatus status) throws TransactionException {\n    // \u4e8b\u52a1\u5df2\u7ecf\u5b8c\u6210\u4e0d\u9700\u8981\u56de\u6eda\n    if (status.isCompleted()) {\n        throw new IllegalTransactionStateException();\n    }\n    DefaultTransactionStatus defStatus = (DefaultTransactionStatus) status;\n    // \u5f00\u59cb\u56de\u6eda\u4e8b\u52a1\n    processRollback(defStatus, false);\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AbstractPlatformTransactionManager#processRollback\uff1a\u4e8b\u52a1\u56de\u6eda"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"triggerBeforeCompletion(status)"}),"\uff1a\u7528\u6765\u505a\u6269\u5c55\u903b\u8f91\uff0c\u56de\u6eda\u524d\u7684\u524d\u7f6e\u5904\u7406"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (status.hasSavepoint())"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d\u4e8b\u52a1\u662f\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u5185\u5d4c\u4e8b\u52a1"}),"\uff0c\u5f53\u524d\u65b9\u6cd5\u53ea\u662f\u590d\u7528\u4e86\u4e0a\u5c42\u4e8b\u52a1\u7684\u4e00\u4e2a\u5185\u5d4c\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"status.rollbackToHeldSavepoint()"}),"\uff1a\u5185\u5d4c\u4e8b\u52a1\u52a0\u5165\u4e8b\u52a1\u65f6\u4f1a\u521b\u5efa\u4e00\u4e2a\u4fdd\u5b58\u70b9\uff0c\u6b64\u65f6\u6062\u590d\u81f3\u4fdd\u5b58\u70b9"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (status.isNewTransaction())"}),"\uff1a\u8bf4\u660e\u4e8b\u52a1\u662f\u5f53\u524d\u8fde\u63a5\u5f00\u542f\u7684\uff0c\u9700\u8981\u53bb\u56de\u6eda\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"doRollback(status)"}),"\uff1a\u771f\u6b63\u7684\u7684\u56de\u6eda\u51fd\u6570"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"DataSourceTransactionObject txObject = status.getTransaction()"}),"\uff1a\u83b7\u53d6\u4e8b\u52a1\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Connection con = txObject.getConnectionHolder().getConnection()"}),"\uff1a\u83b7\u53d6\u8fde\u63a5\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"con.rollback()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"JDBC \u7684\u65b9\u5f0f\u56de\u6eda\u4e8b\u52a1"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"else"}),"\uff1a\u5f53\u524d\u65b9\u6cd5\u662f\u5171\u4eab\u7684\u4e0a\u5c42\u7684\u4e8b\u52a1\uff0c\u548c\u4e0a\u5c42\u4f7f\u7528\u540c\u4e00\u4e2a Conn \u8d44\u6e90\uff0c",(0,i.jsx)(e.strong,{children:"\u5171\u4eab\u7684\u4e8b\u52a1\u4e0d\u80fd\u76f4\u63a5\u56de\u6eda\uff0c\u5e94\u8be5\u4ea4\u7ed9\u4e0a\u5c42\u5904\u7406"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"doSetRollbackOnly(status)"}),"\uff1a\u8bbe\u7f6e con.rollbackOnly = true\uff0c\u7ebf\u7a0b\u56de\u5230\u4e0a\u5c42\u4e8b\u52a1 commit \u65f6\u4f1a\u68c0\u67e5\u8be5\u5b57\u6bb5\uff0c\u7136\u540e\u6267\u884c\u56de\u6eda\u64cd\u4f5c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"triggerAfterCompletion(status, TransactionSynchronization.STATUS_ROLLED_BACK)"}),"\uff1a\u56de\u6eda\u7684\u540e\u7f6e\u5904\u7406"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"cleanupAfterCompletion(status)"}),"\uff1a\u6e05\u7406\u548c\u6062\u590d\u73b0\u573a"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u63d0\u4ea4\u65b9\u5f0f",children:"\u63d0\u4ea4\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected void commitTransactionAfterReturning(@Nullable TransactionInfo txInfo) {\n    if (txInfo != null && txInfo.getTransactionStatus() != null) {\n        // \u4e8b\u52a1\u7ba1\u7406\u5668\u7684\u63d0\u4ea4\u65b9\u6cd5\n        txInfo.getTransactionManager().commit(txInfo.getTransactionStatus());\n    }\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public final void commit(TransactionStatus status) throws TransactionException {\n    // \u5df2\u7ecf\u5b8c\u6210\u7684\u4e8b\u52a1\u4e0d\u9700\u8981\u63d0\u4ea4\u4e86\n    if (status.isCompleted()) {\n        throw new IllegalTransactionStateException();\n    }\n    DefaultTransactionStatus defStatus = (DefaultTransactionStatus) status;\n    // \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u662f\u5f53\u524d\u7684\u4e1a\u52a1\u5f3a\u5236\u56de\u6eda\n    if (defStatus.isLocalRollbackOnly()) {\n        // \u56de\u6eda\u903b\u8f91\uff0c\n        processRollback(defStatus, false);\n        return;\n    }\n\t// \u6210\u7acb\u8bf4\u660e\u5171\u4eab\u5f53\u524d\u4e8b\u52a1\u7684\u3010\u4e0b\u5c42\u4e8b\u52a1\u903b\u8f91\u51fa\u9519\uff0c\u9700\u8981\u56de\u6eda\u3011\n    if (!shouldCommitOnGlobalRollbackOnly() && defStatus.isGlobalRollbackOnly()) {\n        // \u5982\u679c\u5f53\u524d\u4e8b\u52a1\u8fd8\u662f\u4e8b\u52a1\u91cd\u5165\uff0c\u4f1a\u7ee7\u7eed\u629b\u7ed9\u4e0a\u5c42\uff0c\u6700\u4e0a\u5c42\u4e8b\u52a1\u4f1a\u8fdb\u884c\u771f\u5b9e\u7684\u4e8b\u52a1\u56de\u6eda\u64cd\u4f5c\n        processRollback(defStatus, true);\n        return;\n    }\n\t// \u6267\u884c\u63d0\u4ea4\n    processCommit(defStatus);\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"AbstractPlatformTransactionManager#processCommit\uff1a\u4e8b\u52a1\u63d0\u4ea4"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"prepareForCommit(status)"}),"\uff1a\u524d\u7f6e\u5904\u7406"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (status.hasSavepoint())"}),"\uff1a\u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d\u4e8b\u52a1\u662f\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u5185\u5d4c\u4e8b\u52a1"}),"\uff0c\u53ea\u662f\u590d\u7528\u4e86\u4e0a\u5c42\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"status.releaseHeldSavepoint()"}),"\uff1a\u6e05\u7406\u4fdd\u5b58\u70b9\uff0c\u56e0\u4e3a\u6ca1\u6709\u53d1\u751f\u4efb\u4f55\u5f02\u5e38\uff0c\u6240\u4ee5\u4fdd\u5b58\u70b9\u6ca1\u6709\u5b58\u5728\u7684\u610f\u4e49\u4e86"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (status.isNewTransaction())"}),"\uff1a\u8bf4\u660e\u4e8b\u52a1\u662f\u5f52\u5c5e\u4e8e\u5f53\u524d\u8fde\u63a5\u7684\uff0c\u9700\u8981\u53bb\u63d0\u4ea4\u4e8b\u52a1"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"doCommit(status)"}),"\uff1a\u771f\u6b63\u7684\u63d0\u4ea4\u51fd\u6570"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Connection con = txObject.getConnectionHolder().getConnection()"}),"\uff1a\u83b7\u53d6\u8fde\u63a5\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"con.commit()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"JDBC \u7684\u65b9\u5f0f\u63d0\u4ea4\u4e8b\u52a1"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"doRollbackOnCommitException(status, ex)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u63d0\u4ea4\u4e8b\u52a1\u51fa\u9519\u540e\u8fdb\u884c\u56de\u6eda"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:" cleanupAfterCompletion(status)"}),"\uff1a\u6e05\u7406\u548c\u6062\u590d\u73b0\u573a"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6e05\u7406\u73b0\u573a",children:"\u6e05\u7406\u73b0\u573a"}),"\n",(0,i.jsx)(e.p,{children:"\u6062\u590d\u4e0a\u5c42\u4e8b\u52a1\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected void cleanupTransactionInfo(@Nullable TransactionInfo txInfo) {\n    if (txInfo != null) {\n        // \u4ece\u5f53\u524d\u7ebf\u7a0b\u7684 ThreadLocal \u83b7\u53d6\u4e0a\u5c42\u7684\u4e8b\u52a1\u4fe1\u606f\uff0c\u5c06\u5f53\u524d\u4e8b\u52a1\u51fa\u6808\uff0c\u7ee7\u7eed\u6267\u884c\u4e0a\u5c42\u4e8b\u52a1\n        txInfo.restoreThreadLocalStatus();\n    }\n}\nprivate void restoreThreadLocalStatus() {\n    // Use stack to restore old transaction TransactionInfo.\n    transactionInfoHolder.set(this.oldTransactionInfo);\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u524d\u5c42\u7ea7\u4e8b\u52a1\u7ed3\u675f\u65f6\u7684\u6e05\u7406\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private void cleanupAfterCompletion(DefaultTransactionStatus status) {\n    // \u8bbe\u7f6e\u5f53\u524d\u65b9\u6cd5\u7684\u4e8b\u52a1\u72b6\u6001\u4e3a\u5b8c\u6210\u72b6\u6001\n    status.setCompleted();\n    if (status.isNewSynchronization()) {\n        // \u6e05\u7406\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u53d8\u91cf\u4ee5\u53ca\u6269\u5c55\u70b9\u6ce8\u518c\u7684 sync\n        TransactionSynchronizationManager.clear();\n    }\n    // \u4e8b\u52a1\u662f\u5f53\u524d\u7ebf\u7a0b\u5f00\u542f\u7684\n    if (status.isNewTransaction()) {\n        // \u89e3\u7ed1\u8d44\u6e90\n        doCleanupAfterCompletion(status.getTransaction());\n    }\n    // \u6761\u4ef6\u6210\u7acb\u8bf4\u660e\u5f53\u524d\u4e8b\u52a1\u6267\u884c\u7684\u65f6\u5019\uff0c\u3010\u6302\u8d77\u4e86\u4e00\u4e2a\u4e0a\u5c42\u7684\u4e8b\u52a1\u3011\n    if (status.getSuspendedResources() != null) {\n        Object transaction = (status.hasTransaction() ? status.getTransaction() : null);\n        // \u6062\u590d\u4e0a\u5c42\u4e8b\u52a1\u73b0\u573a\n        resume(transaction, (SuspendedResourcesHolder) status.getSuspendedResources());\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"DataSourceTransactionManager#doCleanupAfterCompletion\uff1a\u6e05\u7406\u5de5\u4f5c"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"TransactionSynchronizationManager.unbindResource(obtainDataSource())"}),"\uff1a\u89e3\u7ed1\u6570\u636e\u5e93\u8d44\u6e90"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (txObject.isMustRestoreAutoCommit())"}),"\uff1a\u662f\u5426\u6062\u590d\u8fde\u63a5\uff0cConn \u5f52\u8fd8\u5230 DataSource**\uff0c\u5f52\u8fd8\u524d\u9700\u8981\u6062\u590d\u5230\u7533\u8bf7\u65f6\u7684\u72b6\u6001**"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"con.setAutoCommit(true)"}),"\uff1a\u6062\u590d\u8fde\u63a5\u4e3a\u81ea\u52a8\u63d0\u4ea4"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DataSourceUtils.resetConnectionAfterTransaction(con, txObject.getPreviousIsolationLevel())"}),"\uff1a\u6062\u590d\u9694\u79bb\u7ea7\u522b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DataSourceUtils.releaseConnection(con, this.dataSource)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06\u8fde\u63a5\u5f52\u8fd8\u7ed9\u6570\u636e\u5e93\u8fde\u63a5\u6c60"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"txObject.getConnectionHolder().clear()"}),"\uff1a\u6e05\u7406 ConnectionHolder \u8d44\u6e90"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6ce8\u89e3-1",children:"\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h4,{id:"component",children:"Component"}),"\n",(0,i.jsx)(e.p,{children:"@Component \u89e3\u6790\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\u7c7b\u542f\u52a8\u5bb9\u5668\u7684\u65f6\uff0c\u6ce8\u518c ClassPathBeanDefinitionScanner \u5230\u5bb9\u5668\uff0c\u7528\u6765\u626b\u63cf Bean \u7684\u76f8\u5173\u4fe1\u606f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected Set<BeanDefinitionHolder> doScan(String... basePackages) {\n    Set<BeanDefinitionHolder> beanDefinitions = new LinkedHashSet<>();\n    // \u904d\u5386\u6307\u5b9a\u7684\u6240\u6709\u7684\u5305\uff0c\u3010\u8fd9\u5c31\u76f8\u5f53\u4e8e\u626b\u63cf\u4e86\u3011\n    for (String basePackage : basePackages) {\n        // \u8bfb\u53d6\u5f53\u524d\u5305\u4e0b\u7684\u8d44\u6e90\u88c5\u6362\u4e3a BeanDefinition\uff0c\u5b57\u8282\u6d41\u7684\u65b9\u5f0f\n        Set<BeanDefinition> candidates = findCandidateComponents(basePackage);\n        for (BeanDefinition candidate : candidates) {\n            // \u904d\u5386\uff0c\u5c01\u88c5\uff0c\u7c7b\u4f3c\u4e8e XML \u7684\u89e3\u6790\u65b9\u5f0f\uff0c\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\n            registerBeanDefinition(definitionHolder, this.registry)\n        }\n    return beanDefinitions;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ClassPathScanningCandidateComponentProvider.findCandidateComponents()"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public Set<BeanDefinition> findCandidateComponents(String basePackage) {\n    if (this.componentsIndex != null && indexSupportsIncludeFilters()) {\n        return addCandidateComponentsFromIndex(this.componentsIndex, basePackage);\n    }\n    else {\n        return scanCandidateComponents(basePackage);\n    }\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private Set<BeanDefinition> scanCandidateComponents(String basePackage) {}\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"String packageSearchPath = ResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX resolveBasePackage(basePackage) + '/' + this.resourcePattern"})," \uff1a\u5c06 package \u8f6c\u5316\u4e3a ClassLoader \u7c7b\u8d44\u6e90\u641c\u7d22\u8def\u5f84 packageSearchPath\uff0c\u4f8b\u5982\uff1a",(0,i.jsx)(e.code,{children:"com.sea.spring.boot"})," \u8f6c\u5316\u4e3a ",(0,i.jsx)(e.code,{children:"classpath*:com/sea/spring/boot/**/*.class"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resources = getResourcePatternResolver().getResources(packageSearchPath)"}),"\uff1a\u52a0\u8f7d\u8def\u5f84\u4e0b\u7684\u8d44\u6e90"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (Resource resource : resources) "}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u8d44\u6e90"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"metadataReader = getMetadataReaderFactory().getMetadataReader(resource)"}),"\uff1a\u83b7\u53d6\u5143\u6570\u636e\u9605\u8bfb\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (isCandidateComponent(metadataReader))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5f53\u524d\u7c7b\u4e0d\u5339\u914d\u4efb\u4f55\u6392\u9664\u8fc7\u6ee4\u5668\uff0c\u5e76\u4e14\u5339\u914d\u4e00\u4e2a\u5305\u542b\u8fc7\u6ee4\u5668"}),"\uff0c\u8fd4\u56de true"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["includeFilters \u7531 ",(0,i.jsx)(e.code,{children:"registerDefaultFilters()"})," \u8bbe\u7f6e\u521d\u59cb\u503c\uff0c\u65b9\u6cd5\u6709 @Component\uff0c\u6ca1\u6709 @Service\uff0c\u56e0\u4e3a @Component \u662f @Service \u7684\u5143\u6ce8\u89e3\uff0cSpring \u5728\u8bfb\u53d6 @Service \u65f6\u4e5f\u8bfb\u53d6\u4e86\u5143\u6ce8\u89e3\uff0c\u5e76\u5c06 @Service \u4f5c\u4e3a @Component \u5904\u7406"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"this.includeFilters.add(new AnnotationTypeFilter(Component.class))\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Component\t// \u62e5\u6709\u4e86 Component \u529f\u80fd\npublic @interface Service {}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"candidates.add(sbd)"}),"\uff1a\u6dfb\u52a0\u5230\u8fd4\u56de\u7ed3\u679c\u7684 list"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,i.jsx)(e.a,{href:"https://my.oschina.net/floor/blog/4325651",children:"https://my.oschina.net/floor/blog/4325651"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"autowired",children:"Autowired"}),"\n",(0,i.jsx)(e.p,{children:"\u6253\u5f00 @Autowired \u6e90\u7801\uff0c\u6ce8\u91ca\u4e0a\u5199 Please consult the javadoc for the AutowiredAnnotationBeanPostProcessor"}),"\n",(0,i.jsxs)(e.p,{children:["AutowiredAnnotationBeanPostProcessor \u95f4\u63a5\u5b9e\u73b0 InstantiationAwareBeanPostProcessor\uff0c\u5c31\u5177\u5907\u4e86\u5b9e\u4f8b\u5316\u524d\u540e\uff08\u800c\u4e0d\u662f\u521d\u59cb\u5316\u524d\u540e\uff09\u7ba1\u7406\u5bf9\u8c61\u7684\u80fd\u529b\uff0c\u5b9e\u73b0\u4e86 BeanPostProcessor\uff0c\u5177\u6709\u521d\u59cb\u5316\u524d\u540e\u7ba1\u7406\u5bf9\u8c61\u7684\u80fd\u529b\uff0c\u5b9e\u73b0 BeanFactoryAware\uff0c\u5177\u5907\u968f\u65f6\u62ff\u5230 BeanFactory \u7684\u80fd\u529b\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7c7b",(0,i.jsx)(e.strong,{children:"\u5177\u5907\u4e00\u5207\u540e\u7f6e\u5904\u7406\u5668\u7684\u80fd\u529b"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5728\u5bb9\u5668\u542f\u52a8\uff0c\u4e3a\u5bf9\u8c61\u8d4b\u503c\u7684\u65f6\u5019\uff0c\u9047\u5230 @Autowired \u6ce8\u89e3\uff0c\u4f1a\u7528\u540e\u7f6e\u5904\u7406\u5668\u673a\u5236\uff0c\u6765\u521b\u5efa\u5c5e\u6027\u7684\u5b9e\u4f8b\uff0c\u7136\u540e\u518d\u5229\u7528\u53cd\u5c04\u673a\u5236\uff0c\u5c06\u5b9e\u4f8b\u5316\u597d\u7684\u5c5e\u6027\uff0c\u8d4b\u503c\u7ed9\u5bf9\u8c61\u4e0a\uff0c\u8fd9\u5c31\u662f Autowired \u7684\u539f\u7406"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\u65f6\u673a\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Spring \u5728\u6bcf\u4e2a Bean \u5b9e\u4f8b\u5316\u4e4b\u540e\uff0c\u8c03\u7528 AutowiredAnnotationBeanPostProcessor \u7684 ",(0,i.jsx)(e.code,{children:"postProcessMergedBeanDefinition()"})," \u65b9\u6cd5\uff0c\u67e5\u627e\u8be5 Bean \u662f\u5426\u6709 @Autowired \u6ce8\u89e3\uff0c\u8fdb\u884c\u76f8\u5173\u5143\u6570\u636e\u7684\u83b7\u53d6"]}),"\n",(0,i.jsxs)(e.li,{children:["Spring \u5728\u6bcf\u4e2a Bean \u8c03\u7528 ",(0,i.jsx)(e.code,{children:"populateBean()"})," \u8fdb\u884c\u5c5e\u6027\u6ce8\u5165\u7684\u65f6\u5019\uff0c\u5373\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"postProcessProperties()"})," \u65b9\u6cd5\uff0c\u67e5\u627e\u8be5 Bean \u5c5e\u6027\u662f\u5426\u6709 @Autowired \u6ce8\u89e3\uff0c\u8fdb\u884c\u76f8\u5173\u6570\u636e\u7684\u586b\u5145"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h1,{id:"mvc",children:"MVC"}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u4ecb\u7ecd-3",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"SpringMVC\uff1a\u662f\u4e00\u79cd\u57fa\u4e8e Java \u5b9e\u73b0 MVC \u6a21\u578b\u7684\u8f7b\u91cf\u7ea7 Web \u6846\u67b6"}),"\n",(0,i.jsx)(e.p,{children:"SpringMVC \u4f18\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4f7f\u7528\u7b80\u5355"}),"\n",(0,i.jsx)(e.li,{children:"\u6027\u80fd\u7a81\u51fa\uff08\u5bf9\u6bd4\u73b0\u6709\u7684\u6846\u67b6\u6280\u672f\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u7075\u6d3b\u6027\u5f3a"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8f6f\u4ef6\u5f00\u53d1\u4e09\u5c42\u67b6\u6784\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8868\u73b0\u5c42\uff1a\u8d1f\u8d23\u6570\u636e\u5c55\u793a"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u5c42\uff1a\u8d1f\u8d23\u4e1a\u52a1\u5904\u7406"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u5c42\uff1a\u8d1f\u8d23\u6570\u636e\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(60907).A+"",width:"583",height:"207"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"MVC\uff08Model View Controller\uff09\uff0c\u4e00\u79cd\u7528\u4e8e\u8bbe\u8ba1\u521b\u5efaWeb\u5e94\u7528\u7a0b\u5e8f\u8868\u73b0\u5c42\u7684\u6a21\u5f0f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Model\uff08\u6a21\u578b\uff09\uff1a\u6570\u636e\u6a21\u578b\uff0c\u7528\u4e8e\u5c01\u88c5\u6570\u636e"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"View\uff08\u89c6\u56fe\uff09\uff1a\u9875\u9762\u89c6\u56fe\uff0c\u7528\u4e8e\u5c55\u793a\u6570\u636e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"jsp"}),"\n",(0,i.jsx)(e.li,{children:"html"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff08\u63a7\u5236\u5668\uff09\uff1a\u5904\u7406\u7528\u6237\u4ea4\u4e92\u7684\u8c03\u5ea6\u5668\uff0c\u7528\u4e8e\u6839\u636e\u7528\u6237\u9700\u6c42\u5904\u7406\u7a0b\u5e8f\u903b\u8f91"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Servlet"}),"\n",(0,i.jsx)(e.li,{children:"SpringMVC"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(436).A+"",width:"867",height:"225"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u89c6\u9891\uff1a",(0,i.jsx)(e.a,{href:"https://space.bilibili.com/37974444/",children:"https://space.bilibili.com/37974444/"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u914d\u7f6e",children:"\u57fa\u672c\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"\u5165\u95e8\u9879\u76ee-2",children:"\u5165\u95e8\u9879\u76ee"}),"\n",(0,i.jsx)(e.p,{children:"\u6d41\u7a0b\u5206\u6790\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u670d\u52a1\u5668\u542f\u52a8\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u52a0\u8f7d web.xml \u4e2d DispatcherServlet"}),"\n",(0,i.jsx)(e.li,{children:"\u8bfb\u53d6 spring-mvc.xml \u4e2d\u7684\u914d\u7f6e\uff0c\u52a0\u8f7d\u6240\u6709 controller \u5305\u4e2d\u6240\u6709\u6807\u8bb0\u4e3a bean \u7684\u7c7b"}),"\n",(0,i.jsx)(e.li,{children:"\u8bfb\u53d6 bean \u4e2d\u65b9\u6cd5\u4e0a\u65b9\u6807\u6ce8 @RequestMapping \u7684\u5185\u5bb9"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5904\u7406\u8bf7\u6c42\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"DispatcherServlet \u914d\u7f6e\u62e6\u622a\u6240\u6709\u8bf7\u6c42 /"}),"\n",(0,i.jsx)(e.li,{children:"\u4f7f\u7528\u8bf7\u6c42\u8def\u5f84\u4e0e\u6240\u6709\u52a0\u8f7d\u7684 @RequestMapping \u7684\u5185\u5bb9\u8fdb\u884c\u6bd4\u5bf9"}),"\n",(0,i.jsx)(e.li,{children:"\u6267\u884c\u5bf9\u5e94\u7684\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.li,{children:"\u6839\u636e\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5728 webapp \u76ee\u5f55\u4e2d\u67e5\u627e\u5bf9\u5e94\u7684\u9875\u9762\u5e76\u5c55\u793a"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pom.xml \u5bfc\u5165\u5750\u6807"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<modelVersion>4.0.0</modelVersion>\n\n<groupId>demo</groupId>\n<artifactId>spring_base_config</artifactId>\n<version>1.0-SNAPSHOT</version>\n<packaging>war</packaging>\n\n<properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n    <maven.compiler.source>1.8</maven.compiler.source>\n    <maven.compiler.target>1.8</maven.compiler.target>\n</properties>\n\n<dependencies>\n    \x3c!-- servlet3.0\u89c4\u8303\u7684\u5750\u6807 --\x3e\n    <dependency>\n        <groupId>javax.servlet</groupId>\n        <artifactId>javax.servlet-api</artifactId>\n        <version>3.1.0</version>\n        <scope>provided</scope>\n    </dependency>\n    \x3c!--jsp\u5750\u6807--\x3e\n    <dependency>\n        <groupId>javax.servlet.jsp</groupId>\n        <artifactId>jsp-api</artifactId>\n        <version>2.1</version>\n        <scope>provided</scope>\n    </dependency>\n    \x3c!--spring\u7684\u5750\u6807--\x3e\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>5.1.9.RELEASE</version>\n    </dependency>\n    \x3c!--springmvc\u7684\u5750\u6807--\x3e\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-webmvc</artifactId>\n        <version>5.1.9.RELEASE</version>\n    </dependency>\n</dependencies>\n\n\x3c!--\u6784\u5efa--\x3e\n<build>\n    \x3c!--\u8bbe\u7f6e\u63d2\u4ef6--\x3e\n    <plugins>\n        \x3c!--\u5177\u4f53\u7684\u63d2\u4ef6\u914d\u7f6e--\x3e\n        <plugin>\n            <groupId>org.apache.tomcat.maven</groupId>\n            <artifactId>tomcat7-maven-plugin</artifactId>\n            <version>2.1</version>\n            <configuration>\n                <port>80</port>\n                <path>/</path>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bbe\u5b9a\u5177\u4f53 Controller\uff0c\u63a7\u5236\u5c42 java / controller / UserController"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller  //@Component\u884d\u751f\u6ce8\u89e3\npublic class UserController {\n    //\u8bbe\u5b9a\u5f53\u524d\u65b9\u6cd5\u7684\u8bbf\u95ee\u6620\u5c04\u5730\u5740\uff0c\u7b49\u540c\u4e8eServlet\u5728web.xml\u4e2d\u7684\u914d\u7f6e\n    @RequestMapping("/save")\n    //\u8bbe\u7f6e\u5f53\u524d\u65b9\u6cd5\u8fd4\u56de\u503c\u7c7b\u578b\u4e3aString\uff0c\u7528\u4e8e\u6307\u5b9a\u8bf7\u6c42\u5b8c\u6210\u540e\u8df3\u8f6c\u7684\u9875\u9762\n    public String save(){\n        System.out.println("user mvc controller is running ...");\n        //\u8bbe\u5b9a\u5177\u4f53\u8df3\u8f6c\u7684\u9875\u9762\n    \treturn "success.jsp";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"webapp / WEB-INF / web.xml\uff0c\u914d\u7f6eSpringMVC\u6838\u5fc3\u63a7\u5236\u5668\uff0c\u8bf7\u6c42\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684\u5177\u4f53\u4e1a\u52a1\u5904\u7406\u5668Controller\u4e2d\uff08\u7b49\u540c\u4e8eServlet\u914d\u7f6e\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"\n         version="3.1">\n    \x3c!--\u914d\u7f6eServlet--\x3e\n    <servlet>\n        <servlet-name>DispatcherServlet</servlet-name>\n        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n        \x3c!--\u52a0\u8f7dSpring\u63a7\u5236\u6587\u4ef6--\x3e\n        <init-param>\n            <param-name>contextConfigLocation</param-name>\n            <param-value>classpath*:spring-mvc.xml</param-value>\n        </init-param>\n    </servlet>\n    <servlet-mapping>\n        <servlet-name>DispatcherServlet</servlet-name>\n        <url-pattern>/</url-pattern>\n    </servlet-mapping>\n</web-app>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"resouces / spring-mvc.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:mvc="http://www.springframework.org/schema/mvc"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans \n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context.xsd\n        http://www.springframework.org/schema/mvc \n        http://www.springframework.org/schema/mvc/spring-mvc.xsd">\n    \x3c!--\u626b\u63cf\u52a0\u8f7d\u6240\u6709\u7684\u63a7\u5236\u7c7b--\x3e\n    <context:component-scan base-package="controller"/>\n</beans>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u52a0\u8f7d\u63a7\u5236-1",children:"\u52a0\u8f7d\u63a7\u5236"}),"\n",(0,i.jsx)(e.p,{children:"Controller \u52a0\u8f7d\u63a7\u5236\uff1aSpringMVC \u7684\u5904\u7406\u5668\u5bf9\u5e94\u7684 bean \u5fc5\u987b\u6309\u7167\u89c4\u8303\u683c\u5f0f\u5f00\u53d1\uff0c\u672a\u907f\u514d\u52a0\u5165\u65e0\u6548\u7684 bean \u53ef\u901a\u8fc7 bean \u52a0\u8f7d\u8fc7\u6ee4\u5668\u8fdb\u884c\u5305\u542b\u8bbe\u5b9a\u6216\u6392\u9664\u8bbe\u5b9a\uff0c\u8868\u73b0\u5c42 bean \u6807\u6ce8\u901a\u5e38\u8bbe\u5b9a\u4e3a @Controller"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"resources / spring-mvc.xml \u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<context:component-scan base-package="com.seazean">\n    <context:include-filter \n\t\t\t\t\t\ttype="annotation" \n\t\t\t\t\t\texpression="org.springframework.stereotype.Controller"/>\n</context:component-scan>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9759\u6001\u8d44\u6e90\u52a0\u8f7d\uff08webapp \u76ee\u5f55\u4e0b\u7684\u76f8\u5173\u8d44\u6e90\uff09\uff0cspring-mvc.xml \u914d\u7f6e\uff0c\u5f00\u542f mvc \u547d\u540d\u7a7a\u95f4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--\u653e\u884c\u6307\u5b9a\u7c7b\u578b\u9759\u6001\u8d44\u6e90\u914d\u7f6e\u65b9\u5f0f--\x3e\n<mvc:resources mapping="/img/**" location="/img/"/> \x3c!--webapp/img/\u8d44\u6e90--\x3e\n<mvc:resources mapping="/js/**" location="/js/"/>\n<mvc:resources mapping="/css/**" location="/css/"/>\n\n\x3c!--SpringMVC \u63d0\u4f9b\u7684\u901a\u7528\u8d44\u6e90\u653e\u884c\u65b9\u5f0f\uff0c\u5efa\u8bae\u9009\u62e9--\x3e\n<mvc:default-servlet-handler/>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e2d\u6587\u4e71\u7801\u5904\u7406 SpringMVC \u63d0\u4f9b\u4e13\u7528\u7684\u4e2d\u6587\u5b57\u7b26\u8fc7\u6ee4\u5668\uff0c\u7528\u4e8e\u5904\u7406\u4e71\u7801\u95ee\u9898\u3002\u914d\u7f6e\u5728 web.xml \u91cc\u9762"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u4e71\u7801\u5904\u7406\u8fc7\u6ee4\u5668\uff0c\u4e0eServlet\u4e2d\u4f7f\u7528\u7684\u5b8c\u5168\u76f8\u540c\uff0c\u5dee\u5f02\u4e4b\u5904\u5728\u4e8e\u5904\u7406\u5668\u7684\u7c7b\u7531Spring\u63d0\u4f9b--\x3e\n<filter>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\n    <init-param>\n        <param-name>encoding</param-name>\n        <param-value>UTF-8</param-value>\n    </init-param>\n</filter>\n<filter-mapping>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6ce8\u89e3\u9a71\u52a8-1",children:"\u6ce8\u89e3\u9a71\u52a8"}),"\n",(0,i.jsx)(e.p,{children:"WebApplicationContext\uff0c\u751f\u6210 Spring \u6838\u5fc3\u5bb9\u5668\uff08\u4e3b\u5bb9\u5668/\u7236\u5bb9\u5668/\u6839\u5bb9\u5668\uff09"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7236\u5bb9\u5668\uff1aSpring \u73af\u5883\u52a0\u8f7d\u540e\u5f62\u6210\u7684\u5bb9\u5668\uff0c\u5305\u542b Spring \u73af\u5883\u4e0b\u7684\u6240\u6709\u7684 bean"}),"\n",(0,i.jsx)(e.li,{children:"\u5b50\u5bb9\u5668\uff1a\u5f53\u524d mvc \u73af\u5883\u52a0\u8f7d\u540e\u5f62\u6210\u7684\u5bb9\u5668\uff0c\u4e0d\u5305\u542b Spring \u73af\u5883\u4e0b\u7684 bean"}),"\n",(0,i.jsx)(e.li,{children:"\u5b50\u5bb9\u5668\u53ef\u4ee5\u8bbf\u95ee\u7236\u5bb9\u5668\u4e2d\u7684\u8d44\u6e90\uff0c\u7236\u5bb9\u5668\u4e0d\u53ef\u4ee5\u8bbf\u95ee\u5b50\u5bb9\u5668\u7684\u8d44\u6e90"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"EnableWebMvc \u6ce8\u89e3\u4f5c\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 ConversionService \u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u65b9\u4fbf\u914d\u7f6e\u81ea\u5b9a\u4e49\u7c7b\u578b\u8f6c\u6362\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 @NumberFormat \u6ce8\u89e3\u683c\u5f0f\u5316\u6570\u5b57\u7c7b\u578b"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 @DateTimeFormat \u6ce8\u89e3\u683c\u5f0f\u5316\u65e5\u671f\u6570\u636e\uff0c\u65e5\u671f\u5305\u62ec Date\u3001Calendar"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 @Valid \u7684\u53c2\u6570\u6821\u9a8c\uff08\u9700\u8981\u5bfc\u5165 JSR-303 \u89c4\u8303\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u914d\u5408\u7b2c\u4e09\u65b9 jar \u5305\u548c SpringMVC \u63d0\u4f9b\u7684\u6ce8\u89e3\u8bfb\u5199 XML \u548c JSON \u683c\u5f0f\u6570\u636e"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7eaf\u6ce8\u89e3\u5f00\u53d1\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u6ce8\u89e3\u5f62\u5f0f\u8f6c\u5316 SpringMVC \u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e3a\u914d\u7f6e\u7c7b java / config /  SpringMVCConfiguration.java"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ComponentScan(value = "com.seazean", includeFilters = @ComponentScan.Filter(\n    \t\t\t\t\t\t\t\ttype=FilterType.ANNOTATION,\n    \t\t\t\t\t\t\t\tclasses = {Controller.class} )\n    )\n//\u7b49\u540c\u4e8e<mvc:annotation-driven/>\uff0c\u8fd8\u4e0d\u5b8c\u5168\u76f8\u540c\n@EnableWebMvc\npublic class SpringMVCConfiguration implements WebMvcConfigurer{\n    //\u6ce8\u89e3\u914d\u7f6e\u901a\u7528\u653e\u884c\u8d44\u6e90\u7684\u683c\u5f0f \u5efa\u8bae\u4f7f\u7528\n    @Override\n    public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {\n        configurer.enable();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u57fa\u4e8e servlet3.0 \u89c4\u8303\uff0c\u81ea\u5b9a\u4e49 Servlet \u5bb9\u5668\u521d\u59cb\u5316\u914d\u7f6e\u7c7b\uff0c\u52a0\u8f7d SpringMVC \u6838\u5fc3\u914d\u7f6e\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class ServletContainersInitConfig extends AbstractDispatcherServletInitializer {\n    //\u521b\u5efaServlet\u5bb9\u5668\u65f6\uff0c\u4f7f\u7528\u6ce8\u89e3\u65b9\u5f0f\u52a0\u8f7dSPRINGMVC\u914d\u7f6e\u7c7b\u4e2d\u7684\u4fe1\u606f\uff0c\n    //\u5e76\u52a0\u8f7d\u6210WEB\u4e13\u7528\u7684ApplicationContext\u5bf9\u8c61\u8be5\u5bf9\u8c61\u653e\u5165\u4e86ServletContext\u8303\u56f4\uff0c\n    //\u5728\u6574\u4e2aWEB\u5bb9\u5668\u4e2d\u53ef\u4ee5\u968f\u65f6\u83b7\u53d6\u8c03\u7528\n    @Override\n    protected WebApplicationContext createServletApplicationContext() {\n        A.C.W.A ctx = new AnnotationConfigWebApplicationContext();\n        ctx.register(SpringMVCConfiguration.class);\n        return ctx;\n    }\n\n    //\u6ce8\u89e3\u914d\u7f6e\u6620\u5c04\u5730\u5740\u65b9\u5f0f\uff0c\u670d\u52a1\u4e8eSpringMVC\u7684\u6838\u5fc3\u63a7\u5236\u5668DispatcherServlet\n    @Override\n    protected String[] getServletMappings() {\n        return new String[]{"/"};\n    }\n\n    @Override\n    protected WebApplicationContext createRootApplicationContext() {\n        return null;\n    }\n\n    //\u4e71\u7801\u5904\u7406\u4f5c\u4e3a\u8fc7\u6ee4\u5668\uff0c\u5728servlet\u5bb9\u5668\u542f\u52a8\u65f6\u8fdb\u884c\u914d\u7f6e\n    @Override\n    public void onStartup(ServletContext servletContext) throws ServletException {\n        super.onStartup(servletContext);\n        CharacterEncodingFilter cef = new CharacterEncodingFilter();\n        cef.setEncoding("UTF-8");\n        FilterRegistration.Dynamic registration = servletContext.addFilter("characterEncodingFilter", cef);\n        registration.addMappingForUrlPatterns(EnumSet.of(\n           \t\t\tDispatcherType.REQUEST,\n            \t\tDispatcherType.FORWARD,\n            \t\tDispatcherType.INCLUDE), false,"/*");\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u8bf7\u6c42\u6620\u5c04",children:"\u8bf7\u6c42\u6620\u5c04"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@RequestMapping"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u65b9\u6cd5\u6ce8\u89e3\u3001\u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9\u3001\u5904\u7406\u5668\u7c7b\u5b9a\u4e49\u4e0a\u65b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b9\u6cd5\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u7ed1\u5b9a\u8bf7\u6c42\u5730\u5740\u4e0e\u5bf9\u5e94\u5904\u7406\u65b9\u6cd5\u95f4\u7684\u5173\u7cfb"}),"\n",(0,i.jsxs)(e.p,{children:["\u65e0\u7c7b\u6620\u5c04\u5730\u5740\u8bbf\u95ee\u683c\u5f0f\uff1a ",(0,i.jsx)(e.a,{href:"http://localhost/requestURL2",children:"http://localhost/requestURL2"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class UserController {\n    @RequestMapping("/requestURL2")\n    public String requestURL2() {\n        return "page.jsp";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u4e3a\u5f53\u524d\u5904\u7406\u5668\u4e2d\u6240\u6709\u65b9\u6cd5\u8bbe\u5b9a\u516c\u5171\u7684\u8bbf\u95ee\u8def\u5f84\u524d\u7f00"}),"\n",(0,i.jsxs)(e.p,{children:["\u5e26\u6709\u7c7b\u6620\u5c04\u5730\u5740\u8bbf\u95ee\u683c\u5f0f\uff0c\u5c06\u7c7b\u6620\u5c04\u5730\u5740\u4f5c\u4e3a\u524d\u7f00\u6dfb\u52a0\u5728\u5b9e\u9645\u6620\u5c04\u5730\u5740\u524d\u9762\uff1a",(0,i.jsx)(e.strong,{children:"/user/requestURL1"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u6700\u7ec8\u8fd4\u56de\u7684\u9875\u9762\u5982\u679c\u672a\u8bbe\u5b9a\u7edd\u5bf9\u8bbf\u95ee\u8def\u5f84\uff0c\u5c06\u4ece\u7c7b\u6620\u5c04\u5730\u5740\u6240\u5728\u76ee\u5f55\u4e2d\u67e5\u627e ",(0,i.jsx)(e.strong,{children:"webapp/user/page.jsp"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\n@RequestMapping("/user")\npublic class UserController {\n    @RequestMapping("/requestURL2")\n    public String requestURL2() {\n        return "page.jsp";\n    }\n} \n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5e38\u7528\u5c5e\u6027"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping(\n    value="/requestURL3", //\u8bbe\u5b9a\u8bf7\u6c42\u8def\u5f84\uff0c\u4e0epath\u5c5e\u6027\u3001 value\u5c5e\u6027\u76f8\u540c\n    method = RequestMethod.GET, //\u8bbe\u5b9a\u8bf7\u6c42\u65b9\u5f0f\n    params = "name", //\u8bbe\u5b9a\u8bf7\u6c42\u53c2\u6570\u6761\u4ef6\n    headers = "content-type=text/*", //\u8bbe\u5b9a\u8bf7\u6c42\u6d88\u606f\u5934\u6761\u4ef6\n    consumes = "text/*", //\u7528\u4e8e\u6307\u5b9a\u53ef\u4ee5\u63a5\u6536\u7684\u8bf7\u6c42\u6b63\u6587\u7c7b\u578b\uff08MIME\u7c7b\u578b\uff09\n    produces = "text/*" //\u7528\u4e8e\u6307\u5b9a\u53ef\u4ee5\u751f\u6210\u7684\u54cd\u5e94\u6b63\u6587\u7c7b\u578b\uff08MIME\u7c7b\u578b\uff09\n)\npublic String requestURL3() {\n    return "/page.jsp";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u64cd\u4f5c-2",children:"\u57fa\u672c\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.h3,{id:"\u8bf7\u6c42\u5904\u7406",children:"\u8bf7\u6c42\u5904\u7406"}),"\n",(0,i.jsx)(e.h4,{id:"\u666e\u901a\u7c7b\u578b",children:"\u666e\u901a\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"SpringMVC \u5c06\u4f20\u9012\u7684\u53c2\u6570\u5c01\u88c5\u5230\u5904\u7406\u5668\u65b9\u6cd5\u7684\u5f62\u53c2\u4e2d\uff0c\u8fbe\u5230\u5feb\u901f\u8bbf\u95ee\u53c2\u6570\u7684\u76ee\u7684"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.a,{href:"http://localhost/requestParam1?name=seazean&age=14",children:"http://localhost/requestParam1?name=seazean&age=14"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class UserController {\n    @RequestMapping("/requestParam1")\n    public String requestParam1(String name ,int age){\n        System.out.println("name=" + name + ",age=" + age);\n        return "page.jsp";\n    }\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-jsp",children:'<%@page pageEncoding="UTF-8" language="java" contentType="text/html;UTF-8" %>\n<html>\n<body>\n\t<h1>\u8bf7\u6c42\u53c2\u6570\u6d4b\u8bd5\u9875\u9762</h1>\n</body>\n</html>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@RequestParam \u7684\u4f7f\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5f62\u53c2\u524d\u65b9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u7ed1\u5b9a\u8bf7\u6c42\u53c2\u6570\u4e0e\u5bf9\u5e94\u5904\u7406\u65b9\u6cd5\u5f62\u53c2\u95f4\u7684\u5173\u7cfb"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.a,{href:"http://localhost/requestParam2?userName=Jock",children:"http://localhost/requestParam2?userName=Jock"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam2")\npublic String requestParam2(@RequestParam(\n                            name = "userName",\n                            required = true,\t//\u4e3atrue\u4ee3\u8868\u5fc5\u987b\u6709\u53c2\u6570\n                            defaultValue = "s") String name){\n    System.out.println("name=" + name);\n    return "page.jsp";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"pojo\u7c7b\u578b",children:"POJO\u7c7b\u578b"}),"\n",(0,i.jsx)(e.h5,{id:"\u7b80\u5355\u7c7b\u578b",children:"\u7b80\u5355\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"\u5f53 POJO \u4e2d\u4f7f\u7528\u7b80\u5355\u7c7b\u578b\u5c5e\u6027\u65f6\uff0c \u53c2\u6570\u540d\u79f0\u4e0e POJO \u7c7b\u5c5e\u6027\u540d\u4fdd\u6301\u4e00\u81f4"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a ",(0,i.jsx)(e.a,{href:"http://localhost/requestParam3?name=seazean&age=14",children:"http://localhost/requestParam3?name=seazean&age=14"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam3")\npublic String requestParam3(User user){\n    System.out.println("name=" + user.getName());\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User {\n    private String name;\n    private Integer age;\n    //......\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u53c2\u6570\u51b2\u7a81",children:"\u53c2\u6570\u51b2\u7a81"}),"\n",(0,i.jsxs)(e.p,{children:["\u5f53 POJO \u7c7b\u578b\u5c5e\u6027\u4e0e\u5176\u4ed6\u5f62\u53c2\u51fa\u73b0\u540c\u540d\u95ee\u9898\u65f6\uff0c\u5c06\u88ab",(0,i.jsx)(e.strong,{children:"\u540c\u65f6\u8d4b\u503c"}),"\uff0c\u5efa\u8bae\u4f7f\u7528 @RequestParam \u6ce8\u89e3\u8fdb\u884c\u533a\u5206"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a ",(0,i.jsx)(e.a,{href:"http://localhost/requestParam4?name=seazean&age=14",children:"http://localhost/requestParam4?name=seazean&age=14"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam4")\npublic String requestParam4(User user, String age){\n    System.out.println("user.age=" + user.getAge() + ",age=" + age);//14 14 \n    return "page.jsp";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u590d\u6742\u7c7b\u578b",children:"\u590d\u6742\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"\u5f53 POJO \u4e2d\u51fa\u73b0\u5bf9\u8c61\u5c5e\u6027\u65f6\uff0c\u53c2\u6570\u540d\u79f0\u4e0e\u5bf9\u8c61\u5c42\u6b21\u7ed3\u6784\u540d\u79f0\u4fdd\u6301\u4e00\u81f4"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a ",(0,i.jsx)(e.a,{href:"http://localhost/requestParam5?address.province=beijing",children:"http://localhost/requestParam5?address.province=beijing"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam5")\npublic String requestParam5(User user){\n    System.out.println("user.address=" + user.getAddress().getProvince());\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User {\n    private String name;\n    private Integer age;\n    private Address address; //....\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Address {\n    private String province;\n    private String city;\n    private String address;\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u5bb9\u5668\u7c7b\u578b",children:"\u5bb9\u5668\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"POJO \u4e2d\u51fa\u73b0\u96c6\u5408\u7c7b\u578b\u7684\u5904\u7406\u65b9\u5f0f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7 URL \u5730\u5740\u4e2d\u540c\u540d\u53c2\u6570\uff0c\u53ef\u4ee5\u4e3a POJO \u4e2d\u7684\u96c6\u5408\u5c5e\u6027\u8fdb\u884c\u8d4b\u503c\uff0c\u96c6\u5408\u5c5e\u6027\u8981\u6c42\u4fdd\u5b58\u7b80\u5355\u6570\u636e"}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.a,{href:"http://localhost/requestParam6?nick=Jock1&nick=Jockme&nick=zahc",children:"http://localhost/requestParam6?nick=Jock1&nick=Jockme&nick=zahc"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam6")\npublic String requestParam6(User user){\n    System.out.println("user=" + user);\n    //user = User{name=\'null\',age=null,nick={Jock1,Jockme,zahc}}\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User {\n    private String name;\n    private Integer age;\n    private List<String> nick;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["POJO \u4e2d\u51fa\u73b0 List \u4fdd\u5b58\u5bf9\u8c61\u6570\u636e\uff0c\u53c2\u6570\u540d\u79f0\u4e0e\u5bf9\u8c61\u5c42\u6b21\u7ed3\u6784\u540d\u79f0\u4fdd\u6301\u4e00\u81f4\uff0c\u4f7f\u7528\u6570\u7ec4\u683c\u5f0f\u63cf\u8ff0\u96c6\u5408\u4e2d\u5bf9\u8c61\u7684\u4f4d\u7f6e\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.code,{children:"http://localhost/requestParam7?addresses[0].province=bj&addresses[1].province=tj"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam7")\npublic String requestParam7(User user){\n    System.out.println("user.addresses=" + user.getAddress());\n    //{Address{provice=bj,city=\'null\',address=\'null\'}},{Address{....}}\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User {\n    private String name;\n    private Integer age;\n    private List<Address> addresses;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"POJO \u4e2d\u51fa\u73b0 Map \u4fdd\u5b58\u5bf9\u8c61\u6570\u636e\uff0c\u53c2\u6570\u540d\u79f0\u4e0e\u5bf9\u8c61\u5c42\u6b21\u7ed3\u6784\u540d\u79f0\u4fdd\u6301\u4e00\u81f4\uff0c\u4f7f\u7528\u6620\u5c04\u683c\u5f0f\u63cf\u8ff0\u96c6\u5408\u4e2d\u5bf9\u8c61\u4f4d\u7f6e"}),"\n",(0,i.jsxs)(e.p,{children:["URL: ",(0,i.jsx)(e.a,{href:"http://localhost/requestParam8?addressMap%5B%E2%80%99home%E2%80%99%5D.province=bj&addressMap%5B%E2%80%99job%E2%80%99%5D.province=tj",children:"http://localhost/requestParam8?addressMap[\u2019home\u2019].province=bj&addressMap[\u2019job\u2019].province=tj"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam8")\npublic String requestParam8(User user){\n    System.out.println("user.addressMap=" + user.getAddressMap());\n    //user.addressMap={home=Address{p=,c=,a=},job=Address{....}}\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User {\n    private Map<String,Address> addressMap;\n    //....\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6570\u7ec4\u96c6\u5408",children:"\u6570\u7ec4\u96c6\u5408"}),"\n",(0,i.jsx)(e.h5,{id:"\u6570\u7ec4\u7c7b\u578b",children:"\u6570\u7ec4\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"\u8bf7\u6c42\u53c2\u6570\u540d\u4e0e\u5904\u7406\u5668\u65b9\u6cd5\u5f62\u53c2\u540d\u4fdd\u6301\u4e00\u81f4\uff0c\u4e14\u8bf7\u6c42\u53c2\u6570\u6570\u91cf\uff1e 1\u4e2a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a ",(0,i.jsx)(e.a,{href:"http://localhost/requestParam9?nick=Jockme&nick=zahc",children:"http://localhost/requestParam9?nick=Jockme&nick=zahc"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam9")\npublic String requestParam9(String[] nick){\n    System.out.println(nick[0] + "," + nick[1]);\n    return "page.jsp";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u96c6\u5408\u7c7b\u578b",children:"\u96c6\u5408\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"\u4fdd\u5b58\u7b80\u5355\u7c7b\u578b\u6570\u636e\uff0c\u8bf7\u6c42\u53c2\u6570\u540d\u4e0e\u5904\u7406\u5668\u65b9\u6cd5\u5f62\u53c2\u540d\u4fdd\u6301\u4e00\u81f4\uff0c\u4e14\u8bf7\u6c42\u53c2\u6570\u6570\u91cf\uff1e 1\u4e2a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a ",(0,i.jsx)(e.a,{href:"http://localhost/requestParam10?nick=Jockme&nick=zahc",children:"http://localhost/requestParam10?nick=Jockme&nick=zahc"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam10")\npublic String requestParam10(@RequestParam("nick") List<String> nick){\n    System.out.println(nick);\n    return "page.jsp";\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a SpringMVC \u9ed8\u8ba4\u5c06 List \u4f5c\u4e3a\u5bf9\u8c61\u5904\u7406\uff0c\u8d4b\u503c\u524d\u5148\u521b\u5efa\u5bf9\u8c61\uff0c\u7136\u540e\u5c06 nick ",(0,i.jsx)(e.strong,{children:"\u4f5c\u4e3a\u5bf9\u8c61\u7684\u5c5e\u6027"}),"\u8fdb\u884c\u5904\u7406\u3002List \u662f\u63a5\u53e3\u65e0\u6cd5\u521b\u5efa\u5bf9\u8c61\uff0c\u62a5\u65e0\u6cd5\u627e\u5230\u6784\u9020\u65b9\u6cd5\u5f02\u5e38\uff1b\u4fee\u590d\u7c7b\u578b\u4e3a\u53ef\u521b\u5efa\u5bf9\u8c61\u7684 ArrayList \u7c7b\u578b\u540e\uff0c\u5bf9\u8c61\u53ef\u4ee5\u521b\u5efa\u4f46\u6ca1\u6709 nick \u5c5e\u6027\uff0c\u56e0\u6b64\u6570\u636e\u4e3a\u7a7a\n\u89e3\u51b3\u65b9\u6cd5\uff1a\u9700\u8981\u544a\u77e5 SpringMVC \u7684\u5904\u7406\u5668 nick \u662f\u4e00\u7ec4\u6570\u636e\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u5355\u4e00\u5c5e\u6027\u3002\u901a\u8fc7 @RequestParam \u6ce8\u89e3\uff0c\u5c06\u6570\u91cf\u5927\u4e8e 1 \u4e2a names \u53c2\u6570\u6253\u5305\u6210\u53c2\u6570\u6570\u7ec4\u540e\uff0c SpringMVC \u624d\u80fd\u8bc6\u522b\u8be5\u6570\u636e\u683c\u5f0f\uff0c\u5e76\u5224\u5b9a\u5f62\u53c2\u7c7b\u578b\u662f\u5426\u4e3a\u6570\u7ec4\u6216\u96c6\u5408\uff0c\u5e76\u6309\u6570\u7ec4\u6216\u96c6\u5408\u5bf9\u8c61\u7684\u5f62\u5f0f\u64cd\u4f5c\u6570\u636e"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8f6c\u6362\u5668",children:"\u8f6c\u6362\u5668"}),"\n",(0,i.jsx)(e.h5,{id:"\u7c7b\u578b",children:"\u7c7b\u578b"}),"\n",(0,i.jsxs)(e.p,{children:["\u5f00\u542f\u8f6c\u6362\u914d\u7f6e\uff1a",(0,i.jsx)(e.code,{children:"<mvc:annotation-driven />  "}),"\n\u4f5c\u7528\uff1a\u63d0\u4f9b Controller \u8bf7\u6c42\u8f6c\u53d1\uff0cJson \u81ea\u52a8\u8f6c\u6362\u7b49\u529f\u80fd"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679c\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.code,{children:"http://localhost/requestParam1?name=seazean&age=seazean"}),"\uff0c\u4f1a\u51fa\u73b0\u62a5\u9519\uff0c\u7c7b\u578b\u8f6c\u5316\u5f02\u5e38"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam1")\npublic String requestParam1(String name ,int age){\n    System.out.println("name=" + name + ",age=" + age);\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"SpringMVC \u5bf9\u63a5\u6536\u7684\u6570\u636e\u8fdb\u884c\u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\uff0c\u8be5\u5de5\u4f5c\u901a\u8fc7 Converter \u63a5\u53e3\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6807\u91cf\u8f6c\u6362\u5668"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u96c6\u5408\u3001\u6570\u7ec4\u76f8\u5173\u8f6c\u6362\u5668"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9ed8\u8ba4\u8f6c\u6362\u5668"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u65e5\u671f",children:"\u65e5\u671f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(58160).A+"",width:"772",height:"252"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679c\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.code,{children:"http://localhost/requestParam11?date=1999-09-09"})," \u4f1a\u62a5\u9519\uff0c\u6240\u4ee5\u9700\u8981\u65e5\u671f\u7c7b\u578b\u8f6c\u6362"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u58f0\u660e\u81ea\u5b9a\u4e49\u7684\u8f6c\u6362\u683c\u5f0f\u5e76\u8986\u76d6\u7cfb\u7edf\u8f6c\u6362\u683c\u5f0f\uff0c\u914d\u7f6e resources / spring-mvc.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--5.\u542f\u7528\u81ea\u5b9a\u4e49Converter--\x3e\n<mvc:annotation-driven conversion-service="conversionService"/>\n\x3c!--1.\u8bbe\u5b9a\u683c\u5f0f\u7c7b\u578bConverter\uff0c\u6ce8\u518c\u4e3aBean\uff0c\u53d7SpringMVC\u7ba1\u7406--\x3e\n<bean id="conversionService" class="org.springframework.format.support.FormattingConversionServiceFactoryBean">\n    \x3c!--2.\u81ea\u5b9a\u4e49Converter\u683c\u5f0f\u7c7b\u578b\u8bbe\u5b9a\uff0c\u8be5\u8bbe\u5b9a\u4f7f\u7528\u7684\u662f\u540c\u7c7b\u578b\u8986\u76d6\u7684\u601d\u60f3--\x3e\n    <property name="formatters">\n        \x3c!--3.\u4f7f\u7528set\u4fdd\u969c\u76f8\u540c\u7c7b\u578b\u7684\u8f6c\u6362\u5668\u4ec5\u4fdd\u7559\u4e00\u4e2a\uff0c\u907f\u514d\u51b2\u7a81--\x3e\n        <set>\n            \x3c!--4.\u8bbe\u7f6e\u5177\u4f53\u7684\u683c\u5f0f\u7c7b\u578b--\x3e\n            <bean class="org.springframework.format.datetime.DateFormatter">\n                \x3c!--5.\u7c7b\u578b\u89c4\u5219--\x3e\n                <property name="pattern" value="yyyy-MM-dd"/>\n            </bean>\n        </set>\n    </property>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@DateTimeFormat\n\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3\u3001\u6210\u5458\u53d8\u91cf\u6ce8\u89e3\n\u4f4d\u7f6e\uff1a\u5f62\u53c2\u524d\u9762 \u6216 \u6210\u5458\u53d8\u91cf\u4e0a\u65b9\n\u4f5c\u7528\uff1a\u4e3a\u5f53\u524d\u53c2\u6570\u6216\u53d8\u91cf\u6307\u5b9a\u7c7b\u578b\u8f6c\u6362\u89c4\u5219"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public String requestParam12(@DateTimeFormat(pattern = "yyyy-MM-dd") Date date){\n    System.out.println("date=" + date);\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@DateTimeFormat(pattern = "yyyy-MM-dd")\nprivate Date date;\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4f9d\u8d56\u6ce8\u89e3\u9a71\u52a8\u652f\u6301\uff0cxml \u5f00\u542f\u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<mvc:annotation-driven />  \n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u81ea\u5b9a\u4e49-1",children:"\u81ea\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u7c7b\u578b\u8f6c\u6362\u5668\uff0c\u5b9e\u73b0 Converter \u63a5\u53e3\u6216\u8005\u76f4\u63a5\u5bb9\u5668\u4e2d\u6ce8\u5165\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b9\u5f0f\u4e00\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class WebConfig implements WebMvcConfigurer {\n    @Bean\n    public WebMvcConfigurer webMvcConfigurer() {\n        return new WebMvcConfigurer() {\n            @Override\n            public void addFormatters(FormatterRegistry registry) {\n                registry.addConverter(new Converter<String, Date>() {\n                    @Override\n                    public Pet convert(String source) {\n                    \tDateFormat df = new SimpleDateFormat("yyyy-MM-dd");\n                        Date date = null;\n                        //\u7c7b\u578b\u8f6c\u6362\u5668\u65e0\u6cd5\u9884\u8ba1\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u5f02\u5e38\uff0c\u56e0\u6b64\u5fc5\u987b\u5728\u7c7b\u578b\u8f6c\u6362\u5668\u5185\u90e8\u6355\u83b7\uff0c\n                        //\u4e0d\u5141\u8bb8\u629b\u51fa\uff0c\u6846\u67b6\u65e0\u6cd5\u9884\u8ba1\u6b64\u7c7b\u5f02\u5e38\u5982\u4f55\u5904\u7406\n                        try {\n                            date = df.parse(source);\n                        } catch (ParseException e) {\n                            e.printStackTrace();\n                        }\n                        return date;\n                    }\n                });\n        }\n    }\n}\n\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b9\u5f0f\u4e8c\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u672c\u4f8b\u4e2d\u7684\u6cdb\u578b\u586b\u5199\u7684\u662fString\uff0cDate\uff0c\u6700\u7ec8\u51fa\u73b0\u5b57\u7b26\u4e32\u8f6c\u65e5\u671f\u65f6\uff0c\u8be5\u7c7b\u578b\u8f6c\u6362\u5668\u751f\u6548\npublic class MyDateConverter implements Converter<String, Date> {\n    //\u91cd\u5199\u63a5\u53e3\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u53c2\u6570\u7531\u6cdb\u578b\u51b3\u5b9a\n    public Date convert(String source) {\n        DateFormat df = new SimpleDateFormat("yyyy-MM-dd");\n        Date date = null;\n        //\u7c7b\u578b\u8f6c\u6362\u5668\u65e0\u6cd5\u9884\u8ba1\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u5f02\u5e38\uff0c\u56e0\u6b64\u5fc5\u987b\u5728\u7c7b\u578b\u8f6c\u6362\u5668\u5185\u90e8\u6355\u83b7\uff0c\n        //\u4e0d\u5141\u8bb8\u629b\u51fa\uff0c\u6846\u67b6\u65e0\u6cd5\u9884\u8ba1\u6b64\u7c7b\u5f02\u5e38\u5982\u4f55\u5904\u7406\n        try {\n            date = df.parse(source);\n        } catch (ParseException e) {\n            e.printStackTrace();\n        }\n        return date;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e resources / spring-mvc.xml\uff0c\u6ce8\u518c\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668\uff0c\u5c06\u529f\u80fd\u52a0\u5165\u5230 SpringMVC \u8f6c\u6362\u670d\u52a1 ConverterService \u4e2d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!--1.\u5c06\u81ea\u5b9a\u4e49Converter\u6ce8\u518c\u4e3aBean\uff0c\u53d7SpringMVC\u7ba1\u7406--\x3e\n<bean id="myDateConverter" class="converter.MyDateConverter"/>\n\x3c!--2.\u8bbe\u5b9a\u81ea\u5b9a\u4e49Converter\u670d\u52a1bean--\x3e\n<bean id="conversionService"\n      class="org.springframework.context.support.ConversionServiceFactoryBean">\n    \x3c!--3.\u6ce8\u5165\u6240\u6709\u7684\u81ea\u5b9a\u4e49Converter\uff0c\u8be5\u8bbe\u5b9a\u4f7f\u7528\u7684\u662f\u540c\u7c7b\u578b\u8986\u76d6\u7684\u601d\u60f3--\x3e\n    <property name="converters">\n        \x3c!--4.set\u4fdd\u969c\u540c\u7c7b\u578b\u8f6c\u6362\u5668\u4ec5\u4fdd\u7559\u4e00\u4e2a\uff0c\u53bb\u91cd\u89c4\u5219\u4ee5Converter<S,T>\u7684\u6cdb\u578b\u4e3a\u51c6--\x3e\n        <set>\n            \x3c!--5.\u5177\u4f53\u7684\u7c7b\u578b\u8f6c\u6362\u5668--\x3e\n            <ref bean="myDateConverter"/>\n        </set>\n    </property>\n</bean>\n\n\x3c!--\u5f00\u542f\u6ce8\u89e3\u9a71\u52a8\uff0c\u52a0\u8f7d\u81ea\u5b9a\u4e49\u683c\u5f0f\u5316\u8f6c\u6362\u5668\u5bf9\u5e94\u7684\u7c7b\u578b\u8f6c\u6362\u670d\u52a1--\x3e\n<mvc:annotation-driven conversion-service="conversionService"/>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u8f6c\u6362\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/requestParam12")\npublic String requestParam12(Date date){\n    System.out.println(date);\n    return "page.jsp";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u54cd\u5e94\u5904\u7406",children:"\u54cd\u5e94\u5904\u7406"}),"\n",(0,i.jsx)(e.h4,{id:"\u9875\u9762\u8df3\u8f6c",children:"\u9875\u9762\u8df3\u8f6c"}),"\n",(0,i.jsx)(e.p,{children:"\u8bf7\u6c42\u8f6c\u53d1\u548c\u91cd\u5b9a\u5411\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bf7\u6c42\u8f6c\u53d1\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class UserController {\n    @RequestMapping("/showPage1")\n\tpublic String showPage1() {\n   \t \tSystem.out.println("user mvc controller is running ...");\n    \treturn "forward:/WEB-INF/page/page.jsp;\n\t}\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bf7\u6c42\u91cd\u5b9a\u5411\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/showPage2")\npublic String showPage2() {\n    System.out.println("user mvc controller is running ...");\n    return "redirect:/WEB-INF/page/page.jsp";//\u4e0d\u80fd\u8bbf\u95eeWEB-INF\u4e0b\u7684\u8d44\u6e90\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u9875\u9762\u8bbf\u95ee\u5feb\u6377\u8bbe\u5b9a\uff08InternalResourceViewResolver\uff09\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5c55\u793a\u9875\u9762\u7684\u4fdd\u5b58\u4f4d\u7f6e\u901a\u5e38\u56fa\u5b9a\u4e14\u7ed3\u6784\u76f8\u4f3c\uff0c\u53ef\u4ee5\u8bbe\u5b9a\u901a\u7528\u7684\u8bbf\u95ee\u8def\u5f84\u7b80\u5316\u9875\u9762\u914d\u7f6e\uff0c\u914d\u7f6e spring-mvc.xml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">\n    <property name="prefix" value="/WEB-INF/pages/"/>\n    <property name="suffix" value=".jsp"/>\n</bean>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7b80\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/showPage3")\npublic String showPage3() {\n    System.out.println("user mvc controller is running...");\n    return "page";\n}\n@RequestMapping("/showPage4")\npublic String showPage4() {\n    System.out.println("user mvc controller is running...");\n    return "forward:page";\n}\n\n@RequestMapping("/showPage5")\npublic String showPage5() {\n    System.out.println("user mvc controller is running...");\n    return "redirect:page";\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679c\u672a\u8bbe\u5b9a\u4e86\u8fd4\u56de\u503c\uff0c\u4f7f\u7528 void \u7c7b\u578b\uff0c\u5219\u9ed8\u8ba4\u4f7f\u7528\u8bbf\u95ee\u8def\u5f84\u4f5c\u9875\u9762\u5730\u5740\u7684\u524d\u7f00\u540e\u7f00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u6700\u7b80\u9875\u9762\u914d\u7f6e\u65b9\u5f0f\uff0c\u4f7f\u7528\u8bbf\u95ee\u8def\u5f84\u4f5c\u4e3a\u9875\u9762\u540d\u79f0\uff0c\u7701\u7565\u8fd4\u56de\u503c\n@RequestMapping("/showPage6")\npublic void showPage6() {\n    System.out.println("user mvc controller is running ...");\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6570\u636e\u8df3\u8f6c",children:"\u6570\u636e\u8df3\u8f6c"}),"\n",(0,i.jsx)(e.p,{children:"ModelAndView \u662f SpringMVC \u63d0\u4f9b\u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u53ef\u4ee5\u7528\u4f5c\u63a7\u5236\u5668\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\uff08Model \u540c\uff09\uff0c\u5b9e\u73b0\u643a\u5e26\u6570\u636e\u8df3\u8f6c"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8bbe\u7f6e\u6570\u636e\uff0c\u5411\u8bf7\u6c42\u57df\u5bf9\u8c61\u4e2d\u5b58\u50a8\u6570\u636e"}),"\n",(0,i.jsx)(e.li,{children:"\u8bbe\u7f6e\u89c6\u56fe\uff0c\u903b\u8f91\u89c6\u56fe"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 HttpServletRequest \u7c7b\u578b\u5f62\u53c2\u8fdb\u884c\u6570\u636e\u4f20\u9012"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class BookController {\n    @RequestMapping("/showPageAndData1")\n    public String showPageAndData1(HttpServletRequest request) {\n        request.setAttribute("name","seazean");\n        return "page";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 Model \u7c7b\u578b\u5f62\u53c2\u8fdb\u884c\u6570\u636e\u4f20\u9012"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/showPageAndData2")\npublic String showPageAndData2(Model model) {\n    model.addAttribute("name","seazean");\n    Book book = new Book();\n    book.setName("SpringMVC\u5165\u95e8\u5b9e\u6218");\n    book.setPrice(66.6d);\n    //\u6dfb\u52a0\u6570\u636e\u7684\u65b9\u5f0f\uff0ckey\u5bf9value\n    model.addAttribute("book",book);\n    return "page";\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Book {\n    private String name;\n    private Double price;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 ModelAndView \u7c7b\u578b\u5f62\u53c2\u8fdb\u884c\u6570\u636e\u4f20\u9012\uff0c\u5c06\u8be5\u5bf9\u8c61\u4f5c\u4e3a\u8fd4\u56de\u503c\u4f20\u9012\u7ed9\u8c03\u7528\u8005"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/showPageAndData3")\npublic ModelAndView showPageAndData3(ModelAndView modelAndView) {\n    //ModelAndView mav = new ModelAndView(); \u66ff\u6362\u5f62\u53c2\u4e2d\u7684\u53c2\u6570\n    Book book  = new Book();\n    book.setName("SpringMVC\u5165\u95e8\u6848\u4f8b");\n    book.setPrice(66.66d);\n\n    //\u6dfb\u52a0\u6570\u636e\u7684\u65b9\u5f0f\uff0ckey\u5bf9value\n    modelAndView.addObject("book",book);\n    modelAndView.addObject("name","Jockme");\n    //\u8bbe\u7f6e\u9875\u9762\u7684\u65b9\u5f0f\uff0c\u8be5\u65b9\u6cd5\u6700\u540e\u4e00\u6b21\u6267\u884c\u7684\u7ed3\u679c\u751f\u6548\n    modelAndView.setViewName("page");\n    //\u8fd4\u56de\u503c\u8bbe\u5b9a\u6210ModelAndView\u5bf9\u8c61\n    return modelAndView;\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ModelAndView \u6269\u5c55"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//ModelAndView\u5bf9\u8c61\u652f\u6301\u8f6c\u53d1\u7684\u624b\u5de5\u8bbe\u5b9a\uff0c\u8be5\u8bbe\u5b9a\u4e0d\u4f1a\u542f\u7528\u524d\u7f00\u540e\u7f00\u7684\u9875\u9762\u62fc\u63a5\u683c\u5f0f\n@RequestMapping("/showPageAndData4")\npublic ModelAndView showPageAndData4(ModelAndView modelAndView) {\n    modelAndView.setViewName("forward:/WEB-INF/page/page.jsp");\n    return modelAndView;\n}\n\n//ModelAndView\u5bf9\u8c61\u652f\u6301\u91cd\u5b9a\u5411\u7684\u624b\u5de5\u8bbe\u5b9a\uff0c\u8be5\u8bbe\u5b9a\u4e0d\u4f1a\u542f\u7528\u524d\u7f00\u540e\u7f00\u7684\u9875\u9762\u62fc\u63a5\u683c\u5f0f\n@RequestMapping("/showPageAndData5")\npublic ModelAndView showPageAndData6(ModelAndView modelAndView) {\n    modelAndView.setViewName("redirect:page.jsp");\n    return modelAndView;\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"json",children:"JSON"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@ResponseBody"}),"\n",(0,i.jsxs)(e.p,{children:["\u4f5c\u7528\uff1a\u5c06 Controller \u7684\u65b9\u6cd5\u8fd4\u56de\u7684\u5bf9\u8c61\u901a\u8fc7\u9002\u5f53\u7684\u8f6c\u6362\u5668\u8f6c\u6362\u4e3a\u6307\u5b9a\u7684\u683c\u5f0f\u4e4b\u540e\uff0c\u5199\u5165\u5230 Response \u7684 body \u533a\u3002\u5982\u679c\u8fd4\u56de\u503c\u662f\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u76f4\u63a5\u5c06\u5b57\u7b26\u4e32\u8fd4\u56de\u5ba2\u6237\u7aef\uff1b\u5982\u679c\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f1a",(0,i.jsx)(e.strong,{children:"\u5c06\u5bf9\u8c61\u8f6c\u5316\u4e3a JSON"}),"\uff0c\u8fd4\u56de\u5ba2\u6237\u7aef"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5f53\u65b9\u6cd5\u4e0a\u9762\u6ca1\u6709\u5199 ResponseBody\uff0c\u5e95\u5c42\u4f1a\u5c06\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5c01\u88c5\u4e3a ModelAndView \u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 HttpServletResponse \u5bf9\u8c61\u54cd\u5e94\u6570\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class AccountController {\n    @RequestMapping("/showData1")\n    public void showData1(HttpServletResponse response) throws IOException {\n        response.getWriter().write("message");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(e.strong,{children:"@ResponseBody \u5c06\u8fd4\u56de\u7684\u7ed3\u679c\u4f5c\u4e3a\u54cd\u5e94\u5185\u5bb9"}),"\uff08\u9875\u9762\u663e\u793a\uff09\uff0c\u800c\u975e\u54cd\u5e94\u7684\u9875\u9762\u540d\u79f0"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@RequestMapping(\"/showData2\")\n@ResponseBody\npublic String showData2(){\n    return \"{'name':'Jock'}\";\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 jackson \u8fdb\u884c json \u6570\u636e\u683c\u5f0f\u8f6c\u5316"}),"\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5750\u6807\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--json\u76f8\u5173\u5750\u68073\u4e2a--\x3e\n<dependency>\n    <groupId>com.fasterxml.jackson.core</groupId>\n    <artifactId>jackson-core</artifactId>\n    <version>2.9.0</version>\n</dependency>\n\n<dependency>\n    <groupId>com.fasterxml.jackson.core</groupId>\n    <artifactId>jackson-databind</artifactId>\n    <version>2.9.0</version>\n</dependency>\n\n<dependency>\n    <groupId>com.fasterxml.jackson.core</groupId>\n    <artifactId>jackson-annotations</artifactId>\n    <version>2.9.0</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/showData3")\n@ResponseBody\npublic String showData3() throws JsonProcessingException {\n    Book book  = new Book();\n    book.setName("SpringMVC\u5165\u95e8\u6848\u4f8b");\n    book.setPrice(66.66d);\n\n    ObjectMapper om = new ObjectMapper();\n    return om.writeValueAsString(book);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 SpringMVC \u63d0\u4f9b\u7684\u6d88\u606f\u7c7b\u578b\u8f6c\u6362\u5668\u5c06\u5bf9\u8c61\u4e0e\u96c6\u5408\u6570\u636e\u81ea\u52a8\u8f6c\u6362\u4e3a JSON \u6570\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u4f7f\u7528SpringMVC\u6ce8\u89e3\u9a71\u52a8\uff0c\u5bf9\u6807\u6ce8@ResponseBody\u6ce8\u89e3\u7684\u63a7\u5236\u5668\u65b9\u6cd5\u8fdb\u884c\u7ed3\u679c\u8f6c\u6362\uff0c\u7531\u4e8e\u8fd4\u56de\u503c\u4e3a\u5f15\u7528\u7c7b\u578b\uff0c\u81ea\u52a8\u8c03\u7528jackson\u63d0\u4f9b\u7684\u7c7b\u578b\u8f6c\u6362\u5668\u8fdb\u884c\u683c\u5f0f\u8f6c\u6362\n@RequestMapping("/showData4")\n@ResponseBody\npublic Book showData4() {\n    Book book  = new Book();\n    book.setName("SpringMVC\u5165\u95e8\u6848\u4f8b");\n    book.setPrice(66.66d);\n    return book;\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u624b\u5de5\u6dfb\u52a0\u4fe1\u606f\u7c7b\u578b\u8f6c\u6362\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<bean class="org.springframework.web.servlet.mvc.method.\n             annotation.RequestMappingHandlerAdapter">\n    <property name="messageConverters">\n        <list>\n            <bean class="org.springframework.http.converter.\n                      json.MappingJackson2HttpMessageConverter"/>\n        </list>\n    </property>\n</bean\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 SpringMVC \u6ce8\u89e3\u9a71\u52a8\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u5f00\u542fspringmvc\u6ce8\u89e3\u9a71\u52a8\uff0c\u5bf9@ResponseBody\u7684\u6ce8\u89e3\u8fdb\u884c\u683c\u5f0f\u589e\u5f3a\uff0c\u8ffd\u52a0\u5176\u7c7b\u578b\u8f6c\u6362\u7684\u529f\u80fd\uff0c\u5177\u4f53\u5b9e\u73b0\u7531MappingJackson2HttpMessageConverter\u8fdb\u884c--\x3e\n<mvc:annotation-driven/>\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8f6c\u6362\u96c6\u5408\u7c7b\u578b\u6570\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/showData5")\n@ResponseBody\npublic List showData5() {\n    Book book1  = new Book();\n    book1.setName("SpringMVC\u5165\u95e8\u6848\u4f8b");\n    book1.setPrice(66.66d);\n\n    Book book2  = new Book();\n    book2.setName("SpringMVC\u5165\u95e8\u6848\u4f8b");\n    book2.setPrice(66.66d);\n\n    ArrayList al = new ArrayList();\n    al.add(book1);\n    al.add(book2);\n    return al;\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"restful",children:"Restful"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-4",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsxs)(e.p,{children:["Rest\uff08REpresentational State Transfer\uff09\uff1a\u8868\u73b0\u5c42\u72b6\u6001\u8f6c\u5316\uff0c\u5b9a\u4e49\u4e86",(0,i.jsx)(e.strong,{children:"\u8d44\u6e90\u5728\u7f51\u7edc\u4f20\u8f93\u4e2d\u4ee5\u67d0\u79cd\u8868\u73b0\u5f62\u5f0f\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb"}),"\uff0c\u5373\u7f51\u7edc\u8d44\u6e90\u7684\u8bbf\u95ee\u65b9\u5f0f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8d44\u6e90\uff1a\u628a\u771f\u5b9e\u7684\u5bf9\u8c61\u6570\u636e\u79f0\u4e3a\u8d44\u6e90\uff0c\u4e00\u4e2a\u8d44\u6e90\u65e2\u53ef\u4ee5\u662f\u4e00\u4e2a\u96c6\u5408\uff0c\u4e5f\u53ef\u4ee5\u662f\u5355\u4e2a\u4e2a\u4f53\uff1b\u6bcf\u4e00\u79cd\u8d44\u6e90\u90fd\u6709\u7279\u5b9a\u7684 URI\uff08\u7edf\u4e00\u8d44\u6e90\u6807\u8bc6\u7b26\uff09\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5982\u679c\u83b7\u53d6\u8fd9\u4e2a\u8d44\u6e90\uff0c\u8bbf\u95ee\u8fd9\u4e2a URI \u5c31\u53ef\u4ee5\uff0c\u6bd4\u5982\u83b7\u53d6\u7279\u5b9a\u7684\u73ed\u7ea7 ",(0,i.jsx)(e.code,{children:"/class/12"}),"\uff1b\u8d44\u6e90\u4e5f\u53ef\u4ee5\u5305\u542b\u5b50\u8d44\u6e90\uff0c\u6bd4\u5982 ",(0,i.jsx)(e.code,{children:"/classes/classId/teachers"})," \u67d0\u4e2a\u6307\u5b9a\u73ed\u7ea7\u7684\u6240\u6709\u8001\u5e08"]}),"\n",(0,i.jsx)(e.li,{children:'\u8868\u73b0\u5f62\u5f0f\uff1a\u8d44\u6e90\u662f\u4e00\u79cd\u4fe1\u606f\u5b9e\u4f53\uff0c\u5b83\u53ef\u4ee5\u6709\u591a\u79cd\u5916\u5728\u8868\u73b0\u5f62\u5f0f\uff0c\u628a\u8d44\u6e90\u5177\u4f53\u5448\u73b0\u51fa\u6765\u7684\u5f62\u5f0f\u6bd4\u5982 json\u3001xml\u3001image\u3001txt \u7b49\u7b49\u53eb\u505a\u5b83\u7684"\u8868\u73b0\u5c42/\u8868\u73b0\u5f62\u5f0f"'}),"\n",(0,i.jsxs)(e.li,{children:["\u72b6\u6001\u8f6c\u79fb\uff1a\u63cf\u8ff0\u7684\u670d\u52a1\u5668\u7aef\u8d44\u6e90\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u589e\u5220\u6539\u67e5\uff08\u901a\u8fc7 HTTP \u52a8\u8bcd\u5b9e\u73b0\uff09\u5f15\u8d77\u8d44\u6e90\u72b6\u6001\u7684\u6539\u53d8\uff0c\u4e92\u8054\u7f51\u901a\u4fe1\u534f\u8bae HTTP \u534f\u8bae\uff0c\u662f\u4e00\u4e2a",(0,i.jsx)(e.strong,{children:"\u65e0\u72b6\u6001\u534f\u8bae"}),"\uff0c\u6240\u6709\u7684\u8d44\u6e90\u72b6\u6001\u90fd\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u7aef"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8bbf\u95ee\u65b9\u5f0f",children:"\u8bbf\u95ee\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"Restful \u662f\u6309\u7167 Rest \u98ce\u683c\u8bbf\u95ee\u7f51\u7edc\u8d44\u6e90"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4f20\u7edf\u98ce\u683c\u8bbf\u95ee\u8def\u5f84\uff1a",(0,i.jsx)(e.a,{href:"http://localhost/user/get?id=1",children:"http://localhost/user/get?id=1"})]}),"\n",(0,i.jsxs)(e.li,{children:["Rest \u98ce\u683c\u8bbf\u95ee\u8def\u5f84\uff1a",(0,i.jsx)(e.a,{href:"http://localhost/user/1",children:"http://localhost/user/1"})]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f18\u70b9\uff1a\u9690\u85cf\u8d44\u6e90\u7684\u8bbf\u95ee\u884c\u4e3a\uff0c\u901a\u8fc7\u5730\u5740\u65e0\u6cd5\u5f97\u77e5\u505a\u7684\u662f\u4f55\u79cd\u64cd\u4f5c\uff0c\u4e66\u5199\u7b80\u5316"}),"\n",(0,i.jsxs)(e.p,{children:["Restful \u8bf7\u6c42\u8def\u5f84\u7b80\u5316\u914d\u7f6e\u65b9\u5f0f\uff1a",(0,i.jsx)(e.code,{children:"@RestController = @Controller + @ResponseBody"})]}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u6ce8\u89e3\uff1a@GetMapping \u6ce8\u89e3\u662f @RequestMapping \u6ce8\u89e3\u7684\u884d\u751f\uff0c\u6240\u4ee5\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u5efa\u8bae\u4f7f\u7528 @GetMapping"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:'@GetMapping("/poll")'})," = ",(0,i.jsx)(e.code,{children:'@RequestMapping(value = "/poll",method = RequestMethod.GET)'})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping(method = RequestMethod.GET)\t\t\t// @GetMapping \u5c31\u62e5\u6709\u4e86 @RequestMapping \u7684\u529f\u80fd\npublic @interface GetMapping {\n    @AliasFor(annotation = RequestMapping.class)\t// \u4e0e RequestMapping \u76f8\u901a\n\tString name() default "";\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:'@PostMapping("/push")'})," = ",(0,i.jsx)(e.code,{children:'@RequestMapping(value = "/push",method = RequestMethod.POST)'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fc7\u6ee4\u5668\uff1aHiddenHttpMethodFilter \u662f SpringMVC \u5bf9 Restful \u98ce\u683c\u7684\u8bbf\u95ee\u652f\u6301\u7684\u8fc7\u6ee4\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"restful.jsp\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u9875\u9762\u8868\u5355",(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u9690\u85cf\u57df\u63d0\u4ea4\u8bf7\u6c42\u7c7b\u578b"}),"\uff0c\u53c2\u6570\u540d\u79f0\u56fa\u5b9a\u4e3a _method\uff0c\u5fc5\u987b\u914d\u5408\u63d0\u4ea4\u7c7b\u578b method=post \u4f7f\u7528"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"GET \u8bf7\u6c42\u901a\u8fc7\u5730\u5740\u680f\u53ef\u4ee5\u53d1\u9001\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e form \u7684\u8bf7\u6c42\u65b9\u5f0f\u63d0\u4ea4"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"POST \u8bf7\u6c42\u5fc5\u987b\u901a\u8fc7 form \u7684\u8bf7\u6c42\u65b9\u5f0f\u63d0\u4ea4"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<h1>restful\u98ce\u683c\u8bf7\u6c42\u8868\u5355</h1>\n\x3c!--\u5207\u6362\u8bf7\u6c42\u8def\u5f84\u4e3arestful\u98ce\u683c--\x3e\n<form action="/user" method="post">\n\t\x3c!--\u4e00\u9690\u85cf\u57df\uff0c\u5207\u6362\u4e3aPUT\u8bf7\u6c42\u6216DELETE\u8bf7\u6c42\uff0c\u4f46\u662fform\u8868\u5355\u7684\u63d0\u4ea4\u65b9\u5f0fmethod\u5c5e\u6027\u5fc5\u987b\u586b\u5199post--\x3e\n\t<input name="_method" type="hidden" value="PUT"/>\n\t<input value="REST-PUT \u63d0\u4ea4" type="submit"/>\n</form>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"java / controller / UserController"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\t\t\t\t//\u8bbe\u7f6erest\u98ce\u683c\u7684\u63a7\u5236\u5668\n@RequestMapping("/user/")\t//\u8bbe\u7f6e\u516c\u5171\u8bbf\u95ee\u8def\u5f84\uff0c\u914d\u5408\u4e0b\u65b9\u8bbf\u95ee\u8def\u5f84\u4f7f\u7528\npublic class UserController {\n    @GetMapping("/user")\n    //@RequestMapping(value = "/user",method = RequestMethod.GET)\n    public String getUser(){\n        return "GET-\u5f20\u4e09";\n    }\n\n    @PostMapping("/user")\n    //@RequestMapping(value = "/user",method = RequestMethod.POST)\n    public String saveUser(){\n        return "POST-\u5f20\u4e09";\n    }\n\n    @PutMapping("/user")\n    //@RequestMapping(value = "/user",method = RequestMethod.PUT)\n    public String putUser(){\n        return "PUT-\u5f20\u4e09";\n    }\n\n    @DeleteMapping("/user")\n    //@RequestMapping(value = "/user",method = RequestMethod.DELETE)\n    public String deleteUser(){\n        return "DELETE-\u5f20\u4e09";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u62e6\u622a\u5668 web.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u914d\u7f6e\u62e6\u622a\u5668\uff0c\u89e3\u6790\u8bf7\u6c42\u4e2d\u7684\u53c2\u6570_method\uff0c\u5426\u5219\u65e0\u6cd5\u53d1\u8d77PUT\u8bf7\u6c42\u4e0eDELETE\u8bf7\u6c42\uff0c\u914d\u5408\u9875\u9762\u8868\u5355\u4f7f\u7528--\x3e\n<filter>\n    <filter-name>HiddenHttpMethodFilter</filter-name>\n    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>\n</filter>\n<filter-mapping>\n    <filter-name>HiddenHttpMethodFilter</filter-name>\n    <servlet-name>DispatcherServlet</servlet-name>\n</filter-mapping>\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u53c2\u6570\u6ce8\u89e3",children:"\u53c2\u6570\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"Restful \u5f00\u53d1\u4e2d\u7684\u53c2\u6570\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("{id}")\npublic String getMessage(@PathVariable("id") Integer id){\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 @PathVariable \u6ce8\u89e3\u83b7\u53d6\u8def\u5f84\u4e0a\u914d\u7f6e\u7684\u5177\u540d\u53d8\u91cf\uff0c\u4e00\u822c\u5728\u6709\u591a\u4e2a\u53c2\u6570\u7684\u65f6\u5019\u6dfb\u52a0"}),"\n",(0,i.jsx)(e.p,{children:"\u5176\u4ed6\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@RequestHeader\uff1a\u83b7\u53d6\u8bf7\u6c42\u5934"}),"\n",(0,i.jsx)(e.li,{children:"@RequestParam\uff1a\u83b7\u53d6\u8bf7\u6c42\u53c2\u6570\uff08\u6307\u95ee\u53f7\u540e\u7684\u53c2\u6570\uff0curl?a=1&b=2\uff09"}),"\n",(0,i.jsx)(e.li,{children:"@CookieValue\uff1a\u83b7\u53d6 Cookie \u503c"}),"\n",(0,i.jsx)(e.li,{children:"@RequestAttribute\uff1a\u83b7\u53d6 request \u57df\u5c5e\u6027"}),"\n",(0,i.jsx)(e.li,{children:"@RequestBody\uff1a\u83b7\u53d6\u8bf7\u6c42\u4f53 [POST]"}),"\n",(0,i.jsx)(e.li,{children:"@MatrixVariable\uff1a\u77e9\u9635\u53d8\u91cf"}),"\n",(0,i.jsx)(e.li,{children:"@ModelAttribute\uff1a\u81ea\u5b9a\u4e49\u7c7b\u578b\u53d8\u91cf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\t\n@RequestMapping("/user/")\npublic class UserController {\n    //rest\u98ce\u683c\u8bbf\u95ee\u8def\u5f84\u7b80\u5316\u4e66\u5199\u65b9\u5f0f\uff0c\u914d\u5408\u7c7b\u6ce8\u89e3@RequestMapping\u4f7f\u7528\n    @RequestMapping("{id}")\n    public String restLocation2(@PathVariable Integer id){\n        System.out.println("restful is running ....get:" + id);\n        return "success.jsp";\n    }\n\n    //@RequestMapping(value = "{id}",method = RequestMethod.GET)\n    @GetMapping("{id}")\n    public String get(@PathVariable Integer id){\n        System.out.println("restful is running ....get:" + id);\n        return "success.jsp";\n    }\n\n    @PostMapping("{id}")\n    public String post(@PathVariable Integer id){\n        System.out.println("restful is running ....post:" + id);\n        return "success.jsp";\n    }\n\n    @PutMapping("{id}")\n    public String put(@PathVariable Integer id){\n        System.out.println("restful is running ....put:" + id);\n        return "success.jsp";\n    }\n\n    @DeleteMapping("{id}")\n    public String delete(@PathVariable Integer id){\n        System.out.println("restful is running ....delete:" + id);\n        return "success.jsp";\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8bc6\u522b\u539f\u7406",children:"\u8bc6\u522b\u539f\u7406"}),"\n",(0,i.jsxs)(e.p,{children:["\u8868\u5355\u63d0\u4ea4\u8981\u4f7f\u7528 REST \u65f6\uff0c\u4f1a\u5e26\u4e0a ",(0,i.jsx)(e.code,{children:"_method=PUT"}),"\uff0c\u8bf7\u6c42\u8fc7\u6765\u88ab ",(0,i.jsx)(e.code,{children:"HiddenHttpMethodFilter"})," \u62e6\u622a\uff0c\u8fdb\u884c\u8fc7\u6ee4\u64cd\u4f5c"]}),"\n",(0,i.jsx)(e.p,{children:"org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal()\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class HiddenHttpMethodFilter extends OncePerRequestFilter {\n    // \u517c\u5bb9\u7684\u8bf7\u6c42 PUT\u3001DELETE\u3001PATCH\n    private static final List<String> ALLOWED_METHODS =\n\t\t\tCollections.unmodifiableList(Arrays.asList(HttpMethod.PUT.name(),\n\t\t\t\t\tHttpMethod.DELETE.name(), HttpMethod.PATCH.name()));\n    // \u9690\u85cf\u57df\u7684\u540d\u5b57\n\tpublic static final String DEFAULT_METHOD_PARAM = "_method";\n\n\tprivate String methodParam = DEFAULT_METHOD_PARAM;\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response,\n                                    FilterChain filterChain) throws ServletException, IOException {\n\n        HttpServletRequest requestToUse = request;\n        // \u8bf7\u6c42\u5fc5\u987b\u662f POST\uff0c\n        if ("POST".equals(request.getMethod()) && request.getAttribute(WebUtils.ERROR_EXCEPTION_ATTRIBUTE) == null) {\n            // \u83b7\u53d6\u6807\u7b7e\u4e2d name="_method" \u7684 value \u503c\n            String paramValue = request.getParameter(this.methodParam);\n            if (StringUtils.hasLength(paramValue)) {\n                // \u8f6c\u6210\u5927\u5199\n                String method = paramValue.toUpperCase(Locale.ENGLISH);\n                // \u517c\u5bb9\u7684\u8bf7\u6c42\u65b9\u5f0f\n                if (ALLOWED_METHODS.contains(method)) {\n                    // \u5305\u88c5\u8bf7\u6c42\n                    requestToUse = new HttpMethodRequestWrapper(request, method);\n                }\n            }\n        }\n        // \u8fc7\u6ee4\u5668\u94fe\u653e\u884c\u7684\u65f6\u5019\u7528wrapper\u3002\u4ee5\u540e\u7684\u65b9\u6cd5\u8c03\u7528getMethod\u662f\u8c03\u7528requesWrapper\u7684\n        filterChain.doFilter(requestToUse, response);\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"Rest \u4f7f\u7528\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u5982 Postman \u53ef\u76f4\u63a5\u53d1\u9001 put\u3001delete \u7b49\u65b9\u5f0f\u8bf7\u6c42\u4e0d\u88ab\u8fc7\u6ee4"}),"\n",(0,i.jsxs)(e.p,{children:["\u6539\u53d8\u9ed8\u8ba4\u7684 ",(0,i.jsx)(e.code,{children:"_method"})," \u7684\u65b9\u5f0f\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration(proxyBeanMethods = false)\npublic class WebConfig{\n    //\u81ea\u5b9a\u4e49filter\n    @Bean\n    public HiddenHttpMethodFilter hiddenHttpMethodFilter(){\n        HiddenHttpMethodFilter methodFilter = new HiddenHttpMethodFilter();\n        //\u901a\u8fc7set \u65b9\u6cd5\u81ea\u5b9a\u4e49\n        methodFilter.setMethodParam("_m");\n        return methodFilter;\n    }    \n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"servlet",children:"Servlet"}),"\n",(0,i.jsx)(e.p,{children:"SpringMVC \u63d0\u4f9b\u8bbf\u95ee\u539f\u59cb Servlet \u63a5\u53e3\u7684\u529f\u80fd"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"SpringMVC \u63d0\u4f9b\u8bbf\u95ee\u539f\u59cb Servlet \u63a5\u53e3 API \u7684\u529f\u80fd\uff0c\u901a\u8fc7\u5f62\u53c2\u58f0\u660e\u5373\u53ef"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/servletApi")\npublic String servletApi(HttpServletRequest request,\n                         HttpServletResponse response, HttpSession session){\n    System.out.println(request);\n    System.out.println(response);\n    System.out.println(session);\n    request.setAttribute("name","seazean");\n    System.out.println(request.getAttribute("name"));\n    return "page.jsp";\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Head \u6570\u636e\u83b7\u53d6\u5feb\u6377\u64cd\u4f5c\u65b9\u5f0f\n\u540d\u79f0\uff1a@RequestHeader\n\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3\n\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5f62\u53c2\u524d\u65b9\n\u4f5c\u7528\uff1a\u7ed1\u5b9a\u8bf7\u6c42\u5934\u6570\u636e\u4e0e\u5bf9\u5e94\u5904\u7406\u65b9\u6cd5\u5f62\u53c2\u95f4\u7684\u5173\u7cfb\n\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'\u5feb\u6377\u64cd\u4f5c\u65b9\u5f0f@RequestMapping("/headApi")\npublic String headApi(@RequestHeader("Accept-Language") String headMsg){\n    System.out.println(headMsg);\n    return "page";\n}  \n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Cookie \u6570\u636e\u83b7\u53d6\u5feb\u6377\u64cd\u4f5c\u65b9\u5f0f\n\u540d\u79f0\uff1a@CookieValue\n\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3\n\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5f62\u53c2\u524d\u65b9\n\u4f5c\u7528\uff1a\u7ed1\u5b9a\u8bf7\u6c42 Cookie \u6570\u636e\u4e0e\u5bf9\u5e94\u5904\u7406\u65b9\u6cd5\u5f62\u53c2\u95f4\u7684\u5173\u7cfb\n\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/cookieApi")\npublic String cookieApi(@CookieValue("JSESSIONID") String jsessionid){\n    System.out.println(jsessionid);\n    return "page";\n}  \n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Session \u6570\u636e\u83b7\u53d6\n\u540d\u79f0\uff1a@SessionAttribute\n\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3\n\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5f62\u53c2\u524d\u65b9\n\u4f5c\u7528\uff1a\u7ed1\u5b9a\u8bf7\u6c42Session\u6570\u636e\u4e0e\u5bf9\u5e94\u5904\u7406\u65b9\u6cd5\u5f62\u53c2\u95f4\u7684\u5173\u7cfb\n\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/sessionApi")\npublic String sessionApi(@SessionAttribute("name") String name){\n    System.out.println(name);\n    return "page.jsp";\n}\n//\u7528\u4e8e\u5728session\u4e2d\u653e\u5165\u6570\u636e\n@RequestMapping("/setSessionData")\npublic String setSessionData(HttpSession session){\n    session.setAttribute("name","seazean");\n    return "page";\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Session \u6570\u636e\u8bbe\u7f6e\n\u540d\u79f0\uff1a@SessionAttributes\n\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\n\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e0a\u65b9\n\u4f5c\u7528\uff1a\u58f0\u660e\u653e\u5165session\u8303\u56f4\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u9002\u7528\u4e8eModel\u7c7b\u578b\u6570\u636e\u4f20\u53c2\n\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\n//\u8bbe\u5b9a\u5f53\u524d\u7c7b\u4e2d\u540d\u79f0\u4e3aage\u548cgender\u7684\u53d8\u91cf\u653e\u5165session\u8303\u56f4\uff0c\u4e0d\u5e38\u7528\n@SessionAttributes(names = {"age","gender"})\npublic class ServletController {\n\t//\u5c06\u6570\u636e\u653e\u5165session\u5b58\u50a8\u8303\u56f4\uff0cModel\u5bf9\u8c61\u5b9e\u73b0\u6570\u636eset\uff0c@SessionAttributes\u6ce8\u89e3\u5b9e\u73b0\u8303\u56f4\u8bbe\u5b9a\n    @RequestMapping("/setSessionData2")\n    public String setSessionDate2(Model model) {\n        model.addAttribute("age",39);\n        model.addAttribute("gender","\u7537");\n        return "page";\n    }\n    \n    @RequestMapping("/sessionApi")\n    public String sessionApi(@SessionAttribute("age") int age,\n                             @SessionAttribute("gender") String gender){\n        System.out.println(name);\n        System.out.println(age);\n        return "page";\n    }\n}  \n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"spring-mvc.xml \u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:mvc="http://www.springframework.org/schema/mvc"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd\n        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">\n\n    <context:component-scan base-package="com.seazean"/>\n    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">\n        <property name="prefix" value="/WEB-INF/page/"/>\n        <property name="suffix" value=".jsp"/>\n    </bean>\n    <mvc:annotation-driven/>\n</beans>\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u8fd0\u884c\u539f\u7406-1",children:"\u8fd0\u884c\u539f\u7406"}),"\n",(0,i.jsx)(e.h3,{id:"\u6280\u672f\u67b6\u6784",children:"\u6280\u672f\u67b6\u6784"}),"\n",(0,i.jsx)(e.h4,{id:"\u7ec4\u4ef6\u4ecb\u7ecd",children:"\u7ec4\u4ef6\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u7ec4\u4ef6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DispatcherServlet\uff1a\u6838\u5fc3\u63a7\u5236\u5668\uff0c \u662f SpringMVC \u7684\u6838\u5fc3\uff0c\u6574\u4f53\u6d41\u7a0b\u63a7\u5236\u7684\u4e2d\u5fc3\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u7b2c\u4e00\u6b65\u90fd\u5148\u5230\u8fbe\u8fd9\u91cc\uff0c\u7531\u5176\u8c03\u7528\u5176\u5b83\u7ec4\u4ef6\u5904\u7406\u7528\u6237\u7684\u8bf7\u6c42\uff0c\u5b83\u5c31\u662f\u5728 web.xml \u914d\u7f6e\u7684\u6838\u5fc3 Servlet\uff0c\u6709\u6548\u7684\u964d\u4f4e\u4e86\u7ec4\u4ef6\u95f4\u7684\u8026\u5408\u6027"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"HandlerMapping\uff1a\u5904\u7406\u5668\u6620\u5c04\u5668\uff0c \u8d1f\u8d23\u6839\u636e\u8bf7\u6c42\u627e\u5230\u5bf9\u5e94\u5177\u4f53\u7684 Handler \u5904\u7406\u5668\uff0cSpringMVC \u4e2d\u9488\u5bf9\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f\u3001\u6ce8\u89e3\u65b9\u5f0f\u7b49\u63d0\u4f9b\u4e86\u4e0d\u540c\u7684\u6620\u5c04\u5668\u6765\u5904\u7406"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Handler\uff1a\u5904\u7406\u5668\uff0c\u5176\u5b9e\u5c31\u662f Controller\uff0c\u4e1a\u52a1\u5904\u7406\u7684\u6838\u5fc3\u7c7b\uff0c\u901a\u5e38\u7531\u5f00\u53d1\u8005\u7f16\u5199\uff0c\u5e76\u4e14\u5fc5\u987b\u9075\u5b88 Controller \u5f00\u53d1\u7684\u89c4\u5219\uff0c\u8fd9\u6837\u9002\u914d\u5668\u624d\u80fd\u6b63\u786e\u7684\u6267\u884c\u3002\u4f8b\u5982\u5b9e\u73b0 Controller \u63a5\u53e3\uff0c\u5c06 Controller \u6ce8\u518c\u5230 IOC \u5bb9\u5668\u4e2d\u7b49"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"HandlAdapter\uff1a\u5904\u7406\u5668\u9002\u914d\u5668\uff0c\u6839\u636e\u6620\u5c04\u5668\u4e2d\u627e\u5230\u7684 Handler\uff0c\u901a\u8fc7 HandlerAdapter \u53bb\u6267\u884c Handler\uff0c\u8fd9\u662f\u9002\u914d\u5668\u6a21\u5f0f\u7684\u5e94\u7528"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"View Resolver\uff1a\u89c6\u56fe\u89e3\u6790\u5668\uff0c \u5c06 Handler \u4e2d\u8fd4\u56de\u7684\u903b\u8f91\u89c6\u56fe\uff08ModelAndView\uff09\u89e3\u6790\u4e3a\u4e00\u4e2a\u5177\u4f53\u7684\u89c6\u56fe\uff08View\uff09\u5bf9\u8c61"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"View\uff1a\u89c6\u56fe\uff0c View \u6700\u540e\u5bf9\u9875\u9762\u8fdb\u884c\u6e32\u67d3\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u7528\u6237\uff0cSpringMVC \u6846\u67b6\u63d0\u4f9b\u4e86\u5f88\u591a\u7684 View \u89c6\u56fe\u7c7b\u578b\uff0c\u5305\u62ec\uff1ajstlView\u3001freemarkerView\u3001pdfView \u7b49"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(85819).A+"",width:"599",height:"247"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f18\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4e0e Spring \u96c6\u6210\uff0c\u66f4\u597d\u7684\u7ba1\u7406\u8d44\u6e90"}),"\n",(0,i.jsx)(e.li,{children:"\u6709\u5f88\u591a\u53c2\u6570\u89e3\u6790\u5668\u548c\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u4e30\u5bcc"}),"\n",(0,i.jsx)(e.li,{children:"\u5c06\u6620\u5c04\u5668\u3001\u5904\u7406\u5668\u3001\u89c6\u56fe\u89e3\u6790\u5668\u8fdb\u884c\u89e3\u8026\uff0c\u5206\u5de5\u660e\u786e"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5de5\u4f5c\u539f\u7406",children:"\u5de5\u4f5c\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 Spring \u5bb9\u5668\u521d\u59cb\u5316\u65f6\u4f1a\u5efa\u7acb\u6240\u6709\u7684 URL \u548c Controller \u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u4fdd\u5b58\u5230 Map<URL, Controller> \u4e2d\uff0c\u8fd9\u6837 request \u5c31\u80fd\u5feb\u901f\u6839\u636e URL \u5b9a\u4f4d\u5230 Controller\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728 Spring IOC \u5bb9\u5668\u521d\u59cb\u5316\u5b8c\u6240\u6709\u5355\u4f8b bean \u540e"}),"\n",(0,i.jsx)(e.li,{children:"SpringMVC \u4f1a\u904d\u5386\u6240\u6709\u7684 bean\uff0c\u83b7\u53d6 Controller \u4e2d\u5bf9\u5e94\u7684 URL\uff08\u8fd9\u91cc\u83b7\u53d6 URL \u7684\u5b9e\u73b0\u7c7b\u6709\u591a\u4e2a\uff0c\u7528\u4e8e\u5904\u7406\u4e0d\u540c\u5f62\u5f0f\u914d\u7f6e\u7684 Controller\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5c06\u6bcf\u4e00\u4e2a URL \u5bf9\u5e94\u4e00\u4e2a Controller \u5b58\u5165 Map<URL, Controller> \u4e2d"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5c06 @Controller \u6ce8\u89e3\u6362\u6210 @Component\uff0c\u542f\u52a8\u65f6\u4e0d\u4f1a\u62a5\u9519\uff0c\u4f46\u662f\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u8def\u5f84\u65f6\u4f1a\u51fa\u73b0 404\uff0c\u8bf4\u660e Spring \u6ca1\u6709\u5bf9\u6240\u6709\u7684 bean \u8fdb\u884c URL \u6620\u5c04"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4e00\u4e2a Request \u6765\u4e86\uff1a"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u76d1\u542c\u7aef\u53e3\uff0c\u83b7\u5f97\u8bf7\u6c42\uff1aTomcat \u76d1\u542c 8080 \u7aef\u53e3\u7684\u8bf7\u6c42\u5904\u7406\uff0c\u6839\u636e\u8def\u5f84\u8c03\u7528\u4e86 web.xml \u4e2d\u914d\u7f6e\u7684\u6838\u5fc3\u63a7\u5236\u5668 DispatcherServlet\uff0c",(0,i.jsx)(e.code,{children:"DispatcherServlet#doDispatch"})," \u662f",(0,i.jsx)(e.strong,{children:"\u6838\u5fc3\u8c03\u5ea6\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9996\u5148\u6839\u636e URI \u83b7\u53d6 HandlerMapping \u5904\u7406\u5668\u6620\u5c04\u5668"}),"\uff0cRequestMappingHandlerMapping \u7528\u6765\u5904\u7406 @RequestMapping \u6ce8\u89e3\u7684\u6620\u5c04\u89c4\u5219\uff0c\u5176\u4e2d\u4fdd\u5b58\u4e86\u6240\u6709 handler \u7684\u6620\u5c04\u89c4\u5219\uff0c\u6700\u540e\u5305\u88c5\u6210\u4e00\u4e2a\u62e6\u622a\u5668\u94fe\u8fd4\u56de\uff0c\u62e6\u622a\u5668\u94fe\u5bf9\u8c61\u6301\u6709 HandlerMapping\u3002\u5982\u679c\u6ca1\u6709\u5408\u9002\u7684\u5904\u7406\u8bf7\u6c42\u7684 HandlerMapping\uff0c\u8bf4\u660e\u8bf7\u6c42\u5904\u7406\u5931\u8d25\uff0c\u8bbe\u7f6e\u54cd\u5e94\u7801 404 \u8fd4\u56de"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6839\u636e\u6620\u5c04\u5668\u83b7\u53d6\u5f53\u524d handler\uff0c",(0,i.jsx)(e.strong,{children:"\u5904\u7406\u5668\u9002\u914d\u5668\u6267\u884c\u5904\u7406\u65b9\u6cd5"}),"\uff0c\u9002\u914d\u5668\u6839\u636e\u8bf7\u6c42\u7684 URL \u53bb handler \u4e2d\u5bfb\u627e\u5bf9\u5e94\u7684\u5904\u7406\u65b9\u6cd5\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u521b\u5efa ModelAndViewContainer (mav) \u5bf9\u8c61\uff0c\u7528\u6765\u586b\u5145\u6570\u636e\uff0c\u7136\u540e\u901a\u8fc7\u4e0d\u540c\u7684",(0,i.jsx)(e.strong,{children:"\u53c2\u6570\u89e3\u6790\u5668"}),"\u53bb\u89e3\u6790 URL \u4e2d\u7684\u53c2\u6570\uff0c\u5b8c\u6210\u6570\u636e\u89e3\u6790\u7ed1\u5b9a\uff0c\u7136\u540e\u6267\u884c\u771f\u6b63\u7684 Controller \u65b9\u6cd5\uff0c\u5b8c\u6210 handle \u5904\u7406"]}),"\n",(0,i.jsxs)(e.li,{children:["\u65b9\u6cd5\u6267\u884c\u5b8c\u5bf9",(0,i.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\u8fdb\u884c\u5904\u7406\uff0c\u6ca1\u6dfb\u52a0 @ResponseBody \u6ce8\u89e3\u7684\u8fd4\u56de\u503c\u4f7f\u7528\u89c6\u56fe\u5904\u7406\u5668\u5904\u7406\uff0c\u628a\u89c6\u56fe\u540d\u79f0\u8bbe\u7f6e\u8fdb\u5165 mav \u4e2d"]}),"\n",(0,i.jsx)(e.li,{children:"\u5bf9\u6dfb\u52a0\u4e86 @ResponseBody \u6ce8\u89e3\u7684 Controller \u7684\u6309\u7167\u666e\u901a\u7684\u8fd4\u56de\u503c\u8fdb\u884c\u5904\u7406\uff0c\u9996\u5148\u8fdb\u884c\u5185\u5bb9\u534f\u5546\uff0c\u627e\u5230\u4e00\u79cd\u6d4f\u89c8\u5668\u53ef\u4ee5\u63a5\u53d7\uff08\u8bf7\u6c42\u5934 Accept\uff09\u7684\u5e76\u4e14\u670d\u52a1\u5668\u53ef\u4ee5\u751f\u6210\u7684\u6570\u636e\u7c7b\u578b\uff0c\u9009\u62e9\u5408\u9002\u6570\u636e\u8f6c\u6362\u5668\uff0c\u8bbe\u7f6e\u54cd\u5e94\u5934\u4e2d\u7684\u6570\u636e\u7c7b\u578b\uff0c\u7136\u540e\u5199\u51fa\u6570\u636e"}),"\n",(0,i.jsxs)(e.li,{children:["\u6700\u540e\u628a ModelAndViewContainer \u548c ModelMap \u4e2d\u7684\u6570\u636e",(0,i.jsx)(e.strong,{children:"\u5c01\u88c5\u5230 ModelAndView \u5bf9\u8c61"}),"\u8fd4\u56de"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u89c6\u56fe\u89e3\u6790"}),"\uff0c\u6839\u636e\u8fd4\u56de\u503c\u521b\u5efa\u89c6\u56fe\uff0c\u8bf7\u6c42\u8f6c\u53d1 View \u5b9e\u4f8b\u4e3a InternalResourceView\uff0c\u91cd\u5b9a\u5411 View \u5b9e\u4f8b\u4e3a RedirectView\u3002\u6700\u540e\u8c03\u7528 view.render \u8fdb\u884c\u9875\u9762\u6e32\u67d3\uff0c\u7ed3\u679c\u6d3e\u53d1\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8bf7\u6c42\u8f6c\u53d1\u65f6\u8bf7\u6c42\u57df\u4e2d\u7684\u6570\u636e\u4e0d\u4e22\u5931\uff0c\u4f1a\u628a ModelAndView \u7684\u6570\u636e\u8bbe\u7f6e\u5230\u8bf7\u6c42\u57df\u4e2d\uff0c\u83b7\u53d6 Servlet \u539f\u751f\u7684 RequestDispatcher\uff0c\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"RequestDispatcher#forward"})," \u5b9e\u73b0\u8f6c\u53d1"]}),"\n",(0,i.jsxs)(e.li,{children:["\u91cd\u5b9a\u5411\u4f1a\u9020\u6210\u8bf7\u6c42\u57df\u4e2d\u7684\u6570\u636e\u4e22\u5931\uff0c\u4f7f\u7528 Servlet \u539f\u751f\u65b9\u5f0f\u5b9e\u73b0\u91cd\u5b9a\u5411 ",(0,i.jsx)(e.code,{children:"HttpServletResponse#sendRedirect"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u8c03\u5ea6\u51fd\u6570",children:"\u8c03\u5ea6\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u8bf7\u6c42\u8fdb\u5165\u539f\u751f\u7684 HttpServlet \u7684 doGet() \u65b9\u6cd5\u5904\u7406\uff0c\u8c03\u7528\u5b50\u7c7b FrameworkServlet \u7684 doGet() \u65b9\u6cd5\uff0c\u6700\u7ec8\u8c03\u7528 DispatcherServlet \u7684 doService() \u65b9\u6cd5\uff0c\u4e3a\u8bf7\u6c42\u8bbe\u7f6e\u76f8\u5173\u5c5e\u6027\u540e\u8c03\u7528 doDispatch()\uff0c\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u4ee5\u53c2\u6570\u7684\u5f62\u5f0f\u4f20\u5165"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(2646).A+"",width:"746",height:"144"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// request \u548c response \u4e3a Java \u539f\u751f\u7684\u7c7b\nprotected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception {\n    HttpServletRequest processedRequest = request;\n    HandlerExecutionChain mappedHandler = null;\n    // \u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\n    boolean multipartRequestParsed = false;\n    // \u5f02\u6b65\u7ba1\u7406\u5668\n    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);\n\n    try {\n        ModelAndView mv = null;\n        Exception dispatchException = null;\n\n        try {\n            // \u6587\u4ef6\u4e0a\u4f20\u76f8\u5173\u8bf7\u6c42\n            processedRequest = checkMultipart(request);\n            multipartRequestParsed = (processedRequest != request);\n\n            // \u627e\u5230\u5f53\u524d\u8bf7\u6c42\u4f7f\u7528\u54ea\u4e2a HandlerMapping \uff08Controller \u7684\u65b9\u6cd5\uff09\u5904\u7406\uff0c\u8fd4\u56de\u6267\u884c\u94fe\n            mappedHandler = getHandler(processedRequest);\n            // \u6ca1\u6709\u5408\u9002\u7684\u5904\u7406\u8bf7\u6c42\u7684\u65b9\u5f0f HandlerMapping\uff0c\u8bf7\u6c42\u5931\u8d25\uff0c\u76f4\u63a5\u8fd4\u56de 404\n            if (mappedHandler == null) {\n                noHandlerFound(processedRequest, response);\n                return;\n            }\n\n            // \u6839\u636e\u6620\u5c04\u5668\u83b7\u53d6\u5f53\u524d handler \u5904\u7406\u5668\u9002\u914d\u5668\uff0c\u7528\u6765\u3010\u5904\u7406\u5f53\u524d\u7684\u8bf7\u6c42\u3011\n            HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());\n            // \u83b7\u53d6\u53d1\u51fa\u6b64\u6b21\u8bf7\u6c42\u7684\u65b9\u5f0f\n            String method = request.getMethod();\n            // \u5224\u65ad\u8bf7\u6c42\u662f\u4e0d\u662f GET \u65b9\u6cd5\n            boolean isGet = HttpMethod.GET.matches(method);\n            if (isGet || HttpMethod.HEAD.matches(method)) {\n                long lastModified = ha.getLastModified(request, mappedHandler.getHandler());\n                if (new ServletWebRequest(request, response).checkNotModified(lastModified) && isGet) {\n                    return;\n                }\n            }\n\t\t\t// \u62e6\u622a\u5668\u94fe\u7684\u524d\u7f6e\u5904\u7406\n            if (!mappedHandler.applyPreHandle(processedRequest, response)) {\n                return;\n            }\n            // \u6267\u884c\u5904\u7406\u65b9\u6cd5\uff0c\u8fd4\u56de\u7684\u662f ModelAndView \u5bf9\u8c61\uff0c\u5c01\u88c5\u4e86\u6240\u6709\u7684\u8fd4\u56de\u503c\u6570\u636e\n            mv = ha.handle(processedRequest, response, mappedHandler.getHandler());\n\n            if (asyncManager.isConcurrentHandlingStarted()) {\n                return;\n            }\n\t\t\t// \u8bbe\u7f6e\u89c6\u56fe\u540d\u5b57\n            applyDefaultViewName(processedRequest, mv);\n            // \u6267\u884c\u62e6\u622a\u5668\u94fe\u4e2d\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5\n            mappedHandler.applyPostHandle(processedRequest, response, mv);\n        } catch (Exception ex) {\n            dispatchException = ex;\n        }\n        \n        // \u5904\u7406\u7a0b\u5e8f\u8c03\u7528\u7684\u7ed3\u679c\uff0c\u8fdb\u884c\u7ed3\u679c\u6d3e\u53d1\n        processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);\n    }\n    //....\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u7b14\u8bb0\u53c2\u8003\u89c6\u9891\uff1a",(0,i.jsx)(e.a,{href:"https://www.bilibili.com/video/BV19K4y1L7MT",children:"https://www.bilibili.com/video/BV19K4y1L7MT"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u8bf7\u6c42\u6620\u5c04-1",children:"\u8bf7\u6c42\u6620\u5c04"}),"\n",(0,i.jsx)(e.h4,{id:"\u6620\u5c04\u5668",children:"\u6620\u5c04\u5668"}),"\n",(0,i.jsx)(e.p,{children:"doDispatch() \u4e2d\u8c03\u7528 getHandler \u65b9\u6cd5\u83b7\u53d6\u6240\u6709\u7684\u6620\u5c04\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u603b\u4f53\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6240\u6709\u7684\u8bf7\u6c42\u6620\u5c04\u90fd\u5728 HandlerMapping \u4e2d\uff0c",(0,i.jsx)(e.strong,{children:"RequestMappingHandlerMapping \u5904\u7406 @RequestMapping \u6ce8\u89e3\u7684\u6620\u5c04\u89c4\u5219"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u904d\u5386\u6240\u6709\u7684 HandlerMapping \u770b\u662f\u5426\u53ef\u4ee5\u5339\u914d\u5f53\u524d\u8bf7\u6c42\uff0c\u5339\u914d\u6210\u529f\u540e\u8fd4\u56de\uff0c\u5339\u914d\u5931\u8d25\u8bbe\u7f6e HTTP 404 \u54cd\u5e94\u7801"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7528\u6237\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7684\u6620\u5c04\u5904\u7406\uff0c\u4e5f\u53ef\u4ee5\u7ed9\u5bb9\u5668\u4e2d\u653e\u5165\u81ea\u5b9a\u4e49 HandlerMapping"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.a,{href:"http://localhost:8080/user",children:"http://localhost:8080/user"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/user")\npublic String getUser(){\n    return "GET";\n}\n@PostMapping("/user")\npublic String postUser(){\n    return "POST";\n}\n//\u3002\u3002\u3002\u3002\u3002\n'})}),"\n",(0,i.jsxs)(e.p,{children:["HandlerMapping \u5904\u7406\u5668\u6620\u5c04\u5668\uff0c",(0,i.jsxs)(e.strong,{children:["\u4fdd\u5b58\u4e86\u6240\u6709 ",(0,i.jsx)(e.code,{children:"@RequestMapping"}),"  \u548c ",(0,i.jsx)(e.code,{children:"handler"})," \u7684\u6620\u5c04\u89c4\u5219"]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception {\n    if (this.handlerMappings != null) {\n        // \u904d\u5386\u6240\u6709\u7684 HandlerMapping\n        for (HandlerMapping mapping : this.handlerMappings) {\n            // \u5c1d\u8bd5\u53bb\u6bcf\u4e2a HandlerMapping \u4e2d\u5339\u914d\u5f53\u524d\u8bf7\u6c42\u7684\u5904\u7406\n            HandlerExecutionChain handler = mapping.getHandler(request);\n            if (handler != null) {\n                return handler;\n            }\n        }\n    }\n    return null;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(60139).A+"",width:"1433",height:"367"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mapping.getHandler(request)"}),"\uff1a\u8c03\u7528 AbstractHandlerMapping#getHandler"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object handler = getHandlerInternal(request)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u6620\u5c04\u5668"}),"\uff0c\u5e95\u5c42\u8c03\u7528 RequestMappingInfoHandlerMapping \u7c7b\u7684\u65b9\u6cd5\uff0c\u53c8\u8c03\u7528 AbstractHandlerMethodMapping#getHandlerInternal"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"String lookupPath = initLookupPath(request)"}),"\uff1a\u5730\u5740\u680f\u7684 URI\uff0c\u8fd9\u91cc\u7684 lookupPath \u4e3a /user"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.mappingRegistry.acquireReadLock()"}),"\uff1a\u52a0\u8bfb\u9501\u9632\u6b62\u5176\u4ed6\u7ebf\u7a0b\u5e76\u53d1\u4fee\u6539"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"handlerMethod = lookupHandlerMethod(lookupPath, request)"}),"\uff1a\u83b7\u53d6\u5f53\u524d HandlerMapping \u4e2d\u7684\u6620\u5c04\u89c4\u5219"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"directPathMatches = this.mappingRegistry.getMappingsByDirectPath(lookupPath)"}),"\uff1a\u83b7\u53d6\u5f53\u524d\u7684\u6620\u5c04\u5668\u4e0e\u5f53\u524d",(0,i.jsx)(e.strong,{children:"\u8bf7\u6c42\u7684 URI \u6709\u5173\u7684\u6240\u6709\u6620\u5c04\u89c4\u5219"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(33331).A+"",width:"1542",height:"381"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"addMatchingMappings(directPathMatches, matches, request)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5339\u914d\u67d0\u4e2a\u6620\u5c04\u89c4\u5219"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"for (T mapping : mappings)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u6620\u5c04\u89c4\u5219"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"match = getMatchingMapping(mapping, request)"}),"\uff1a\u53bb\u5339\u914d\u6bcf\u4e00\u4e2a\u6620\u5c04\u89c4\u5219\uff0c\u5339\u914d\u5931\u8d25\u8fd4\u56de null"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"matches.add(new Match())"}),"\uff1a\u5339\u914d\u6210\u529f\u540e\u5c01\u88c5\u6210\u5339\u914d\u5668\u6dfb\u52a0\u5230\u5339\u914d\u96c6\u5408\u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"matches.sort(comparator)"}),"\uff1a\u5339\u914d\u96c6\u5408\u6392\u5e8f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Match bestMatch = matches.get(0)"}),"\uff1a\u5339\u914d\u5b8c\u6210\u53ea\u5269\u4e00\u4e2a\uff0c\u76f4\u63a5\u83b7\u53d6\u8fd4\u56de\u5bf9\u5e94\u7684\u5904\u7406\u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (matches.size() > 1)"}),"\uff1a\u5f53\u6709\u591a\u4e2a\u6620\u5c04\u89c4\u5219\u7b26\u5408\u8bf7\u6c42\u65f6\uff0c\u62a5\u9519"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return bestMatch.getHandlerMethod()"}),"\uff1a\u8fd4\u56de\u5339\u914d\u5668\u4e2d\u7684\u5904\u7406\u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"executionChain = getHandlerExecutionChain(handler, request)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4e3a\u5f53\u524d\u8bf7\u6c42\u548c\u6620\u5c04\u5668\u7684\u6784\u5efa\u4e00\u4e2a\u62e6\u622a\u5668\u94fe"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"for (HandlerInterceptor interceptor : this.adaptedInterceptors)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u62e6\u622a\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"chain.addInterceptor(interceptor)"}),"\uff1a\u628a\u6240\u6709\u7684\u62e6\u622a\u5668\u6dfb\u52a0\u5230 HandlerExecutionChain \u4e2d\uff0c\u5f62\u6210\u62e6\u622a\u5668\u94fe"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return executionChain"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8fd4\u56de\u62e6\u622a\u5668\u94fe\uff0cHandlerMapping \u662f\u94fe\u7684 handler \u6210\u5458\u5c5e\u6027"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u9002\u914d\u5668",children:"\u9002\u914d\u5668"}),"\n",(0,i.jsxs)(e.p,{children:["doDispatch() \u4e2d\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler())"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected HandlerAdapter getHandlerAdapter(Object handler) throws ServletException {\n    if (this.handlerAdapters != null) {\n        // \u904d\u5386\u6240\u6709\u7684 HandlerAdapter\n        for (HandlerAdapter adapter : this.handlerAdapters) {\n            // \u5224\u65ad\u5f53\u524d\u9002\u914d\u5668\u662f\u5426\u652f\u6301\u5f53\u524d handle\n            if (adapter.supports(handler)) {\n                // \u8fd4\u56de\u7684\u662f \u3010RequestMappingHandlerAdapter\u3011\n                // AbstractHandlerMethodAdapter#supports -> RequestMappingHandlerAdapter\n                return adapter;\n            }\n        }\n    }\n    throw new ServletException();\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u65b9\u6cd5\u6267\u884c",children:"\u65b9\u6cd5\u6267\u884c"}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u4f8b\u4ee3\u7801\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/params")\npublic String param(Map<String, Object> map, Model model, HttpServletRequest request) {\n    map.put("k1", "v1");\t\t\t// \u90fd\u53ef\u4ee5\u5411\u8bf7\u6c42\u57df\u4e2d\u6dfb\u52a0\u6570\u636e\n    model.addAttribute("k2", "v2");\t// \u5b83\u4eec\u4e24\u4e2a\u90fd\u5728\u6570\u636e\u5c01\u88c5\u5728 \u3010BindingAwareModelMap\u3011\uff0c\u7ee7\u627f\u81ea LinkedHashMap\n    request.setAttribute("m", "HelloWorld");\n    return "forward:/success";\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(77010).A+"",width:"1514",height:"306"})}),"\n",(0,i.jsxs)(e.p,{children:["doDispatch() \u4e2d\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"mv = ha.handle(processedRequest, response, mappedHandler.getHandler())"})," ",(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u9002\u914d\u5668\u6267\u884c\u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AbstractHandlerMethodAdapter#handle"})," \u2192 ",(0,i.jsx)(e.code,{children:"RequestMappingHandlerAdapter#handleInternal"})," \u2192 ",(0,i.jsx)(e.code,{children:"invokeHandlerMethod"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected ModelAndView invokeHandlerMethod(HttpServletRequest request,\n                                           HttpServletResponse response, \n                                           HandlerMethod handlerMethod) throws Exception {\n\t// \u5c01\u88c5\u6210 SpringMVC \u7684\u63a5\u53e3\uff0c\u7528\u4e8e\u901a\u7528 Web \u8bf7\u6c42\u62e6\u622a\u5668\uff0c\u4f7f\u80fd\u591f\u8bbf\u95ee\u901a\u7528\u8bf7\u6c42\u5143\u6570\u636e\uff0c\u800c\u4e0d\u662f\u7528\u4e8e\u5b9e\u9645\u5904\u7406\u8bf7\u6c42\n    ServletWebRequest webRequest = new ServletWebRequest(request, response);\n    try {\n        // WebDataBinder \u7528\u4e8e\u3010\u4ece Web \u8bf7\u6c42\u53c2\u6570\u5230 JavaBean \u5bf9\u8c61\u7684\u6570\u636e\u7ed1\u5b9a\u3011\uff0c\u83b7\u53d6\u521b\u5efa\u8be5\u5b9e\u4f8b\u7684\u5de5\u5382\n        WebDataBinderFactory binderFactory = getDataBinderFactory(handlerMethod);\n        // \u521b\u5efa Model \u5b9e\u4f8b\uff0c\u7528\u4e8e\u5411\u6a21\u578b\u6dfb\u52a0\u5c5e\u6027\n        ModelFactory modelFactory = getModelFactory(handlerMethod, binderFactory);\n\t\t// \u65b9\u6cd5\u6267\u884c\u5668\n        ServletInvocableHandlerMethod invocableMethod = createInvocableHandlerMethod(handlerMethod);\n        \n        // \u53c2\u6570\u89e3\u6790\u5668\uff0c\u6709\u5f88\u591a\n        if (this.argumentResolvers != null) {\n            invocableMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);\n        }\n        // \u8fd4\u56de\u503c\u5904\u7406\u5668\uff0c\u4e5f\u6709\u5f88\u591a\n        if (this.returnValueHandlers != null) {\n            invocableMethod.setHandlerMethodReturnValueHandlers(this.returnValueHandlers);\n        }\n        // \u8bbe\u7f6e\u6570\u636e\u7ed1\u5b9a\u5668\n        invocableMethod.setDataBinderFactory(binderFactory);\n        // \u8bbe\u7f6e\u53c2\u6570\u68c0\u67e5\u5668\n\t\tinvocableMethod.setParameterNameDiscoverer(this.parameterNameDiscoverer);\n   \n        // \u65b0\u5efa\u4e00\u4e2a ModelAndViewContainer \u5e76\u8fdb\u884c\u521d\u59cb\u5316\u548c\u4e00\u4e9b\u5c5e\u6027\u7684\u586b\u5145\n        ModelAndViewContainer mavContainer = new ModelAndViewContainer();\n            \n        // \u8bbe\u7f6e\u4e00\u4e9b\u5c5e\u6027\n        \n        // \u3010\u6267\u884c\u76ee\u6807\u65b9\u6cd5\u3011\n        invocableMethod.invokeAndHandle(webRequest, mavContainer);\n        // \u5f02\u6b65\u8bf7\u6c42\n        if (asyncManager.isConcurrentHandlingStarted()) {\n            return null;\n        }\n\t\t// \u3010\u83b7\u53d6 ModelAndView \u5bf9\u8c61\uff0c\u5c01\u88c5\u4e86 ModelAndViewContainer\u3011\n        return getModelAndView(mavContainer, modelFactory, webRequest);\n    }\n    finally {\n        webRequest.requestCompleted();\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"ServletInvocableHandlerMethod#invokeAndHandle\uff1a\u6267\u884c\u76ee\u6807\u65b9\u6cd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"returnValue = invokeForRequest(webRequest, mavContainer, providedArgs)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6267\u884c\u81ea\u5df1\u5199\u7684 controller \u65b9\u6cd5\uff0c\u8fd4\u56de\u7684\u5c31\u662f\u81ea\u5b9a\u4e49\u65b9\u6cd5\u4e2d return \u7684\u503c"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object[] args = getMethodArgumentValues(request, mavContainer, providedArgs)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u53c2\u6570\u5904\u7406\u7684\u903b\u8f91"}),"\uff0c\u904d\u5386\u6240\u6709\u7684\u53c2\u6570\u89e3\u6790\u5668\u89e3\u6790\u53c2\u6570\u6216\u8005\u5c06 URI \u4e2d\u7684\u53c2\u6570\u8fdb\u884c\u7ed1\u5b9a\uff0c\u7ed1\u5b9a\u5b8c\u6210\u540e\u5f00\u59cb\u6267\u884c\u76ee\u6807\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"parameters = getMethodParameters()"}),"\uff1a\u83b7\u53d6\u6b64\u5904\u7406\u7a0b\u5e8f\u65b9\u6cd5\u7684\u65b9\u6cd5\u53c2\u6570\u7684\u8be6\u7ec6\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object[] args = new Object[parameters.length]"}),"\uff1a\u5b58\u653e\u6240\u6709\u7684\u53c2\u6570"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (int i = 0; i < parameters.length; i++)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u53c2\u6570"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"args[i] = findProvidedArgument(parameter, providedArgs)"}),"\uff1a\u83b7\u53d6\u8c03\u7528\u65b9\u6cd5\u65f6\u63d0\u4f9b\u7684\u53c2\u6570\uff0c\u4e00\u822c\u662f\u7a7a"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!this.resolvers.supportsParameter(parameter))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u53ef\u4ee5\u89e3\u6790\u5f53\u524d\u53c2\u6570\u7684\u53c2\u6570\u89e3\u6790\u5668"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return getArgumentResolver(parameter) != null"}),"\uff1a\u83b7\u53d6\u53c2\u6570\u7684\u89e3\u6790\u662f\u5426\u4e3a\u7a7a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (HandlerMethodArgumentResolver resolver : this.argumentResolvers)"}),"\uff1a\u904d\u5386\u5bb9\u5668\u5185\u6240\u6709\u7684\u89e3\u6790\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (resolver.supportsParameter(parameter))"}),"\uff1a\u662f\u5426\u652f\u6301\u5f53\u524d\u53c2\u6570"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PathVariableMethodArgumentResolver#supportsParameter"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u89e3\u6790\u6807\u6ce8 @PathVariable \u6ce8\u89e3\u7684\u53c2\u6570"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ModelMethodProcessor#supportsParameter"}),"\uff1a\u89e3\u6790 Map \u548c Model \u7c7b\u578b\u7684\u53c2\u6570\uff0cModel \u548c Map \u7684\u4f5c\u7528\u4e00\u6837"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ExpressionValueMethodArgumentResolver#supportsParameter"}),"\uff1a\u89e3\u6790\u6807\u6ce8 @Value \u6ce8\u89e3\u7684\u53c2\u6570"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RequestParamMapMethodArgumentResolver#supportsParameter"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u89e3\u6790\u6807\u6ce8 @RequestParam \u6ce8\u89e3"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RequestPartMethodArgumentResolver#supportsParameter"}),"\uff1a\u89e3\u6790\u6587\u4ef6\u4e0a\u4f20\u7684\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ModelAttributeMethodProcessor#supportsParameter"}),"\uff1a\u89e3\u6790\u6807\u6ce8 @ModelAttribute \u6ce8\u89e3\u6216\u8005\u4e0d\u662f\u7b80\u5355\u7c7b\u578b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5b50\u7c7b ServletModelAttributeMethodProcessor \u662f\u89e3\u6790\u81ea\u5b9a\u4e49\u7c7b\u578b JavaBean \u7684\u89e3\u6790\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u7b80\u5355\u7c7b\u578b\u6709 Void\u3001Enum\u3001Number\u3001CharSequence\u3001Date\u3001URI\u3001URL\u3001Locale\u3001Class"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"args[i] = this.resolvers.resolveArgument()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5f00\u59cb\u89e3\u6790\u53c2\u6570\uff0c\u6bcf\u4e2a\u53c2\u6570\u4f7f\u7528\u7684\u89e3\u6790\u5668\u4e0d\u540c"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resolver = getArgumentResolver(parameter)"}),"\uff1a\u83b7\u53d6\u53c2\u6570\u89e3\u6790\u5668"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return resolver.resolveArgument()"}),"\uff1a\u5f00\u59cb\u89e3\u6790"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PathVariableMapMethodArgumentResolver#resolveArgument"}),"\uff1a@PathVariable\uff0c\u5305\u88c5 URI \u4e2d\u7684\u53c2\u6570\u4e3a Map"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MapMethodProcessor#resolveArgument"}),"\uff1a\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"mavContainer.getModel()"})," \u8fd4\u56de\u9ed8\u8ba4 BindingAwareModelMap \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ModelAttributeMethodProcessor#resolveArgument"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u81ea\u5b9a\u4e49\u7684 JavaBean \u7684\u7ed1\u5b9a\u5c01\u88c5"}),"\uff0c\u4e0b\u4e00\u5c0f\u8282\u8be6\u89e3"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return doInvoke(args)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u771f\u6b63\u7684\u6267\u884c Controller \u65b9\u6cd5"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Method method = getBridgedMethod()"}),"\uff1a\u4ece HandlerMethod \u83b7\u53d6\u8981\u53cd\u5c04\u6267\u884c\u7684\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ReflectionUtils.makeAccessible(method)"}),"\uff1a\u7834\u89e3\u6743\u9650"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"method.invoke(getBean(), args)"}),"\uff1a\u6267\u884c\u65b9\u6cd5\uff0cgetBean \u83b7\u53d6\u7684\u662f\u6807\u8bb0 @Controller \u7684 Bean \u7c7b\uff0c\u5176\u4e2d\u5305\u542b\u6267\u884c\u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u8fdb\u884c\u8fd4\u56de\u503c\u7684\u5904\u7406\uff0c\u54cd\u5e94\u90e8\u5206\u8be6\u89e3"}),"\uff0c\u5904\u7406\u5b8c\u6210\u8fdb\u5165\u4e0b\u9762\u7684\u903b\u8f91"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"RequestMappingHandlerAdapter#getModelAndView\uff1a\u83b7\u53d6 ModelAndView \u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"modelFactory.updateModel(webRequest, mavContainer)"}),"\uff1aModel \u6570\u636e\u5347\u7ea7\u5230\u4f1a\u8bdd\u57df\uff08",(0,i.jsx)(e.strong,{children:"\u8bf7\u6c42\u57df\u4e2d\u7684\u6570\u636e\u5728\u91cd\u5b9a\u5411\u65f6\u4e22\u5931"}),"\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"updateBindingResult(request, defaultModel)"}),"\uff1a\u628a\u7ed1\u5b9a\u7684\u6570\u636e\u6dfb\u52a0\u5230 BindingAwareModelMap \u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (mavContainer.isRequestHandled())"}),"\uff1a\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u5df2\u7ecf\u5904\u7406\u5b8c\u6210\u4e86"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ModelMap model = mavContainer.getModel()"}),"\uff1a\u83b7\u53d6",(0,i.jsx)(e.strong,{children:"\u5305\u542b Controller \u65b9\u6cd5\u53c2\u6570"}),"\u7684 BindingAwareModelMap\uff08\u672c\u8282\u5f00\u5934\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mav = new ModelAndView()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u628a ModelAndViewContainer \u548c ModelMap \u4e2d\u7684\u6570\u636e\u5c01\u88c5\u5230 ModelAndView"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!mavContainer.isViewReference())"}),"\uff1a\u662f\u5426\u662f\u901a\u8fc7\u540d\u79f0\u6307\u5b9a\u89c6\u56fe\u5f15\u7528"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (model instanceof RedirectAttributes)"}),"\uff1a\u5224\u65ad model \u662f\u5426\u662f\u91cd\u5b9a\u5411\u6570\u636e\uff0c\u5982\u679c\u662f\u8fdb\u884c\u91cd\u5b9a\u5411\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return mav"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4efb\u4f55\u65b9\u6cd5\u6267\u884c\u90fd\u4f1a\u8fd4\u56de ModelAndView \u5bf9\u8c61"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u53c2\u6570\u89e3\u6790",children:"\u53c2\u6570\u89e3\u6790"}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u6790\u81ea\u5b9a\u4e49\u7684 JavaBean \u4e3a\u4f8b\uff0c\u8c03\u7528 ModelAttributeMethodProcessor#resolveArgument \u5904\u7406\u53c2\u6570\u7684\u65b9\u6cd5\uff0c\u901a\u8fc7\u5408\u9002\u7684\u7c7b\u578b\u8f6c\u6362\u5668\u628a URL \u4e2d\u7684\u53c2\u6570\u8f6c\u6362\u4ee5\u540e\uff0c\u5229\u7528\u53cd\u5c04\u83b7\u53d6 set \u65b9\u6cd5\uff0c\u6ce8\u5165\u5230 JavaBean"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Person.java\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Data\n@Component\t//\u52a0\u5165\u5230\u5bb9\u5668\u4e2d\npublic class Person {\n    private String userName;\n    private Integer age;\n    private Date birth;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\t//\u8fd4\u56de\u7684\u6570\u636e\u4e0d\u662f\u9875\u9762\npublic class ParameterController {\n    // \u6570\u636e\u7ed1\u5b9a\uff1a\u9875\u9762\u63d0\u4ea4\u7684\u8bf7\u6c42\u6570\u636e\uff08GET\u3001POST\uff09\u90fd\u53ef\u4ee5\u548c\u5bf9\u8c61\u5c5e\u6027\u8fdb\u884c\u7ed1\u5b9a\n    @GetMapping("/saveuser")\n    public Person saveuser(Person person){\n        return person;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.a,{href:"http://localhost:8080/saveuser?userName=zhangsan&age=20",children:"http://localhost:8080/saveuser?userName=zhangsan&age=20"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u5165\u6e90\u7801\uff1aModelAttributeMethodProcessor#resolveArgument"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"name = ModelFactory.getNameForParameter(parameter)"}),"\uff1a\u83b7\u53d6\u540d\u5b57\uff0c\u6b64\u4f8b\u5c31\u662f person"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ann = parameter.getParameterAnnotation(ModelAttribute.class)"}),"\uff1a\u662f\u5426\u6709 ModelAttribute \u6ce8\u89e3"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (mavContainer.containsAttribute(name))"}),"\uff1aModelAndViewContainer \u4e2d\u662f\u5426\u5305\u542b person \u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"attribute = createAttribute()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u7a7a\u7684 Person \u5bf9\u8c61"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"binder = binderFactory.createBinder(webRequest, attribute, name)"}),"\uff1aWeb \u6570\u636e\u7ed1\u5b9a\u5668\uff0c\u53ef\u4ee5\u5229\u7528 Converters \u5c06\u8bf7\u6c42\u6570\u636e\u8f6c\u6210\u6307\u5b9a\u7684\u6570\u636e\u7c7b\u578b\uff0c\u7ed1\u5b9a\u5230 JavaBean \u4e2d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bindRequestParameters(binder, webRequest)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5229\u7528\u53cd\u5c04\u5411\u76ee\u6807\u5bf9\u8c61\u586b\u5145\u6570\u636e"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"servletBinder = (ServletRequestDataBinder) binder"}),"\uff1a\u7c7b\u578b\u5f3a\u8f6c"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"servletBinder.bind(servletRequest)"}),"\uff1a\u7ed1\u5b9a\u6570\u636e"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mpvs = new MutablePropertyValues(request.getParameterMap())"}),"\uff1a\u83b7\u53d6\u8bf7\u6c42 URI \u53c2\u6570\u4e2d\u7684 k-v \u952e\u503c\u5bf9"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"addBindValues(mpvs, request)"}),"\uff1a\u5b50\u7c7b\u53ef\u4ee5\u7528\u6765\u4e3a\u8bf7\u6c42\u6dfb\u52a0\u989d\u5916\u7ed1\u5b9a\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"doBind(mpvs)"}),"\uff1a\u771f\u6b63\u7684\u7ed1\u5b9a\u7684\u65b9\u6cd5\uff0c\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"applyPropertyValues"})," \u5e94\u7528\u53c2\u6570\u503c\uff0c\u7136\u540e\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"setPropertyValues"})," \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AbstractPropertyAccessor#setPropertyValues()"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"List<PropertyValue> propertyValues"}),"\uff1a\u83b7\u53d6\u5230\u6240\u6709\u7684\u53c2\u6570\u7684\u503c\uff0c\u5c31\u662f URI \u4e0a\u7684\u6240\u6709\u7684\u53c2\u6570\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (PropertyValue pv : propertyValues)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u53c2\u6570\u503c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"setPropertyValue(pv)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u586b\u5145\u5230\u7a7a\u7684 Person \u5b9e\u4f8b\u4e2d"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"nestedPa = getPropertyAccessorForPropertyPath(propertyName)"}),"\uff1a\u83b7\u53d6\u5c5e\u6027\u8bbf\u95ee\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"tokens = getPropertyNameTokens()"}),"\uff1a\u83b7\u53d6\u5143\u6570\u636e\u7684\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"nestedPa.setPropertyValue(tokens, pv)"}),"\uff1a\u586b\u5145\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"processLocalProperty(tokens, pv)"}),"\uff1a\u5904\u7406\u5c5e\u6027"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (!Boolean.FALSE.equals(pv.conversionNecessary))"}),"\uff1a\u6570\u636e\u662f\u5426\u9700\u8981\u8f6c\u6362\u4e86"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (pv.isConverted())"}),"\uff1a\u6570\u636e\u5df2\u7ecf\u8f6c\u6362\u8fc7\u4e86\uff0c\u8f6c\u6362\u4e86\u76f4\u63a5\u8d4b\u503c\uff0c\u6ca1\u8f6c\u6362\u8fdb\u884c\u8f6c\u6362"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"oldValue = ph.getValue()"}),"\uff1a\u83b7\u53d6\u672a\u8f6c\u6362\u7684\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"valueToApply = convertForProperty()"}),"\uff1a\u8fdb\u884c\u6570\u636e\u8f6c\u6362"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"TypeConverterDelegate#convertIfNecessary"}),"\uff1a\u8fdb\u5165\u8be5\u65b9\u6cd5\u7684\u903b\u8f91"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (conversionService.canConvert(sourceTypeDesc, typeDescriptor))"}),"\uff1a\u5224\u65ad\u80fd\u4e0d\u80fd\u8f6c\u6362"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"GenericConverter converter = getConverter(sourceType, targetType)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u7c7b\u578b\u8f6c\u6362\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"converter = this.converters.find(sourceType, targetType)"}),"\uff1a\u5bfb\u627e\u5408\u9002\u7684\u8f6c\u6362\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"sourceCandidates = getClassHierarchy(sourceType.getType())"}),"\uff1a\u539f\u6570\u636e\u7c7b\u578b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"targetCandidates = getClassHierarchy(targetType.getType())"}),"\uff1a\u76ee\u6807\u6570\u636e\u7c7b\u578b"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"for (Class<?> sourceCandidate : sourceCandidates) {\n    //\u53cc\u91cd\u5faa\u73af\u904d\u5386\uff0c\u5bfb\u627e\u5408\u9002\u7684\u8f6c\u6362\u5668\n \tfor (Class<?> targetCandidate : targetCandidates) {\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"GenericConverter converter = getRegisteredConverter(..)"}),"\uff1a\u5339\u914d\u7c7b\u578b\u8f6c\u6362\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return converter"}),"\uff1a\u8fd4\u56de\u8f6c\u6362\u5668"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"conversionService.convert(newValue, sourceTypeDesc, typeDescriptor)"}),"\uff1a\u5f00\u59cb\u8f6c\u6362"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"converter = getConverter(sourceType, targetType)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u53ef\u7528\u7684\u8f6c\u6362\u5668"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"result = ConversionUtils.invokeConverter()"}),"\uff1a\u6267\u884c\u8f6c\u6362\u65b9\u6cd5\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"converter.convert()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8c03\u7528\u8f6c\u6362\u5668\u7684\u8f6c\u6362\u65b9\u6cd5"}),"\uff08GenericConverter#convert\uff09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return handleResult(sourceType, targetType, result)"}),"\uff1a\u8fd4\u56de\u7ed3\u679c"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ph.setValue(valueToApply)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8bbe\u7f6e JavaBean \u5c5e\u6027"}),"\uff08BeanWrapperImpl.BeanPropertyHandler\uff09"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Method writeMethod"}),"\uff1a\u83b7\u53d6\u5199\u6570\u636e\u65b9\u6cd5\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Class<?> cls = getClass0()"}),"\uff1a\u83b7\u53d6 Class \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"writeMethodName = Introspector.SET_PREFIX + getBaseName()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"set \u524d\u7f00 + \u5c5e\u6027\u540d"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"writeMethod = Introspector.findMethod(cls, writeMethodName, 1, args)"}),"\uff1a\u83b7\u53d6\u53ea\u5305\u542b\u4e00\u4e2a\u53c2\u6570\u7684 set \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"setWriteMethod(writeMethod)"}),"\uff1a\u52a0\u5165\u7f13\u5b58"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ReflectionUtils.makeAccessible(writeMethod)"}),"\uff1a\u8bbe\u7f6e\u8bbf\u95ee\u6743\u9650"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"writeMethod.invoke(getWrappedInstance(), value)"}),"\uff1a\u6267\u884c\u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bindingResult = binder.getBindingResult()"}),"\uff1a\u83b7\u53d6\u7ed1\u5b9a\u7684\u7ed3\u679c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mavContainer.addAllAttributes(bindingResultModel)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u628a\u6240\u6709\u586b\u5145\u7684\u53c2\u6570\u653e\u5165 ModelAndViewContainer"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return attribute"}),"\uff1a\u8fd4\u56de\u586b\u5145\u540e\u7684 Person \u5bf9\u8c61"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u54cd\u5e94\u5904\u7406-1",children:"\u54cd\u5e94\u5904\u7406"}),"\n",(0,i.jsx)(e.h4,{id:"\u54cd\u5e94\u6570\u636e",children:"\u54cd\u5e94\u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:"\u4ee5 Person \u4e3a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@ResponseBody  \t\t// \u5229\u7528\u8fd4\u56de\u503c\u5904\u7406\u5668\u91cc\u9762\u7684\u6d88\u606f\u8f6c\u6362\u5668\u8fdb\u884c\u5904\u7406\uff0c\u800c\u4e0d\u662f\u89c6\u56fe\n@GetMapping(value = "/person")\npublic Person getPerson(){\n    Person person = new Person();\n    person.setAge(28);\n    person.setBirth(new Date());\n    person.setUserName("zhangsan");\n    return person;\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u76f4\u63a5\u8fdb\u5165\u65b9\u6cd5\u6267\u884c\u5b8c\u540e\u7684\u903b\u8f91 ServletInvocableHandlerMethod#invokeAndHandle\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void invokeAndHandle(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,\n                            Object... providedArgs) throws Exception {\n\t// \u3010\u6267\u884c\u76ee\u6807\u65b9\u6cd5\u3011\uff0creturn person \u5bf9\u8c61\n    Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);\n    // \u8bbe\u7f6e\u72b6\u6001\u7801\n    setResponseStatus(webRequest);\n\n    // \u5224\u65ad\u65b9\u6cd5\u662f\u5426\u6709\u8fd4\u56de\u503c\n    if (returnValue == null) {\n        if (isRequestNotModified(webRequest) || getResponseStatus() != null || mavContainer.isRequestHandled()) {\n            disableContentCachingIfNecessary(webRequest);\n            mavContainer.setRequestHandled(true);\n            return;\n        }\n    }\t// \u8fd4\u56de\u503c\u662f\u5b57\u7b26\u4e32\n    else if (StringUtils.hasText(getResponseStatusReason())) {\n        // \u8bbe\u7f6e\u8bf7\u6c42\u5904\u7406\u5b8c\u6210\n        mavContainer.setRequestHandled(true);\n        return;\n\t// \u8bbe\u7f6e\u8bf7\u6c42\u6ca1\u6709\u5904\u7406\u5b8c\u6210\uff0c\u8fd8\u9700\u8981\u8fdb\u884c\u8fd4\u56de\u503c\u7684\u903b\u8f91\n    mavContainer.setRequestHandled(false);\n    Assert.state(this.returnValueHandlers != null, "No return value handlers");\n    try {\n        // \u3010\u8fd4\u56de\u503c\u7684\u5904\u7406\u3011\n        this.returnValueHandlers.handleReturnValue(\n            returnValue, getReturnValueType(returnValue), mavContainer, webRequest);\n    }\n    catch (Exception ex) {}\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6ca1\u6709\u52a0 @ResponseBody \u6ce8\u89e3\u7684\u8fd4\u56de\u6570\u636e\u6309\u7167\u89c6\u56fe\u5904\u7406\u7684\u903b\u8f91"}),"\uff0cViewNameMethodReturnValueHandler\uff08\u89c6\u56fe\u8be6\u89e3\uff09"]}),"\n",(0,i.jsx)(e.li,{children:"\u6b64\u4f8b\u662f\u52a0\u4e86\u6ce8\u89e3\u7684\uff0c\u8fd4\u56de\u7684\u6570\u636e\u4e0d\u662f\u89c6\u56fe\uff0cHandlerMethodReturnValueHandlerComposite#handleReturnValue\uff1a"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void handleReturnValue(@Nullable Object returnValue, MethodParameter returnType,\n                              ModelAndViewContainer mavContainer, NativeWebRequest webRequest)  {\n\t// \u83b7\u53d6\u5408\u9002\u7684\u8fd4\u56de\u503c\u5904\u7406\u5668\n    HandlerMethodReturnValueHandler handler = selectHandler(returnValue, returnType);\n    if (handler == null) {\n        throw new IllegalArgumentException();\n    }\n    // \u4f7f\u7528\u5904\u7406\u5668\u5904\u7406\u8fd4\u56de\u503c\uff08\u8be6\u89e3\u6e90\u7801\u4e2d\u7684\u8fd9\u4e24\u4e2a\u51fd\u6570\uff09\n    handler.handleReturnValue(returnValue, returnType, mavContainer, webRequest);\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"HandlerMethodReturnValueHandlerComposite#selectHandler\uff1a\u83b7\u53d6\u5408\u9002\u7684\u8fd4\u56de\u503c\u5904\u7406\u5668"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"boolean isAsyncValue = isAsyncReturnValue(value, returnType)"}),"\uff1a\u662f\u5426\u662f\u5f02\u6b65\u8bf7\u6c42"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (HandlerMethodReturnValueHandler handler : this.returnValueHandlers)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u8fd4\u56de\u503c\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RequestResponseBodyMethodProcessor#supportsReturnType"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5904\u7406\u6807\u6ce8 @ResponseBody \u6ce8\u89e3\u7684\u8fd4\u56de\u503c"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ModelAndViewMethodReturnValueHandler#supportsReturnType"}),"\uff1a\u5904\u7406\u8fd4\u56de\u503c\u7c7b\u578b\u662f ModelAndView \u7684\u5904\u7406\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ModelAndViewResolverMethodReturnValueHandler#supportsReturnType"}),"\uff1a\u76f4\u63a5\u8fd4\u56de true\uff0c\u5904\u7406\u6240\u6709\u6570\u636e"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["RequestResponseBodyMethodProcessor#handleReturnValue\uff1a\u5904\u7406\u8fd4\u56de\u503c\uff0c\u8981\u8fdb\u884c",(0,i.jsx)(e.strong,{children:"\u5185\u5bb9\u534f\u5546"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mavContainer.setRequestHandled(true)"}),"\uff1a\u8bbe\u7f6e\u8bf7\u6c42\u5904\u7406\u5b8c\u6210"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"inputMessage = createInputMessage(webRequest)"}),"\uff1a\u83b7\u53d6\u8f93\u5165\u7684\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"outputMessage = createOutputMessage(webRequest)"}),"\uff1a\u83b7\u53d6\u8f93\u51fa\u7684\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"writeWithMessageConverters(returnValue, returnType, inputMessage, outputMessage)"}),"\uff1a\u4f7f\u7528\u6d88\u606f\u8f6c\u6362\u5668\u8fdb\u884c\u5199\u51fa"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (value instanceof CharSequence)"}),"\uff1a\u5224\u65ad\u8fd4\u56de\u7684\u6570\u636e\u662f\u4e0d\u662f\u5b57\u7b26\u7c7b\u578b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"body = value"}),"\uff1a\u628a value \u8d4b\u503c\u7ed9 body\uff0c\u6b64\u65f6 body \u4e2d\u5c31\u662f\u81ea\u5b9a\u4e49\u65b9\u6cd5\u6267\u884c\u5b8c\u540e\u7684 Person \u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (isResourceType(value, returnType))"}),"\uff1a\u5f53\u524d\u6570\u636e\u662f\u4e0d\u662f\u6d41\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"MediaType selectedMediaType"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5185\u5bb9\u534f\u5546\u540e\u9009\u62e9\u4f7f\u7528\u7684\u7c7b\u578b\uff0c\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u90fd\u652f\u6301\u7684\u5a92\u4f53\uff08\u6570\u636e\uff09\u7c7b\u578b"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"MediaType contentType = outputMessage.getHeaders().getContentType()"}),"\uff1a\u83b7\u53d6\u54cd\u5e94\u5934\u7684\u6570\u636e"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (contentType != null && contentType.isConcrete())"}),"\uff1a\u5224\u65ad\u5f53\u524d\u54cd\u5e94\u5934\u4e2d\u662f\u5426\u5df2\u7ecf\u6709\u786e\u5b9a\u7684\u5a92\u4f53\u7c7b\u578b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"selectedMediaType = contentType"}),"\uff1a\u524d\u7f6e\u5904\u7406\u5df2\u7ecf\u4f7f\u7528\u4e86\u5a92\u4f53\u7c7b\u578b\uff0c\u76f4\u63a5\u7ee7\u7eed\u4f7f\u7528\u8be5\u7c7b\u578b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"acceptableTypes = getAcceptableMediaTypes(request)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u6d4f\u89c8\u5668\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b\uff0c\u8bf7\u6c42\u5934\u5b57\u6bb5"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.contentNegotiationManager.resolveMediaTypes()"}),"\uff1a\u8c03\u7528\u8be5\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"for(ContentNegotiationStrategy strategy:this.strategies)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u9ed8\u8ba4\u7b56\u7565\u662f\u63d0\u53d6\u8bf7\u6c42\u5934\u7684\u5b57\u6bb5\u7684\u5185\u5bb9"}),"\uff0c\u7b56\u7565\u7c7b\u4e3aHeaderContentNegotiationStrategy\uff0c\u53ef\u4ee5\u914d\u7f6e\u6dfb\u52a0\u5176\u4ed6\u7c7b\u578b\u7684\u7b56\u7565\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"List<MediaType> mediaTypes = strategy.resolveMediaTypes(request)"}),"\uff1a\u89e3\u6790 Accept \u5b57\u6bb5\u5b58\u50a8\u4e3a List\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"headerValueArray = request.getHeaderValues(HttpHeaders.ACCEPT)"}),"\uff1a\u83b7\u53d6\u8bf7\u6c42\u5934\u4e2d Accept \u5b57\u6bb5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"List<MediaType> mediaTypes = MediaType.parseMediaTypes(headerValues)"}),"\uff1a\u89e3\u6790\u6210 List \u96c6\u5408"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"MediaType.sortBySpecificityAndQuality(mediaTypes)"}),"\uff1a\u6309\u7167\u76f8\u5bf9\u54c1\u8d28\u56e0\u6570 q \u964d\u5e8f\u6392\u5e8f"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(72520).A+"",width:"1511",height:"141"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"producibleTypes = getProducibleMediaTypes(request, valueType, targetType)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u670d\u52a1\u5668\u80fd\u751f\u6210\u7684\u5a92\u4f53\u7c7b\u578b"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"request.getAttribute(HandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE)"}),"\uff1a\u4ece\u8bf7\u6c42\u57df\u83b7\u53d6\u9ed8\u8ba4\u7684\u5a92\u4f53\u7c7b\u578b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" for (HttpMessageConverter<?> converter : this.messageConverters)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u6d88\u606f\u8f6c\u6362\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"converter.canWrite(valueClass, null)"}),"\uff1a\u662f\u5426\u652f\u6301\u5f53\u524d\u7684\u7c7b\u578b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" result.addAll(converter.getSupportedMediaTypes())"}),"\uff1a\u628a\u5f53\u524d MessageConverter \u652f\u6301\u7684\u6240\u6709\u7c7b\u578b\u653e\u5165 result"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"List<MediaType> mediaTypesToUse = new ArrayList<>()"}),"\uff1a\u5b58\u50a8\u6700\u4f73\u5339\u914d\u7684\u96c6\u5408"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5185\u5bb9\u534f\u5546\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"  for (MediaType requestedType : acceptableTypes) {\t\t\t\t// \u904d\u5386\u6240\u6709\u6d4f\u89c8\u5668\u80fd\u63a5\u53d7\u7684\u5a92\u4f53\u7c7b\u578b\n      for (MediaType producibleType : producibleTypes) {\t\t// \u904d\u5386\u6240\u6709\u670d\u52a1\u5668\u80fd\u4ea7\u51fa\u7684\n          if (requestedType.isCompatibleWith(producibleType)) {\t// \u5224\u65ad\u7c7b\u578b\u662f\u5426\u5339\u914d\uff0c\u6700\u4f73\u5339\u914d\n              // \u6570\u636e\u534f\u5546\u5339\u914d\u6210\u529f\uff0c\u4e00\u822c\u6709\u591a\u79cd\n              mediaTypesToUse.add(getMostSpecificMediaType(requestedType, producibleType));\n          }\n      }\n  }\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"MediaType.sortBySpecificityAndQuality(mediaTypesToUse)"}),"\uff1a\u6309\u7167\u76f8\u5bf9\u54c1\u8d28\u56e0\u6570 q \u6392\u5e8f\uff0c\u964d\u5e8f\u6392\u5e8f\uff0c\u8d8a\u5927\u7684\u8d8a\u597d"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (MediaType mediaType : mediaTypesToUse)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u6240\u6709\u7684\u6700\u4f73\u5339\u914d"}),"\uff0c\u9009\u62e9\u4e00\u79cd\u8d4b\u503c\u7ed9\u9009\u62e9\u7684\u7c7b\u578b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"selectedMediaType = selectedMediaType.removeQualityValue()"}),"\uff1a\u5a92\u4f53\u7c7b\u578b\u53bb\u9664\u76f8\u5bf9\u54c1\u8d28\u56e0\u6570"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (HttpMessageConverter<?> converter : this.messageConverters)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u6240\u6709\u7684 HTTP \u6570\u636e\u8f6c\u6362\u5668"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"GenericHttpMessageConverter genericConverter"}),"\uff1a",(0,i.jsx)(e.strong,{children:"MappingJackson2HttpMessageConverter \u53ef\u4ee5\u5c06\u5bf9\u8c61\u5199\u4e3a JSON"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"((GenericHttpMessageConverter) converter).canWrite()"}),"\uff1a\u5224\u65ad\u8f6c\u6362\u5668\u662f\u5426\u53ef\u4ee5\u5199\u51fa\u7ed9\u5b9a\u7684\u7c7b\u578b"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"AbstractJackson2HttpMessageConverter#canWrit"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (!canWrite(mediaType))"}),"\uff1a\u662f\u5426\u53ef\u4ee5\u5199\u51fa\u6307\u5b9a\u7c7b\u578b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MediaType.ALL.equalsTypeAndSubtype(mediaType)"}),"\uff1a\u662f\u4e0d\u662f ",(0,i.jsx)(e.code,{children:"*/*"})," \u7c7b\u578b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getSupportedMediaTypes()"}),"\uff1a\u652f\u6301 ",(0,i.jsx)(e.code,{children:"application/json"})," \u548c ",(0,i.jsx)(e.code,{children:"application/*+json"})," \u4e24\u79cd\u7c7b\u578b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return true"}),"\uff1a\u8fd4\u56de true"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"objectMapper = selectObjectMapper(clazz, mediaType)"}),"\uff1a\u9009\u62e9\u53ef\u4ee5\u4f7f\u7528\u7684 objectMapper"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"causeRef = new AtomicReference<>()"}),"\uff1a\u83b7\u53d6\u5e76\u53d1\u5b89\u5168\u7684\u5f15\u7528"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (objectMapper.canSerialize(clazz, causeRef))"}),"\uff1aobjectMapper \u53ef\u4ee5\u5e8f\u5217\u5316\u5f53\u524d\u7c7b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return true"}),"\uff1a\u8fd4\u56de true"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:" body = getAdvice().beforeBodyWrite()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u8981\u54cd\u5e94\u7684\u6240\u6709\u6570\u636e\uff0c\u5c31\u662f Person \u5bf9\u8c61"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"addContentDispositionHeader(inputMessage, outputMessage)"}),"\uff1a\u68c0\u67e5\u8def\u5f84"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"genericConverter.write(body, targetType, selectedMediaType, outputMessage)"}),"\uff1a\u8c03\u7528\u6d88\u606f\u8f6c\u6362\u5668\u7684 write \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AbstractGenericHttpMessageConverter#write"}),"\uff1a\u8be5\u7c7b\u7684\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"addDefaultHeaders(headers, t, contentType)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8bbe\u7f6e\u54cd\u5e94\u5934\u4e2d\u7684\u6570\u636e\u7c7b\u578b"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(70794).A+"",width:"1273",height:"107"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"writeInternal(t, type, outputMessage)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6570\u636e\u5199\u51fa\u4e3a JSON \u683c\u5f0f"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Object value = object"}),"\uff1avalue \u5f15\u7528 Person \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ObjectWriter objectWriter = objectMapper.writer()"}),"\uff1a\u83b7\u53d6 ObjectWriter \u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"objectWriter.writeValue(generator, value)"}),"\uff1a\u4f7f\u7528 ObjectWriter \u5199\u51fa\u6570\u636e\u4e3a JSON"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u534f\u5546\u7b56\u7565",children:"\u534f\u5546\u7b56\u7565"}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u542f\u57fa\u4e8e\u8bf7\u6c42\u53c2\u6570\u7684\u5185\u5bb9\u534f\u5546\u6a21\u5f0f\uff1a\uff08SpringBoot \u65b9\u5f0f\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring.mvc.contentnegotiation:favor-parameter: true  # \u5f00\u542f\u8bf7\u6c42\u53c2\u6570\u5185\u5bb9\u534f\u5546\u6a21\u5f0f\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53d1\u8bf7\u6c42\uff1a ",(0,i.jsx)(e.code,{children:"http://localhost:8080/person?format=json"}),"\uff0c\u89e3\u6790 format"]}),"\n",(0,i.jsx)(e.p,{children:"\u7b56\u7565\u7c7b\u4e3a ParameterContentNegotiationStrategy\uff0c\u8fd0\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"acceptableTypes = getAcceptableMediaTypes(request)"}),"\uff1a\u83b7\u53d6\u6d4f\u89c8\u5668\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mediaTypes = strategy.resolveMediaTypes(request)"}),"\uff1a\u89e3\u6790\u8bf7\u6c42 URL \u53c2\u6570\u4e2d\u7684\u6570\u636e"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return resolveMediaTypeKey(webRequest, getMediaTypeKey(webRequest))"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getMediaTypeKey(webRequest)"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"request.getParameter(getParameterName())"}),"\uff1a\u83b7\u53d6 URL \u4e2d\u6307\u5b9a\u7684\u9700\u6c42\u7684\u6570\u636e\u7c7b\u578b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getParameterName()"}),"\uff1a\u83b7\u53d6\u53c2\u6570\u7684\u5c5e\u6027\u540d format"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getParameter()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 URL \u4e2d format \u5bf9\u5e94\u7684\u6570\u636e"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"resolveMediaTypeKey()"}),"\uff1a\u89e3\u6790\u5a92\u4f53\u7c7b\u578b\uff0c\u5c01\u88c5\u6210\u96c6\u5408"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u5185\u5bb9\u534f\u5546\u7b56\u7565\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class WebConfig implements WebMvcConfigurer {\n    @Bean\n    public WebMvcConfigurer webMvcConfigurer() {\n        return new WebMvcConfigurer() {\n            @Override\t//\u81ea\u5b9a\u4e49\u5185\u5bb9\u534f\u5546\u7b56\u7565\n            public void configureContentNegotiation(ContentNegotiationConfigurer configurer) {\n                Map<String, MediaType> mediaTypes = new HashMap<>();\n                mediaTypes.put("json", MediaType.APPLICATION_JSON);\n                mediaTypes.put("xml",MediaType.APPLICATION_XML);\n                mediaTypes.put("person",MediaType.parseMediaType("application/x-person"));\n                // \u6307\u5b9a\u652f\u6301\u89e3\u6790\u54ea\u4e9b\u53c2\u6570\u5bf9\u5e94\u7684\u54ea\u4e9b\u5a92\u4f53\u7c7b\u578b\n                ParameterContentNegotiationStrategy parameterStrategy = new ParameterContentNegotiationStrategy(mediaTypes);\n\n                // \u8bf7\u6c42\u5934\u89e3\u6790\n                HeaderContentNegotiationStrategy headStrategy = new HeaderContentNegotiationStrategy();\n\n                // \u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\uff0c\u5373\u53ef\u4ee5\u89e3\u6790\u8bf7\u6c42\u5934 \u53c8\u53ef\u4ee5\u89e3\u6790\u8bf7\u6c42\u53c2\u6570\n                configurer.strategies(Arrays.asList(parameterStrategy,headStrategy));\n            }\n            \n            @Override \t// \u81ea\u5b9a\u4e49\u6d88\u606f\u8f6c\u6362\u5668\n            public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {\n                converters.add(new GuiguMessageConverter());\n            }\n        }\n    }\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49 HttpMessageConverter\uff0c\u5b9e\u73b0 HttpMessageConverter",(0,i.jsx)(e.t,{children:" \u63a5\u53e3\u91cd\u5199\u65b9\u6cd5\u5373\u53ef"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u89c6\u56fe\u89e3\u6790",children:"\u89c6\u56fe\u89e3\u6790"}),"\n",(0,i.jsx)(e.h4,{id:"\u8fd4\u56de\u89e3\u6790",children:"\u8fd4\u56de\u89e3\u6790"}),"\n",(0,i.jsx)(e.p,{children:"\u8bf7\u6c42\u5904\u7406\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/params")\npublic String param(){\n\treturn "forward:/success";\n    //return "redirect:/success";\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u8fdb\u5165\u6267\u884c\u65b9\u6cd5\u903b\u8f91 ServletInvocableHandlerMethod#invokeAndHandle\uff0c\u8fdb\u5165 ",(0,i.jsx)(e.code,{children:"this.returnValueHandlers.handleReturnValue"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void handleReturnValue(@Nullable Object returnValue, MethodParameter returnType,\n                              ModelAndViewContainer mavContainer, NativeWebRequest webRequest)  {\n\t// \u83b7\u53d6\u5408\u9002\u7684\u8fd4\u56de\u503c\u5904\u7406\u5668\uff1a\u8c03\u7528 if (handler.supportsReturnType(returnType))\u5224\u65ad\u662f\u5426\u652f\u6301\n    HandlerMethodReturnValueHandler handler = selectHandler(returnValue, returnType);\n    if (handler == null) {\n        throw new IllegalArgumentException();\n    }\n    // \u4f7f\u7528\u5904\u7406\u5668\u5904\u7406\u8fd4\u56de\u503c\n    handler.handleReturnValue(returnValue, returnType, mavContainer, webRequest);\n}\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ViewNameMethodReturnValueHandler#supportsReturnType\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public boolean supportsReturnType(MethodParameter returnType) {\n    Class<?> paramType = returnType.getParameterType();\n    // \u8fd4\u56de\u503c\u662f\u5426\u662f void \u6216\u8005\u662f CharSequence \u5b57\u7b26\u5e8f\u5217\uff0c\u8fd9\u91cc\u662f\u5b57\u7b26\u5e8f\u5217\n    return (void.class == paramType || CharSequence.class.isAssignableFrom(paramType));\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ViewNameMethodReturnValueHandler#handleReturnValue\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void handleReturnValue(@Nullable Object returnValue, MethodParameter returnType,\n                              ModelAndViewContainer mavContainer, \n                              NativeWebRequest webRequest) throws Exception {\n\t// \u8fd4\u56de\u503c\u662f\u5b57\u7b26\u4e32\uff0c\u662f return "forward:/success"\n    if (returnValue instanceof CharSequence) {\n        String viewName = returnValue.toString();\n        // \u3010\u628a\u89c6\u56fe\u540d\u79f0\u8bbe\u7f6e\u8fdb\u5165 ModelAndViewContainer \u4e2d\u3011\n        mavContainer.setViewName(viewName);\n        // \u5224\u65ad\u662f\u5426\u662f\u91cd\u5b9a\u5411\u6570\u636e `viewName.startsWith("redirect:")`\n        if (isRedirectViewName(viewName)) {\n            // \u5982\u679c\u662f\u91cd\u5b9a\u5411\uff0c\u8bbe\u7f6e\u662f\u91cd\u5b9a\u5411\u6307\u4ee4\n            mavContainer.setRedirectModelScenario(true);\n        }\n    }\n    else if (returnValue != null) {\n        // should not happen\n        throw new UnsupportedOperationException();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u7ed3\u679c\u6d3e\u53d1",children:"\u7ed3\u679c\u6d3e\u53d1"}),"\n",(0,i.jsx)(e.p,{children:"doDispatch() \u4e2d\u7684 processDispatchResult\uff1a\u5904\u7406\u6d3e\u53d1\u7ed3\u679c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private void processDispatchResult(HttpServletRequest request, HttpServletResponse response,\n                                   @Nullable HandlerExecutionChain mappedHandler, \n                                   @Nullable ModelAndView mv,\n                                   @Nullable Exception exception) throws Exception {\n    boolean errorView = false;\n    if (exception != null) {\n    }\n    // mv \u662f ModelAndValue\n    if (mv != null && !mv.wasCleared()) {\n        // \u6e32\u67d3\u89c6\u56fe\n        render(mv, request, response);\n        if (errorView) {\n            WebUtils.clearErrorRequestAttributes(request);\n        }\n    }\n    else {}  \n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"DispatcherServlet#render\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Locale locale = this.localeResolver.resolveLocale(request)"}),"\uff1a\u56fd\u9645\u5316\u76f8\u5173"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"String viewName = mv.getViewName()"}),"\uff1a\u89c6\u56fe\u540d\u5b57\uff0c\u662f\u8bf7\u6c42\u8f6c\u53d1 forward:/success\uff08\u54cd\u5e94\u6570\u636e\u89e3\u6790\u5e76\u5b58\u5165 ModelAndView\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"view = resolveViewName(viewName, mv.getModelInternal(), locale, request)"}),"\uff1a\u89e3\u6790\u89c6\u56fe"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (ViewResolver viewResolver : this.viewResolvers)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u904d\u5386\u6240\u6709\u7684\u89c6\u56fe\u89e3\u6790\u5668"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"view = viewResolver.resolveViewName(viewName, locale)"}),"\uff1a\u6839\u636e\u89c6\u56fe\u540d\u5b57\u89e3\u6790\u89c6\u56fe\uff0c\u8c03\u7528\u5185\u5bb9\u534f\u5546\u89c6\u56fe\u5904\u7406\u5668 ContentNegotiatingViewResolver \u7684\u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"attrs = RequestContextHolder.getRequestAttributes()"}),"\uff1a\u83b7\u53d6\u8bf7\u6c42\u7684\u76f8\u5173\u5c5e\u6027\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"requestedMediaTypes = getMediaTypes(((ServletRequestAttributes) attrs).getRequest())"}),"\uff1a\u83b7\u53d6\u6700\u4f73\u5339\u914d\u7684\u5a92\u4f53\u7c7b\u578b\uff0c\u51fd\u6570\u5185\u8fdb\u884c\u4e86\u5339\u914d\u7684\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"candidateViews = getCandidateViews(viewName, locale, requestedMediaTypes)"}),"\uff1a\u83b7\u53d6\u5019\u9009\u7684\u89c6\u56fe\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"for (ViewResolver viewResolver : this.viewResolvers)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u89c6\u56fe\u89e3\u6790\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"View view = viewResolver.resolveViewName(viewName, locale)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u89e3\u6790\u89c6\u56fe"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AbstractCachingViewResolver#resolveViewName"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"returnview = createView(viewName, locale)"}),"\uff1aUrlBasedViewResolver#createView"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u8bf7\u6c42\u8f6c\u53d1"}),"\uff1a\u5b9e\u4f8b\u4e3a InternalResourceView"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"if (viewName.startsWith(FORWARD_URL_PREFIX))"}),"\uff1a\u89c6\u56fe\u540d\u5b57\u662f\u5426\u662f ",(0,i.jsx)(e.strong,{children:(0,i.jsx)(e.code,{children:"forward:"})})," \u7684\u524d\u7f00"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"forwardUrl = viewName.substring(FORWARD_URL_PREFIX.length())"}),"\uff1a\u540d\u5b57\u622a\u53d6\u524d\u7f00"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"view = new InternalResourceView(forwardUrl)"}),"\uff1a\u65b0\u5efa InternalResourceView  \u5bf9\u8c61\u5e76\u8fd4\u56de"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return applyLifecycleMethods(FORWARD_URL_PREFIX, view)"}),"\uff1aSpring \u4e2d\u7684\u521d\u59cb\u5316\u64cd\u4f5c"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u91cd\u5b9a\u5411"}),"\uff1a\u5b9e\u4f8b\u4e3a RedirectView"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (viewName.startsWith(REDIRECT_URL_PREFIX))"}),"\uff1a\u89c6\u56fe\u540d\u5b57\u662f\u5426\u662f ",(0,i.jsx)(e.strong,{children:(0,i.jsx)(e.code,{children:"redirect:"})})," \u7684\u524d\u7f00"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"redirectUrl = viewName.substring(REDIRECT_URL_PREFIX.length())"}),"\uff1a\u540d\u5b57\u622a\u53d6\u524d\u7f00"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RedirectView view = new RedirectView()"}),"\uff1a\u65b0\u5efa RedirectView \u5bf9\u8c61\u5e76\u8fd4\u56de"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bestView = getBestView(candidateViews, requestedMediaTypes, attrs)"}),"\uff1a\u9009\u51fa\u6700\u4f73\u5339\u914d\u7684\u89c6\u56fe\u5bf9\u8c61"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"view.render(mv.getModelInternal(), request, response)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u9875\u9762\u6e32\u67d3"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"mergedModel = createMergedOutputModel(model, request, response)"}),"\uff1a\u628a\u8bf7\u6c42\u57df\u4e2d\u7684\u6570\u636e\u5c01\u88c5\u5230 model"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"prepareResponse(request, response)"}),"\uff1a\u54cd\u5e94\u524d\u7684\u51c6\u5907\u5de5\u4f5c\uff0c\u8bbe\u7f6e\u4e00\u4e9b\u54cd\u5e94\u5934"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"renderMergedOutputModel(mergedModel, getRequestToExpose(request), response)"}),"\uff1a\u6e32\u67d3\u8f93\u51fa\u7684\u6570\u636e"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"getRequestToExpose(request)"}),"\uff1a\u83b7\u53d6 Servlet \u539f\u751f\u7684\u65b9\u5f0f"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u8bf7\u6c42\u8f6c\u53d1 InternalResourceView \u7684\u903b\u8f91\uff1a\u8bf7\u6c42\u57df\u4e2d\u7684\u6570\u636e\u4e0d\u4e22\u5931"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"exposeModelAsRequestAttributes(model, request)"}),"\uff1a\u66b4\u9732 model \u4f5c\u4e3a\u8bf7\u6c42\u57df\u7684\u5c5e\u6027\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"model.forEach()"}),"\uff1a\u904d\u5386 Model \u4e2d\u7684\u6570\u636e"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"request.setAttribute(name, value)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u8bbe\u7f6e\u5230\u8bf7\u6c42\u57df\u4e2d"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"exposeHelpers(request)"}),"\uff1a\u81ea\u5b9a\u4e49\u63a5\u53e3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"dispatcherPath = prepareForRendering(request, response)"}),"\uff1a\u786e\u5b9a\u8c03\u5ea6\u5206\u6d3e\u7684\u8def\u5f84\uff0c\u6b64\u4f8b\u662f /success"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"rd = getRequestDispatcher(request, dispatcherPath)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6 Servlet \u539f\u751f\u7684 RequestDispatcher \u5b9e\u73b0\u8f6c\u53d1"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"rd.forward(request, response)"}),"\uff1a\u5b9e\u73b0\u8bf7\u6c42\u8f6c\u53d1"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u91cd\u5b9a\u5411 RedirectView \u7684\u903b\u8f91\uff1a\u8bf7\u6c42\u57df\u4e2d\u7684\u6570\u636e\u4f1a\u4e22\u5931"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"targetUrl = createTargetUrl(model, request)"}),"\uff1a\u83b7\u53d6\u76ee\u6807 URL\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"enc = request.getCharacterEncoding()"}),"\uff1a\u8bbe\u7f6e\u7f16\u7801 UTF-8"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"appendQueryProperties(targetUrl, model, enc)"}),"\uff1a\u6dfb\u52a0\u4e00\u4e9b\u5c5e\u6027\uff0c\u6bd4\u5982 ",(0,i.jsx)(e.code,{children:"url + ?name=123&&age=324"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"sendRedirect(request, response, targetUrl, this.http10Compatible)"}),"\uff1a\u91cd\u5b9a\u5411\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"response.sendRedirect(encodedURL)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u4f7f\u7528 Servlet \u539f\u751f\u65b9\u6cd5\u5b9e\u73b0\u91cd\u5b9a\u5411"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u5f02\u6b65\u8c03\u7528",children:"\u5f02\u6b65\u8c03\u7528"}),"\n",(0,i.jsx)(e.h3,{id:"\u8bf7\u6c42\u53c2\u6570",children:"\u8bf7\u6c42\u53c2\u6570"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@RequestBody"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u5f62\u53c2\u524d\u65b9"}),"\n",(0,i.jsxs)(e.p,{children:["\u4f5c\u7528\uff1a\u5c06\u5f02\u6b65\u63d0\u4ea4\u6570\u636e",(0,i.jsx)(e.strong,{children:"\u8f6c\u6362"}),"\u6210\u6807\u51c6\u8bf7\u6c42\u53c2\u6570\u683c\u5f0f\uff0c\u5e76\u8d4b\u503c\u7ed9\u5f62\u53c2\n\u8303\u4f8b\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller //\u63a7\u5236\u5c42\npublic class AjaxController {\n    @RequestMapping("/ajaxController")\n    public String ajaxController(@RequestBody String message){\n        System.out.println(message);\n        return "page.jsp";\n    }  \n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u6ce8\u89e3\u6dfb\u52a0\u5230 POJO  \u53c2\u6570\u524d\u65b9\u65f6\uff0c\u5c01\u88c5\u7684\u5f02\u6b65\u63d0\u4ea4\u6570\u636e\u6309\u7167 POJO  \u7684\u5c5e\u6027\u683c\u5f0f\u8fdb\u884c\u5173\u7cfb\u6620\u5c04\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"POJO \u4e2d\u7684\u5c5e\u6027\u5982\u679c\u8bf7\u6c42\u6570\u636e\u4e2d\u6ca1\u6709\uff0c\u5c5e\u6027\u503c\u4e3a null"}),"\n",(0,i.jsx)(e.li,{children:"POJO \u4e2d\u6ca1\u6709\u7684\u5c5e\u6027\u5982\u679c\u8bf7\u6c42\u6570\u636e\u4e2d\u6709\uff0c\u4e0d\u8fdb\u884c\u6620\u5c04"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u6ce8\u89e3\u6dfb\u52a0\u5230\u96c6\u5408\u53c2\u6570\u524d\u65b9\u65f6\uff0c\u5c01\u88c5\u7684\u5f02\u6b65\u63d0\u4ea4\u6570\u636e\u6309\u7167\u96c6\u5408\u7684\u5b58\u50a8\u7ed3\u6784\u8fdb\u884c\u5173\u7cfb\u6620\u5c04"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/ajaxPojoToController")\n//\u5982\u679c\u5904\u7406\u53c2\u6570\u662fPOJO\uff0c\u4e14\u9875\u9762\u53d1\u9001\u7684\u8bf7\u6c42\u6570\u636e\u683c\u5f0f\u4e0ePOJO\u4e2d\u7684\u5c5e\u6027\u5bf9\u5e94\uff0c@RequestBody\u6ce8\u89e3\u53ef\u4ee5\u81ea\u52a8\u6620\u5c04\u5bf9\u5e94\u8bf7\u6c42\u6570\u636e\u5230POJO\u4e2d\npublic String  ajaxPojoToController(@RequestBody User user){\n    System.out.println("controller pojo :"+user);\n    return "page.jsp";\n}\n\n@RequestMapping("/ajaxListToController")\n//\u5982\u679c\u5904\u7406\u53c2\u6570\u662fList\u96c6\u5408\u4e14\u5c01\u88c5\u4e86POJO\uff0c\u4e14\u9875\u9762\u53d1\u9001\u7684\u6570\u636e\u662fJSON\u683c\u5f0f\uff0c\u6570\u636e\u5c06\u81ea\u52a8\u6620\u5c04\u5230\u96c6\u5408\u53c2\u6570\npublic String  ajaxListToController(@RequestBody List<User> userList){\n    System.out.println("controller list :"+userList);\n    return "page.jsp";\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"ajax.jsp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<%@page pageEncoding="UTF-8" language="java" contentType="text/html;UTF-8" %>\n\n<a href="javascript:void(0);" id="testAjax">\u8bbf\u95eespringmvc\u540e\u53f0controller</a><br/>\n<a href="javascript:void(0);" id="testAjaxPojo">\u4f20\u9012Json\u683c\u5f0fPOJO</a><br/>\n<a href="javascript:void(0);" id="testAjaxList">\u4f20\u9012Json\u683c\u5f0fList</a><br/>\n    \n<script type="text/javascript" src="${pageContext.request.contextPath}/js/jquery-3.3.1.min.js"><\/script>\n<script type="text/javascript">\n    $(function () {\n        //\u4e3aid="testAjax"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n        $("#testAjax").click(function(){\n            //\u53d1\u9001\u5f02\u6b65\u8c03\u7528\n            $.ajax({\n               //\u8bf7\u6c42\u65b9\u5f0f\uff1aPOST\u8bf7\u6c42\n               type:"POST",\n               //\u8bf7\u6c42\u7684\u5730\u5740\n               url:"ajaxController",\n               //\u8bf7\u6c42\u53c2\u6570\uff08\u4e5f\u5c31\u662f\u8bf7\u6c42\u5185\u5bb9\uff09\n               data:\'ajax message\',\n               //\u54cd\u5e94\u6b63\u6587\u7c7b\u578b\n               dataType:"text",\n               //\u8bf7\u6c42\u6b63\u6587\u7684MIME\u7c7b\u578b\n               contentType:"application/text",\n            });\n        });\n        \n         //\u4e3aid="testAjaxPojo"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n        $("#testAjaxPojo").click(function(){\n            $.ajax({\n               type:"POST",\n               url:"ajaxPojoToController",\n               data:\'{"name":"Jock","age":39}\',\n               dataType:"text",\n               contentType:"application/json",\n            });\n        });\n        \n        //\u4e3aid="testAjaxList"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n        $("#testAjaxList").click(function(){\n            $.ajax({//.....\n               data:\'[{"name":"Jock","age":39},{"name":"Jockme","age":40}]\'})}\n    }\n<\/script>\n'})}),"\n",(0,i.jsx)(e.p,{children:"web.xml\u914d\u7f6e\uff1a\u8bf7\u6c42\u54cd\u5e94\u7ae0\u8282\u8bf7\u6c42\u4e2d\u7684web.xml\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"CharacterEncodingFilter + DispatcherServlet\n"})}),"\n",(0,i.jsx)(e.p,{children:"spring-mvc.xml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<context:component-scan base-package="controller,domain"/>\n<mvc:resources mapping="/js/**" location="/js/"/>\n<mvc:annotation-driven/>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u54cd\u5e94\u6570\u636e-1",children:"\u54cd\u5e94\u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@ResponseBody"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u5c06 Java \u5bf9\u8c61\u8f6c\u4e3a json \u683c\u5f0f\u7684\u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:"\u65b9\u6cd5\u8fd4\u56de\u503c\u4e3a POJO \u65f6\uff0c\u81ea\u52a8\u5c01\u88c5\u6570\u636e\u6210 Json \u5bf9\u8c61\u6570\u636e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/ajaxReturnJson")\n@ResponseBody\npublic User ajaxReturnJson(){\n    System.out.println("controller return json pojo...");\n    User user = new User("Jockme",40);\n    return user;\n}  \n'})}),"\n",(0,i.jsx)(e.p,{children:"\u65b9\u6cd5\u8fd4\u56de\u503c\u4e3a List \u65f6\uff0c\u81ea\u52a8\u5c01\u88c5\u6570\u636e\u6210 json \u5bf9\u8c61\u6570\u7ec4\u6570\u636e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/ajaxReturnJsonList")\n@ResponseBody\n//\u57fa\u4e8ejackon\u6280\u672f\uff0c\u4f7f\u7528@ResponseBody\u6ce8\u89e3\u53ef\u4ee5\u5c06\u8fd4\u56de\u7684\u4fdd\u5b58POJO\u5bf9\u8c61\u7684\u96c6\u5408\u8f6c\u6210json\u6570\u7ec4\u683c\u5f0f\u6570\u636e\npublic List ajaxReturnJsonList(){\n    System.out.println("controller return json list...");\n    User user1 = new User("Tom",3);\n    User user2 = new User("Jerry",5);\n\n    ArrayList al = new ArrayList();\n    al.add(user1);\n    al.add(user2);\n    return al;\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"AJAX \u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'//\u4e3aid="testAjaxReturnString"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n$("#testAjaxReturnString").click(function(){\n    //\u53d1\u9001\u5f02\u6b65\u8c03\u7528\n    $.ajax({\n        type:"POST",\n        url:"ajaxReturnString",\n        //\u56de\u8c03\u51fd\u6570\n        success:function(data){\n            //\u6253\u5370\u8fd4\u56de\u7ed3\u679c\n            alert(data);\n        }\n    });\n});\n\n//\u4e3aid="testAjaxReturnJson"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n$("#testAjaxReturnJson").click(function(){\n    $.ajax({\n        type:"POST",\n        url:"ajaxReturnJson",\n        success:function(data){\n            alert(data[\'name\']+" ,  "+data[\'age\']);\n        }\n    });\n});\n\n//\u4e3aid="testAjaxReturnJsonList"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n$("#testAjaxReturnJsonList").click(function(){\n    $.ajax({\n        type:"POST",\n        url:"ajaxReturnJsonList",\n        success:function(data){\n            alert(data);\n            alert(data[0]["name"]);\n            alert(data[1]["age"]);\n        }\n    });\n});\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u8de8\u57df\u8bbf\u95ee",children:"\u8de8\u57df\u8bbf\u95ee"}),"\n",(0,i.jsx)(e.p,{children:"\u8de8\u57df\u8bbf\u95ee\uff1a\u5f53\u901a\u8fc7\u57df\u540d A \u4e0b\u7684\u64cd\u4f5c\u8bbf\u95ee\u57df\u540d B \u4e0b\u7684\u8d44\u6e90\u65f6\uff0c\u79f0\u4e3a\u8de8\u57df\u8bbf\u95ee\uff0c\u8de8\u57df\u8bbf\u95ee\u65f6\uff0c\u4f1a\u51fa\u73b0\u65e0\u6cd5\u8bbf\u95ee\u7684\u73b0\u8c61"}),"\n",(0,i.jsx)(e.p,{children:"\u73af\u5883\u642d\u5efa\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e3a\u5f53\u524d\u4e3b\u673a\u6dfb\u52a0\u5907\u7528\u57df\u540d\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539 windows \u5b89\u88c5\u76ee\u5f55\u4e2d\u7684 host \u6587\u4ef6"}),"\n",(0,i.jsx)(e.li,{children:"\u683c\u5f0f\uff1a ip \u57df\u540d"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u52a8\u6001\u5237\u65b0 DNS\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u547d\u4ee4\uff1a ipconfig /displaydns"}),"\n",(0,i.jsx)(e.li,{children:"\u547d\u4ee4\uff1a ipconfig /flushdns"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8de8\u57df\u8bbf\u95ee\u652f\u6301\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u540d\u79f0\uff1a@CrossOrigin"}),"\n",(0,i.jsx)(e.li,{children:"\u7c7b\u578b\uff1a\u65b9\u6cd5\u6ce8\u89e3 \u3001 \u7c7b\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.li,{children:"\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4e0a\u65b9\u6216\u7c7b\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.li,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5f53\u524d\u5904\u7406\u5668\u65b9\u6cd5 / \u5904\u7406\u5668\u7c7b\u4e2d\u6240\u6709\u65b9\u6cd5\u652f\u6301\u8de8\u57df\u8bbf\u95ee"}),"\n",(0,i.jsx)(e.li,{children:"\u8303\u4f8b\uff1a"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping("/cross")\n@ResponseBody\n//\u4f7f\u7528@CrossOrigin\u5f00\u542f\u8de8\u57df\u8bbf\u95ee\n//\u6807\u6ce8\u5728\u5904\u7406\u5668\u65b9\u6cd5\u4e0a\u65b9\u8868\u793a\u8be5\u65b9\u6cd5\u652f\u6301\u8de8\u57df\u8bbf\u95ee\n//\u6807\u6ce8\u5728\u5904\u7406\u5668\u7c7b\u4e0a\u65b9\u8868\u793a\u8be5\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u6240\u6709\u5904\u7406\u5668\u65b9\u6cd5\u5747\u652f\u6301\u8de8\u57df\u8bbf\u95ee\n@CrossOrigin\npublic User cross(HttpServletRequest request){\n    System.out.println("controller cross..." + request.getRequestURL());\n    User user = new User("Jockme",36);\n    return user;\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"jsp \u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<a href="javascript:void(0);" id="testCross">\u8de8\u57df\u8bbf\u95ee</a><br/>\n<script type="text/javascript" src="${pageContext.request.contextPath}/js/jquery-3.3.1.min.js"><\/script>\n<script type="text/javascript">\n    $(function () {\n        //\u4e3aid="testCross"\u7684\u7ec4\u4ef6\u7ed1\u5b9a\u70b9\u51fb\u4e8b\u4ef6\n        $("#testCross").click(function(){\n            //\u53d1\u9001\u5f02\u6b65\u8c03\u7528\n            $.ajax({\n               type:"POST",\n               url:"http://127.0.0.1/cross",\n               //\u56de\u8c03\u51fd\u6570\n               success:function(data){\n                   alert("\u8de8\u57df\u8c03\u7528\u4fe1\u606f\u53cd\u9988:" + data[\'name\'] + "," + data[\'age\']);\n               }\n            });\n        });\n    });\n<\/script>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u62e6\u622a\u5668",children:"\u62e6\u622a\u5668"}),"\n",(0,i.jsx)(e.h3,{id:"\u57fa\u672c\u4ecb\u7ecd-5",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u5668\uff08Interceptor\uff09\u662f\u4e00\u79cd\u52a8\u6001\u62e6\u622a\u65b9\u6cd5\u8c03\u7528\u7684\u673a\u5236"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728\u6307\u5b9a\u7684\u65b9\u6cd5\u8c03\u7528\u524d\u540e\u6267\u884c\u9884\u5148\u8bbe\u5b9a\u540e\u7684\u7684\u4ee3\u7801"}),"\n",(0,i.jsx)(e.li,{children:"\u963b\u6b62\u539f\u59cb\u65b9\u6cd5\u7684\u6267\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u539f\u7406\uff1aAOP \u601d\u60f3"}),"\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u5668\u94fe\uff1a\u591a\u4e2a\u62e6\u622a\u5668\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\uff0c\u5bf9\u539f\u59cb\u88ab\u8c03\u7528\u529f\u80fd\u8fdb\u884c\u589e\u5f3a"}),"\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u5668\u548c\u8fc7\u6ee4\u5668\u5bf9\u6bd4\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f52\u5c5e\u4e0d\u540c\uff1a Filter \u5c5e\u4e8e Servlet \u6280\u672f\uff0c Interceptor \u5c5e\u4e8e SpringMVC \u6280\u672f"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u5185\u5bb9\u4e0d\u540c\uff1a Filter \u5bf9\u6240\u6709\u8bbf\u95ee\u8fdb\u884c\u589e\u5f3a\uff0c Interceptor \u4ec5\u9488\u5bf9 SpringMVC \u7684\u8bbf\u95ee\u8fdb\u884c\u589e\u5f3a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(23127).A+"",width:"999",height:"334"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5904\u7406\u65b9\u6cd5",children:"\u5904\u7406\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.h4,{id:"\u524d\u7f6e\u5904\u7406",children:"\u524d\u7f6e\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u59cb\u65b9\u6cd5\u4e4b\u524d\u8fd0\u884c\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public boolean preHandle(HttpServletRequest request,\n                         HttpServletResponse response,\n                         Object handler) throws Exception {\n    System.out.println("preHandle");\n    return true;\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53c2\u6570\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"request\uff1a\u8bf7\u6c42\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"response\uff1a\u54cd\u5e94\u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.li,{children:["handler\uff1a\u88ab\u8c03\u7528\u7684\u5904\u7406\u5668\u5bf9\u8c61\uff0c\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u65b9\u6cd5\u5bf9\u8c61\uff0c\u5bf9\u53cd\u5c04\u4e2d\u7684Method\u5bf9\u8c61\u8fdb\u884c\u4e86\u518d\u5305\u88c5\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"handler\uff1apublic String controller.InterceptorController.handleRun"}),"\n",(0,i.jsx)(e.li,{children:"handler.getClass()\uff1aorg.springframework.web.method.HandlerMethod"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u8fd4\u56de\u503c\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd4\u56de\u503c\u4e3a false\uff0c\u88ab\u62e6\u622a\u7684\u5904\u7406\u5668\u5c06\u4e0d\u6267\u884c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u540e\u7f6e\u5904\u7406-1",children:"\u540e\u7f6e\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u59cb\u65b9\u6cd5\u8fd0\u884c\u540e\u8fd0\u884c\uff0c\u5982\u679c\u539f\u59cb\u65b9\u6cd5\u88ab\u62e6\u622a\uff0c\u5219\u4e0d\u6267\u884c\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void postHandle(HttpServletRequest request,\n                       HttpServletResponse response,\n                       Object handler,\n                       ModelAndView modelAndView) throws Exception {\n    System.out.println("postHandle");\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"modelAndView\uff1a\u5982\u679c\u5904\u7406\u5668\u6267\u884c\u5b8c\u6210\u5177\u6709\u8fd4\u56de\u7ed3\u679c\uff0c\u53ef\u4ee5\u8bfb\u53d6\u5230\u5bf9\u5e94\u6570\u636e\u4e0e\u9875\u9762\u4fe1\u606f\uff0c\u5e76\u8fdb\u884c\u8c03\u6574"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5f02\u5e38\u5904\u7406",children:"\u5f02\u5e38\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u5668\u6700\u540e\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u65e0\u8bba\u539f\u59cb\u65b9\u6cd5\u662f\u5426\u6267\u884c\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void afterCompletion(HttpServletRequest request,\n                            HttpServletResponse response,\n                            Object handler,\n                            Exception ex) throws Exception {\n    System.out.println("afterCompletion");\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"ex\uff1a\u5982\u679c\u5904\u7406\u5668\u6267\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u5f02\u5e38\u5bf9\u8c61\uff0c\u53ef\u4ee5\u9488\u5bf9\u5f02\u5e38\u60c5\u51b5\u8fdb\u884c\u5355\u72ec\u5904\u7406"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u62e6\u622a\u914d\u7f6e",children:"\u62e6\u622a\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u8def\u5f84\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/**"}),"\uff1a\u8868\u793a\u62e6\u622a\u6240\u6709\u6620\u5c04"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/* "}),"\uff1a\u8868\u793a\u62e6\u622a\u6240\u6709/\u5f00\u5934\u7684\u6620\u5c04"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/user/*"}),"\uff1a\u8868\u793a\u62e6\u622a\u6240\u6709 /user/ \u5f00\u5934\u7684\u6620\u5c04"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/user/add*"}),"\uff1a\u8868\u793a\u62e6\u622a\u6240\u6709 /user/ \u5f00\u5934\uff0c\u4e14\u5177\u4f53\u6620\u5c04\u540d\u79f0\u4ee5 add \u5f00\u5934\u7684\u6620\u5c04"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"/user/*All"}),"\uff1a\u8868\u793a\u62e6\u622a\u6240\u6709 /user/ \u5f00\u5934\uff0c\u4e14\u5177\u4f53\u6620\u5c04\u540d\u79f0\u4ee5 All \u7ed3\u5c3e\u7684\u6620\u5c04"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mvc:interceptors>\n    \x3c!--\u5f00\u542f\u5177\u4f53\u7684\u62e6\u622a\u5668\u7684\u4f7f\u7528\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a--\x3e\n    <mvc:interceptor>\n        \x3c!--\u8bbe\u7f6e\u62e6\u622a\u5668\u7684\u62e6\u622a\u8def\u5f84\uff0c\u652f\u6301*\u901a\u914d--\x3e       \n        <mvc:mapping path="/handleRun*"/>\n        \x3c!--\u8bbe\u7f6e\u62e6\u622a\u6392\u9664\u7684\u8def\u5f84\uff0c\u914d\u7f6e/**\u6216/*\uff0c\u8fbe\u5230\u5feb\u901f\u914d\u7f6e\u7684\u76ee\u7684--\x3e\n        <mvc:exclude-mapping path="/b*"/>\n        \x3c!--\u6307\u5b9a\u5177\u4f53\u7684\u62e6\u622a\u5668\u7c7b--\x3e\n        <bean class="MyInterceptor"/>\n    </mvc:interceptor>\n</mvc:interceptors>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u62e6\u622a\u5668\u94fe",children:"\u62e6\u622a\u5668\u94fe"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u8d23\u4efb\u94fe\u6a21\u5f0f"}),"\uff1a\u8d23\u4efb\u94fe\u6a21\u5f0f\u662f\u4e00\u79cd\u884c\u4e3a\u6a21\u5f0f"]}),"\n",(0,i.jsx)(e.p,{children:"\u7279\u70b9\uff1a\u6cbf\u7740\u4e00\u6761\u9884\u5148\u8bbe\u5b9a\u7684\u4efb\u52a1\u94fe\u987a\u5e8f\u6267\u884c\uff0c\u6bcf\u4e2a\u8282\u70b9\u5177\u6709\u72ec\u7acb\u7684\u5de5\u4f5c\u4efb\u52a1\n\u4f18\u52bf\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u72ec\u7acb\u6027\uff1a\u53ea\u5173\u6ce8\u5f53\u524d\u8282\u70b9\u7684\u4efb\u52a1\uff0c\u5bf9\u5176\u4ed6\u4efb\u52a1\u76f4\u63a5\u653e\u884c\u5230\u4e0b\u4e00\u8282\u70b9"}),"\n",(0,i.jsx)(e.li,{children:"\u9694\u79bb\u6027\uff1a\u5177\u5907\u94fe\u5f0f\u4f20\u9012\u7279\u5f81\uff0c\u65e0\u9700\u77e5\u6653\u6574\u4f53\u94fe\u8def\u7ed3\u6784\uff0c\u53ea\u9700\u7b49\u5f85\u8bf7\u6c42\u5230\u8fbe\u540e\u8fdb\u884c\u5904\u7406\u5373\u53ef"}),"\n",(0,i.jsx)(e.li,{children:"\u7075\u6d3b\u6027\uff1a\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\u94fe\u8def\u7ed3\u6784\u52a8\u6001\u65b0\u589e\u6216\u5220\u51cf\u6574\u4f53\u94fe\u8def\u8d23\u4efb"}),"\n",(0,i.jsx)(e.li,{children:"\u89e3\u8026\uff1a\u5c06\u52a8\u6001\u4efb\u52a1\u4e0e\u539f\u59cb\u4efb\u52a1\u89e3\u8026"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7f3a\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u94fe\u8def\u8fc7\u957f\u65f6\uff0c\u5904\u7406\u6548\u7387\u4f4e\u4e0b"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u80fd\u5b58\u5728\u8282\u70b9\u4e0a\u7684\u5faa\u73af\u5f15\u7528\u73b0\u8c61\uff0c\u9020\u6210\u6b7b\u5faa\u73af\uff0c\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(10997).A+"",width:"899",height:"478"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6e90\u7801\u89e3\u6790-2",children:"\u6e90\u7801\u89e3\u6790"}),"\n",(0,i.jsx)(e.p,{children:"DispatcherServlet#doDispatch \u65b9\u6cd5\u4e2d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception {\n\ttry {\n        // \u83b7\u53d6\u6620\u5c04\u5668\u4ee5\u53ca\u6620\u5c04\u5668\u7684\u6240\u6709\u62e6\u622a\u5668\uff08\u8fd0\u884c\u539f\u7406\u90e8\u5206\u8be6\u89e3\u4e86\u6e90\u7801\uff09\n        mappedHandler = getHandler(processedRequest);\n        // \u524d\u7f6e\u5904\u7406\uff0c\u8fd4\u56de false \u4ee3\u8868\u6761\u4ef6\u6210\u7acb\n        if (!mappedHandler.applyPreHandle(processedRequest, response)) {\n            //\u8bf7\u6c42\u4ece\u8fd9\u91cc\u76f4\u63a5\u7ed3\u675f\n            return;\n        }\n        //\u6240\u6709\u62e6\u622a\u5668\u90fd\u8fd4\u56de true\uff0c\u6267\u884c\u76ee\u6807\u65b9\u6cd5\n        mv = ha.handle(processedRequest, response, mappedHandler.getHandler())\n        // \u5012\u5e8f\u6267\u884c\u6240\u6709\u62e6\u622a\u5668\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5\n        mappedHandler.applyPostHandle(processedRequest, response, mv);\n    } catch (Exception ex) {\n        //\u5f02\u5e38\u5904\u7406\u673a\u5236\n        triggerAfterCompletion(processedRequest, response, mappedHandler, ex);\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"HandlerExecutionChain#applyPreHandle\uff1a\u524d\u7f6e\u5904\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"boolean applyPreHandle(HttpServletRequest request, HttpServletResponse response) throws Exception {\n    //\u904d\u5386\u6240\u6709\u7684\u62e6\u622a\u5668\n    for (int i = 0; i < this.interceptorList.size(); i++) {\n        HandlerInterceptor interceptor = this.interceptorList.get(i);\n        //\u6267\u884c\u524d\u7f6e\u5904\u7406\uff0c\u5982\u679c\u62e6\u622a\u5668\u8fd4\u56de false\uff0c\u5219\u6761\u4ef6\u6210\u7acb\uff0c\u4e0d\u5728\u6267\u884c\u5176\u4ed6\u7684\u62e6\u622a\u5668\uff0c\u76f4\u63a5\u8fd4\u56de false\uff0c\u8bf7\u6c42\u76f4\u63a5\u7ed3\u675f\n        if (!interceptor.preHandle(request, response, this.handler)) {\n            triggerAfterCompletion(request, response, null);\n            return false;\n        }\n        this.interceptorIndex = i;\n    }\n    return true;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"HandlerExecutionChain#applyPostHandle\uff1a\u540e\u7f6e\u5904\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"void applyPostHandle(HttpServletRequest request, HttpServletResponse response, @Nullable ModelAndView mv)\n    throws Exception {\n\t//\u5012\u5e8f\u904d\u5386\n    for (int i = this.interceptorList.size() - 1; i >= 0; i--) {\n        HandlerInterceptor interceptor = this.interceptorList.get(i);\n        interceptor.postHandle(request, response, this.handler, mv);\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"DispatcherServlet#triggerAfterCompletion \u5e95\u5c42\u8c03\u7528 HandlerExecutionChain#triggerAfterCompletion\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u524d\u9762\u7684\u6b65\u9aa4\u6709\u4efb\u4f55\u5f02\u5e38\u90fd\u4f1a\u76f4\u63a5\u5012\u5e8f\u89e6\u53d1 afterCompletion"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9875\u9762\u6210\u529f\u6e32\u67d3\u6709\u5f02\u5e38\uff0c\u4e5f\u4f1a\u5012\u5e8f\u89e6\u53d1 afterCompletion"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'void triggerAfterCompletion(HttpServletRequest request, HttpServletResponse response, @Nullable Exception ex) {\n    //\u5012\u5e8f\u904d\u5386\n    for (int i = this.interceptorIndex; i >= 0; i--) {\n        HandlerInterceptor interceptor = this.interceptorList.get(i);\n        try {\n            //\u6267\u884c\u5f02\u5e38\u5904\u7406\u7684\u65b9\u6cd5\n            interceptor.afterCompletion(request, response, this.handler, ex);\n        }\n        catch (Throwable ex2) {\n            logger.error("HandlerInterceptor.afterCompletion threw exception", ex2);\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u62e6\u622a\u5668\u7684\u6267\u884c\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(2023).A+"",width:"1480",height:"656"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,i.jsx)(e.a,{href:"https://www.yuque.com/atguigu/springboot/vgzmgh#wtPLU",children:"https://www.yuque.com/atguigu/springboot/vgzmgh#wtPLU"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49-2",children:"\u81ea\u5b9a\u4e49"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Contoller\u5c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class InterceptorController {\n    @RequestMapping("/handleRun")\n    public String handleRun() {\n        System.out.println("\u4e1a\u52a1\u5904\u7406\u5668\u8fd0\u884c------------main");\n        return "page.jsp";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u9700\u8981\u5b9e\u73b0 HandleInterceptor \u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u9700\u8981\u5b9e\u73b0HandleInterceptor\u63a5\u53e3\npublic class MyInterceptor implements HandlerInterceptor {\n    //\u5904\u7406\u5668\u8fd0\u884c\u4e4b\u524d\u6267\u884c\n    @Override\n    public boolean preHandle(HttpServletRequest request,\n                             HttpServletResponse response,\n                             Object handler) throws Exception {\n        System.out.println("\u524d\u7f6e\u8fd0\u884c----a1");\n        //\u8fd4\u56de\u503c\u4e3afalse\u5c06\u62e6\u622a\u539f\u59cb\u5904\u7406\u5668\u7684\u8fd0\u884c\n        //\u5982\u679c\u914d\u7f6e\u591a\u62e6\u622a\u5668\uff0c\u8fd4\u56de\u503c\u4e3afalse\u5c06\u7ec8\u6b62\u5f53\u524d\u62e6\u622a\u5668\u540e\u9762\u914d\u7f6e\u7684\u62e6\u622a\u5668\u7684\u8fd0\u884c\n        return true;\n    }\n\n    //\u5904\u7406\u5668\u8fd0\u884c\u4e4b\u540e\u6267\u884c\n    @Override\n    public void postHandle(HttpServletRequest request,\n                           HttpServletResponse response,\n                           Object handler,\n                           ModelAndView modelAndView) throws Exception {\n        System.out.println("\u540e\u7f6e\u8fd0\u884c----b1");\n    }\n\n    //\u6240\u6709\u62e6\u622a\u5668\u7684\u540e\u7f6e\u6267\u884c\u5168\u90e8\u7ed3\u675f\u540e\uff0c\u6267\u884c\u8be5\u64cd\u4f5c\n    @Override\n    public void afterCompletion(HttpServletRequest request,\n                                HttpServletResponse response,\n                                Object handler,\n                                Exception ex) throws Exception {\n        System.out.println("\u5b8c\u6210\u8fd0\u884c----c1");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a\u4e09\u4e2a\u65b9\u6cd5\u7684\u8fd0\u884c\u987a\u5e8f\u4e3a    preHandle \u2192 postHandle \u2192 afterCompletion\uff0c\u5982\u679c preHandle \u8fd4\u56de\u503c\u4e3a false\uff0c\u4e09\u4e2a\u65b9\u6cd5\u4ec5\u8fd0\u884cpreHandle"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"web.xml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"CharacterEncodingFilter + DispatcherServlet\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u62e6\u622a\u5668\uff1aspring-mvc.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mvc:annotation-driven/>\n<context:component-scan base-package="interceptor,controller"/>\n<mvc:interceptors>\n    <mvc:interceptor>\n        <mvc:mapping path="/handleRun"/>\n        <bean class="interceptor.MyInterceptor"/>\n    </mvc:interceptor>\n</mvc:interceptors>\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a\u914d\u7f6e\u987a\u5e8f\u4e3a",(0,i.jsx)(e.strong,{children:"\u5148\u914d\u7f6e\u6267\u884c\u4f4d\u7f6e\uff0c\u540e\u914d\u7f6e\u6267\u884c\u7c7b"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u5f02\u5e38\u5904\u7406-1",children:"\u5f02\u5e38\u5904\u7406"}),"\n",(0,i.jsx)(e.h3,{id:"\u5904\u7406\u5668-1",children:"\u5904\u7406\u5668"}),"\n",(0,i.jsxs)(e.p,{children:["\u5f02\u5e38\u5904\u7406\u5668\uff1a ",(0,i.jsx)(e.strong,{children:"HandlerExceptionResolver"})," \u63a5\u53e3"]}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u7ee7\u627f\u8be5\u63a5\u53e3\u7684\u4ee5\u540e\uff0c\u5f53\u5f00\u53d1\u51fa\u73b0\u5f02\u5e38\u540e\u4f1a\u6267\u884c\u6307\u5b9a\u7684\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\npublic class ExceptionResolver implements HandlerExceptionResolver {\n    @Override\n    public ModelAndView resolveException(HttpServletRequest request,\n                                         HttpServletResponse response,\n                                         Object handler,\n                                         Exception ex) {\n        System.out.println("\u5f02\u5e38\u5904\u7406\u5668\u6b63\u5728\u6267\u884c\u4e2d");\n        ModelAndView modelAndView = new ModelAndView();\n        //\u5b9a\u4e49\u5f02\u5e38\u73b0\u8c61\u51fa\u73b0\u540e\uff0c\u53cd\u9988\u7ed9\u7528\u6237\u67e5\u770b\u7684\u4fe1\u606f\n        modelAndView.addObject("msg","\u51fa\u9519\u5566\uff01 ");\n        //\u5b9a\u4e49\u5f02\u5e38\u73b0\u8c61\u51fa\u73b0\u540e\uff0c\u53cd\u9988\u7ed9\u7528\u6237\u67e5\u770b\u7684\u9875\u9762\n        modelAndView.setViewName("error.jsp");\n        return modelAndView;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6839\u636e\u5f02\u5e38\u7684\u79cd\u7c7b\u4e0d\u540c\uff0c\u8fdb\u884c\u5206\u95e8\u522b\u7c7b\u7684\u7ba1\u7406\uff0c\u8fd4\u56de\u4e0d\u540c\u7684\u4fe1\u606f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class ExceptionResolver implements HandlerExceptionResolver {\n    @Override\n    public ModelAndView resolveException(HttpServletRequest request,\n                                         HttpServletResponse response,\n                                         Object handler,\n                                         Exception ex) {\n        System.out.println("my exception is running ...." + ex);\n        ModelAndView modelAndView = new ModelAndView();\n        if( ex instanceof NullPointerException){\n            modelAndView.addObject("msg","\u7a7a\u6307\u9488\u5f02\u5e38");\n        }else if ( ex instanceof  ArithmeticException){\n            modelAndView.addObject("msg","\u7b97\u6570\u8fd0\u7b97\u5f02\u5e38");\n        }else{\n            modelAndView.addObject("msg","\u672a\u77e5\u7684\u5f02\u5e38");\n        }\n        modelAndView.setViewName("error.jsp");\n        return modelAndView;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6a21\u62df\u9519\u8bef\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class UserController {\n    @RequestMapping("/save")\n    @ResponseBody\n    public String save(@RequestBody String name) {\n        //\u6a21\u62df\u4e1a\u52a1\u5c42\u53d1\u8d77\u8c03\u7528\u4ea7\u751f\u4e86\u5f02\u5e38\n//        int i = 1/0;\n//        String str = null;\n//        str.length();\n\n        return "error.jsp";\n    }\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6ce8\u89e3\u5f00\u53d1-3",children:"\u6ce8\u89e3\u5f00\u53d1"}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u6ce8\u89e3\u5b9e\u73b0\u5f02\u5e38\u5206\u7c7b\u7ba1\u7406\uff0c\u5f00\u53d1\u5f02\u5e38\u5904\u7406\u5668"}),"\n",(0,i.jsx)(e.p,{children:"@ControllerAdvice \u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5f02\u5e38\u5904\u7406\u5668\u7c7b\u4e0a\u65b9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5f53\u524d\u7c7b\u4e3a\u5f02\u5e38\u5904\u7406\u5668\u7c7b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Component\n//\u58f0\u660e\u8be5\u7c7b\u662f\u4e00\u4e2aController\u7684\u901a\u77e5\u7c7b\uff0c\u58f0\u660e\u540e\u8be5\u7c7b\u5c31\u4f1a\u88ab\u52a0\u8f7d\u6210\u5f02\u5e38\u5904\u7406\u5668\n@ControllerAdvice\npublic class ExceptionAdvice {\n}  \n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@ExceptionHandler \u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u65b9\u6cd5\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5f02\u5e38\u5904\u7406\u5668\u7c7b\u4e2d\u9488\u5bf9\u6307\u5b9a\u5f02\u5e38\u8fdb\u884c\u5904\u7406\u7684\u65b9\u6cd5\u4e0a\u65b9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u7f6e\u6307\u5b9a\u5f02\u5e38\u7684\u5904\u7406\u65b9\u5f0f"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a\u5904\u7406\u5668\u65b9\u6cd5\u53ef\u4ee5\u8bbe\u5b9a\u591a\u4e2a"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@ControllerAdvice\npublic class ExceptionAdvice {\n    //\u7c7b\u4e2d\u5b9a\u4e49\u7684\u65b9\u6cd5\u643a\u5e26@ExceptionHandler\u6ce8\u89e3\u7684\u4f1a\u88ab\u4f5c\u4e3a\u5f02\u5e38\u5904\u7406\u5668\uff0c\u540e\u9762\u6dfb\u52a0\u5b9e\u9645\u5904\u7406\u7684\u5f02\u5e38\u7c7b\u578b\n    @ExceptionHandler(NullPointerException.class)\n    @ResponseBody\n    public String doNullException(Exception ex){\n        return "\u7a7a\u6307\u9488\u5f02\u5e38";\n    }\n\n    @ExceptionHandler(Exception.class)\n    @ResponseBody\n    public String doException(Exception ex){\n        return "all Exception";\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"@ResponseStatus \u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u7c7b\u6ce8\u89e3\u3001\u65b9\u6cd5\u6ce8\u89e3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5f02\u5e38\u5904\u7406\u5668\u7c7b\u3001\u65b9\u6cd5\u4e0a\u65b9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\uff1a"}),"\n",(0,i.jsx)(e.p,{children:"value\uff1a\u51fa\u73b0\u9519\u8bef\u6307\u5b9a\u8fd4\u56de\u72b6\u6001\u7801"}),"\n",(0,i.jsx)(e.p,{children:"reason\uff1a\u51fa\u73b0\u9519\u8bef\u8fd4\u56de\u7684\u9519\u8bef\u4fe1\u606f"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u89e3\u51b3\u65b9\u6848",children:"\u89e3\u51b3\u65b9\u6848"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"web.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"DispatcherServlet + CharacterEncodingFilter\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ajax.jsp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-jsp",children:'<%@page pageEncoding="UTF-8" language="java" contentType="text/html;UTF-8" %>\n\n<a href="javascript:void(0);" id="testException">\u70b9\u51fb</a><br/>\n\n<script type="text/javascript" src="${pageContext.request.contextPath}/js/jquery-3.3.1.min.js"><\/script>\n<script type="text/javascript">\n    $(function () {\n        $("#testException").click(function(){\n            $.ajax({\n                contentType:"application/json",\n                type:"POST",\n                url:"save",\n                /*\u901a\u8fc7\u4fee\u6539\u53c2\u6570\uff0c\u6fc0\u6d3b\u81ea\u5b9a\u4e49\u5f02\u5e38\u7684\u51fa\u73b0*/\n                // name\u957f\u5ea6\u4f4e\u4e8e8\u4f4d\u51fa\u73b0\u4e1a\u52a1\u5f02\u5e38\n                // age\u5c0f\u4e8e0\u51fa\u73b0\u4e1a\u52a1\u5f02\u5e38\n                // age\u5927\u4e8e100\u51fa\u73b0\u7cfb\u7edf\u5f02\u5e38\n                // age\u7c7b\u578b\u5982\u679c\u65e0\u6cd5\u5339\u914d\u5c06\u8f6c\u5165\u5176\u4ed6\u7c7b\u522b\u5f02\u5e38\n                data:\'{"name":"JockSuperMan","age":"-1"}\',\n                dataType:"text",\n                //\u56de\u8c03\u51fd\u6570\n                success:function(data){\n                    alert(data);\n                }\n            });\n        });\n    });\n<\/script>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"spring-mvc.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<mvc:annotation-driven/>\n<context:component-scan base-package="com.seazean"/>\n<mvc:resources mapping="/js/**" location="/js/"/>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"java / controller / UserController"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class UserController {\n    @RequestMapping("/save")\n    @ResponseBody\n    public List<User> save(@RequestBody User user) {\n        System.out.println("user controller save is running ...");\n        //\u5bf9\u7528\u6237\u7684\u975e\u6cd5\u64cd\u4f5c\u8fdb\u884c\u5224\u5b9a\uff0c\u5e76\u5305\u88c5\u6210\u5f02\u5e38\u5bf9\u8c61\u8fdb\u884c\u5904\u7406\uff0c\u4fbf\u4e8e\u7edf\u4e00\u7ba1\u7406\n        if(user.getName().trim().length() < 8){\n            throw new BusinessException("\u5bf9\u4e0d\u8d77\uff0c\u7528\u6237\u540d\u957f\u5ea6\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\uff01");\n        }\n        if(user.getAge() < 0){\n            throw new BusinessException("\u5bf9\u4e0d\u8d77\uff0c\u5e74\u9f84\u5fc5\u987b\u662f0\u5230100\u4e4b\u95f4\u7684\u6570\u5b57\uff01");\n        }\n        if(user.getAge() > 100){\n            throw new SystemException("\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u5c3d\u5feb\u68c0\u67e5\u5904\u7406\uff01");\n        }\n\n        User u1 = new User("Tom",3);\n        User u2 = new User("Jerry",5);\n        ArrayList<User> al = new ArrayList<User>();\n        al.add(u1);al.add(u2);\n        return al;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u5f02\u5e38"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u81ea\u5b9a\u4e49\u5f02\u5e38\u7ee7\u627fRuntimeException\uff0c\u8986\u76d6\u7236\u7c7b\u6240\u6709\u7684\u6784\u9020\u65b9\u6cd5\npublic class BusinessException extends RuntimeException {\u8986\u76d6\u7236\u7c7b\u6240\u6709\u7684\u6784\u9020\u65b9\u6cd5}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class SystemException extends RuntimeException {}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u81ea\u5b9a\u4e49\u5f02\u5e38\u5c06\u6240\u6709\u7684\u5f02\u5e38\u73b0\u8c61\u8fdb\u884c\u5206\u7c7b\u7ba1\u7406\uff0c\u4ee5\u7edf\u4e00\u7684\u683c\u5f0f\u5bf9\u5916\u5448\u73b0\u5f02\u5e38\u6d88\u606f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@ControllerAdvice\npublic class ProjectExceptionAdvice {\n    @ExceptionHandler(BusinessException.class)\n    public String doBusinessException(Exception ex, Model m){\n        //\u4f7f\u7528\u53c2\u6570Model\u5c06\u8981\u4fdd\u5b58\u7684\u6570\u636e\u4f20\u9012\u5230\u9875\u9762\u4e0a\uff0c\u529f\u80fd\u7b49\u540c\u4e8eModelAndView\n        //\u4e1a\u52a1\u5f02\u5e38\u51fa\u73b0\u7684\u6d88\u606f\u8981\u53d1\u9001\u7ed9\u7528\u6237\u67e5\u770b\n        m.addAttribute("msg",ex.getMessage());\n        return "error.jsp";\n    }\n\n    @ExceptionHandler(SystemException.class)\n    public String doSystemException(Exception ex, Model m){\n        //\u7cfb\u7edf\u5f02\u5e38\u51fa\u73b0\u7684\u6d88\u606f\u4e0d\u8981\u53d1\u9001\u7ed9\u7528\u6237\u67e5\u770b\uff0c\u53d1\u9001\u7edf\u4e00\u7684\u4fe1\u606f\u7ed9\u7528\u6237\u770b\n        m.addAttribute("msg","\u670d\u52a1\u5668\u51fa\u73b0\u95ee\u9898\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\uff01");\n        return "error.jsp";\n    }\n\n    @ExceptionHandler(Exception.class)\n    public String doException(Exception ex, Model m){\n        m.addAttribute("msg",ex.getMessage());\n        //\u5c06ex\u5bf9\u8c61\u4fdd\u5b58\u8d77\u6765\n        return "error.jsp";\n    }\n\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u6587\u4ef6\u4f20\u8f93",children:"\u6587\u4ef6\u4f20\u8f93"}),"\n",(0,i.jsx)(e.h3,{id:"\u4e0a\u4f20\u4e0b\u8f7d",children:"\u4e0a\u4f20\u4e0b\u8f7d"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0a\u4f20\u6587\u4ef6\u8fc7\u7a0b\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(86403).A+"",width:"941",height:"412"})}),"\n",(0,i.jsx)(e.p,{children:"MultipartResolver\u63a5\u53e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"MultipartResolver \u63a5\u53e3\u5b9a\u4e49\u4e86\u6587\u4ef6\u4e0a\u4f20\u8fc7\u7a0b\u4e2d\u7684\u76f8\u5173\u64cd\u4f5c\uff0c\u5e76\u5bf9\u901a\u7528\u6027\u64cd\u4f5c\u8fdb\u884c\u4e86\u5c01\u88c5"}),"\n",(0,i.jsx)(e.li,{children:"MultipartResolver \u63a5\u53e3\u5e95\u5c42\u5b9e\u73b0\u7c7b CommonsMultipartResovler"}),"\n",(0,i.jsx)(e.li,{children:"CommonsMultipartResovler \u5e76\u672a\u81ea\u4e3b\u5b9e\u73b0\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u5bf9\u5e94\u7684\u529f\u80fd\uff0c\u800c\u662f\u8c03\u7528\u4e86 apache \u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u7ec4\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5750\u6807"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>commons-fileupload</groupId>\n    <artifactId>commons-fileupload</artifactId>\n    <version>1.4</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9875\u9762\u8868\u5355 fileupload.jsp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<form method="post" action="/upload" enctype="multipart/form-data">\n    <input type="file" name="file"><br>\n    <input type="submit" value="\u63d0\u4ea4">\n</form>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"web.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"DispatcherServlet + CharacterEncodingFilter\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u63a7\u5236\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@PostMapping("/upload")\npublic String upload(@RequestParam("email") String email,\n                     @RequestParam("username") String username,\n                     @RequestPart("headerImg") MultipartFile headerImg) throws IOException {\n\n    if(!headerImg.isEmpty()){\n        //\u4fdd\u5b58\u5230\u6587\u4ef6\u670d\u52a1\u5668\uff0cOSS\u670d\u52a1\u5668\n        String originalFilename = headerImg.getOriginalFilename();\n        headerImg.transferTo(new File("H:\\\\cache\\\\" + originalFilename));\n    }\n    return "main";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u540d\u79f0\u95ee\u9898",children:"\u540d\u79f0\u95ee\u9898"}),"\n",(0,i.jsx)(e.p,{children:"MultipartFile \u53c2\u6570\u4e2d\u5c01\u88c5\u4e86\u4e0a\u4f20\u7684\u6587\u4ef6\u7684\u76f8\u5173\u4fe1\u606f\u3002"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6587\u4ef6\u547d\u540d\u95ee\u9898\uff0c \u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u540d\uff0c\u5e76\u89e3\u6790\u6587\u4ef6\u540d\u4e0e\u6269\u5c55\u540d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"file.getOriginalFilename();\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6587\u4ef6\u540d\u8fc7\u957f\u95ee\u9898"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6587\u4ef6\u4fdd\u5b58\u8def\u5f84"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'ServletContext context = request.getServletContext();\nString realPath = context.getRealPath("/uploads");\nFile file = new File(realPath + "/");\nif(!file.exists()) file.mkdirs();\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u91cd\u540d\u95ee\u9898"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'String uuid = UUID.randomUUID.toString().replace("-", "").toUpperCase();\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class FileUploadController {\n    @RequestMapping(value = "/fileupload")\n\t//\u53c2\u6570\u4e2d\u5b9a\u4e49MultipartFile\u53c2\u6570\uff0c\u7528\u4e8e\u63a5\u6536\u9875\u9762\u63d0\u4ea4\u7684type=file\u7c7b\u578b\u7684\u8868\u5355\uff0c\u8868\u5355\u540d\u79f0\u4e0e\u53c2\u6570\u540d\u76f8\u540c\n    public String fileupload(MultipartFile file,MultipartFile file1,MultipartFile file2, HttpServletRequest request) throws IOException {\n        System.out.println("file upload is running ..."+file);\n//        MultipartFile\u53c2\u6570\u4e2d\u5c01\u88c5\u4e86\u4e0a\u4f20\u7684\u6587\u4ef6\u7684\u76f8\u5173\u4fe1\u606f\n//        System.out.println(file.getSize());\n//        System.out.println(file.getBytes().length);\n//        System.out.println(file.getContentType());\n//        System.out.println(file.getName());\n//        System.out.println(file.getOriginalFilename());\n//        System.out.println(file.isEmpty());\n        //\u9996\u5148\u5224\u65ad\u662f\u5426\u662f\u7a7a\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u5b58\u50a8\u7a7a\u95f4\u5360\u7528\u4e3a0\u7684\u6587\u4ef6\n        if(!file.isEmpty()){\n            //\u5982\u679c\u5927\u5c0f\u5728\u8303\u56f4\u8981\u6c42\u5185\u6b63\u5e38\u5904\u7406\uff0c\u5426\u5219\u629b\u51fa\u81ea\u5b9a\u4e49\u5f02\u5e38\u544a\u77e5\u7528\u6237\uff08\u672a\u5b9e\u73b0\uff09\n            //\u83b7\u53d6\u539f\u59cb\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5f53\u524d\u6587\u4ef6\u7684\u771f\u5b9e\u540d\u79f0\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u4e2d\u5907\u7528\n            String fileName = file.getOriginalFilename();\n            //\u8bbe\u7f6e\u4fdd\u5b58\u7684\u8def\u5f84\n            String realPath = request.getServletContext().getRealPath("/images");\n            //\u4fdd\u5b58\u6587\u4ef6\u7684\u65b9\u6cd5\uff0c\u901a\u5e38\u6587\u4ef6\u540d\u4f7f\u7528\u968f\u673a\u751f\u6210\u7b56\u7565\u4ea7\u751f\uff0c\u907f\u514d\u6587\u4ef6\u540d\u51b2\u7a81\u95ee\u9898\n            file.transferTo(new File(realPath,file.getOriginalFilename()));\n        }\n        //\u6d4b\u8bd5\u4e00\u6b21\u6027\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\n        if(!file1.isEmpty()){\n            String fileName = file1.getOriginalFilename();\n            //\u53ef\u4ee5\u6839\u636e\u9700\u8981\uff0c\u5bf9\u4e0d\u540c\u79cd\u7c7b\u7684\u6587\u4ef6\u505a\u4e0d\u540c\u7684\u5b58\u50a8\u8def\u5f84\u7684\u533a\u5206\uff0c\u4fee\u6539\u5bf9\u5e94\u7684\u4fdd\u5b58\u4f4d\u7f6e\u5373\u53ef\n            String realPath = request.getServletContext().getRealPath("/images");\n            file1.transferTo(new File(realPath,file1.getOriginalFilename()));\n        }\n        if(!file2.isEmpty()){\n            String fileName = file2.getOriginalFilename();\n            String realPath = request.getServletContext().getRealPath("/images");\n            file2.transferTo(new File(realPath,file2.getOriginalFilename()));\n        }\n        return "page.jsp";\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6e90\u7801\u89e3\u6790-3",children:"\u6e90\u7801\u89e3\u6790"}),"\n",(0,i.jsx)(e.p,{children:"StandardServletMultipartResolver \u662f\u6587\u4ef6\u4e0a\u4f20\u89e3\u6790\u5668"}),"\n",(0,i.jsx)(e.p,{children:"DispatcherServlet#doDispatch\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception {\n    // \u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u4e0d\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\n    processedRequest = checkMultipart(request);\n    // \u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\u4f1a\u5bf9 request \u8fdb\u884c\u5305\u88c5\uff0c\u5bfc\u81f4\u4e24\u8005\u4e0d\u76f8\u7b49\uff0c\u6b64\u5904\u8d4b\u503c\u4e3a true\uff0c\u4ee3\u8868\u5df2\u7ecf\u88ab\u89e3\u6790\n    multipartRequestParsed = (processedRequest != request);\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"DispatcherServlet#checkMultipart\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"if (this.multipartResolver != null && this.multipartResolver.isMultipart(request))"}),"\uff1a\u5224\u65ad\u662f\u5426\u662f\u6587\u4ef6\u8bf7\u6c42\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"StandardServletMultipartResolver#isMultipart"}),"\uff1a\u6839\u636e\u5f00\u5934\u662f\u5426\u7b26\u5408 multipart/form-data \u6216\u8005 multipart/"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return this.multipartResolver.resolveMultipart(request)"}),"\uff1a\u628a\u8bf7\u6c42\u5c01\u88c5\u6210 StandardMultipartHttpServletRequest \u5bf9\u8c61"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u59cb\u6267\u884c ha.handle() \u76ee\u6807\u65b9\u6cd5\u8fdb\u884c\u6570\u636e\u7684\u89e3\u6790"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RequestPartMethodArgumentResolver#supportsParameter\uff1a\u652f\u6301\u89e3\u6790\u6587\u4ef6\u4e0a\u4f20\u6570\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public boolean supportsParameter(MethodParameter parameter) {\n    // \u53c2\u6570\u4e0a\u6709 @RequestPart \u6ce8\u89e3\n    if (parameter.hasParameterAnnotation(RequestPart.class)) {\n        return true;\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RequestPartMethodArgumentResolver#resolveArgument\uff1a\u89e3\u6790\u53c2\u6570\u6570\u636e\uff0c\u5c01\u88c5\u6210 MultipartFile \u5bf9\u8c61"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RequestPart requestPart = parameter.getParameterAnnotation(RequestPart.class)"}),"\uff1a\u83b7\u53d6\u6ce8\u89e3\u7684\u76f8\u5173\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"String name = getPartName(parameter, requestPart)"}),"\uff1a\u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u7684\u540d\u5b57"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Object mpArg = MultipartResolutionDelegate.resolveMultipartArgument()"}),"\uff1a\u89e3\u6790\u53c2\u6570\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"List<MultipartFile> files = multipartRequest.getFiles(name)"}),"\uff1a\u83b7\u53d6\u6587\u4ef6\u7684\u6240\u6709\u6570\u636e"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return doInvoke(args)"}),"\uff1a\u89e3\u6790\u5b8c\u6210\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u65b9\u6cd5\uff0c\u5b8c\u6210\u4e0a\u4f20\u529f\u80fd"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u5b9e\u7528\u6280\u672f",children:"\u5b9e\u7528\u6280\u672f"}),"\n",(0,i.jsx)(e.h3,{id:"\u6821\u9a8c\u6846\u67b6",children:"\u6821\u9a8c\u6846\u67b6"}),"\n",(0,i.jsx)(e.h4,{id:"\u6821\u9a8c\u6982\u8ff0",children:"\u6821\u9a8c\u6982\u8ff0"}),"\n",(0,i.jsx)(e.p,{children:"\u8868\u5355\u6821\u9a8c\u4fdd\u969c\u4e86\u6570\u636e\u6709\u6548\u6027\u3001\u5b89\u5168\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u6821\u9a8c\u5206\u7c7b\uff1a\u5ba2\u6237\u7aef\u6821\u9a8c\u548c\u670d\u52a1\u7aef\u6821\u9a8c"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u683c\u5f0f\u6821\u9a8c\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5ba2\u6237\u7aef\uff1a\u4f7f\u7528 js \u6280\u672f\uff0c\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u6821\u9a8c"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7aef\uff1a\u4f7f\u7528\u6821\u9a8c\u6846\u67b6"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u903b\u8f91\u6821\u9a8c\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5ba2\u6237\u7aef\uff1a\u4f7f\u7528ajax\u53d1\u9001\u8981\u6821\u9a8c\u7684\u6570\u636e\uff0c\u5728\u670d\u52a1\u7aef\u5b8c\u6210\u903b\u8f91\u6821\u9a8c\uff0c\u8fd4\u56de\u6821\u9a8c\u7ed3\u679c"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7aef\uff1a\u63a5\u6536\u5230\u5b8c\u6574\u7684\u8bf7\u6c42\u540e\uff0c\u5728\u6267\u884c\u4e1a\u52a1\u64cd\u4f5c\u524d\uff0c\u5b8c\u6210\u903b\u8f91\u6821\u9a8c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8868\u5355\u6821\u9a8c\u6846\u67b6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JSR\uff08Java Specification Requests\uff09\uff1aJava \u89c4\u8303\u63d0\u6848"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"303\uff1a\u63d0\u4f9bbean\u5c5e\u6027\u76f8\u5173\u6821\u9a8c\u89c4\u5219"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JCP\uff08Java Community Process\uff09\uff1aJava\u793e\u533a"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Hibernate\u6846\u67b6\u4e2d\u5305\u542b\u4e00\u5957\u72ec\u7acb\u7684\u6821\u9a8c\u6846\u67b6hibernate-validator"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5750\u6807\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u5bfc\u5165\u6821\u9a8c\u7684jsr303\u89c4\u8303--\x3e\n<dependency>\n    <groupId>javax.validation</groupId>\n    <artifactId>validation-api</artifactId>\n    <version>2.0.1.Final</version>\n</dependency>\n\x3c!--\u5bfc\u5165\u6821\u9a8c\u6846\u67b6\u5b9e\u73b0\u6280\u672f--\x3e\n<dependency>\n    <groupId>org.hibernate</groupId>\n    <artifactId>hibernate-validator</artifactId>\n    <version>6.1.0.Final</version>\n</dependency>\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6ce8\u610f\uff1a"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["tomcat7\uff1a\u642d\u914d hibernate-validator \u7248\u672c 5.",(0,i.jsx)(e.em,{children:"."}),".Final"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["tomcat8.5\uff1a\u642d\u914d hibernate-validator \u7248\u672c 6.",(0,i.jsx)(e.em,{children:"."}),".Final"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.h5,{id:"\u5f00\u542f\u6821\u9a8c",children:"\u5f00\u542f\u6821\u9a8c"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Valid\u3001@Validated"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5f62\u53c2\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5904\u7406\u5668\u7c7b\u4e2d\u7684\u5b9e\u4f53\u7c7b\u7c7b\u578b\u7684\u65b9\u6cd5\u5f62\u53c2\u524d\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u5b9a\u5bf9\u5f53\u524d\u5b9e\u4f53\u7c7b\u7c7b\u578b\u53c2\u6570\u8fdb\u884c\u6821\u9a8c"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping(value = "/addemployee")\npublic String addEmployee(@Valid Employee employee) {\n    System.out.println(employee);\n}\n'})}),"\n",(0,i.jsx)(e.h5,{id:"\u6821\u9a8c\u89c4\u5219",children:"\u6821\u9a8c\u89c4\u5219"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@NotNull"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5c5e\u6027\u6ce8\u89e3\u7b49"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5b9e\u4f53\u7c7b\u5c5e\u6027\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u5b9a\u5f53\u524d\u5c5e\u6027\u6821\u9a8c\u89c4\u5219"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a\u6bcf\u4e2a\u6821\u9a8c\u89c4\u5219\u6240\u643a\u5e26\u7684\u53c2\u6570\u4e0d\u540c\uff0c\u6839\u636e\u6821\u9a8c\u89c4\u5219\u8fdb\u884c\u76f8\u5e94\u7684\u8c03\u6574\uff0c\u5177\u4f53\u7684\u6821\u9a8c\u89c4\u5219\u67e5\u770b\u5bf9\u5e94\u7684\u6821\u9a8c\u6846\u67b6\u8fdb\u884c\u83b7\u53d6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Employee{\n    @NotNull(message = "\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a")\n    private String name;//\u5458\u5de5\u59d3\u540d\n}  \n'})}),"\n",(0,i.jsx)(e.h5,{id:"\u9519\u8bef\u4fe1\u606f",children:"\u9519\u8bef\u4fe1\u606f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RequestMapping(value = "/addemployee")\n//Errors\u5bf9\u8c61\u7528\u4e8e\u5c01\u88c5\u6821\u9a8c\u7ed3\u679c\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u6821\u9a8c\u89c4\u5219\uff0c\u5bf9\u5e94\u7684\u6821\u9a8c\u7ed3\u679c\u5c01\u88c5\u5230\u8be5\u5bf9\u8c61\u4e2d\uff0c\u5305\u542b\u6821\u9a8c\u7684\u5c5e\u6027\u540d\u548c\u6821\u9a8c\u4e0d\u901a\u8fc7\u8fd4\u56de\u7684\u6d88\u606f\npublic String addEmployee(@Valid Employee employee, Errors errors, Model model){\n    System.out.println(employee);\n    //\u5224\u5b9aErrors\u5bf9\u8c61\u4e2d\u662f\u5426\u5b58\u5728\u672a\u901a\u8fc7\u6821\u9a8c\u7684\u5b57\u6bb5\n    if(errors.hasErrors()){\n        for(FieldError error : errors.getFieldErrors()){\n        \t//\u5c06\u6821\u9a8c\u7ed3\u679c\u6dfb\u52a0\u5230Model\u5bf9\u8c61\u4e2d\uff0c\u7528\u4e8e\u9875\u9762\u663e\u793a\uff0c\u8fd4\u56dejson\u6570\u636e\u5373\u53ef\n            model.addAttribute(error.getField(),error.getDefaultMessage());\n        }\n        //\u5f53\u51fa\u73b0\u672a\u901a\u8fc7\u6821\u9a8c\u7684\u5b57\u6bb5\u65f6\uff0c\u8df3\u8f6c\u9875\u9762\u5230\u539f\u59cb\u9875\u9762\uff0c\u8fdb\u884c\u6570\u636e\u56de\u663e\n        return "addemployee.jsp";\n    }\n    return "success.jsp";\n}  \n'})}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u5f62\u53c2Errors\u83b7\u53d6\u6821\u9a8c\u7ed3\u679c\u6570\u636e\uff0c\u901a\u8fc7Model\u63a5\u53e3\u5c06\u6570\u636e\u5c01\u88c5\u540e\u4f20\u9012\u5230\u9875\u9762\u663e\u793a\uff0c\u9875\u9762\u83b7\u53d6\u540e\u53f0\u5c01\u88c5\u7684\u6821\u9a8c\u7ed3\u679c\u4fe1\u606f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<form action="/addemployee" method="post">\n    \u5458\u5de5\u59d3\u540d\uff1a<input type="text" name="name"><span style="color:red">${name}</span><br/>\n    \u5458\u5de5\u5e74\u9f84\uff1a<input type="text" name="age"><span style="color:red">${age}</span><br/>\n    <input type="submit" value="\u63d0\u4ea4">\n</form>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u591a\u89c4\u5219\u6821\u9a8c",children:"\u591a\u89c4\u5219\u6821\u9a8c"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540c\u4e00\u4e2a\u5c5e\u6027\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u6821\u9a8c\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Employee{\n    @NotBlank(message = "\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a")\n    private String name;//\u5458\u5de5\u59d3\u540d\n\n    @NotNull(message = "\u8bf7\u8f93\u5165\u5e74\u9f84")\n    @Max(value = 60,message = "\u5e74\u9f84\u6700\u5927\u503c60")\n    @Min(value = 18,message = "\u5e74\u9f84\u6700\u5c0f\u503c18")\n    private Integer age;//\u5458\u5de5\u5e74\u9f84\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4e09\u79cd\u5224\u5b9a\u7a7a\u6821\u9a8c\u5668\u7684\u533a\u522b\n",(0,i.jsx)(e.img,{src:s(17063).A+"",width:"680",height:"202"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5d4c\u5957\u6821\u9a8c",children:"\u5d4c\u5957\u6821\u9a8c"}),"\n",(0,i.jsx)(e.p,{children:"\u540d\u79f0\uff1a@Valid"}),"\n",(0,i.jsx)(e.p,{children:"\u7c7b\u578b\uff1a\u5c5e\u6027\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u4f4d\u7f6e\uff1a\u5b9e\u4f53\u7c7b\u4e2d\u7684\u5f15\u7528\u7c7b\u578b\u5c5e\u6027\u4e0a\u65b9"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u8bbe\u5b9a\u5f53\u524d\u5e94\u7528\u7c7b\u578b\u5c5e\u6027\u4e2d\u7684\u5c5e\u6027\u5f00\u542f\u6821\u9a8c"}),"\n",(0,i.jsx)(e.p,{children:"\u8303\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Employee {\n    //\u5b9e\u4f53\u7c7b\u4e2d\u7684\u5f15\u7528\u7c7b\u578b\u901a\u8fc7\u6807\u6ce8@Valid\u6ce8\u89e3\uff0c\u8bbe\u5b9a\u5f00\u542f\u5f53\u524d\u5f15\u7528\u7c7b\u578b\u5b57\u6bb5\u4e2d\u7684\u5c5e\u6027\u53c2\u4e0e\u6821\u9a8c\n    @Valid\n    private Address address;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5f00\u542f\u5d4c\u5957\u6821\u9a8c\u540e\uff0c\u88ab\u6821\u9a8c\u5bf9\u8c61\u5185\u90e8\u9700\u8981\u6dfb\u52a0\u5bf9\u5e94\u7684\u6821\u9a8c\u89c4\u5219"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u5d4c\u5957\u6821\u9a8c\u7684\u5b9e\u4f53\u4e2d\uff0c\u5bf9\u6bcf\u4e2a\u5c5e\u6027\u6b63\u5e38\u6dfb\u52a0\u6821\u9a8c\u89c4\u5219\u5373\u53ef\npublic class Address implements Serializable {\n    @NotBlank(message = "\u8bf7\u8f93\u5165\u7701\u4efd\u540d\u79f0")\n    private String provinceName;//\u7701\u4efd\u540d\u79f0\n\n    @NotBlank(message = "\u8bf7\u8f93\u5165\u90ae\u653f\u7f16\u7801")\n    @Size(max = 6,min = 6,message = "\u90ae\u653f\u7f16\u7801\u75316\u4f4d\u7ec4\u6210")\n    private String zipCode;//\u90ae\u653f\u7f16\u7801\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5206\u7ec4\u6821\u9a8c",children:"\u5206\u7ec4\u6821\u9a8c"}),"\n",(0,i.jsx)(e.p,{children:"\u5206\u7ec4\u6821\u9a8c\u7684\u4ecb\u7ecd"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u540c\u4e00\u4e2a\u6a21\u5757\uff0c\u6839\u636e\u6267\u884c\u7684\u4e1a\u52a1\u4e0d\u540c\uff0c\u9700\u8981\u6821\u9a8c\u7684\u5c5e\u6027\u4f1a\u6709\u4e0d\u540c\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u65b0\u589e\u7528\u6237"}),"\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539\u7528\u6237"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5bf9\u4e0d\u540c\u79cd\u7c7b\u7684\u5c5e\u6027\u8fdb\u884c\u5206\u7ec4\uff0c\u5728\u6821\u9a8c\u65f6\u53ef\u4ee5\u6307\u5b9a\u53c2\u4e0e\u6821\u9a8c\u7684\u5b57\u6bb5\u6240\u5c5e\u7684\u7ec4\u7c7b\u522b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5b9a\u4e49\u7ec4\uff08\u901a\u7528\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u4e3a\u5c5e\u6027\u8bbe\u7f6e\u6240\u5c5e\u7ec4\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a"}),"\n",(0,i.jsx)(e.li,{children:"\u5f00\u542f\u7ec4\u6821\u9a8c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"domain\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u7528\u4e8e\u8bbe\u5b9a\u5206\u7ec4\u6821\u9a8c\u4e2d\u7684\u7ec4\u540d\uff0c\u5f53\u524d\u63a5\u53e3\u4ec5\u63d0\u4f9b\u5b57\u8282\u7801\uff0c\u7528\u4e8e\u8bc6\u522b\npublic interface GroupOne {\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class Employee{\n    @NotBlank(message = "\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a",groups = {GroupA.class})\n    private String name;//\u5458\u5de5\u59d3\u540d\n\n    @NotNull(message = "\u8bf7\u8f93\u5165\u5e74\u9f84",groups = {GroupA.class})\n    @Max(value = 60,message = "\u5e74\u9f84\u6700\u5927\u503c60")//\u4e0d\u52a0Group\u7684\u6821\u9a8c\u4e0d\u751f\u6548\n    @Min(value = 18,message = "\u5e74\u9f84\u6700\u5c0f\u503c18")\n    private Integer age;//\u5458\u5de5\u5e74\u9f84\n\n    @Valid\n    private Address address;\n    //......\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Controller\npublic class EmployeeController {\n    @RequestMapping(value = "/addemployee")\n    public String addEmployee(@Validated({GroupA.class}) Employee employee, Errors errors, Model m){\n        if(errors.hasErrors()){\n            List<FieldError> fieldErrors = errors.getFieldErrors();\n            System.out.println(fieldErrors.size());\n            for(FieldError error : fieldErrors){\n                m.addAttribute(error.getField(),error.getDefaultMessage());\n            }\n            return "addemployee.jsp";\n        }\n        return "success.jsp";\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"jsp\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<form action="/addemployee" method="post"><%--\u9875\u9762\u4f7f\u7528${}\u83b7\u53d6\u540e\u53f0\u4f20\u9012\u7684\u6821\u9a8c\u4fe1\u606f--%>\n    \u5458\u5de5\u59d3\u540d\uff1a<input type="text" name="name"><span style="color:red">${name}</span><br/>\n    \u5458\u5de5\u5e74\u9f84\uff1a<input type="text" name="age"><span style="color:red">${age}</span><br/>\n    <%--\u6ce8\u610f\uff0c\u5f15\u7528\u7c7b\u578b\u7684\u6821\u9a8c\u672a\u901a\u8fc7\u4fe1\u606f\u4e0d\u662f\u901a\u8fc7\u5bf9\u8c61\u8fdb\u884c\u5c01\u88c5\u7684\uff0c\u76f4\u63a5\u4f7f\u7528\u5bf9\u8c61\u540d.\u5c5e\u6027\u540d\u7684\u683c\u5f0f\u4f5c\u4e3a\u6574\u4f53\u5c5e\u6027\u5b57\u7b26\u4e32\u8fdb\u884c\u4fdd\u5b58\u7684\uff0c\u548c\u4f7f\u7528\u8005\u7684\u5c5e\u6027\u4f20\u9012\u65b9\u5f0f\u6709\u5173\uff0c\u4e0d\u5177\u6709\u901a\u7528\u6027\uff0c\u4ec5\u9002\u7528\u4e8e\u672c\u6848\u4f8b--%>\n    \u7701\uff1a<input type="text" name="address.provinceName"><span style="color:red">${requestScope[\'address.provinceName\']}</span><br/>\n        <input type="submit" value="\u63d0\u4ea4">\n/form>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"lombok",children:"Lombok"}),"\n",(0,i.jsx)(e.p,{children:"Lombok \u7528\u6807\u7b7e\u65b9\u5f0f\u4ee3\u66ff\u6784\u9020\u5668\u3001getter/setter\u3001toString() \u7b49\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165\u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.projectlombok</groupId>\n    <artifactId>lombok</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u8f7d\u63d2\u4ef6\uff1aIDEA \u4e2d File \u2192 Settings \u2192 Plugins\uff0c\u641c\u7d22\u5b89\u88c5 Lombok \u63d2\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u5e38\u7528\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@NoArgsConstructor\t\t// \u65e0\u53c2\u6784\u9020\n@AllArgsConstructor\t\t// \u5168\u53c2\u6784\u9020\n@Data\t\t\t\t\t// set + get\n@ToString\t\t\t\t// toString\n@EqualsAndHashCode\t\t// hashConde + equals\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7b80\u5316\u65e5\u5fd7\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Slf4j\n@RestController\npublic class HelloController {\n    @RequestMapping("/hello")\n    public String handle01(@RequestParam("name") String name){\n        log.info("\u8bf7\u6c42\u8fdb\u6765\u4e86....");\n        return "Hello, Spring!" + "\u4f60\u597d\uff1a" + name;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h1,{id:"boot",children:"Boot"}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u4ecb\u7ecd-6",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.h3,{id:"boot\u4ecb\u7ecd",children:"Boot\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u63d0\u4f9b\u4e86\u4e00\u79cd\u5feb\u901f\u4f7f\u7528 Spring \u7684\u65b9\u5f0f\uff0c\u57fa\u4e8e\u7ea6\u5b9a\u4f18\u4e8e\u914d\u7f6e\u7684\u601d\u60f3\uff0c\u53ef\u4ee5\u8ba9\u5f00\u53d1\u4eba\u5458\u4e0d\u5fc5\u5728\u914d\u7f6e\u4e0e\u903b\u8f91\u4e1a\u52a1\u4e4b\u95f4\u8fdb\u884c\u601d\u7ef4\u7684\u5207\u6362\uff0c\u5168\u8eab\u5fc3\u7684\u6295\u5165\u5230\u903b\u8f91\u4e1a\u52a1\u7684\u4ee3\u7801\u7f16\u5199\u4e2d\uff0c\u4ece\u800c\u5927\u5927\u63d0\u9ad8\u4e86\u5f00\u53d1\u7684\u6548\u7387"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u529f\u80fd\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u52a8\u914d\u7f6e\uff0c\u81ea\u52a8\u914d\u7f6e\u662f\u4e00\u4e2a\u8fd0\u884c\u65f6\uff08\u66f4\u51c6\u786e\u5730\u8bf4\uff0c\u662f\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff09\u7684\u8fc7\u7a0b\uff0c\u8003\u8651\u4e86\u4f17\u591a\u56e0\u7d20\u9009\u62e9\u4f7f\u7528\u54ea\u4e2a\u914d\u7f6e\uff0c\u8be5\u8fc7\u7a0b\u662fSpringBoot \u81ea\u52a8\u5b8c\u6210\u7684"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8d77\u6b65\u4f9d\u8d56\uff0c\u8d77\u6b65\u4f9d\u8d56\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a Maven \u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08Project Object Model\uff0cPOM\uff09\uff0c\u5b9a\u4e49\u4e86\u5bf9\u5176\u4ed6\u5e93\u7684\u4f20\u9012\u4f9d\u8d56\uff0c\u8fd9\u4e9b\u4e1c\u897f\u52a0\u5728\u4e00\u8d77\u5373\u652f\u6301\u67d0\u9879\u529f\u80fd\u3002\u7b80\u5355\u7684\u8bf4\uff0c\u8d77\u6b65\u4f9d\u8d56\u5c31\u662f\u5c06\u5177\u5907\u67d0\u79cd\u529f\u80fd\u7684\u5750\u6807\u6253\u5305\u5230\u4e00\u8d77\uff0c\u5e76\u63d0\u4f9b\u4e00\u4e9b\u9ed8\u8ba4\u7684\u529f\u80fd"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8f85\u52a9\u529f\u80fd\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5927\u578b\u9879\u76ee\u4e2d\u5e38\u89c1\u7684\u975e\u529f\u80fd\u6027\u7279\u6027\uff0c\u5982\u5185\u5d4c web \u670d\u52a1\u5668\u3001\u5b89\u5168\u3001\u6307\u6807\uff0c\u5065\u5eb7\u68c0\u6d4b\u3001\u5916\u90e8\u914d\u7f6e\u7b49"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u89c6\u9891\uff1a",(0,i.jsx)(e.a,{href:"https://www.bilibili.com/video/BV19K4y1L7MT",children:"https://www.bilibili.com/video/BV19K4y1L7MT"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u6784\u5efa\u5de5\u7a0b",children:"\u6784\u5efa\u5de5\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u666e\u901a\u6784\u5efa\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u521b\u5efa Maven \u9879\u76ee"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165 SpringBoot \u8d77\u6b65\u4f9d\u8d56"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--springboot \u5de5\u7a0b\u9700\u8981\u7ee7\u627f\u7684\u7236\u5de5\u7a0b--\x3e\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>2.1.8.RELEASE</version>\n</parent>\n\n<dependencies>\n    \x3c!--web \u5f00\u53d1\u7684\u8d77\u6b65\u4f9d\u8d56--\x3e\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n</dependencies>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9a\u4e49 Controller"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\npublic class HelloController {\n    @RequestMapping("/hello")\n    public String hello(){\n        return " hello Spring Boot !";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7f16\u5199\u5f15\u5bfc\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u5f15\u5bfc\u7c7b\uff0cSpringBoot\u9879\u76ee\u7684\u5165\u53e3\n@SpringBootApplication\npublic class HelloApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(HelloApplication.class, args);\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5feb\u901f\u6784\u5efa\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(82485).A+"",width:"1017",height:"672"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u81ea\u52a8\u88c5\u914d-1",children:"\u81ea\u52a8\u88c5\u914d"}),"\n",(0,i.jsx)(e.h3,{id:"\u4f9d\u8d56\u7ba1\u7406",children:"\u4f9d\u8d56\u7ba1\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 spring-boot-starter-parent \u4e2d\u5b9a\u4e49\u4e86\u5404\u79cd\u6280\u672f\u7684\u7248\u672c\u4fe1\u606f\uff0c\u7ec4\u5408\u4e86\u4e00\u5957\u6700\u4f18\u642d\u914d\u7684\u6280\u672f\u7248\u672c\u3002\u5728\u5404\u79cd starter \u4e2d\uff0c\u5b9a\u4e49\u4e86\u5b8c\u6210\u8be5\u529f\u80fd\u9700\u8981\u7684\u5750\u6807\u5408\u96c6\uff0c\u5176\u4e2d\u5927\u90e8\u5206\u7248\u672c\u4fe1\u606f\u6765\u81ea\u4e8e\u7236\u5de5\u7a0b\u3002\u5de5\u7a0b\u7ee7\u627f parent\uff0c\u5f15\u5165 starter \u540e\uff0c\u901a\u8fc7\u4f9d\u8d56\u4f20\u9012\uff0c\u5c31\u53ef\u4ee5\u7b80\u5355\u65b9\u4fbf\u83b7\u5f97\u9700\u8981\u7684 jar \u5305\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5b58\u5728\u7248\u672c\u51b2\u7a81\uff0c\u81ea\u52a8\u7248\u672c\u4ef2\u88c1\u673a\u5236"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5e95\u5c42\u6ce8\u89e3",children:"\u5e95\u5c42\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.h4,{id:"springboot",children:"SpringBoot"}),"\n",(0,i.jsx)(e.p,{children:"@SpringBootApplication\uff1a\u542f\u52a8\u6ce8\u89e3\uff0c\u5b9e\u73b0 SpringBoot \u7684\u81ea\u52a8\u90e8\u7f72"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53c2\u6570 scanBasePackages\uff1a\u53ef\u4ee5\u6307\u5b9a\u626b\u63cf\u8303\u56f4"}),"\n",(0,i.jsx)(e.li,{children:"\u9ed8\u8ba4\u626b\u63cf\u5f53\u524d\u5f15\u5bfc\u7c7b\u6240\u5728\u5305\u53ca\u5176\u5b50\u5305"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5047\u5982\u6240\u5728\u5305\u4e3a com.example.springbootenable\uff0c\u626b\u63cf\u914d\u7f6e\u5305 com.example.config \u7684\u4fe1\u606f\uff0c\u4e09\u79cd\u89e3\u51b3\u529e\u6cd5\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 @ComponentScan \u626b\u63cf com.example.config \u5305"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4f7f\u7528 @Import \u6ce8\u89e3\u52a0\u8f7d\u7c7b\uff0c\u8fd9\u4e9b\u7c7b\u90fd\u4f1a\u88ab Spring \u521b\u5efa\u5e76\u653e\u5165 ioc \u5bb9\u5668\uff0c\u9ed8\u8ba4\u7ec4\u4ef6\u7684\u540d\u5b57\u5c31\u662f",(0,i.jsx)(e.strong,{children:"\u5168\u7c7b\u540d"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bf9 @Import \u6ce8\u89e3\u8fdb\u884c\u5c01\u88c5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//1.@ComponentScan("com.example.config")\n//2.@Import(UserConfig.class)\n@EnableUser\n@SpringBootApplication\npublic class SpringbootEnableApplication {\n\n    public static void main(String[] args) {\n        ConfigurableApplicationContext context = SpringApplication.run(SpringbootEnableApplication.class, args);\n    \t//\u83b7\u53d6Bean\n        Object user = context.getBean("user");\n        System.out.println(user);\n\n\t}\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"UserConfig\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class UserConfig {\n    @Bean\n    public User user() {\n        return new User();\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"EnableUser \u6ce8\u89e3\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Import(UserConfig.class)//@Import\u6ce8\u89e3\u5b9e\u73b0Bean\u7684\u52a8\u6001\u52a0\u8f7d\npublic @interface EnableUser {\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(e.p,{children:"@Configuration\uff1a\u8bbe\u7f6e\u5f53\u524d\u7c7b\u4e3a SpringBoot \u7684\u914d\u7f6e\u7c7b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["proxyBeanMethods = true\uff1aFull \u5168\u6a21\u5f0f\uff0c\u6bcf\u4e2a @Bean \u65b9\u6cd5\u88ab\u8c03\u7528\u591a\u5c11\u6b21\u8fd4\u56de\u7684\u7ec4\u4ef6\u90fd\u662f\u5355\u5b9e\u4f8b\u7684\uff0c\u9ed8\u8ba4\u503c\uff0c\u7c7b\u7ec4\u4ef6\u4e4b\u95f4",(0,i.jsx)(e.strong,{children:"\u6709\u4f9d\u8d56\u5173\u7cfb"}),"\uff0c\u65b9\u6cd5\u4f1a\u88ab\u8c03\u7528\u5f97\u5230\u4e4b\u524d\u5355\u5b9e\u4f8b\u7ec4\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:["proxyBeanMethods = false\uff1aLite \u8f7b\u91cf\u7ea7\u6a21\u5f0f\uff0c\u6bcf\u4e2a @Bean \u65b9\u6cd5\u88ab\u8c03\u7528\u591a\u5c11\u6b21\u8fd4\u56de\u7684\u7ec4\u4ef6\u90fd\u662f\u65b0\u521b\u5efa\u7684\uff0c\u7c7b\u7ec4\u4ef6\u4e4b\u95f4",(0,i.jsx)(e.strong,{children:"\u65e0\u4f9d\u8d56\u5173\u7cfb"}),"\u7528 Lite \u6a21\u5f0f\u52a0\u901f\u5bb9\u5668\u542f\u52a8\u8fc7\u7a0b"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration(proxyBeanMethods = true)\npublic class MyConfig {\n    @Bean //\u7ed9\u5bb9\u5668\u4e2d\u6dfb\u52a0\u7ec4\u4ef6\u3002\u4ee5\u65b9\u6cd5\u540d\u4f5c\u4e3a\u7ec4\u4ef6\u7684 id\u3002\u8fd4\u56de\u7c7b\u578b\u5c31\u662f\u7ec4\u4ef6\u7c7b\u578b\u3002\u8fd4\u56de\u7684\u503c\uff0c\u5c31\u662f\u7ec4\u4ef6\u5728\u5bb9\u5668\u4e2d\u7684\u5b9e\u4f8b\n    public User user(){\n        User user = new User("zhangsan", 18);\n        return user;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"condition",children:"Condition"}),"\n",(0,i.jsx)(e.h5,{id:"\u6761\u4ef6\u6ce8\u89e3",children:"\u6761\u4ef6\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"Condition \u662f Spring4.0 \u540e\u5f15\u5165\u7684\u6761\u4ef6\u5316\u914d\u7f6e\u63a5\u53e3\uff0c\u901a\u8fc7\u5b9e\u73b0 Condition \u63a5\u53e3\u53ef\u4ee5\u5b8c\u6210\u6709\u6761\u4ef6\u7684\u52a0\u8f7d\u76f8\u5e94\u7684 Bean"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3\uff1a@Conditional"}),"\n",(0,i.jsx)(e.p,{children:"\u4f5c\u7528\uff1a\u6761\u4ef6\u88c5\u914d\uff0c\u6ee1\u8db3 Conditional \u6307\u5b9a\u7684\u6761\u4ef6\u5219\u8fdb\u884c\u7ec4\u4ef6\u6ce8\u5165\uff0c\u52a0\u4e0a\u65b9\u6cd5\u6216\u8005\u7c7b\u4e0a\uff0c\u4f5c\u7528\u8303\u56f4\u4e0d\u540c"}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\uff1a@Conditional \u914d\u5408 Condition \u7684\u5b9e\u73b0\u7c7b\uff08ClassCondition\uff09\u8fdb\u884c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"ConditionContext \u7c7bAPI\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ConfigurableListableBeanFactory  getBeanFactory()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u5230 IOC \u4f7f\u7528\u7684 beanfactory"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ClassLoader getClassLoader()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u7c7b\u52a0\u8f7d\u5668"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Environment getEnvironment()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u5f53\u524d\u73af\u5883\u4fe1\u606f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"BeanDefinitionRegistry getRegistry()"}),(0,i.jsx)(e.td,{children:"\u83b7\u53d6\u5230 bean \u5b9a\u4e49\u7684\u6ce8\u518c\u7c7b"})]})]})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ClassCondition\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class ClassCondition implements Condition {\n    /**\n     * context \u4e0a\u4e0b\u6587\u5bf9\u8c61\u3002\u7528\u4e8e\u83b7\u53d6\u73af\u5883\uff0cIOC\u5bb9\u5668\uff0cClassLoader\u5bf9\u8c61\n     * metadata \u6ce8\u89e3\u5143\u5bf9\u8c61\u3002 \u53ef\u4ee5\u7528\u4e8e\u83b7\u53d6\u6ce8\u89e3\u5b9a\u4e49\u7684\u5c5e\u6027\u503c\n     */\n    @Override\n    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {\n      \n        //1.\u9700\u6c42\uff1a \u5bfc\u5165Jedis\u5750\u6807\u540e\u521b\u5efaBean\n        //\u601d\u8def\uff1a\u5224\u65adredis.clients.jedis.Jedis.class\u6587\u4ef6\u662f\u5426\u5b58\u5728\n        boolean flag = true;\n        try {\n            Class<?> cls = Class.forName("redis.clients.jedis.Jedis");\n        } catch (ClassNotFoundException e) {\n            flag = false;\n        }\n        return flag;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"UserConfig\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class UserConfig {\n    @Bean\n    @Conditional(ClassCondition.class)\n    public User user(){\n        return new User();\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@SpringBootApplication\npublic class SpringbootConditionApplication {\n    public static void main(String[] args) {\n        //\u542f\u52a8SpringBoot\u5e94\u7528\uff0c\u8fd4\u56deSpring\u7684IOC\u5bb9\u5668\n        ConfigurableApplicationContext context = SpringApplication.run(SpringbootConditionApplication.class, args);\n\n        Object user = context.getBean("user");\n        System.out.println(user);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u81ea\u5b9a\u4e49\u6ce8\u89e3",children:"\u81ea\u5b9a\u4e49\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"\u5c06\u7c7b\u7684\u5224\u65ad\u5b9a\u4e49\u4e3a\u52a8\u6001\u7684\uff0c\u5224\u65ad\u54ea\u4e2a\u5b57\u8282\u7801\u6587\u4ef6\u5b58\u5728\u53ef\u4ee5\u52a8\u6001\u6307\u5b9a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u6761\u4ef6\u6ce8\u89e3\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Target({ElementType.TYPE, ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Conditional(ClassCondition.class)\npublic @interface ConditionOnClass {\n    String[] value();\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ClassCondition"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class ClassCondition implements Condition {\n    @Override\n    public boolean matches(ConditionContext conditionContext, AnnotatedTypeMetadata metadata) {\n\n        //\u9700\u6c42\uff1a\u901a\u8fc7\u6ce8\u89e3\u5c5e\u6027\u503cvalue\u6307\u5b9a\u5750\u6807\u540e\u521b\u5efabean\n        Map<String, Object> map = metadata.getAnnotationAttributes\n            \t\t\t\t\t(ConditionOnClass.class.getName());\n        //map = {value={\u5c5e\u6027\u503c}}\n        //\u83b7\u53d6\u6240\u6709\u7684\n        String[] value = (String[]) map.get("value");\n\n        boolean flag = true;\n        try {\n            for (String className : value) {\n                Class<?> cls = Class.forName(className);\n            }\n        } catch (Exception e) {\n            flag = false;\n        }\n        return flag;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"UserConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\npublic class UserConfig {\n    @Bean\n    @ConditionOnClass("com.alibaba.fastjson.JSON")//JSON\u52a0\u8f7d\u4e86\u624d\u6ce8\u518c User \u5230\u5bb9\u5668\n    public User user(){\n        return new User();\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5 User \u5bf9\u8c61\u7684\u521b\u5efa"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u5e38\u7528\u6ce8\u89e3",children:"\u5e38\u7528\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u63d0\u4f9b\u7684\u5e38\u7528\u6761\u4ef6\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:["@ConditionalOnProperty\uff1a\u5224\u65ad",(0,i.jsx)(e.strong,{children:"\u914d\u7f6e\u6587\u4ef6"}),"\u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u5c5e\u6027\u548c\u503c\u624d\u521d\u59cb\u5316 Bean"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\npublic class UserConfig {\n    @Bean\n    @ConditionalOnProperty(name = "it", havingValue = "seazean")\n    public User user() {\n        return new User();\n    }\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"it=seazean\n"})}),"\n",(0,i.jsx)(e.p,{children:"@ConditionalOnClass\uff1a\u5224\u65ad\u73af\u5883\u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u7c7b\u6587\u4ef6\u624d\u521d\u59cb\u5316 Bean"}),"\n",(0,i.jsx)(e.p,{children:"@ConditionalOnMissingClass\uff1a\u5224\u65ad\u73af\u5883\u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u7c7b\u6587\u4ef6\u624d\u521d\u59cb\u5316 Bean"}),"\n",(0,i.jsx)(e.p,{children:"@ConditionalOnMissingBean\uff1a\u5224\u65ad\u73af\u5883\u4e2d\u6ca1\u6709\u5bf9\u5e94Bean\u624d\u521d\u59cb\u5316 Bean"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"importres",children:"ImportRes"}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 bean.xml \u6587\u4ef6\u751f\u6210\u914d\u7f6e bean\uff0c\u5982\u679c\u9700\u8981\u7ee7\u7eed\u590d\u7528 bean.xml\uff0c@ImportResource \u5bfc\u5165\u914d\u7f6e\u6587\u4ef6\u5373\u53ef"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@ImportResource("classpath:beans.xml")\npublic class MyConfig {\n\t//...\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<beans ...>\n    <bean id="haha" class="com.lun.boot.bean.User">\n        <property name="name" value="zhangsan"></property>\n        <property name="age" value="18"></property>\n    </bean>\n\n    <bean id="hehe" class="com.lun.boot.bean.Pet">\n        <property name="name" value="tomcat"></property>\n    </bean>\n</beans>\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(e.p,{children:"@ConfigurationProperties\uff1a\u8bfb\u53d6\u5230 properties \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u5e76\u4e14\u5c01\u88c5\u5230 JavaBean \u4e2d"}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"mycar.brand=BYD\nmycar.price=100000\n"})}),"\n",(0,i.jsx)(e.p,{children:"JavaBean \u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\t//\u5bfc\u5165\u5230\u5bb9\u5668\u5185\n@ConfigurationProperties(prefix = "mycar")//\u4ee3\u8868\u914d\u7f6e\u6587\u4ef6\u7684\u524d\u7f00\npublic class Car {\n    private String brand;\n    private Integer price;\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u88c5\u914d\u539f\u7406",children:"\u88c5\u914d\u539f\u7406"}),"\n",(0,i.jsx)(e.h4,{id:"\u542f\u52a8\u6d41\u7a0b",children:"\u542f\u52a8\u6d41\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\u542f\u52a8\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\npublic class BootApplication {\n    public static void main(String[] args) {\n        // \u542f\u52a8\u4ee3\u7801\n        SpringApplication.run(BootApplication.class, args);\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"SpringApplication \u6784\u9020\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.resourceLoader = resourceLoader"}),"\uff1a\u8d44\u6e90\u52a0\u8f7d\u5668\uff0c\u521d\u59cb\u4e3a null"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.webApplicationType = WebApplicationType.deduceFromClasspath()"}),"\uff1a\u5224\u65ad\u5f53\u524d\u5e94\u7528\u7684\u7c7b\u578b\uff0c\u662f\u54cd\u5e94\u5f0f\u8fd8\u662f Web \u7c7b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.bootstrapRegistryInitializers = getBootstrapRegistryInitializersFromSpringFactories()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u5f15\u5bfc\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53bb ",(0,i.jsx)(e.strong,{children:(0,i.jsx)(e.code,{children:"META-INF/spring.factories"})})," \u6587\u4ef6\u4e2d\u627e org.springframework.boot.Bootstrapper"]}),"\n",(0,i.jsx)(e.li,{children:"\u5bfb\u627e\u7684\u987a\u5e8f\uff1aclasspath \u2192 spring-beans \u2192 boot-devtools \u2192 springboot \u2192 boot-autoconfigure"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"setInitializers(getSpringFactoriesInstances(ApplicationContextInitializer.class))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u521d\u59cb\u5316\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53bb ",(0,i.jsx)(e.code,{children:"META-INF/spring.factories"})," \u6587\u4ef6\u4e2d\u627e org.springframework.context.ApplicationContextInitializer"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class))"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u76d1\u542c\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53bb ",(0,i.jsx)(e.code,{children:"META-INF/spring.factories"})," \u6587\u4ef6\u4e2d\u627e org.springframework.context.ApplicationListener"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"this.mainApplicationClass = deduceMainApplicationClass()"}),"\uff1a\u83b7\u53d6\u51fa main \u7a0b\u5e8f\u7c7b"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"SpringApplication#run(String... args)\uff1a\u521b\u5efa IOC \u5bb9\u5668\u5e76\u5b9e\u73b0\u4e86\u81ea\u52a8\u88c5\u914d"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"StopWatch stopWatch = new StopWatch()"}),"\uff1a\u505c\u6b62\u76d1\u542c\u5668\uff0c",(0,i.jsx)(e.strong,{children:"\u76d1\u63a7\u6574\u4e2a\u5e94\u7528\u7684\u542f\u505c"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"stopWatch.start()"}),"\uff1a\u8bb0\u5f55\u5e94\u7528\u7684\u542f\u52a8\u65f6\u95f4"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bootstrapContext = createBootstrapContext()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u5f15\u5bfc\u4e0a\u4e0b\u6587\u73af\u5883"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"bootstrapContext = new DefaultBootstrapContext()"}),"\uff1a\u521b\u5efa\u9ed8\u8ba4\u7684\u5f15\u5bfc\u7c7b\u73af\u5883"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"this.bootstrapRegistryInitializers.forEach()"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u5f15\u5bfc\u5668\u8c03\u7528 initialize \u65b9\u6cd5\u5b8c\u6210\u521d\u59cb\u5316\u8bbe\u7f6e"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"configureHeadlessProperty()"}),"\uff1a\u8ba9\u5f53\u524d\u5e94\u7528\u8fdb\u5165 headless \u6a21\u5f0f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners = getRunListeners(args)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u6240\u6709 RunListener\uff08\u8fd0\u884c\u76d1\u542c\u5668\uff09"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53bb ",(0,i.jsx)(e.code,{children:"META-INF/spring.factories"})," \u6587\u4ef6\u4e2d\u627e org.springframework.boot.SpringApplicationRunListener"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners.starting(bootstrapContext, this.mainApplicationClass)"}),"\uff1a\u904d\u5386\u6240\u6709\u7684\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 starting \u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"applicationArguments = new DefaultApplicationArguments(args)"}),"\uff1a\u83b7\u53d6\u6240\u6709\u7684\u547d\u4ee4\u884c\u53c2\u6570"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"environment = prepareEnvironment(listeners, bootstrapContext, applicationArguments)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u51c6\u5907\u73af\u5883"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"environment = getOrCreateEnvironment()"}),"\uff1a\u8fd4\u56de\u6216\u521b\u5efa\u57fa\u7840\u73af\u5883\u4fe1\u606f\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"switch (this.webApplicationType)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u6839\u636e\u5f53\u524d\u5e94\u7528\u7684\u7c7b\u578b\u521b\u5efa\u73af\u5883"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"case SERVLET"}),"\uff1aWeb \u5e94\u7528\u73af\u5883\u5bf9\u5e94 ApplicationServletEnvironment"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"case REACTIVE"}),"\uff1a\u54cd\u5e94\u5f0f\u7f16\u7a0b\u5bf9\u5e94 ApplicationReactiveWebEnvironment"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"default"}),"\uff1a\u9ed8\u8ba4\u4e3a Spring \u73af\u5883 ApplicationEnvironment"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"configureEnvironment(environment, applicationArguments.getSourceArgs())"}),"\uff1a\u8bfb\u53d6\u6240\u6709\u914d\u7f6e\u6e90\u7684\u5c5e\u6027\u503c\u914d\u7f6e\u73af\u5883"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ConfigurationPropertySources.attach(environment)"}),"\uff1a\u5c5e\u6027\u503c\u7ed1\u5b9a\u73af\u5883\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"sources.addFirst(ATTACHED_PROPERTY_SOURCE_NAME,..)"}),"\uff1a\u628a configurationProperties \u653e\u5165\u73af\u5883\u7684\u5c5e\u6027\u4fe1\u606f\u5934\u90e8"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners.environmentPrepared(bootstrapContext, environment)"}),"\uff1a\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 environmentPrepared()\uff0cEventPublishingRunListener \u53d1\u5e03\u4e8b\u4ef6\u901a\u77e5\u6240\u6709\u7684\u76d1\u542c\u5668\u5f53\u524d\u73af\u5883\u51c6\u5907\u5b8c\u6210"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"DefaultPropertiesPropertySource.moveToEnd(environment)"}),"\uff1a\u79fb\u52a8 defaultProperties \u5c5e\u6027\u6e90\u5230\u73af\u5883\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u6e90"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"bindToSpringApplication(environment)"}),"\uff1a\u4e0e\u5bb9\u5668\u7ed1\u5b9a\u5f53\u524d\u73af\u5883"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ConfigurationPropertySources.attach(environment)"}),"\uff1a\u91cd\u65b0\u5c06\u5c5e\u6027\u503c\u7ed1\u5b9a\u73af\u5883\u4fe1\u606f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"sources.remove(ATTACHED_PROPERTY_SOURCE_NAME)"}),"\uff1a\u4ece\u73af\u5883\u4fe1\u606f\u4e2d\u79fb\u9664 configurationProperties"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"sources.addFirst(ATTACHED_PROPERTY_SOURCE_NAME,..)"}),"\uff1a\u628a configurationProperties \u91cd\u65b0\u653e\u5165\u73af\u5883\u4fe1\u606f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"configureIgnoreBeanInfo(environment)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u914d\u7f6e\u5ffd\u7565\u7684 bean"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"printedBanner = printBanner(environment)"}),"\uff1a\u6253\u5370 SpringBoot \u6807\u5fd7"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"context = createApplicationContext()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa IOC \u5bb9\u5668"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"switch (this.webApplicationType)"}),"\uff1a\u6839\u636e\u5f53\u524d\u5e94\u7528\u7684\u7c7b\u578b\u521b\u5efa IOC \u5bb9\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"case SERVLET"}),"\uff1aWeb \u5e94\u7528\u73af\u5883\u5bf9\u5e94 AnnotationConfigServletWebServerApplicationContext"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"case REACTIVE"}),"\uff1a\u54cd\u5e94\u5f0f\u7f16\u7a0b\u5bf9\u5e94 AnnotationConfigReactiveWebServerApplicationContext"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"default"}),"\uff1a\u9ed8\u8ba4\u4e3a Spring \u73af\u5883 AnnotationConfigApplicationContext"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"context.setApplicationStartup(this.applicationStartup)"}),"\uff1a\u8bbe\u7f6e\u4e00\u4e2a\u542f\u52a8\u5668"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"prepareContext()"}),"\uff1a\u914d\u7f6e IOC \u5bb9\u5668\u7684\u57fa\u672c\u4fe1\u606f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"postProcessApplicationContext(context)"}),"\uff1a\u540e\u7f6e\u5904\u7406\u6d41\u7a0b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"applyInitializers(context)"}),"\uff1a\u83b7\u53d6\u6240\u6709\u7684",(0,i.jsx)(e.strong,{children:"\u521d\u59cb\u5316\u5668\u8c03\u7528 initialize() \u65b9\u6cd5"}),"\u8fdb\u884c\u521d\u59cb\u5316"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners.contextPrepared(context)"}),"\uff1a\u6240\u6709\u7684\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 environmentPrepared() \u65b9\u6cd5\uff0cEventPublishingRunListener \u53d1\u5e03\u4e8b\u4ef6\u901a\u77e5 IOC \u5bb9\u5668\u51c6\u5907\u5b8c\u6210"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners.contextLoaded(context)"}),"\uff1a\u6240\u6709\u7684\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 contextLoaded() \u65b9\u6cd5\uff0c\u901a\u77e5 IOC \u52a0\u8f7d\u5b8c\u6210"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"refreshContext(context)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5237\u65b0 IOC \u5bb9\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Spring \u7684\u5bb9\u5668\u542f\u52a8\u6d41\u7a0b"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"invokeBeanFactoryPostProcessors(beanFactory)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5b9e\u73b0\u4e86\u81ea\u52a8\u88c5\u914d"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"onRefresh()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa WebServer"})," \u4f7f\u7528\u8be5\u63a5\u53e3"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"afterRefresh(context, applicationArguments)"}),"\uff1a\u7559\u7ed9\u7528\u6237\u81ea\u5b9a\u4e49\u5bb9\u5668\u5237\u65b0\u5b8c\u6210\u540e\u7684\u5904\u7406\u903b\u8f91"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"stopWatch.stop()"}),"\uff1a\u8bb0\u5f55\u5e94\u7528\u542f\u52a8\u5b8c\u6210\u7684\u65f6\u95f4"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"callRunners(context, applicationArguments)"}),"\uff1a\u8c03\u7528\u6240\u6709 runners"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners.started(context)"}),"\uff1a\u6240\u6709\u7684\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 started() \u65b9\u6cd5"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"listeners.running(context)"}),"\uff1a\u6240\u6709\u7684\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 running() \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6\u5bb9\u5668\u4e2d\u7684 ApplicationRunner\u3001CommandLineRunner"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"AnnotationAwareOrderComparator.sort(runners)"}),"\uff1a\u5408\u5e76\u6240\u6709 runner \u5e76\u4e14\u6309\u7167 @Order \u8fdb\u884c\u6392\u5e8f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"callRunner()"}),"\uff1a\u904d\u5386\u6240\u6709\u7684 runner\uff0c\u8c03\u7528 run \u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"handleRunFailure(context, ex, listeners)"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5904\u7406\u5f02\u5e38"}),"\uff0c\u51fa\u73b0\u5f02\u5e38\u8fdb\u5165\u8be5\u903b\u8f91"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"handleExitCode(context, exception)"}),"\uff1a\u5904\u7406\u9519\u8bef\u4ee3\u7801"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"listeners.failed(context, exception)"}),"\uff1a\u8fd0\u884c\u76d1\u542c\u5668\u8c03\u7528 failed() \u65b9\u6cd5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"reportFailure(getExceptionReporters(context), exception)"}),"\uff1a\u901a\u77e5\u5f02\u5e38"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6ce8\u89e3\u5206\u6790",children:"\u6ce8\u89e3\u5206\u6790"}),"\n",(0,i.jsxs)(e.p,{children:["SpringBoot \u5b9a\u4e49\u4e86\u4e00\u5957\u63a5\u53e3\u89c4\u8303\uff0c\u8fd9\u5957\u89c4\u8303\u89c4\u5b9a SpringBoot \u5728\u542f\u52a8\u65f6\u4f1a\u626b\u63cf\u5916\u90e8\u5f15\u7528 jar \u5305\u4e2d\u7684 ",(0,i.jsx)(e.code,{children:"META-INF/spring.factories"})," \u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u7c7b\u578b\u4fe1\u606f\u52a0\u8f7d\u5230 Spring \u5bb9\u5668\uff0c\u5e76\u6267\u884c\u7c7b\u4e2d\u5b9a\u4e49\u7684\u5404\u79cd\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u5916\u90e8\u7684 jar \u5305\uff0c\u76f4\u63a5\u5f15\u5165\u4e00\u4e2a starter \u5373\u53ef"]}),"\n",(0,i.jsxs)(e.p,{children:["@SpringBootApplication \u6ce8\u89e3\u662f ",(0,i.jsx)(e.code,{children:"@SpringBootConfiguration"}),"\u3001",(0,i.jsx)(e.code,{children:"@EnableAutoConfiguration"}),"\u3001",(0,i.jsx)(e.code,{children:"@ComponentScan"})," \u6ce8\u89e3\u7684\u96c6\u5408"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@SpringBootApplication \u6ce8\u89e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Inherited\n@SpringBootConfiguration\t//\u4ee3\u8868 @SpringBootApplication \u62e5\u6709\u4e86\u8be5\u6ce8\u89e3\u7684\u529f\u80fd\n@EnableAutoConfiguration\t//\u540c\u7406\n@ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),\n\t\t@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })\n// \u626b\u63cf\u88ab @Component (@Service,@Controller)\u6ce8\u89e3\u7684 bean\uff0c\u5bb9\u5668\u4e2d\u5c06\u6392\u9664TypeExcludeFilter \u548c AutoConfigurationExcludeFilter\npublic @interface SpringBootApplication { }\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@SpringBootConfiguration \u6ce8\u89e3\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\t// \u4ee3\u8868\u662f\u914d\u7f6e\u7c7b\n@Indexed\npublic @interface SpringBootConfiguration {\n\t@AliasFor(annotation = Configuration.class)\n\tboolean proxyBeanMethods() default true;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"@AliasFor \u6ce8\u89e3\uff1a\u8868\u793a\u522b\u540d\uff0c\u53ef\u4ee5\u6ce8\u89e3\u5230\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u4e24\u4e2a\u5c5e\u6027\u4e0a\u8868\u793a\u8fd9\u4e24\u4e2a\u4e92\u4e3a\u522b\u540d\uff0c\u4e24\u4e2a\u5c5e\u6027\u5176\u5b9e\u662f\u540c\u4e00\u4e2a\u542b\u4e49\u76f8\u4e92\u66ff\u4ee3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@ComponentScan \u6ce8\u89e3\uff1a\u9ed8\u8ba4\u626b\u63cf\u5f53\u524d\u7c7b\u6240\u5728\u5305\u53ca\u5176\u5b50\u7ea7\u5305\u4e0b\u7684\u6240\u6709\u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"@EnableAutoConfiguration \u6ce8\u89e3\uff1a\u542f\u7528 SpringBoot \u7684\u81ea\u52a8\u914d\u7f6e\u673a\u5236"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@AutoConfigurationPackage\t\n@Import(AutoConfigurationImportSelector.class)\npublic @interface EnableAutoConfiguration { \n\tString ENABLED_OVERRIDE_PROPERTY = "spring.boot.enableautoconfiguration";\n    Class<?>[] exclude() default {}; \n    String[] excludeName() default {};\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@AutoConfigurationPackage\uff1a",(0,i.jsx)(e.strong,{children:"\u5c06\u6dfb\u52a0\u8be5\u6ce8\u89e3\u7684\u7c7b\u6240\u5728\u7684 package \u4f5c\u4e3a\u81ea\u52a8\u914d\u7f6e package \u8fdb\u884c\u7ba1\u7406"}),"\uff0c\u628a\u542f\u52a8\u7c7b\u6240\u5728\u7684\u5305\u8bbe\u7f6e\u4e00\u6b21\uff0c\u4e3a\u4e86\u7ed9\u5404\u79cd\u81ea\u52a8\u914d\u7f6e\u7684\u7b2c\u4e09\u65b9\u5e93\u626b\u63cf\u7528\uff0c\u6bd4\u5982\u5e26 @Mapper \u6ce8\u89e3\u7684\u7c7b\uff0cSpring \u81ea\u8eab\u662f\u4e0d\u80fd\u8bc6\u522b\u7684\uff0c\u4f46\u81ea\u52a8\u914d\u7f6e\u7684 Mybatis \u9700\u8981\u626b\u63cf\u7528\u5230\uff0c\u800c ComponentScan \u53ea\u662f\u7528\u6765\u626b\u63cf\u6ce8\u89e3\u7c7b\uff0c\u5e76\u6ca1\u6709\u63d0\u4f9b\u63a5\u53e3\u7ed9\u4e09\u65b9\u4f7f\u7528"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Import(AutoConfigurationPackages.Registrar.class)\t// \u5229\u7528 Registrar \u7ed9\u5bb9\u5668\u4e2d\u5bfc\u5165\u7ec4\u4ef6\npublic @interface AutoConfigurationPackage { \n\tString[] basePackages() default {};\t//\u81ea\u52a8\u914d\u7f6e\u5305\uff0c\u6307\u5b9a\u4e86\u914d\u7f6e\u7c7b\u7684\u5305\n    Class<?>[] basePackageClasses() default {};\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"register(registry, new PackageImports(metadata).getPackageNames().toArray(new String[0]))"}),"\uff1a\u6ce8\u518c BD"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"new PackageImports(metadata).getPackageNames()"}),"\uff1a\u83b7\u53d6\u6dfb\u52a0\u5f53\u524d\u6ce8\u89e3\u7684\u7c7b\u7684\u6240\u5728\u5305"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"registry.registerBeanDefinition(BEAN, new BasePackagesBeanDefinition(packageNames))"}),"\uff1a\u5b58\u653e\u5230\u5bb9\u5668\u4e2d\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"new BasePackagesBeanDefinition(packageNames)"}),"\uff1a\u628a\u5f53\u524d\u4e3b\u7c7b\u6240\u5728\u7684\u5305\u540d\u5c01\u88c5\u5230\u8be5\u5bf9\u8c61\u4e2d"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Import(AutoConfigurationImportSelector.class)\uff1a",(0,i.jsx)(e.strong,{children:"\u81ea\u52a8\u88c5\u914d\u7684\u6838\u5fc3\u7c7b"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u5bb9\u5668\u5237\u65b0\u65f6\u6267\u884c\uff1a",(0,i.jsx)(e.strong,{children:"invokeBeanFactoryPostProcessors()"})," \u2192 invokeBeanDefinitionRegistryPostProcessors() \u2192 postProcessBeanDefinitionRegistry() \u2192 processConfigBeanDefinitions() \u2192 parse() \u2192 process() \u2192 processGroupImports() \u2192 getImports() \u2192 process() \u2192 ",(0,i.jsx)(e.strong,{children:"AutoConfigurationImportSelector#getAutoConfigurationEntry()"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected AutoConfigurationEntry getAutoConfigurationEntry(AnnotationMetadata annotationMetadata) {\n    if (!isEnabled(annotationMetadata)) {\n        return EMPTY_ENTRY;\n    }\n    // \u83b7\u53d6\u6ce8\u89e3\u5c5e\u6027\uff0c@SpringBootApplication \u6ce8\u89e3\u7684 exclude \u5c5e\u6027\u548c excludeName \u5c5e\u6027\n    AnnotationAttributes attributes = getAttributes(annotationMetadata);\n    // \u83b7\u53d6\u6240\u6709\u9700\u8981\u81ea\u52a8\u88c5\u914d\u7684\u5019\u9009\u9879\n    List<String> configurations = getCandidateConfigurations(annotationMetadata, attributes);\n    // \u53bb\u9664\u91cd\u590d\u7684\u9009\u9879\n    configurations = removeDuplicates(configurations);\n    // \u83b7\u53d6\u6ce8\u89e3\u914d\u7f6e\u7684\u6392\u9664\u7684\u81ea\u52a8\u88c5\u914d\u7c7b\n    Set<String> exclusions = getExclusions(annotationMetadata, attributes);\n    checkExcludedClasses(configurations, exclusions);\n    // \u79fb\u9664\u6240\u6709\u7684\u914d\u7f6e\u7684\u4e0d\u9700\u8981\u81ea\u52a8\u88c5\u914d\u7684\u7c7b\n    configurations.removeAll(exclusions);\n    // \u8fc7\u6ee4\uff0c\u6761\u4ef6\u88c5\u914d\n    configurations = getConfigurationClassFilter().filter(configurations);\n    // \u83b7\u53d6 AutoConfigurationImportListener \u7c7b\u7684\u76d1\u542c\u5668\u8c03\u7528 onAutoConfigurationImportEvent \u65b9\u6cd5\n    fireAutoConfigurationImportEvents(configurations, exclusions);\n    // \u5305\u88c5\u6210 AutoConfigurationEntry \u8fd4\u56de\n    return new AutoConfigurationEntry(configurations, exclusions);\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["AutoConfigurationImportSelector#getCandidateConfigurations\uff1a",(0,i.jsx)(e.strong,{children:"\u83b7\u53d6\u81ea\u52a8\u914d\u7f6e\u7684\u5019\u9009\u9879"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"List<String> configurations = SpringFactoriesLoader.loadFactoryNames()"}),"\uff1a\u52a0\u8f7d\u81ea\u52a8\u914d\u7f6e\u7c7b"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u6570\u4e00\uff1a",(0,i.jsx)(e.code,{children:"getSpringFactoriesLoaderFactoryClass()"}),"\uff1a\u83b7\u53d6 @EnableAutoConfiguration \u6ce8\u89e3\u7c7b"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u6570\u4e8c\uff1a",(0,i.jsx)(e.code,{children:"getBeanClassLoader()"}),"\uff1a\u83b7\u53d6\u7c7b\u52a0\u8f7d\u5668"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"factoryTypeName = factoryType.getName()"}),"\uff1a@EnableAutoConfiguration \u6ce8\u89e3\u7684\u5168\u7c7b\u540d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"return loadSpringFactories(classLoaderToUse).getOrDefault()"}),"\uff1a\u52a0\u8f7d\u8d44\u6e90\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"urls = classLoader.getResources(FACTORIES_RESOURCE_LOCATION)"}),"\uff1a\u83b7\u53d6\u8d44\u6e90\u7c7b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'FACTORIES_RESOURCE_LOCATION = "META-INF/spring.factories"'}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u52a0\u8f7d\u7684\u8d44\u6e90\u7684\u4f4d\u7f6e"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"return configurations"}),"\uff1a\u8fd4\u56de\u6240\u6709\u81ea\u52a8\u88c5\u914d\u7c7b\u7684\u5019\u9009\u9879"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4ece spring-boot-autoconfigure-2.5.3.jar/META-INF/spring.factories \u6587\u4ef6\u4e2d\u5bfb\u627e EnableAutoConfiguration \u5b57\u6bb5\uff0c\u83b7\u53d6\u81ea\u52a8\u88c5\u914d\u7c7b\uff0c",(0,i.jsx)(e.strong,{children:"\u8fdb\u884c\u6761\u4ef6\u88c5\u914d\uff0c\u6309\u9700\u88c5\u914d"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(82044).A+"",width:"2108",height:"468"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u88c5\u914d\u6d41\u7a0b",children:"\u88c5\u914d\u6d41\u7a0b"}),"\n",(0,i.jsxs)(e.p,{children:["Spring Boot \u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"@EnableAutoConfiguration"})," \u5f00\u542f\u81ea\u52a8\u88c5\u914d\uff0c\u901a\u8fc7 SpringFactoriesLoader \u52a0\u8f7d ",(0,i.jsx)(e.code,{children:"META-INF/spring.factories"})," \u4e2d\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\u5b9e\u73b0\u81ea\u52a8\u88c5\u914d\uff0c\u81ea\u52a8\u914d\u7f6e\u7c7b\u5176\u5b9e\u5c31\u662f\u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"@Conditional"})," \u6ce8\u89e3\u6309\u9700\u52a0\u8f7d\u7684\u914d\u7f6e\u7c7b\uff0c\u60f3\u8981\u5176\u751f\u6548\u5fc5\u987b\u5f15\u5165 ",(0,i.jsx)(e.code,{children:"spring-boot-starter-xxx"})," \u5305\u5b9e\u73b0\u8d77\u6b65\u4f9d\u8d56"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"SpringBoot \u5148\u52a0\u8f7d\u6240\u6709\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b xxxxxAutoConfiguration"}),"\n",(0,i.jsxs)(e.li,{children:["\u6bcf\u4e2a\u81ea\u52a8\u914d\u7f6e\u7c7b\u8fdb\u884c",(0,i.jsx)(e.strong,{children:"\u6761\u4ef6\u88c5\u914d"}),"\uff0c\u9ed8\u8ba4\u90fd\u4f1a\u7ed1\u5b9a\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u7684\u503c\uff08xxxProperties \u548c\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4e86\u7ed1\u5b9a\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["SpringBoot \u9ed8\u8ba4\u4f1a\u5728\u5e95\u5c42\u914d\u597d\u6240\u6709\u7684\u7ec4\u4ef6\uff0c\u5982\u679c\u7528\u6237\u81ea\u5df1\u914d\u7f6e\u4e86",(0,i.jsx)(e.strong,{children:"\u4ee5\u7528\u6237\u7684\u4f18\u5148"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5b9a\u5236\u5316\u914d\u7f6e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7528\u6237\u53ef\u4ee5\u4f7f\u7528 @Bean \u65b0\u5efa\u81ea\u5df1\u7684\u7ec4\u4ef6\u6765\u66ff\u6362\u5e95\u5c42\u7684\u7ec4\u4ef6"}),"\n",(0,i.jsx)(e.li,{children:"\u7528\u6237\u53ef\u4ee5\u53bb\u770b\u8fd9\u4e2a\u7ec4\u4ef6\u662f\u83b7\u53d6\u7684\u914d\u7f6e\u6587\u4ef6\u524d\u7f00\u503c\uff0c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4ee5 DispatcherServletAutoConfiguration \u4e3a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)\n// \u7c7b\u4e2d\u7684 Bean \u9ed8\u8ba4\u4e0d\u662f\u5355\u4f8b\n@Configuration(proxyBeanMethods = false)\n@ConditionalOnWebApplication(type = Type.SERVLET)\n// \u6761\u4ef6\u88c5\u914d\uff0c\u73af\u5883\u4e2d\u6709 DispatcherServlet \u7c7b\u624d\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\n@ConditionalOnClass(DispatcherServlet.class)\n@AutoConfigureAfter(ServletWebServerFactoryAutoConfiguration.class)\npublic class DispatcherServletAutoConfiguration {\n\t// \u6ce8\u518c\u7684 DispatcherServlet \u7684 BeanName\n\tpublic static final String DEFAULT_DISPATCHER_SERVLET_BEAN_NAME = "dispatcherServlet";\n\n\t@Configuration(proxyBeanMethods = false)\n\t@Conditional(DefaultDispatcherServletCondition.class)\n\t@ConditionalOnClass(ServletRegistration.class)\n    // \u7ed1\u5b9a\u914d\u7f6e\u6587\u4ef6\u7684\u5c5e\u6027\uff0c\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u83b7\u53d6\u914d\u7f6e\u9879\n\t@EnableConfigurationProperties(WebMvcProperties.class)\n\tprotected static class DispatcherServletConfiguration {\n\t\t\n        // \u7ed9\u5bb9\u5668\u6ce8\u518c\u4e00\u4e2a DispatcherServlet\uff0c\u8d77\u540d\u5b57\u4e3a dispatcherServlet\n\t\t@Bean(name = DEFAULT_DISPATCHER_SERVLET_BEAN_NAME)\n\t\tpublic DispatcherServlet dispatcherServlet(WebMvcProperties webMvcProperties) {\n            // \u65b0\u5efa\u4e00\u4e2a DispatcherServlet \u8bbe\u7f6e\u76f8\u5173\u5c5e\u6027\n\t\t\tDispatcherServlet dispatcherServlet = new DispatcherServlet();\n            // spring.mvc \u4e2d\u7684\u914d\u7f6e\u9879\u83b7\u53d6\u6ce8\u5165\uff0c\u6ca1\u6709\u5c31\u586b\u5145\u9ed8\u8ba4\u503c\n\t\t\tdispatcherServlet.setDispatchOptionsRequest(webMvcProperties.isDispatchOptionsRequest());\n\t\t\t// ......\n            // \u8fd4\u56de\u8be5\u5bf9\u8c61\u6ce8\u518c\u5230\u5bb9\u5668\u5185\n\t\t\treturn dispatcherServlet;\n\t\t}\n\n\t\t@Bean\n        // \u5bb9\u5668\u4e2d\u6709\u8fd9\u4e2a\u7c7b\u578b\u7ec4\u4ef6\u624d\u8fdb\u884c\u88c5\u914d\n\t\t@ConditionalOnBean(MultipartResolver.class)\n        // \u5bb9\u5668\u4e2d\u6ca1\u6709\u8fd9\u4e2a\u540d\u5b57 multipartResolver \u7684\u7ec4\u4ef6\n\t\t@ConditionalOnMissingBean(name = DispatcherServlet.MULTIPART_RESOLVER_BEAN_NAME)\n        // \u65b9\u6cd5\u540d\u5c31\u662f BeanName\n\t\tpublic MultipartResolver multipartResolver(MultipartResolver resolver) {\n\t\t\t// \u7ed9 @Bean \u6807\u6ce8\u7684\u65b9\u6cd5\u4f20\u5165\u4e86\u5bf9\u8c61\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u5c31\u4f1a\u4ece\u5bb9\u5668\u4e2d\u627e\uff0c\u56e0\u4e3a\u7528\u6237\u81ea\u5b9a\u4e49\u4e86\u8be5\u7c7b\u578b\uff0c\u4ee5\u7528\u6237\u914d\u7f6e\u7684\u4f18\u5148\n            // \u4f46\u662f\u540d\u5b57\u4e0d\u7b26\u5408\u89c4\u8303\uff0c\u6240\u4ee5\u83b7\u53d6\u5230\u8be5 Bean \u5e76\u8fd4\u56de\u5230\u5bb9\u5668\u4e00\u4e2a\u89c4\u8303\u7684\u540d\u79f0\uff1amultipartResolver\n\t\t\treturn resolver;\n\t\t}\n\t}\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u5c06\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 spring.mvc \u524d\u7f00\u7684\u5c5e\u6027\u4e0e\u8be5\u7c7b\u7ed1\u5b9a\n@ConfigurationProperties(prefix = "spring.mvc")\t\npublic class WebMvcProperties { }\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u4e8b\u4ef6\u76d1\u542c",children:"\u4e8b\u4ef6\u76d1\u542c"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u5728\u9879\u76ee\u542f\u52a8\u65f6\uff0c\u4f1a\u5bf9\u51e0\u4e2a\u76d1\u542c\u5668\u8fdb\u884c\u56de\u8c03\uff0c\u53ef\u4ee5\u5b9e\u73b0\u76d1\u542c\u5668\u63a5\u53e3\uff0c\u5728\u9879\u76ee\u542f\u52a8\u65f6\u5b8c\u6210\u4e00\u4e9b\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"ApplicationContextInitializer\u3001SpringApplicationRunListener\u3001CommandLineRunner\u3001ApplicationRunner"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyApplicationRunner"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u81ea\u5b9a\u4e49\u76d1\u542c\u5668\u7684\u542f\u52a8\u65f6\u673a"}),"\uff1aMyApplicationRunner \u548c MyCommandLineRunner \u90fd\u662f\u5f53\u9879\u76ee\u542f\u52a8\u540e\u6267\u884c\uff0c\u4f7f\u7528 @Component \u653e\u5165\u5bb9\u5668\u5373\u53ef\u4f7f\u7528"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//\u5f53\u9879\u76ee\u542f\u52a8\u540e\u6267\u884crun\u65b9\u6cd5\n@Component\npublic class MyApplicationRunner implements ApplicationRunner {\n    @Override\n    public void run(ApplicationArguments args) throws Exception {\n        System.out.println("ApplicationRunner...run");\n        System.out.println(Arrays.asList(args.getSourceArgs()));//properties\u914d\u7f6e\u4fe1\u606f\n    }\n} \n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"MyCommandLineRunner"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\npublic class MyCommandLineRunner implements CommandLineRunner {\n    @Override\n    public void run(String... args) throws Exception {\n        System.out.println("CommandLineRunner...run");\n        System.out.println(Arrays.asList(args));\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["MyApplicationContextInitializer \u7684\u542f\u7528\u8981",(0,i.jsx)(e.strong,{children:"\u5728 resource \u6587\u4ef6\u5939\u4e0b\u6dfb\u52a0 META-INF/spring.factories"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"org.springframework.context.ApplicationContextInitializer=\\\ncom.example.springbootlistener.listener.MyApplicationContextInitializer\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\npublic class MyApplicationContextInitializer implements ApplicationContextInitializer {\n    @Override\n    public void initialize(ConfigurableApplicationContext applicationContext) {\n        System.out.println("ApplicationContextInitializer....initialize");\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["MySpringApplicationRunListener \u7684\u4f7f\u7528\u8981\u6dfb\u52a0",(0,i.jsx)(e.strong,{children:"\u6784\u9020\u5668"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class MySpringApplicationRunListener implements SpringApplicationRunListener {\n\t//\u6784\u9020\u5668\n    public MySpringApplicationRunListener(SpringApplication sa, String[] args) {\n    }\n\n    @Override\n    public void starting() {\n        System.out.println("starting...\u9879\u76ee\u542f\u52a8\u4e2d");//\u8f93\u51faSPRING\u4e4b\u524d\n    }\n\n    @Override\n    public void environmentPrepared(ConfigurableEnvironment environment) {\n        System.out.println("environmentPrepared...\u73af\u5883\u5bf9\u8c61\u5f00\u59cb\u51c6\u5907");\n    }\n\n    @Override\n    public void contextPrepared(ConfigurableApplicationContext context) {\n        System.out.println("contextPrepared...\u4e0a\u4e0b\u6587\u5bf9\u8c61\u5f00\u59cb\u51c6\u5907");\n    }\n\n    @Override\n    public void contextLoaded(ConfigurableApplicationContext context) {\n        System.out.println("contextLoaded...\u4e0a\u4e0b\u6587\u5bf9\u8c61\u5f00\u59cb\u52a0\u8f7d");\n    }\n\n    @Override\n    public void started(ConfigurableApplicationContext context) {\n        System.out.println("started...\u4e0a\u4e0b\u6587\u5bf9\u8c61\u52a0\u8f7d\u5b8c\u6210");\n    }\n\n    @Override\n    public void running(ConfigurableApplicationContext context) {\n        System.out.println("running...\u9879\u76ee\u542f\u52a8\u5b8c\u6210\uff0c\u5f00\u59cb\u8fd0\u884c");\n    }\n\n    @Override\n    public void failed(ConfigurableApplicationContext context, Throwable exception) {\n        System.out.println("failed...\u9879\u76ee\u542f\u52a8\u5931\u8d25");\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u914d\u7f6e\u6587\u4ef6",children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.h3,{id:"\u914d\u7f6e\u65b9\u5f0f-1",children:"\u914d\u7f6e\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.h4,{id:"\u6587\u4ef6\u7c7b\u578b",children:"\u6587\u4ef6\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u662f\u57fa\u4e8e\u7ea6\u5b9a\u7684\uff0c\u5f88\u591a\u914d\u7f6e\u90fd\u6709\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u60f3\u4f7f\u7528\u81ea\u5df1\u7684\u914d\u7f6e\u66ff\u6362\u9ed8\u8ba4\u914d\u7f6e\uff0c\u53ef\u4ee5\u4f7f\u7528 application.properties \u6216\u8005 application.yml\uff08application.yaml\uff09\u8fdb\u884c\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\uff1aapplication"}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u540c\u4e00\u7ea7\u76ee\u5f55\u4e0b\u4f18\u5148\u7ea7\u4e3a\uff1aproperties > yml > yaml"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f8b\u5982\u914d\u7f6e\u5185\u7f6e Tomcat \u7684\u7aef\u53e3"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"properties\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"server.port=8080\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server: port: 8080\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"yaml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server: port: 8080\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u52a0\u8f7d\u987a\u5e8f",children:"\u52a0\u8f7d\u987a\u5e8f"}),"\n",(0,i.jsxs)(e.p,{children:["\u6240\u6709\u4f4d\u7f6e\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u4f1a\u88ab\u52a0\u8f7d\uff0c\u4e92\u8865\u914d\u7f6e\uff0c",(0,i.jsx)(e.strong,{children:"\u9ad8\u4f18\u5148\u7ea7\u914d\u7f6e\u5185\u5bb9\u4f1a\u8986\u76d6\u4f4e\u4f18\u5148\u7ea7\u914d\u7f6e\u5185\u5bb9"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u626b\u63cf\u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e\u6309\u4f18\u5148\u7ea7",(0,i.jsx)(e.strong,{children:"\u4ece\u9ad8\u5230\u5e95"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"file:./config/"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u5f53\u524d\u9879\u76ee"}),"\u4e0b\u7684 /config \u76ee\u5f55\u4e0b"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"file:./"}),"\uff1a\u5f53\u524d\u9879\u76ee\u7684\u6839\u76ee\u5f55\uff0cProject\u5de5\u7a0b\u76ee\u5f55"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"classpath:/config/"}),"\uff1aclasspath \u7684 /config \u76ee\u5f55"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"classpath:/"}),"\uff1aclasspath \u7684\u6839\u76ee\u5f55\uff0c\u5c31\u662f resoureces \u76ee\u5f55"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u9879\u76ee\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u987a\u5e8f\uff1a\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u7684\u4f7f\u7528\u662f\u4e3a\u4e86\u5bf9\u5185\u90e8\u6587\u4ef6\u7684\u914d\u5408"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u547d\u4ee4\u884c\uff1a\u5728 package \u6253\u5305\u540e\u7684 target \u76ee\u5f55\u4e0b\uff0c\u4f7f\u7528\u8be5\u547d\u4ee4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sh",children:"java -jar myproject.jar\xa0--server.port=9000\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sh",children:"java -jar myproject.jar --spring.config.location=e://application.properties\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6309\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u5e95\u9009\u62e9\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u547d\u4ee4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sh",children:"java -jar myproject.jar\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"yaml\u8bed\u6cd5",children:"yaml\u8bed\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u8bed\u6cd5\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5927\u5c0f\u5199\u654f\u611f"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6570\u636e\u503c\u524d\u8fb9\u5fc5\u987b\u6709\u7a7a\u683c\uff0c\u4f5c\u4e3a\u5206\u9694\u7b26"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u7f29\u8fdb\u8868\u793a\u5c42\u7ea7\u5173\u7cfb"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7f29\u8fdb\u65f6\u4e0d\u5141\u8bb8\u4f7f\u7528Tab\u952e\uff0c\u53ea\u5141\u8bb8\u4f7f\u7528\u7a7a\u683c\uff08\u5404\u4e2a\u7cfb\u7edf Tab\u5bf9\u5e94\u7a7a\u683c\u6570\u76ee\u53ef\u80fd\u4e0d\u540c\uff0c\u5bfc\u81f4\u5c42\u6b21\u6df7\u4e71\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7f29\u8fdb\u7684\u7a7a\u683c\u6570\u76ee\u4e0d\u91cd\u8981\uff0c\u53ea\u8981\u76f8\u540c\u5c42\u7ea7\u7684\u5143\u7d20\u5de6\u4fa7\u5bf9\u9f50\u5373\u53ef"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"''#\" \u8868\u793a\u6ce8\u91ca\uff0c\u4ece\u8fd9\u4e2a\u5b57\u7b26\u4e00\u76f4\u5230\u884c\u5c3e\uff0c\u90fd\u4f1a\u88ab\u89e3\u6790\u5668\u5ffd\u7565"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server: \n\tport: 8080  \n    address: 127.0.0.1\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u683c\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7eaf\u91cf\uff1a\u5355\u4e2a\u7684\u3001\u4e0d\u53ef\u518d\u5206\u7684\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"msg1: 'hello \\n world'  # \u5355\u5f15\u5ffd\u7565\u8f6c\u4e49\u5b57\u7b26\nmsg2: \"hello \\n world\"  # \u53cc\u5f15\u8bc6\u522b\u8f6c\u4e49\u5b57\u7b26\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5bf9\u8c61\uff1a\u952e\u503c\u5bf9\u96c6\u5408\uff0cMap\u3001Hash"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"person:  \n   name: zhangsan\n   age: 20\n# \u884c\u5185\u5199\u6cd5\nperson: {name: zhangsan}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u4e0d\u5efa\u8bae\u4f7f\u7528 JSON\uff0c\u5e94\u8be5\u4f7f\u7528 yaml \u8bed\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6570\u7ec4\uff1a\u4e00\u7ec4\u6309\u6b21\u5e8f\u6392\u5217\u7684\u503c\uff0cList\u3001Array"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"address:\n  - beijing\n  - shanghai\n# \u884c\u5185\u5199\u6cd5\naddress: [beijing,shanghai]\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"allPerson\t#List<Person>\n  - {name:lisi, age:18}\n  - {name:wangwu, age:20}\n# \u884c\u5185\u5199\u6cd5\nallPerson: [{name:lisi, age:18}, {name:wangwu, age:20}]\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\u5f15\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"name: lisi \nperson:\n  name: ${name} # \u5f15\u7528\u4e0a\u8fb9\u5b9a\u4e49\u7684name\u503c\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u83b7\u53d6\u914d\u7f6e",children:"\u83b7\u53d6\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u4e09\u79cd\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3 @Value"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\npublic class HelloController {\n    @Value("${name}")\n    private String name;\n\n    @Value("${person.name}")\n    private String name2;\n\n    @Value("${address[0]}")\n    private String address1;\n\n    @Value("${msg1}")\n    private String msg1;\n\n    @Value("${msg2}")\n    private String msg2;\n    \n    @RequestMapping("/hello")\n    public String hello(){\n        System.out.println("\u6240\u6709\u7684\u6570\u636e");\n        return " hello Spring Boot !";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Evironment \u5bf9\u8c61"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Autowired\nprivate Environment env;\n\n@RequestMapping("/hello")\npublic String hello() {\n    System.out.println(env.getProperty("person.name"));\n    System.out.println(env.getProperty("address[0]"));\n    return " hello Spring Boot !";\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6ce8\u89e3 @ConfigurationProperties \u914d\u5408 @Component \u4f7f\u7528"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6ce8\u610f"}),"\uff1a\u53c2\u6570 prefix \u4e00\u5b9a\u8981\u6307\u5b9a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\t//\u4e0d\u626b\u63cf\u8be5\u7ec4\u4ef6\u5230\u5bb9\u5668\u5185\uff0c\u65e0\u6cd5\u5b8c\u6210\u81ea\u52a8\u88c5\u914d\n@ConfigurationProperties(prefix = "person")\npublic class Person {\n    private String name;\n    private int age;\n    private String[] address;\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Autowired\nprivate Person person;\n\n@RequestMapping("/hello")\npublic String hello() {\n    System.out.println(person);\n    //Person{name=\'zhangsan\', age=20, address=[beijing, shanghai]}\n    return " hello Spring Boot !";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u914d\u7f6e\u63d0\u793a",children:"\u914d\u7f6e\u63d0\u793a"}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u7684\u7c7b\u548c\u914d\u7f6e\u6587\u4ef6\u7ed1\u5b9a\u4e00\u822c\u6ca1\u6709\u63d0\u793a\uff0c\u6dfb\u52a0\u5982\u4e0b\u4f9d\u8d56\u53ef\u4ee5\u4f7f\u7528\u63d0\u793a\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-configuration-processor</artifactId>\n    <optional>true</optional>\n</dependency>\n\n\x3c!-- \u4e0b\u9762\u63d2\u4ef6\u4f5c\u7528\u662f\u5de5\u7a0b\u6253\u5305\u65f6\uff0c\u4e0d\u5c06spring-boot-configuration-processor\u6253\u8fdb\u5305\u5185\uff0c\u8ba9\u5176\u53ea\u5728\u7f16\u7801\u7684\u65f6\u5019\u6709\u7528 --\x3e\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n            <configuration>\n                <excludes>\n                    <exclude>\n                        <groupId>org.springframework.boot</groupId>\n                        <artifactId>spring-boot-configuration-processor</artifactId>\n                    </exclude>\n                </excludes>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"profile",children:"Profile"}),"\n",(0,i.jsx)(e.p,{children:"@Profile\uff1a\u6307\u5b9a\u7ec4\u4ef6\u5728\u54ea\u4e2a\u73af\u5883\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u88ab\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\uff0c\u4e0d\u6307\u5b9a\uff0c\u4efb\u4f55\u73af\u5883\u4e0b\u90fd\u80fd\u6ce8\u518c\u8fd9\u4e2a\u7ec4\u4ef6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u52a0\u4e86\u73af\u5883\u6807\u8bc6\u7684 bean\uff0c\u53ea\u6709\u8fd9\u4e2a\u73af\u5883\u88ab\u6fc0\u6d3b\u7684\u65f6\u5019\u624d\u80fd\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\uff0c\u9ed8\u8ba4\u662f default \u73af\u5883"}),"\n",(0,i.jsx)(e.li,{children:"\u5199\u5728\u914d\u7f6e\u7c7b\u4e0a\uff0c\u53ea\u6709\u662f\u6307\u5b9a\u7684\u73af\u5883\u7684\u65f6\u5019\uff0c\u6574\u4e2a\u914d\u7f6e\u7c7b\u91cc\u9762\u7684\u6240\u6709\u914d\u7f6e\u624d\u80fd\u5f00\u59cb\u751f\u6548"}),"\n",(0,i.jsx)(e.li,{children:"\u6ca1\u6709\u6807\u6ce8\u73af\u5883\u6807\u8bc6\u7684 bean \u5728\uff0c\u4efb\u4f55\u73af\u5883\u4e0b\u90fd\u662f\u52a0\u8f7d\u7684"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Profile \u7684\u914d\u7f6e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"profile \u662f\u7528\u6765\u5b8c\u6210\u4e0d\u540c\u73af\u5883\u4e0b\uff0c\u914d\u7f6e\u52a8\u6001\u5207\u6362\u529f\u80fd"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"profile \u914d\u7f6e\u65b9\u5f0f"}),"\uff1a\u591a profile \u6587\u4ef6\u65b9\u5f0f\uff0c\u63d0\u4f9b\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u4ee3\u8868\u4e00\u79cd\u73af\u5883"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"application-dev.properties/yml \u5f00\u53d1\u73af\u5883"}),"\n",(0,i.jsx)(e.li,{children:"application-test.properties/yml \u6d4b\u8bd5\u73af\u5883"}),"\n",(0,i.jsx)(e.li,{children:"sapplication-pro.properties/yml \u751f\u4ea7\u73af\u5883"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"yml \u591a\u6587\u6863\u65b9\u5f0f\uff1a\u5728 yml \u4e2d\u4f7f\u7528  --- \u5206\u9694\u4e0d\u540c\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yacas",children:"---\nserver:\n  port: 8081\nspring:\n  profiles:dev\n---\nserver:\n  port: 8082\nspring:\n  profiles:test\n---\nserver:\n  port: 8083\nspring:\n  profiles:pro\n---\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"profile \u6fc0\u6d3b\u65b9\u5f0f"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6587\u4ef6\uff1a\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\uff1aspring.profiles.active=dev"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"spring.profiles.active=dev\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u865a\u62df\u673a\u53c2\u6570\uff1a\u5728VM options \u6307\u5b9a\uff1a",(0,i.jsx)(e.code,{children:"-Dspring.profiles.active=dev"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(39077).A+"",width:"954",height:"417"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u547d\u4ee4\u884c\u53c2\u6570\uff1a",(0,i.jsx)(e.code,{children:"java \u2013jar xxx.jar  --spring.profiles.active=dev"})]}),"\n",(0,i.jsx)(e.p,{children:"\u5728 Program arguments \u91cc\u8f93\u5165\uff0c\u4e5f\u53ef\u4ee5\u5148 package"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"web\u5f00\u53d1",children:"Web\u5f00\u53d1"}),"\n",(0,i.jsx)(e.h3,{id:"\u529f\u80fd\u652f\u6301",children:"\u529f\u80fd\u652f\u6301"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u81ea\u52a8\u914d\u7f6e\u4e86\u5f88\u591a\u7ea6\u5b9a\uff0c\u5927\u591a\u573a\u666f\u90fd\u65e0\u9700\u81ea\u5b9a\u4e49\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5185\u5bb9\u534f\u5546\u89c6\u56fe\u89e3\u6790\u5668 ContentNegotiatingViewResolver \u548c BeanName \u89c6\u56fe\u89e3\u6790\u5668 BeanNameViewResolver"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301\u9759\u6001\u8d44\u6e90\uff08\u5305\u62ec webjars\uff09\u548c\u9759\u6001 index.html \u9875\u652f\u6301"}),"\n",(0,i.jsx)(e.li,{children:"\u81ea\u52a8\u6ce8\u518c\u76f8\u5173\u7c7b\uff1aConverter\u3001GenericConverter\u3001Formatter"}),"\n",(0,i.jsx)(e.li,{children:"\u5185\u5bb9\u534f\u5546\u5904\u7406\u5668\uff1aHttpMessageConverters"}),"\n",(0,i.jsx)(e.li,{children:"\u56fd\u9645\u5316\uff1aMessageCodesResolver"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u53d1\u89c4\u8303\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"@Configuration"})," + ",(0,i.jsx)(e.code,{children:"WebMvcConfigurer"})," \u81ea\u5b9a\u4e49\u89c4\u5219\uff0c\u4e0d\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"@EnableWebMvc"})," \u6ce8\u89e3"]}),"\n",(0,i.jsxs)(e.li,{children:["\u58f0\u660e ",(0,i.jsx)(e.code,{children:"WebMvcRegistrations"})," \u7684\u5b9e\u73b0\u7c7b\u6539\u53d8\u9ed8\u8ba4\u5e95\u5c42\u7ec4\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"@EnableWebMvc"})," + ",(0,i.jsx)(e.code,{children:"@Configuration"})," + ",(0,i.jsx)(e.code,{children:"DelegatingWebMvcConfiguration"})," \u5168\u9762\u63a5\u7ba1 SpringMVC"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u9759\u6001\u8d44\u6e90",children:"\u9759\u6001\u8d44\u6e90"}),"\n",(0,i.jsx)(e.h4,{id:"\u8bbf\u95ee\u89c4\u5219",children:"\u8bbf\u95ee\u89c4\u5219"}),"\n",(0,i.jsxs)(e.p,{children:["\u9ed8\u8ba4\u7684\u9759\u6001\u8d44\u6e90\u8def\u5f84\u662f classpath \u4e0b\u7684\uff0c\u4f18\u5148\u7ea7\u7531\u9ad8\u5230\u4f4e\u4e3a\uff1a/META-INF/resources\u3001/resources\u3001 /static\u3001/public  \u7684\u5305\u5185\uff0c",(0,i.jsx)(e.code,{children:"/"})," \u8868\u793a\u5f53\u524d\u9879\u76ee\u7684\u6839\u8def\u5f84"]}),"\n",(0,i.jsxs)(e.p,{children:["\u9759\u6001\u6620\u5c04 ",(0,i.jsx)(e.code,{children:"/**"})," \uff0c\u8868\u793a\u8bf7\u6c42 ",(0,i.jsx)(e.code,{children:"/ + \u9759\u6001\u8d44\u6e90\u540d"})," \u5c31\u76f4\u63a5\u53bb\u9ed8\u8ba4\u7684\u8d44\u6e90\u8def\u5f84\u5bfb\u627e\u8bf7\u6c42\u7684\u8d44\u6e90"]}),"\n",(0,i.jsx)(e.p,{children:"\u5904\u7406\u539f\u7406\uff1a\u9759\u8bf7\u6c42\u53bb\u5bfb\u627e Controller \u5904\u7406\uff0c\u4e0d\u80fd\u5904\u7406\u7684\u8bf7\u6c42\u5c31\u4f1a\u4ea4\u7ed9\u9759\u6001\u8d44\u6e90\u5904\u7406\u5668\uff0c\u9759\u6001\u8d44\u6e90\u4e5f\u627e\u4e0d\u5230\u5c31\u54cd\u5e94 404 \u9875\u9762"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539\u9ed8\u8ba4\u8d44\u6e90\u8def\u5f84\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  web:\n    resources:\n      static-locations:: [classpath:/haha/]\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u4fee\u6539\u9759\u6001\u8d44\u6e90\u8bbf\u95ee\u524d\u7f00\uff0c\u9ed8\u8ba4\u662f ",(0,i.jsx)(e.code,{children:"/**"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  mvc:\n    static-path-pattern: /resources/**\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee URL\uff1a",(0,i.jsx)(e.code,{children:"http://localhost:8080/resources/"})," + \u9759\u6001\u8d44\u6e90\u540d\uff0c\u5c06\u6240\u6709\u8d44\u6e90",(0,i.jsx)(e.strong,{children:"\u91cd\u5b9a\u4f4d"}),"\u5230 ",(0,i.jsx)(e.code,{children:"/resources/"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"webjar \u8bbf\u95ee\u8d44\u6e90\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.webjars</groupId>\n    <artifactId>jquery</artifactId>\n    <version>3.5.1</version>\n</dependency>\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee\u5730\u5740\uff1a",(0,i.jsx)(e.code,{children:"http://localhost:8080/webjars/jquery/3.5.1/jquery.js"}),"\uff0c\u540e\u9762\u5730\u5740\u8981\u6309\u7167\u4f9d\u8d56\u91cc\u9762\u7684\u5305\u8def\u5f84"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6b22\u8fce\u9875\u9762",children:"\u6b22\u8fce\u9875\u9762"}),"\n",(0,i.jsxs)(e.p,{children:["\u9759\u6001\u8d44\u6e90\u8def\u5f84\u4e0b index.html \u9ed8\u8ba4\u4f5c\u4e3a\u6b22\u8fce\u9875\u9762\uff0c\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://localhost:8080"})," \u51fa\u73b0\u8be5\u9875\u9762\uff0c\u4f7f\u7528 welcome page \u529f\u80fd\u4e0d\u80fd\u4fee\u6539\u524d\u7f00"]}),"\n",(0,i.jsx)(e.p,{children:"\u7f51\u9875\u6807\u7b7e\u4e0a\u7684\u5c0f\u56fe\u6807\u53ef\u4ee5\u81ea\u5b9a\u4e49\u89c4\u5219\uff0c\u628a\u8d44\u6e90\u91cd\u547d\u540d\u4e3a favicon.ico \u653e\u5728\u9759\u6001\u8d44\u6e90\u76ee\u5f55\u4e0b\u5373\u53ef"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6e90\u7801\u5206\u6790",children:"\u6e90\u7801\u5206\u6790"}),"\n",(0,i.jsx)(e.p,{children:"SpringMVC \u529f\u80fd\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b WebMvcAutoConfiguration\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class WebMvcAutoConfiguration {\n    //\u5f53\u524d\u9879\u76ee\u7684\u6839\u8def\u5f84\n    private static final String SERVLET_LOCATION = "/";\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5185\u90e8\u7c7b WebMvcAutoConfigurationAdapter\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Import(EnableWebMvcConfiguration.class)\n// \u7ed1\u5b9a spring.mvc\u3001spring.web\u3001spring.resources \u76f8\u5173\u7684\u914d\u7f6e\u5c5e\u6027\n@EnableConfigurationProperties({ WebMvcProperties.class,ResourceProperties.class, WebProperties.class })\n@Order(0)\npublic static class WebMvcAutoConfigurationAdapter implements WebMvcConfigurer, ServletContextAware {\n\t//\u6709\u53c2\u6784\u9020\u5668\u6240\u6709\u53c2\u6570\u7684\u503c\u90fd\u4f1a\u4ece\u5bb9\u5668\u4e2d\u786e\u5b9a\n    public WebMvcAutoConfigurationAdapter(/*\u53c2\u6570*/) {\n\t\t\tthis.resourceProperties = resourceProperties.hasBeenCustomized() ? resourceProperties\n\t\t\t\t\t: webProperties.getResources();\n\t\t\tthis.mvcProperties = mvcProperties;\n\t\t\tthis.beanFactory = beanFactory;\n\t\t\tthis.messageConvertersProvider = messageConvertersProvider;\n\t\t\tthis.resourceHandlerRegistrationCustomizer = resourceHandlerRegistrationCustomizerProvider.getIfAvailable();\n\t\t\tthis.dispatcherServletPath = dispatcherServletPath;\n\t\t\tthis.servletRegistrations = servletRegistrations;\n\t\t\tthis.mvcProperties.checkConfiguration();\n\t}\n}\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"ResourceProperties resourceProperties\uff1a\u83b7\u53d6\u548c spring.resources \u7ed1\u5b9a\u7684\u6240\u6709\u7684\u503c\u7684\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"WebMvcProperties mvcProperties\uff1a\u83b7\u53d6\u548c spring.mvc \u7ed1\u5b9a\u7684\u6240\u6709\u7684\u503c\u7684\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"ListableBeanFactory beanFactory\uff1aSpring \u7684 beanFactory"}),"\n",(0,i.jsx)(e.li,{children:"HttpMessageConverters\uff1a\u627e\u5230\u6240\u6709\u7684 HttpMessageConverters"}),"\n",(0,i.jsx)(e.li,{children:"ResourceHandlerRegistrationCustomizer\uff1a\u627e\u5230 \u8d44\u6e90\u5904\u7406\u5668\u7684\u81ea\u5b9a\u4e49\u5668\u3002"}),"\n",(0,i.jsx)(e.li,{children:"DispatcherServletPath\uff1a\u9879\u76ee\u8def\u5f84"}),"\n",(0,i.jsx)(e.li,{children:"ServletRegistrationBean\uff1a\u7ed9\u5e94\u7528\u6ce8\u518c Servlet\u3001Filter"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter.addResourceHandler()\uff1a\u4e24\u79cd\u9759\u6001\u8d44\u6e90\u6620\u5c04\u89c4\u5219"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public void addResourceHandlers(ResourceHandlerRegistry registry) {\n    //\u914d\u7f6e\u6587\u4ef6\u8bbe\u7f6e spring.resources.add-mappings: false\uff0c\u7981\u7528\u6240\u6709\u9759\u6001\u8d44\u6e90\n    if (!this.resourceProperties.isAddMappings()) {\n        logger.debug("Default resource handling disabled");//\u88ab\u7981\u7528\n        return;\n    }\n    //\u6ce8\u518cwebjars\u9759\u6001\u8d44\u6e90\u7684\u6620\u5c04\u89c4\u5219\t\u6620\u5c04\t\t\t\u8def\u5f84\n    addResourceHandler(registry, "/webjars/**", "classpath:/META-INF/resources/webjars/");\n    //\u6ce8\u518c\u9759\u6001\u8d44\u6e90\u8def\u5f84\u7684\u6620\u5c04\u89c4\u5219\t\t \u9ed8\u8ba4\u6620\u5c04 staticPathPattern = "/**" \n    addResourceHandler(registry, this.mvcProperties.getStaticPathPattern(), (registration) -> {\n        //staticLocations = CLASSPATH_RESOURCE_LOCATIONS\n        registration.addResourceLocations(this.resourceProperties.getStaticLocations());\n        if (this.servletContext != null) {\n            ServletContextResource resource = new ServletContextResource(this.servletContext, SERVLET_LOCATION);\n            registration.addResourceLocations(resource);\n        }\n    });\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@ConfigurationProperties("spring.web")\npublic class WebProperties {\n    public static class Resources {\n    \t//\u9ed8\u8ba4\u8d44\u6e90\u8def\u5f84\uff0c\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\n    \tstatic final String[] CLASSPATH_RESOURCE_LOCATIONS = { "classpath:/META-INF/resources/",\n                                                 "classpath:/resources/", \n                                                 "classpath:/static/", "classpath:/public/" }\n        private String[] staticLocations = CLASSPATH_RESOURCE_LOCATIONS;\n        //\u53ef\u4ee5\u8fdb\u884c\u89c4\u5219\u91cd\u5199\n        public void setStaticLocations(String[] staticLocations) {\n\t\t\tthis.staticLocations = appendSlashIfNecessary(staticLocations);\n\t\t\tthis.customized = true;\n\t\t}\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"WebMvcAutoConfiguration.EnableWebMvcConfiguration.welcomePageHandlerMapping()\uff1a\u6b22\u8fce\u9875"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'//spring.web \u5c5e\u6027\n@EnableConfigurationProperties(WebProperties.class)\npublic static class EnableWebMvcConfiguration {\n    @Bean\n    public WelcomePageHandlerMapping welcomePageHandlerMapping(/*\u53c2\u6570*/) {\n        WelcomePageHandlerMapping welcomePageHandlerMapping = new WelcomePageHandlerMapping(\n            new TemplateAvailabilityProviders(applicationContext), \n            applicationContext, getWelcomePage(),\n            //staticPathPattern = "/**"\n            this.mvcProperties.getStaticPathPattern());\n        return welcomePageHandlerMapping;\n    }\n}\nWelcomePageHandlerMapping(/*\u53c2\u6570*/) {\n    //\u6240\u4ee5\u9650\u5236 staticPathPattern \u5fc5\u987b\u4e3a /** \u624d\u80fd\u542f\u7528\u8be5\u529f\u80fd\n    if (welcomePage != null && "/**".equals(staticPathPattern)) {\n        logger.info("Adding welcome page: " + welcomePage);\n        //\u91cd\u5b9a\u5411\n        setRootViewName("forward:index.html");\n    }\n    else if (welcomeTemplateExists(templateAvailabilityProviders, applicationContext)) {\n        logger.info("Adding welcome page template: index");\n        setRootViewName("index");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"WelcomePageHandlerMapping\uff0c\u8bbf\u95ee / \u80fd\u8bbf\u95ee\u5230 index.html"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"rest\u6620\u5c04",children:"Rest\u6620\u5c04"}),"\n",(0,i.jsx)(e.p,{children:"\u5f00\u542f Rest \u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  mvc:\n    hiddenmethod:\n      filter:\n        enabled: true   #\u5f00\u542f\u9875\u9762\u8868\u5355\u7684Rest\u529f\u80fd\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6e90\u7801\u5206\u6790\uff0c\u6ce8\u5165\u4e86 HiddenHttpMethodFilte \u89e3\u6790 Rest \u98ce\u683c\u7684\u8bbf\u95ee\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class WebMvcAutoConfiguration {\n    @Bean\n\t@ConditionalOnMissingBean(HiddenHttpMethodFilter.class)\n\t@ConditionalOnProperty(prefix = "spring.mvc.hiddenmethod.filter", name = "enabled")\n\tpublic OrderedHiddenHttpMethodFilter hiddenHttpMethodFilter() {\n\t\treturn new OrderedHiddenHttpMethodFilter();\n\t}\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8be6\u7ec6\u6e90\u7801\u89e3\u6790\uff1aSpringMVC \u2192 \u57fa\u672c\u64cd\u4f5c \u2192 Restful \u2192 \u8bc6\u522b\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"Web \u90e8\u5206\u6e90\u7801\u8be6\u89e3\uff1aSpringMVC \u2192 \u8fd0\u884c\u539f\u7406"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5185\u5d4c\u5bb9\u5668",children:"\u5185\u5d4c\u5bb9\u5668"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u5d4c\u5165\u5f0f Servlet \u5bb9\u5668\uff0c\u9ed8\u8ba4\u652f\u6301\u7684 WebServe\uff1aTomcat\u3001Jetty\u3001Undertow"}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n    <exclusions>\n        <exclusion> \x3c!--\u5fc5\u987b\u8981\u628a\u5185\u5d4c\u7684 Tomcat \u5bb9\u5668--\x3e\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-tomcat</artifactId>\n        </exclusion>\n    </exclusions>\n</dependency>\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-jetty</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.p,{children:"Web \u5e94\u7528\u542f\u52a8\uff0cSpringBoot \u5bfc\u5165 Web \u573a\u666f\u5305 tomcat\uff0c\u521b\u5efa\u4e00\u4e2a Web \u7248\u7684 IOC \u5bb9\u5668\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"SpringApplication.run(BootApplication.class, args)"}),"\uff1a\u5e94\u7528\u542f\u52a8"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"ConfigurableApplicationContext.run()"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"context = createApplicationContext()"}),"\uff1a",(0,i.jsx)(e.strong,{children:"\u521b\u5efa\u5bb9\u5668"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"applicationContextFactory = ApplicationContextFactory.DEFAULT"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"ApplicationContextFactory DEFAULT = (webApplicationType) -> {\n    try {\n        switch (webApplicationType) {\n            case SERVLET:\n                // Servlet \u5bb9\u5668\uff0c\u7ee7\u627f\u81ea ServletWebServerApplicationContext\n                return new AnnotationConfigServletWebServerApplicationContext();\n            case REACTIVE:\n                // \u54cd\u5e94\u5f0f\u7f16\u7a0b\n                return new AnnotationConfigReactiveWebServerApplicationContext();\n            default:\n                // \u666e\u901a Spring \u5bb9\u5668\n                return new AnnotationConfigApplicationContext();\n        }\n    } catch (Exception ex) {\n        throw new IllegalStateException();\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"applicationContextFactory.create(this.webApplicationType)"}),"\uff1a\u6839\u636e\u5e94\u7528\u7c7b\u578b\u521b\u5efa\u5bb9\u5668"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"refreshContext(context)"}),"\uff1a\u5bb9\u5668\u542f\u52a8\u5237\u65b0"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5185\u5d4c\u5bb9\u5668\u5de5\u4f5c\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Spring \u5bb9\u5668\u542f\u52a8\u903b\u8f91\u4e2d\uff0c\u5728\u5b9e\u4f8b\u5316\u975e\u61d2\u52a0\u8f7d\u7684\u5355\u4f8b Bean \u4e4b\u524d\u6709\u4e00\u4e2a\u65b9\u6cd5 ",(0,i.jsx)(e.strong,{children:"onRefresh()"}),"\uff0c\u7559\u7ed9\u5b50\u7c7b\u53bb\u6269\u5c55\uff0cWeb \u5bb9\u5668\u5c31\u662f\u91cd\u5199\u8fd9\u4e2a\u65b9\u6cd5\u521b\u5efa WebServer"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"protected void onRefresh() {\n    //\u7701\u7565....\n\tcreateWebServer();\n}\nprivate void createWebServer() {\n    ServletWebServerFactory factory = getWebServerFactory();\n    this.webServer = factory.getWebServer(getSelfInitializer());\n    createWebServer.end();\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6 WebServer \u5de5\u5382 ServletWebServerFactory\uff0c\u5e76\u4e14\u83b7\u53d6\u7684\u6570\u91cf\u4e0d\u7b49\u4e8e 1 \u4f1a\u62a5\u9519\uff0cSpring \u5e95\u5c42\u6709\u4e09\u79cd\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"TomcatServletWebServerFactory"}),"\u3001",(0,i.jsx)(e.code,{children:"JettyServletWebServerFactory"}),"\u3001",(0,i.jsx)(e.code,{children:"UndertowServletWebServerFactory"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u81ea\u52a8\u914d\u7f6e\u7c7b ServletWebServerFactoryAutoConfiguration"})," \u5bfc\u5165\u4e86 ServletWebServerFactoryConfiguration\uff08\u914d\u7f6e\u7c7b\uff09\uff0c\u6839\u636e\u6761\u4ef6\u88c5\u914d\u5224\u65ad\u7cfb\u7edf\u4e2d\u5230\u5e95\u5bfc\u5165\u4e86\u54ea\u4e2a Web \u670d\u52a1\u5668\u7684\u5305\uff0c\u521b\u5efa\u51fa\u670d\u52a1\u5668\u5e76\u542f\u52a8"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9ed8\u8ba4\u662f web-starter \u5bfc\u5165 tomcat \u5305\uff0c\u5bb9\u5668\u4e2d\u5c31\u6709 TomcatServletWebServerFactory\uff0c\u521b\u5efa\u51fa Tomcat \u670d\u52a1\u5668\u5e76\u542f\u52a8\uff0c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public TomcatWebServer(Tomcat tomcat, boolean autoStart, Shutdown shutdown) {\n\t// \u521d\u59cb\u5316\n   \tinitialize();\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u521d\u59cb\u5316\u65b9\u6cd5 initialize \u4e2d\u6709\u542f\u52a8\u65b9\u6cd5\uff1a",(0,i.jsx)(e.code,{children:"this.tomcat.start()"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49-3",children:"\u81ea\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.h4,{id:"\u5b9a\u5236\u89c4\u5219",children:"\u5b9a\u5236\u89c4\u5219"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class MyWebMvcConfigurer implements WebMvcConfigurer {\n    @Bean\n    public WebMvcConfigurer webMvcConfigurer() {\n        return new WebMvcConfigurer() {\n            //\u8fdb\u884c\u4e00\u4e9b\u65b9\u6cd5\u91cd\u5199\uff0c\u6765\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u89c4\u5219\n            //\u6bd4\u5982\u6dfb\u52a0\u4e00\u4e9b\u89e3\u6790\u5668\u548c\u62e6\u622a\u5668\uff0c\u5c31\u662f\u5bf9\u539f\u59cb\u5bb9\u5668\u529f\u80fd\u7684\u589e\u52a0\n        }\n    }\n    //\u4e5f\u53ef\u4ee5\u4e0d\u52a0 @Bean\uff0c\u76f4\u63a5\u4ece\u8fd9\u91cc\u91cd\u5199\u65b9\u6cd5\u8fdb\u884c\u529f\u80fd\u589e\u52a0\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5b9a\u5236\u5bb9\u5668",children:"\u5b9a\u5236\u5bb9\u5668"}),"\n",(0,i.jsx)(e.p,{children:"@EnableWebMvc\uff1a\u5168\u9762\u63a5\u7ba1 SpringMVC\uff0c\u6240\u6709\u89c4\u5219\u5168\u90e8\u81ea\u5df1\u91cd\u65b0\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@EnableWebMvc + WebMvcConfigurer + @Bean  \u5168\u9762\u63a5\u7ba1SpringMVC"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Import(DelegatingWebMvcConfiguration.",(0,i.jsx)(e.strong,{children:"class"}),")\uff0c\u8be5\u7c7b\u7ee7\u627f WebMvcConfigurationSupport\uff0c\u81ea\u52a8\u914d\u7f6e\u4e86\u4e00\u4e9b\u975e\u5e38\u5e95\u5c42\u7684\u7ec4\u4ef6\uff0c\u53ea\u80fd\u4fdd\u8bc1 SpringMVC \u6700\u57fa\u672c\u7684\u4f7f\u7528"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u539f\u7406\uff1a\u81ea\u52a8\u914d\u7f6e\u7c7b ",(0,i.jsx)(e.strong,{children:"WebMvcAutoConfiguration"})," \u91cc\u9762\u7684\u914d\u7f6e\u8981\u80fd\u751f\u6548\uff0cWebMvcConfigurationSupport \u7c7b\u4e0d\u80fd\u88ab\u52a0\u8f7d\uff0c\u6240\u4ee5 @EnableWebMvc \u5bfc\u81f4\u914d\u7f6e\u7c7b\u5931\u6548\uff0c\u4ece\u800c\u63a5\u7ba1\u4e86 SpringMVC"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)\npublic class WebMvcAutoConfiguration {}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u4e00\u822c\u4e0d\u9002\u7528\u6b64\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u6570\u636e\u8bbf\u95ee",children:"\u6570\u636e\u8bbf\u95ee"}),"\n",(0,i.jsx)(e.h3,{id:"jdbc",children:"JDBC"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-1",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165 starter\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u5bfc\u5165 JDBC \u573a\u666f--\x3e\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-jdbc</artifactId>\n</dependency>\n\x3c!--\u5bfc\u5165 MySQL \u9a71\u52a8--\x3e\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    \x3c!--\u7248\u672c\u5bf9\u5e94\u4f60\u7684 MySQL \u7248\u672c<version>5.1.49</version>--\x3e\n</dependency>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5355\u72ec\u5bfc\u5165 MySQL \u9a71\u52a8\u662f\u56e0\u4e3a\u4e0d\u786e\u5b9a\u7528\u6237\u4f7f\u7528\u7684\u4ec0\u4e48\u6570\u636e\u5e93"}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  datasource:\n    url: jdbc:mysql://192.168.0.107:3306/db1?useSSL=false\t# \u4e0d\u52a0 useSSL \u4f1a\u8b66\u544a\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Slf4j\n@SpringBootTest\nclass Boot05WebAdminApplicationTests {\n\n    @Autowired\n    JdbcTemplate jdbcTemplate;\n\n    @Test\n    void contextLoads() {\n        Long res = jdbcTemplate.queryForObject("select count(*) from account_tbl", Long.class);\n        log.info("\u8bb0\u5f55\u603b\u6570\uff1a{}", res);\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u81ea\u52a8\u914d\u7f6e",children:"\u81ea\u52a8\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"DataSourceAutoConfiguration\uff1a\u6570\u636e\u6e90\u7684\u81ea\u52a8\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration(proxyBeanMethods = false)\n@ConditionalOnClass({ DataSource.class, EmbeddedDatabaseType.class })\n@EnableConfigurationProperties(DataSourceProperties.class)\npublic class DataSourceAutoConfiguration {\n    \n\t@Conditional(PooledDataSourceCondition.class) \n\t@ConditionalOnMissingBean({ DataSource.class, XADataSource.class })\n\t@Import({ DataSourceConfiguration.Hikari.class, DataSourceConfiguration.Tomcat.class,\n\t\t\tDataSourceConfiguration.Dbcp2.class, DataSourceConfiguration.OracleUcp.class})\n\tprotected static class PooledDataSourceConfiguration {}\n}\n// \u914d\u7f6e\u9879\n@ConfigurationProperties(prefix = "spring.datasource")\npublic class DataSourceProperties implements BeanClassLoaderAware, InitializingBean {}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5e95\u5c42\u9ed8\u8ba4\u914d\u7f6e\u597d\u7684\u8fde\u63a5\u6c60\u662f\uff1a",(0,i.jsx)(e.strong,{children:"HikariDataSource"})]}),"\n",(0,i.jsx)(e.li,{children:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u914d\u7f6e\uff0c\u662f\u5bb9\u5668\u4e2d\u6ca1\u6709 DataSource \u624d\u81ea\u52a8\u914d\u7f6e\u7684"}),"\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539\u6570\u636e\u6e90\u76f8\u5173\u7684\u914d\u7f6e\uff1aspring.datasource"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u76f8\u5173\u914d\u7f6e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"DataSourceTransactionManagerAutoConfiguration\uff1a \u4e8b\u52a1\u7ba1\u7406\u5668\u7684\u81ea\u52a8\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.li,{children:["JdbcTemplateAutoConfiguration\uff1a JdbcTemplate \u7684\u81ea\u52a8\u914d\u7f6e\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u53ef\u4ee5\u4fee\u6539\u8fd9\u4e2a\u914d\u7f6e\u9879 @ConfigurationProperties(prefix = ",(0,i.jsx)(e.strong,{children:'"spring.jdbc"'}),") \u6765\u4fee\u6539JdbcTemplate"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"@AutoConfigureAfter(DataSourceAutoConfiguration.class)"}),"\uff1a\u5728 DataSource \u88c5\u914d\u540e\u88c5\u914d"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"JndiDataSourceAutoConfiguration\uff1a jndi \u7684\u81ea\u52a8\u914d\u7f6e"}),"\n",(0,i.jsx)(e.li,{children:"XADataSourceAutoConfiguration\uff1a \u5206\u5e03\u5f0f\u4e8b\u52a1\u76f8\u5173"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"druid-2",children:"Druid"}),"\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5750\u6807\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>druid-spring-boot-starter</artifactId>\n    <version>1.1.17</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\n@ConditionalOnClass(DruidDataSource.class)\n@AutoConfigureBefore(DataSourceAutoConfiguration.class)\n@EnableConfigurationProperties({DruidStatProperties.class, DataSourceProperties.class})\n@Import({DruidSpringAopConfiguration.class,\n    DruidStatViewServletConfiguration.class,\n    DruidWebStatFilterConfiguration.class,\n    DruidFilterConfiguration.class})\npublic class DruidDataSourceAutoConfigure {}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u52a8\u914d\u7f6e\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6269\u5c55\u914d\u7f6e\u9879 ",(0,i.jsx)(e.strong,{children:"spring.datasource.druid"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["DruidSpringAopConfiguration\uff1a \u76d1\u63a7 SpringBean\uff0c\u914d\u7f6e\u9879\u4e3a ",(0,i.jsx)(e.code,{children:"spring.datasource.druid.aop-patterns"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["DruidStatViewServletConfiguration\uff1a\u76d1\u63a7\u9875\u7684\u914d\u7f6e\u9879\u4e3a ",(0,i.jsx)(e.code,{children:"spring.datasource.druid.stat-view-servlet"}),"\uff0c\u9ed8\u8ba4\u5f00\u542f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["DruidWebStatFilterConfiguration\uff1aWeb \u76d1\u63a7\u914d\u7f6e\u9879\u4e3a ",(0,i.jsx)(e.code,{children:"spring.datasource.druid.web-stat-filter"}),"\uff0c\u9ed8\u8ba4\u5f00\u542f"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DruidFilterConfiguration\uff1a\u6240\u6709 Druid \u81ea\u5df1 filter \u7684\u914d\u7f6e"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/db_account\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\n    druid:\n      aop-patterns: com.atguigu.admin.*  #\u76d1\u63a7SpringBean\n      filters: stat,wall     # \u5e95\u5c42\u5f00\u542f\u529f\u80fd\uff0cstat\uff08sql\u76d1\u63a7\uff09\uff0cwall\uff08\u9632\u706b\u5899\uff09\n\n      stat-view-servlet:   # \u914d\u7f6e\u76d1\u63a7\u9875\u529f\u80fd\n        enabled: true\n        login-username: admin\t#\u9879\u76ee\u542f\u52a8\u8bbf\u95ee\uff1ahttp://localhost:8080/druid \uff0c\u8d26\u53f7\u548c\u5bc6\u7801\u662f admin\n        login-password: admin\n        resetEnable: false\n\n      web-stat-filter:  # \u76d1\u63a7web\n        enabled: true\n        urlPattern: /*\n        exclusions: '*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*'\n\n\n      filter:\n        stat:    # \u5bf9\u4e0a\u9762filters\u91cc\u9762\u7684stat\u7684\u8be6\u7ec6\u914d\u7f6e\n          slow-sql-millis: 1000\n          logSlowSql: true\n          enabled: true\n        wall:\n          enabled: true\n          config:\n            drop-table-allow: false\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u914d\u7f6e\u793a\u4f8b\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/alibaba/druid/tree/master/druid-spring-boot-starter",children:"https://github.com/alibaba/druid/tree/master/druid-spring-boot-starter"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u914d\u7f6e\u9879\u5217\u8868\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/alibaba/druid/wiki/DruidDataSource%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E5%88%97%E8%A1%A8",children:"https://github.com/alibaba/druid/wiki/DruidDataSource%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E5%88%97%E8%A1%A8"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"mybatis-2",children:"MyBatis"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-2",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u5bfc\u5165\u5750\u6807\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.mybatis.spring.boot</groupId>\n    <artifactId>mybatis-spring-boot-starter</artifactId>\n    <version>2.1.4</version>\n</dependency>\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7f16\u5199 MyBatis \u76f8\u5173\u914d\u7f6e\uff1aapplication.yml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# \u914d\u7f6emybatis\u89c4\u5219\nmybatis:\n#  config-location: classpath:mybatis/mybatis-config.xml  \u5efa\u8bae\u4e0d\u5199\n  mapper-locations: classpath:mybatis/mapper/*.xml\n  configuration:\n    map-underscore-to-camel-case: true\n    \n #\u53ef\u4ee5\u4e0d\u5199\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\uff0c\u6240\u6709\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\u7684\u914d\u7f6e\u90fd\u653e\u5728 configuration \u914d\u7f6e\u9879\u4e2d\u5373\u53ef\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9a\u4e49\u8868\u548c\u5b9e\u4f53\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class User {\n    private int id;\n    private String username;\n    private String password;\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7f16\u5199 dao \u548c mapper \u6587\u4ef6/\u7eaf\u6ce8\u89e3\u5f00\u53d1"}),"\n",(0,i.jsxs)(e.p,{children:["dao\uff1a",(0,i.jsx)(e.strong,{children:"@Mapper \u6ce8\u89e3\u5fc5\u987b\u52a0\uff0c\u4f7f\u7528\u81ea\u52a8\u88c5\u914d\u7684 package\uff0c\u5426\u5219\u5728\u542f\u52a8\u7c7b\u6307\u5b9a @MapperScan() \u626b\u63cf\u8def\u5f84\uff08\u4e0d\u5efa\u8bae\uff09"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Mapper  //\u5fc5\u987b\u52a0Mapper\n@Repository\npublic interface UserXmlMapper {\n    public List<User> findAll();\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"mapper.xml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.seazean.springbootmybatis.mapper.UserXmlMapper">\n    <select id="findAll" resultType="user">\n        select * from t_user\n    </select>\n</mapper>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7eaf\u6ce8\u89e3\u5f00\u53d1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Mapper\n@Repository\npublic interface UserMapper {\n    @Select("select * from t_user")\n    public List<User> findAll();\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u81ea\u52a8\u914d\u7f6e-1",children:"\u81ea\u52a8\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"MybatisAutoConfiguration\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@EnableConfigurationProperties(MybatisProperties.class)\t//MyBatis\u914d\u7f6e\u9879\u7ed1\u5b9a\u7c7b\u3002\n@AutoConfigureAfter({ DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class })\npublic class MybatisAutoConfiguration {\n    @Bean\n  \t@ConditionalOnMissingBean\n  \tpublic SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n    \tSqlSessionFactoryBean factory = new SqlSessionFactoryBean();\n        return factory.getObject();\n    }\n    \n    @org.springframework.context.annotation.Configuration\n   \t@Import(AutoConfiguredMapperScannerRegistrar.class)\n   \t@ConditionalOnMissingBean({ MapperFactoryBean.class, MapperScannerConfigurer.class })\n   \tpublic static class MapperScannerRegistrarNotFoundConfiguration implements InitializingBean {}\n}\n\n@ConfigurationProperties(prefix = "mybatis")\npublic class MybatisProperties {}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u914d\u7f6e\u6587\u4ef6\uff1a",(0,i.jsx)(e.code,{children:"mybatis"})]}),"\n",(0,i.jsx)(e.li,{children:"\u81ea\u52a8\u914d\u7f6e\u4e86 SqlSessionFactory"}),"\n",(0,i.jsxs)(e.li,{children:["\u5bfc\u5165 ",(0,i.jsx)(e.code,{children:"AutoConfiguredMapperScannerRegistra"})," \u5b9e\u73b0 @Mapper \u7684\u626b\u63cf"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"mybatis-plus",children:"MyBatis-Plus"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.baomidou</groupId>\n    <artifactId>mybatis-plus-boot-starter</artifactId>\n    <version>3.4.1</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u52a8\u914d\u7f6e\u7c7b\uff1aMybatisPlusAutoConfiguration"}),"\n",(0,i.jsxs)(e.p,{children:["\u53ea\u9700\u8981 Mapper \u7ee7\u627f ",(0,i.jsx)(e.strong,{children:"BaseMapper"})," \u5c31\u53ef\u4ee5\u62e5\u6709 CRUD \u529f\u80fd"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"redis",children:"Redis"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-3",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6eredis\u76f8\u5173\u5c5e\u6027"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  redis:\n    host: 127.0.0.1 # redis\u7684\u4e3b\u673aip\n    port: 6379\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6ce8\u5165 RedisTemplate \u6a21\u677f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RunWith(SpringRunner.class)\n@SpringBootTest\npublic class SpringbootRedisApplicationTests {\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    @Test\n    public void testSet() {\n        //\u5b58\u5165\u6570\u636e\n        redisTemplate.boundValueOps("name").set("zhangsan");\n    }\n    @Test\n    public void testGet() {\n        //\u83b7\u53d6\u6570\u636e\n        Object name = redisTemplate.boundValueOps("name").get();\n        System.out.println(name);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u81ea\u52a8\u914d\u7f6e-2",children:"\u81ea\u52a8\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"RedisAutoConfiguration \u81ea\u52a8\u914d\u7f6e\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration(proxyBeanMethods = false)\n@ConditionalOnClass(RedisOperations.class)\n@EnableConfigurationProperties(RedisProperties.class)\n@Import({ LettuceConnectionConfiguration.class, JedisConnectionConfiguration.class })\npublic class RedisAutoConfiguration {\n    @Bean\n    @ConditionalOnMissingBean(name = "redisTemplate")\n    @ConditionalOnSingleCandidate(RedisConnectionFactory.class)\n    public RedisTemplate<Object, Object> redisTemplate(RedisConnectionFactory redisConnectionFactory) {\n        RedisTemplate<Object, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(redisConnectionFactory);\n        return template;\n    }\n\n    @Bean\n    @ConditionalOnMissingBean\n    @ConditionalOnSingleCandidate(RedisConnectionFactory.class)\n    public StringRedisTemplate stringRedisTemplate(RedisConnectionFactory redisConnectionFactory) {\n        StringRedisTemplate template = new StringRedisTemplate();\n        template.setConnectionFactory(redisConnectionFactory);\n        return template;\n    }\n\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u914d\u7f6e\u9879\uff1a",(0,i.jsx)(e.code,{children:"spring.redis"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u52a8\u5bfc\u5165\u4e86\u8fde\u63a5\u5de5\u5382\u914d\u7f6e\u7c7b\uff1aLettuceConnectionConfiguration\u3001JedisConnectionConfiguration"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u52a8\u6ce8\u5165\u4e86\u6a21\u677f\u7c7b\uff1aRedisTemplate<Object, Object> \u3001StringRedisTemplate\uff0ck v \u90fd\u662f String \u7c7b\u578b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 @Autowired \u6ce8\u5165\u6a21\u677f\u7c7b\u5c31\u53ef\u4ee5\u64cd\u4f5c redis"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u5355\u5143\u6d4b\u8bd5",children:"\u5355\u5143\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.h3,{id:"junit5",children:"Junit5"}),"\n",(0,i.jsx)(e.p,{children:"Spring Boot 2.2.0 \u7248\u672c\u5f00\u59cb\u5f15\u5165 JUnit 5 \u4f5c\u4e3a\u5355\u5143\u6d4b\u8bd5\u9ed8\u8ba4\u5e93\uff0c\u7531\u4e09\u4e2a\u4e0d\u540c\u7684\u5b50\u6a21\u5757\u7ec4\u6210\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JUnit Platform\uff1a\u5728 JVM \u4e0a\u542f\u52a8\u6d4b\u8bd5\u6846\u67b6\u7684\u57fa\u7840\uff0c\u4e0d\u4ec5\u652f\u6301 Junit \u81ea\u5236\u7684\u6d4b\u8bd5\u5f15\u64ce\uff0c\u5176\u4ed6\u6d4b\u8bd5\u5f15\u64ce\u4e5f\u53ef\u4ee5\u63a5\u5165"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JUnit Jupiter\uff1a\u63d0\u4f9b\u4e86 JUnit5 \u7684\u65b0\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u662f JUnit5 \u65b0\u7279\u6027\u7684\u6838\u5fc3\uff0c\u5185\u90e8\u5305\u542b\u4e86\u4e00\u4e2a\u6d4b\u8bd5\u5f15\u64ce\uff0c\u7528\u4e8e\u5728 Junit Platform \u4e0a\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"JUnit Vintage\uff1aJUnit Vintage \u63d0\u4f9b\u4e86\u517c\u5bb9 JUnit4.x\u3001Junit3.x \u7684\u6d4b\u8bd5\u5f15\u64ce"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1aSpringBoot 2.4 \u4ee5\u4e0a\u7248\u672c\u79fb\u9664\u4e86\u9ed8\u8ba4\u5bf9 Vintage \u7684\u4f9d\u8d56\uff0c\u5982\u679c\u9700\u8981\u517c\u5bb9 Junit4 \u9700\u8981\u81ea\u884c\u5f15\u5165"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootTest\nclass Boot05WebAdminApplicationTests {\n    @Test\n    void contextLoads() { }\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5e38\u7528\u6ce8\u89e3-1",children:"\u5e38\u7528\u6ce8\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"JUnit5 \u7684\u6ce8\u89e3\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["@Test\uff1a\u8868\u793a\u65b9\u6cd5\u662f\u6d4b\u8bd5\u65b9\u6cd5\uff0c\u4f46\u662f\u4e0e JUnit4 \u7684 @Test \u4e0d\u540c\uff0c\u5b83\u7684\u804c\u8d23\u975e\u5e38\u5355\u4e00\u4e0d\u80fd\u58f0\u660e\u4efb\u4f55\u5c5e\u6027\uff0c\u62d3\u5c55\u7684\u6d4b\u8bd5\u5c06\u4f1a\u7531 Jupiter \u63d0\u4f9b\u989d\u5916\u6d4b\u8bd5\uff0c\u5305\u662f ",(0,i.jsx)(e.code,{children:"org.junit.jupiter.api.Test"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@ParameterizedTest\uff1a\u8868\u793a\u65b9\u6cd5\u662f\u53c2\u6570\u5316\u6d4b\u8bd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@RepeatedTest\uff1a\u8868\u793a\u65b9\u6cd5\u53ef\u91cd\u590d\u6267\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@DisplayName\uff1a\u4e3a\u6d4b\u8bd5\u7c7b\u6216\u8005\u6d4b\u8bd5\u65b9\u6cd5\u8bbe\u7f6e\u5c55\u793a\u540d\u79f0"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@BeforeEach\uff1a\u8868\u793a\u5728\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u4e4b\u524d\u6267\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@AfterEach\uff1a\u8868\u793a\u5728\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u4e4b\u540e\u6267\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@BeforeAll\uff1a\u8868\u793a\u5728\u6240\u6709\u5355\u5143\u6d4b\u8bd5\u4e4b\u524d\u6267\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@AfterAll\uff1a\u8868\u793a\u5728\u6240\u6709\u5355\u5143\u6d4b\u8bd5\u4e4b\u540e\u6267\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@Tag\uff1a\u8868\u793a\u5355\u5143\u6d4b\u8bd5\u7c7b\u522b\uff0c\u7c7b\u4f3c\u4e8e JUnit4 \u4e2d\u7684 @Categories"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@Disabled\uff1a\u8868\u793a\u6d4b\u8bd5\u7c7b\u6216\u6d4b\u8bd5\u65b9\u6cd5\u4e0d\u6267\u884c\uff0c\u7c7b\u4f3c\u4e8e JUnit4 \u4e2d\u7684 @Ignore"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@Timeout\uff1a\u8868\u793a\u6d4b\u8bd5\u65b9\u6cd5\u8fd0\u884c\u5982\u679c\u8d85\u8fc7\u4e86\u6307\u5b9a\u65f6\u95f4\u5c06\u4f1a\u8fd4\u56de\u9519\u8bef"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@ExtendWith\uff1a\u4e3a\u6d4b\u8bd5\u7c7b\u6216\u6d4b\u8bd5\u65b9\u6cd5\u63d0\u4f9b\u6269\u5c55\u7c7b\u5f15\u7528"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u65ad\u8a00\u673a\u5236",children:"\u65ad\u8a00\u673a\u5236"}),"\n",(0,i.jsx)(e.h4,{id:"\u7b80\u5355\u65ad\u8a00",children:"\u7b80\u5355\u65ad\u8a00"}),"\n",(0,i.jsx)(e.p,{children:"\u65ad\u8a00\uff08assertions\uff09\u662f\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u7684\u6838\u5fc3\uff0c\u7528\u6765\u5bf9\u6d4b\u8bd5\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\u8fdb\u884c\u9a8c\u8bc1\uff0c\u65ad\u8a00\u65b9\u6cd5\u90fd\u662f org.junit.jupiter.api.Assertions \u7684\u9759\u6001\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u7528\u6765\u5bf9\u5355\u4e2a\u503c\u8fdb\u884c\u7b80\u5355\u7684\u9a8c\u8bc1\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertEquals"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u6216\u4e24\u4e2a\u539f\u59cb\u7c7b\u578b\u662f\u5426\u76f8\u7b49"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertNotEquals"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u6216\u4e24\u4e2a\u539f\u59cb\u7c7b\u578b\u662f\u5426\u4e0d\u76f8\u7b49"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertSame"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u5f15\u7528\u662f\u5426\u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c61"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertNotSame"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u5f15\u7528\u662f\u5426\u6307\u5411\u4e0d\u540c\u7684\u5bf9\u8c61"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertTrue"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u7ed9\u5b9a\u7684\u5e03\u5c14\u503c\u662f\u5426\u4e3a true"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertFalse"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u7ed9\u5b9a\u7684\u5e03\u5c14\u503c\u662f\u5426\u4e3a false"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertNull"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u7ed9\u5b9a\u7684\u5bf9\u8c61\u5f15\u7528\u662f\u5426\u4e3a null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"assertNotNull"}),(0,i.jsx)(e.td,{children:"\u5224\u65ad\u7ed9\u5b9a\u7684\u5bf9\u8c61\u5f15\u7528\u662f\u5426\u4e0d\u4e3a null"})]})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\n@DisplayName("simple assertion")\npublic void simple() {\n     assertEquals(3, 1 + 2, "simple math");\n     assertNull(null);\n     assertNotNull(new Object());\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6570\u7ec4\u65ad\u8a00",children:"\u6570\u7ec4\u65ad\u8a00"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7 assertArrayEquals \u65b9\u6cd5\u6765\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u6216\u539f\u59cb\u7c7b\u578b\u7684\u6570\u7ec4\u662f\u5426\u76f8\u7b49"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\n@DisplayName("array assertion")\npublic void array() {\n \tassertArrayEquals(new int[]{1, 2}, new int[] {1, 2});\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u7ec4\u5408\u65ad\u8a00",children:"\u7ec4\u5408\u65ad\u8a00"}),"\n",(0,i.jsx)(e.p,{children:"assertAll \u65b9\u6cd5\u63a5\u53d7\u591a\u4e2a org.junit.jupiter.api.Executable \u51fd\u6570\u5f0f\u63a5\u53e3\u7684\u5b9e\u4f8b\u4f5c\u4e3a\u9a8c\u8bc1\u7684\u65ad\u8a00\uff0c\u53ef\u4ee5\u901a\u8fc7 lambda \u8868\u8fbe\u5f0f\u63d0\u4f9b\u8fd9\u4e9b\u65ad\u8a00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\n@DisplayName("assert all")\npublic void all() {\n\tassertAll("Math",\n              () -> assertEquals(2, 1 + 1),\n              () -> assertTrue(1 > 0)\n   \t);\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5f02\u5e38\u65ad\u8a00",children:"\u5f02\u5e38\u65ad\u8a00"}),"\n",(0,i.jsx)(e.p,{children:"Assertions.assertThrows()\uff0c\u914d\u5408\u51fd\u6570\u5f0f\u7f16\u7a0b\u5c31\u53ef\u4ee5\u8fdb\u884c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\n@DisplayName("\u5f02\u5e38\u6d4b\u8bd5")\npublic void exceptionTest() {\n    ArithmeticException exception = Assertions.assertThrows(\n        //\u6254\u51fa\u65ad\u8a00\u5f02\u5e38\n\t\tArithmeticException.class, () -> System.out.println(1 / 0)\n    );\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8d85\u65f6\u65ad\u8a00",children:"\u8d85\u65f6\u65ad\u8a00"}),"\n",(0,i.jsx)(e.p,{children:"Assertions.assertTimeout() \u4e3a\u6d4b\u8bd5\u65b9\u6cd5\u8bbe\u7f6e\u4e86\u8d85\u65f6\u65f6\u95f4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\n@DisplayName("\u8d85\u65f6\u6d4b\u8bd5")\npublic void timeoutTest() {\n    //\u5982\u679c\u6d4b\u8bd5\u65b9\u6cd5\u65f6\u95f4\u8d85\u8fc71s\u5c06\u4f1a\u5f02\u5e38\n    Assertions.assertTimeout(Duration.ofMillis(1000), () -> Thread.sleep(500));\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5feb\u901f\u5931\u8d25",children:"\u5feb\u901f\u5931\u8d25"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7 fail \u65b9\u6cd5\u76f4\u63a5\u4f7f\u5f97\u6d4b\u8bd5\u5931\u8d25"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\n@DisplayName("fail")\npublic void shouldFail() {\n\tfail("This should fail");\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u524d\u7f6e\u6761\u4ef6",children:"\u524d\u7f6e\u6761\u4ef6"}),"\n",(0,i.jsxs)(e.p,{children:["JUnit 5 \u4e2d\u7684\u524d\u7f6e\u6761\u4ef6\uff08assumptions\uff09\u7c7b\u4f3c\u4e8e\u65ad\u8a00\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e",(0,i.jsx)(e.strong,{children:"\u4e0d\u6ee1\u8db3\u7684\u65ad\u8a00\u4f1a\u4f7f\u5f97\u6d4b\u8bd5\u65b9\u6cd5\u5931\u8d25"}),"\uff0c\u800c\u4e0d\u6ee1\u8db3\u7684",(0,i.jsx)(e.strong,{children:"\u524d\u7f6e\u6761\u4ef6\u53ea\u4f1a\u4f7f\u5f97\u6d4b\u8bd5\u65b9\u6cd5\u7684\u6267\u884c\u7ec8\u6b62"}),"\uff0c\u524d\u7f6e\u6761\u4ef6\u53ef\u4ee5\u770b\u6210\u662f\u6d4b\u8bd5\u65b9\u6cd5\u6267\u884c\u7684\u524d\u63d0\uff0c\u5f53\u8be5\u524d\u63d0\u4e0d\u6ee1\u8db3\u65f6\uff0c\u5c31\u6ca1\u6709\u7ee7\u7eed\u6267\u884c\u7684\u5fc5\u8981"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@DisplayName("\u6d4b\u8bd5\u524d\u7f6e\u6761\u4ef6")\n@Test\nvoid testassumptions(){\n    Assumptions.assumeTrue(false,"\u7ed3\u679c\u4e0d\u662ftrue");\n    System.out.println("111111");\n\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5d4c\u5957\u6d4b\u8bd5",children:"\u5d4c\u5957\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.p,{children:"JUnit 5 \u53ef\u4ee5\u901a\u8fc7 Java \u4e2d\u7684\u5185\u90e8\u7c7b\u548c @Nested \u6ce8\u89e3\u5b9e\u73b0\u5d4c\u5957\u6d4b\u8bd5\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u597d\u7684\u628a\u76f8\u5173\u7684\u6d4b\u8bd5\u65b9\u6cd5\u7ec4\u7ec7\u5728\u4e00\u8d77\uff0c\u5728\u5185\u90e8\u7c7b\u4e2d\u53ef\u4ee5\u4f7f\u7528 @BeforeEach \u548c @AfterEach \u6ce8\u89e3\uff0c\u800c\u4e14\u5d4c\u5957\u7684\u5c42\u6b21\u6ca1\u6709\u9650\u5236"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@DisplayName("A stack")\nclass TestingAStackDemo {\n\n    Stack<Object> stack;\n\n    @Test\n    @DisplayName("is instantiated with new Stack()")\n    void isInstantiatedWithNew() {\n        assertNull(stack)\n    }\n\n    @Nested\n    @DisplayName("when new")\n    class WhenNew {\n\n        @BeforeEach\n        void createNewStack() {\n            stack = new Stack<>();\n        }\n\n        @Test\n        @DisplayName("is empty")\n        void isEmpty() {\n            assertTrue(stack.isEmpty());\n        }\n\n        @Test\n        @DisplayName("throws EmptyStackException when popped")\n        void throwsExceptionWhenPopped() {\n            assertThrows(EmptyStackException.class, stack::pop);\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u53c2\u6570\u6d4b\u8bd5",children:"\u53c2\u6570\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.p,{children:"\u53c2\u6570\u5316\u6d4b\u8bd5\u662f JUnit5 \u5f88\u91cd\u8981\u7684\u4e00\u4e2a\u65b0\u7279\u6027\uff0c\u5b83\u4f7f\u5f97\u7528\u4e0d\u540c\u7684\u53c2\u6570\u591a\u6b21\u8fd0\u884c\u6d4b\u8bd5\u6210\u4e3a\u4e86\u53ef\u80fd"}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528**@ValueSource**\u7b49\u6ce8\u89e3\uff0c\u6307\u5b9a\u5165\u53c2\uff0c\u6211\u4eec\u5c06\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u6570\u8fdb\u884c\u591a\u6b21\u5355\u5143\u6d4b\u8bd5\uff0c\u800c\u4e0d\u9700\u8981\u6bcf\u65b0\u589e\u4e00\u4e2a\u53c2\u6570\u5c31\u65b0\u589e\u4e00\u4e2a\u5355\u5143\u6d4b\u8bd5\uff0c\u7701\u53bb\u4e86\u5f88\u591a\u5197\u4f59\u4ee3\u7801\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@ValueSource\uff1a\u4e3a\u53c2\u6570\u5316\u6d4b\u8bd5\u6307\u5b9a\u5165\u53c2\u6765\u6e90\uff0c\u652f\u6301\u516b\u5927\u57fa\u7840\u7c7b\u4ee5\u53ca String \u7c7b\u578b\u3001Class \u7c7b\u578b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@NullSource\uff1a\u8868\u793a\u4e3a\u53c2\u6570\u5316\u6d4b\u8bd5\u63d0\u4f9b\u4e00\u4e2a null \u7684\u5165\u53c2"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@EnumSource\uff1a\u8868\u793a\u4e3a\u53c2\u6570\u5316\u6d4b\u8bd5\u63d0\u4f9b\u4e00\u4e2a\u679a\u4e3e\u5165\u53c2"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@CsvFileSource\uff1a\u8868\u793a\u8bfb\u53d6\u6307\u5b9a CSV \u6587\u4ef6\u5185\u5bb9\u4f5c\u4e3a\u53c2\u6570\u5316\u6d4b\u8bd5\u5165\u53c2"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"@MethodSource\uff1a\u8868\u793a\u8bfb\u53d6\u6307\u5b9a\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u4f5c\u4e3a\u53c2\u6570\u5316\u6d4b\u8bd5\u5165\u53c2\uff08\u6ce8\u610f\u65b9\u6cd5\u8fd4\u56de\u9700\u8981\u662f\u4e00\u4e2a\u6d41\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u6307\u6807\u76d1\u63a7",children:"\u6307\u6807\u76d1\u63a7"}),"\n",(0,i.jsx)(e.h3,{id:"actuator",children:"Actuator"}),"\n",(0,i.jsx)(e.p,{children:"\u6bcf\u4e00\u4e2a\u5fae\u670d\u52a1\u5728\u4e91\u4e0a\u90e8\u7f72\u4ee5\u540e\uff0c\u90fd\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u76d1\u63a7\u3001\u8ffd\u8e2a\u3001\u5ba1\u8ba1\u3001\u63a7\u5236\u7b49\uff0cSpringBoot \u62bd\u53d6\u4e86 Actuator \u573a\u666f\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u5fae\u670d\u52a1\u5feb\u901f\u5f15\u7528\u5373\u53ef\u83b7\u5f97\u751f\u4ea7\u7ea7\u522b\u7684\u5e94\u7528\u76d1\u63a7\u3001\u5ba1\u8ba1\u7b49\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u66b4\u9732\u6240\u6709\u76d1\u63a7\u4fe1\u606f\u4e3a HTTP\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"management:\n  endpoints:\n    enabled-by-default: true #\u66b4\u9732\u6240\u6709\u7aef\u70b9\u4fe1\u606f\n    web:\n      exposure:\n        include: '*'  #\u4ee5web\u65b9\u5f0f\u66b4\u9732\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://localhost:8080/actuator/[beans/health/metrics/]"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u89c6\u5316\u754c\u9762\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/codecentric/spring-boot-admin",children:"https://github.com/codecentric/spring-boot-admin"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"endpoint",children:"Endpoint"}),"\n",(0,i.jsx)(e.p,{children:"\u9ed8\u8ba4\u6240\u6709\u7684 Endpoint \u9664\u8fc7 shutdown \u90fd\u662f\u5f00\u542f\u7684"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"management:\n  endpoints:\n    enabled-by-default: false\t#\u7981\u7528\u6240\u6709\u7684\n  endpoint:\t\t\t\t\t\t#\u624b\u52a8\u5f00\u542f\u4e00\u90e8\u5206\n    beans:\n      enabled: true\n    health:\n      enabled: true\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7aef\u70b9\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"ID"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"auditevents"})}),(0,i.jsxs)(e.td,{children:["\u66b4\u9732\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u7684\u5ba1\u6838\u4e8b\u4ef6\u4fe1\u606f\u3002\u9700\u8981\u4e00\u4e2a ",(0,i.jsx)(e.code,{children:"AuditEventRepository"})," \u7ec4\u4ef6"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"beans"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6240\u6709 Spring Bean \u7684\u5b8c\u6574\u5217\u8868"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"caches"})}),(0,i.jsx)(e.td,{children:"\u66b4\u9732\u53ef\u7528\u7684\u7f13\u5b58"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"conditions"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u81ea\u52a8\u914d\u7f6e\u7684\u6240\u6709\u6761\u4ef6\u4fe1\u606f\uff0c\u5305\u62ec\u5339\u914d\u6216\u4e0d\u5339\u914d\u7684\u539f\u56e0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"configprops"})}),(0,i.jsxs)(e.td,{children:["\u663e\u793a\u6240\u6709 ",(0,i.jsx)(e.code,{children:"@ConfigurationProperties"})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"env"})}),(0,i.jsxs)(e.td,{children:["\u66b4\u9732 Spring \u7684\u5c5e\u6027 ",(0,i.jsx)(e.code,{children:"ConfigurableEnvironment"})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"flyway"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5df2\u5e94\u7528\u7684\u6240\u6709 Flyway \u6570\u636e\u5e93\u8fc1\u79fb\u3002 \u9700\u8981\u4e00\u4e2a\u6216\u591a\u4e2a Flyway \u7ec4\u4ef6\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"health"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u72b6\u51b5\u4fe1\u606f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"httptrace"})}),(0,i.jsxs)(e.td,{children:["\u663e\u793a HTTP \u8ddf\u8e2a\u4fe1\u606f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b 100 \u4e2a HTTP \u8bf7\u6c42-\u54cd\u5e94\u9700\u8981\u4e00\u4e2a ",(0,i.jsx)(e.code,{children:"HttpTraceRepository"})," \u7ec4\u4ef6"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"info"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"integrationgraph"})}),(0,i.jsxs)(e.td,{children:["\u663e\u793a Spring integrationgraph\uff0c\u9700\u8981\u4f9d\u8d56 ",(0,i.jsx)(e.code,{children:"spring-integration-core"})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"loggers"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u548c\u4fee\u6539\u5e94\u7528\u7a0b\u5e8f\u4e2d\u65e5\u5fd7\u7684\u914d\u7f6e"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"liquibase"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5df2\u5e94\u7528\u7684\u6240\u6709 Liquibase \u6570\u636e\u5e93\u8fc1\u79fb\uff0c\u9700\u8981\u4e00\u4e2a\u6216\u591a\u4e2a Liquibase \u7ec4\u4ef6"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"metrics"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u7684\u6307\u6807\u4fe1\u606f\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"mappings"})}),(0,i.jsxs)(e.td,{children:["\u663e\u793a\u6240\u6709 ",(0,i.jsx)(e.code,{children:"@RequestMapping"})," \u8def\u5f84\u5217\u8868"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"scheduledtasks"})}),(0,i.jsx)(e.td,{children:"\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u8ba1\u5212\u4efb\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"sessions"})}),(0,i.jsx)(e.td,{children:"\u5141\u8bb8\u4ece Spring Session \u652f\u6301\u7684\u4f1a\u8bdd\u5b58\u50a8\u4e2d\u68c0\u7d22\u548c\u5220\u9664\u7528\u6237\u4f1a\u8bdd\uff0c\u9700\u8981\u4f7f\u7528 Spring Session \u7684\u57fa\u4e8e Servlet \u7684 Web \u5e94\u7528\u7a0b\u5e8f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"shutdown"})}),(0,i.jsx)(e.td,{children:"\u4f7f\u5e94\u7528\u7a0b\u5e8f\u6b63\u5e38\u5173\u95ed\uff0c\u9ed8\u8ba4\u7981\u7528"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"startup"})}),(0,i.jsxs)(e.td,{children:["\u663e\u793a\u7531 ",(0,i.jsx)(e.code,{children:"ApplicationStartup"})," \u6536\u96c6\u7684\u542f\u52a8\u6b65\u9aa4\u6570\u636e\u3002\u9700\u8981\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"SpringApplication"})," \u8fdb\u884c\u914d\u7f6e ",(0,i.jsx)(e.code,{children:"BufferingApplicationStartup"})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"threaddump"})}),(0,i.jsx)(e.td,{children:"\u6267\u884c\u7ebf\u7a0b\u8f6c\u50a8"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\u7a0b\u5e8f\u662f Web \u5e94\u7528\u7a0b\u5e8f\uff08Spring MVC\uff0cSpring WebFlux \u6216 Jersey\uff09\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u9644\u52a0\u7aef\u70b9\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"ID"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"heapdump"})}),(0,i.jsxs)(e.td,{children:["\u8fd4\u56de ",(0,i.jsx)(e.code,{children:"hprof"})," \u5806\u8f6c\u50a8\u6587\u4ef6\u3002"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"jolokia"})}),(0,i.jsxs)(e.td,{children:["\u901a\u8fc7 HTTP \u66b4\u9732 JMX bean\uff08\u9700\u8981\u5f15\u5165 Jolokia\uff0c\u4e0d\u9002\u7528\u4e8e WebFlux\uff09\uff0c\u9700\u8981\u5f15\u5165\u4f9d\u8d56 ",(0,i.jsx)(e.code,{children:"jolokia-core"})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"logfile"})}),(0,i.jsxs)(e.td,{children:["\u8fd4\u56de\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\uff08\u5982\u679c\u5df2\u8bbe\u7f6e ",(0,i.jsx)(e.code,{children:"logging.file.name"})," \u6216 ",(0,i.jsx)(e.code,{children:"logging.file.path"})," \u5c5e\u6027\uff09\uff0c\u652f\u6301\u4f7f\u7528 HTTP Range\u6807\u5934\u6765\u68c0\u7d22\u90e8\u5206\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\u3002"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"prometheus"})}),(0,i.jsxs)(e.td,{children:["\u4ee5 Prometheus \u670d\u52a1\u5668\u53ef\u4ee5\u6293\u53d6\u7684\u683c\u5f0f\u516c\u5f00\u6307\u6807\uff0c\u9700\u8981\u4f9d\u8d56 ",(0,i.jsx)(e.code,{children:"micrometer-registry-prometheus"})]})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u5e38\u7528 Endpoint\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Health\uff1a\u76d1\u63a7\u72b6\u51b5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Metrics\uff1a\u8fd0\u884c\u65f6\u6307\u6807"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Loggers\uff1a\u65e5\u5fd7\u8bb0\u5f55"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u9879\u76ee\u90e8\u7f72",children:"\u9879\u76ee\u90e8\u7f72"}),"\n",(0,i.jsx)(e.p,{children:"SpringBoot \u9879\u76ee\u5f00\u53d1\u5b8c\u6bd5\u540e\uff0c\u652f\u6301\u4e24\u79cd\u65b9\u5f0f\u90e8\u7f72\u5230\u670d\u52a1\u5668\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"jar \u5305 (\u5b98\u65b9\u63a8\u8350\uff0c\u9ed8\u8ba4)"}),"\n",(0,i.jsx)(e.li,{children:"war \u5305"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u66f4\u6539 pom \u6587\u4ef6\u4e2d\u7684\u6253\u5305\u65b9\u5f0f\u4e3a war"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539\u542f\u52a8\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\npublic class SpringbootDeployApplication extends SpringBootServletInitializer {\n    public static void main(String[] args) {\n        SpringApplication.run(SpringbootDeployApplication.class, args);\n    }\n\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder b) {\n        return b.sources(SpringbootDeployApplication.class);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6307\u5b9a\u6253\u5305\u7684\u540d\u79f0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<packaging>war</packaging>\n<build>\n     <finalName>springboot</finalName>\n     <plugins>\n         <plugin>\n             <groupId>org.springframework.boot</groupId>\n             <artifactId>spring-boot-maven-plugin</artifactId>\n         </plugin>\n     </plugins>\n</build>\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h1,{id:"cloud",children:"Cloud"}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u4ecb\u7ecd-7",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"SpringCloud \u662f\u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u7684\u4e00\u7ad9\u5f0f\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u591a\u79cd\u5fae\u670d\u52a1\u843d\u5730\u6280\u672f\u7684\u96c6\u5408\u4f53\uff0c\u4fd7\u79f0\u5fae\u670d\u52a1\u5168\u5bb6\u6876"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-\u7ec4\u4ef6\u6982\u89c8",src:s(57552).A+"",width:"1051",height:"306"})}),"\n",(0,i.jsxs)(e.p,{children:["\u53c2\u8003\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://www.yuque.com/mrlinxi/pxvr4g/wcwd39",children:"https://www.yuque.com/mrlinxi/pxvr4g/wcwd39"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u670d\u52a1\u6ce8\u518c",children:"\u670d\u52a1\u6ce8\u518c"}),"\n",(0,i.jsx)(e.h3,{id:"eureka",children:"Eureka"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-8",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud \u5c01\u88c5\u4e86 Netflix \u516c\u53f8\u5f00\u53d1\u7684 Eureka \u6a21\u5757\u6765\u5b9e\u73b0\u670d\u52a1\u6cbb\u7406\u3002Eureka \u91c7\u7528\u4e86 CS(Client-Server) \u7684\u8bbe\u8ba1\u67b6\u6784\uff0cEureka Server \u662f\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\uff0c\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u5fae\u670d\u52a1\u4f7f\u7528 Eureka \u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5230 Eureka Server \u5e76\u7ef4\u6301\u5fc3\u8df3\u8fde\u63a5"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Eureka\u548cDubbo\u5bf9\u6bd4",src:s(93638).A+"",width:"1236",height:"380"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Eureka Server \u63d0\u4f9b\u670d\u52a1\u6ce8\u518c\u670d\u52a1\uff1a\u5404\u4e2a\u5fae\u670d\u52a1\u8282\u70b9\u901a\u8fc7\u914d\u7f6e\u542f\u52a8\u540e\uff0c\u4f1a\u5728 EurekaServer \u4e2d\u8fdb\u884c\u6ce8\u518c\uff0cEurekaServer \u4e2d\u7684\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u5c06\u4f1a\u5b58\u50a8\u6240\u6709\u53ef\u7528\u670d\u52a1\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u5e76\u4e14\u5177\u6709\u53ef\u89c6\u5316\u754c\u9762"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Eureka Client \u901a\u8fc7\u6ce8\u518c\u4e2d\u5fc3\u8fdb\u884c\u8bbf\u95ee\uff1a\u7528\u4e8e\u7b80\u5316 Eureka Server\u7684\u4ea4\u4e92\uff0c\u5ba2\u6237\u7aef\u4e5f\u5177\u5907\u4e00\u4e2a\u5185\u7f6e\u7684\u3001\u4f7f\u7528\u8f6e\u8be2 (round-robin) \u8d1f\u8f7d\u7b97\u6cd5\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u5728\u5e94\u7528\u542f\u52a8\u540e\u5c06\u4f1a\u5411 Eureka Server \u53d1\u9001\u5fc3\u8df3\uff08\u9ed8\u8ba4\u5468\u671f\u4e3a30\u79d2\uff09\uff0c\u5982\u679c Eureka Server \u5728\u591a\u4e2a\u5fc3\u8df3\u5468\u671f\u5185\u6ca1\u6709\u63a5\u6536\u5230\u67d0\u4e2a\u8282\u70b9\u7684\u5fc3\u8df3\uff0c\u5c06\u4f1a\u4ece\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u628a\u8fd9\u4e2a\u670d\u52a1\u8282\u70b9\u79fb\u9664\uff08\u9ed8\u8ba4 90 \u79d2\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u7aef",children:"\u670d\u52a1\u7aef"}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u5668\u7aef\u4e3b\u542f\u52a8\u7c7b\u589e\u52a0 @EnableEurekaServer \u6ce8\u89e3\uff0c\u6307\u5b9a\u8be5\u6a21\u5757\u4f5c\u4e3a Eureka \u6ce8\u518c\u4e2d\u5fc3\u7684\u670d\u52a1\u5668"}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u5efa\u6d41\u7a0b\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaServer  // \u8868\u793a\u5f53\u524d\u662fEureka\u7684\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\npublic class EurekaMain7001 {\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaMain7001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539 pom \u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"1.x:    server\u8ddfclient\u5408\u5728\u4e00\u8d77\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-eureka</artifactId>\n</dependency>\n2.x\uff1a server\u8ddfclient\u5206\u5f00\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539  application.yml \u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 7001\n\neureka:\n  instance:\n    hostname: localhost # eureka\u670d\u52a1\u7aef\u7684\u5b9e\u4f8b\u540d\u79f0\n  client:\n    # false\u8868\u793a\u4e0d\u5411\u6ce8\u518c\u4e2d\u5fc3\u6ce8\u518c\u81ea\u5df1\u3002\n    register-with-eureka: false\n    # false\u8868\u793a\u81ea\u5df1\u7aef\u5c31\u662f\u6ce8\u518c\u4e2d\u5fc3\uff0c\u804c\u8d23\u5c31\u662f\u7ef4\u62a4\u670d\u52a1\u5b9e\u4f8b\uff0c\u5e76\u4e0d\u9700\u8981\u53bb\u68c0\u7d22\u670d\u52a1\n    fetch-registry: false\n  service-url:\n    # \u8bbe\u7f6e\u4e0e Eureka Server \u4ea4\u4e92\u7684\u5730\u5740\u67e5\u8be2\u670d\u52a1\u548c\u6ce8\u518c\u670d\u52a1\u90fd\u9700\u8981\u4f9d\u8d56\u8fd9\u4e2a\u5730\u5740\u3002\n    defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6e38\u89c8\u5668\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:7001",children:"http://localhost:7001"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5ba2\u6237\u7aef",children:"\u5ba2\u6237\u7aef"}),"\n",(0,i.jsx)(e.h5,{id:"\u751f\u4ea7\u8005",children:"\u751f\u4ea7\u8005"}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u5668\u7aef\u4e3b\u542f\u52a8\u7c7b\u9700\u8981\u589e\u52a0 @EnableEurekaClient \u6ce8\u89e3\uff0c\u8868\u793a\u8fd9\u662f\u4e00\u4e2a Eureka \u5ba2\u6237\u7aef\uff0c\u8981\u6ce8\u518c\u8fdb EurekaServer \u4e2d"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1aPaymentMain8001"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\npublic class PaymentMain8001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentMain8001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539 pom \u6587\u4ef6\uff1a\u6dfb\u52a0\u4e00\u4e2a Eureka-Client \u4f9d\u8d56"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5199 yml \u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8001\n \neureka:\n  client:\n    # \u8868\u793a\u5c06\u81ea\u5df1\u6ce8\u518c\u8fdbEurekaServer\u9ed8\u8ba4\u4e3atrue\n    register-with-eureka: true\n    # \u8868\u793a\u53ef\u4ee5\u4eceEureka\u6293\u53d6\u5df2\u6709\u7684\u6ce8\u518c\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e3atrue\u3002\u5355\u8282\u70b9\u65e0\u6240\u8c13\uff0c\u96c6\u7fa4\u5fc5\u987b\u8bbe\u7f6e\u4e3atrue\u624d\u80fd\u914d\u5408ribbon\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\n    fetch-registry: true\n    service-url: \n      defaultZone: http://localhost:7001/eureka\n  instance:\n    instance-id: payment8001 # \u53ea\u66b4\u9732\u670d\u52a1\u540d\uff0c\u4e0d\u5e26\u6709\u4e3b\u673a\u540d\n    prefer-ip-address: true  # \u8bbf\u95ee\u4fe1\u606f\u6709 IP \u4fe1\u606f\u63d0\u793a(\u9f20\u6807\u505c\u7559\u5728\u670d\u52a1\u540d\u79f0\u4e0a\u65f6)\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6e38\u89c8\u5668\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:7001",children:"http://localhost:7001"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6d88\u8d39\u8005",children:"\u6d88\u8d39\u8005"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1aPaymentMain8001"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\n@EnableDiscoveryClient\npublic class PaymentMain8001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentMain8001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"pom \u6587\u4ef6\u540c\u751f\u4ea7\u8005"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5199 yml \u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 80\n\n# \u5fae\u670d\u52a1\u540d\u79f0\nspring:\n application:\n  name: cloud-order-service\neureka:\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url: \n      defaultZone: http://localhost:7001/eureka\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6d4f\u89c8\u5668\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:7001",children:"http://localhost:7001"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Eureka\u53ef\u89c6\u5316\u754c\u9762",src:s(80692).A+"",width:"1579",height:"303"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u96c6\u7fa4\u6784\u5efa",children:"\u96c6\u7fa4\u6784\u5efa"}),"\n",(0,i.jsx)(e.h5,{id:"\u670d\u52a1\u7aef-1",children:"\u670d\u52a1\u7aef"}),"\n",(0,i.jsx)(e.p,{children:"Server \u7aef\u9ad8\u53ef\u7528\u96c6\u7fa4\u539f\u7406\uff1a\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u5bb9\u9519\uff0c\u4e92\u76f8\u6ce8\u518c\uff0c\u76f8\u4e92\u5b88\u671b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Eureka\u96c6\u7fa4\u539f\u7406",src:s(13820).A+"",width:"1077",height:"356"})}),"\n",(0,i.jsx)(e.p,{children:"\u591a\u53f0 Eureka \u670d\u52a1\u5668\uff0c\u6bcf\u4e00\u53f0 Eureka \u670d\u52a1\u5668\u9700\u8981\u6709\u81ea\u5df1\u7684\u4e3b\u673a\u540d\uff0c\u540c\u65f6\u5404\u670d\u52a1\u5668\u9700\u8981\u76f8\u4e92\u6ce8\u518c"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Eureka1\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 7001\n\neureka:\n  instance:\n    hostname: eureka7001.com\n  client:\n    register-with-eureka: false\n    fetch-registry: false\n    service-url:\n    # \u8bbe\u7f6e\u4e0eEureka Server\u4ea4\u4e92\u7684\u5730\u5740\u67e5\u8be2\u670d\u52a1\u548c\u6ce8\u518c\u670d\u52a1\u90fd\u9700\u8981\u4f9d\u8d56\u8fd9\u4e2a\u5730\u5740\u3002\n      # \u5355\u673a\u5c31\u662f\u81ea\u5df1\n      # defaultZone: http://eureka7001.com:7001/eureka/\n      # \u96c6\u7fa4\u6307\u5411\u5176\u4ed6eureka\n      #defaultZone: http://eureka7002.com:7002/eureka/\n      # \u5199\u6210\u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u53ef\u89c6\u5316\u9875\u9762\u8df3\u8f6c\u52307002\n      defaultZone: http://eureka7002.com:7002/\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Eureka2\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 7002\n\neureka:\n  instance:\n    hostname: eureka7002.com\n  client:\n    register-with-eureka: false\n    fetch-registry: false\n    service-url:\n      #\u5199\u6210\u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u53ef\u89c6\u5316\u9875\u9762\u8df3\u8f6c\u52307001\n      defaultZone: http://eureka7001.com:7001/\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaServer\npublic class EurekaMain7002 {\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaMain7002.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://eureka7001.com:7001"})," \u548c ",(0,i.jsx)(e.code,{children:"http://eureka7002.com:7002"}),"\uff1a"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-EurekaServer\u96c6\u7fa4\u6784\u5efa\u6210\u529f",src:s(12195).A+"",width:"1739",height:"297"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RPC \u8c03\u7528\uff1acontroller.OrderController"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class OrderController {\n    public static final String PAYMENT_URL = "http://localhost:8001";\n\n    @Autowired\n    private RestTemplate restTemplate;\n\t\n    // CommonResult \u662f\u4e00\u4e2a\u516c\u5171\u7684\u8fd4\u56de\u7c7b\u578b\n    @GetMapping("/consumer/payment/get/{id}")\n    public CommonResult<Payment> getPayment(@PathVariable("id") long id) {\n        // \u8fd4\u56de\u5bf9\u8c61\u4e3a\u54cd\u5e94\u4f53\u4e2d\u6570\u636e\u8f6c\u5316\u6210\u7684\u5bf9\u8c61\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u7406\u89e3\u4e3aJSON\n        return restTemplate.getForObject(PAYMENT_URL + "/payment/get/" + id, CommonResult.class);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u751f\u4ea7\u8005-1",children:"\u751f\u4ea7\u8005"}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u5efa PaymentMain8001 \u7684\u670d\u52a1\u96c6\u7fa4"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\n@EnableDiscoveryClient\npublic class PaymentMain8002 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentMain8002.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5199 yml \u6587\u4ef6\uff1a\u7aef\u53e3\u4fee\u6539\uff0c\u5e76\u4e14 spring.application.name \u5747\u4e3a cloud-payment-service"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8002\n\nspring:\n  application:\n    name: cloud-payment-service\n    \neureka:\n  client:\n    # \u8868\u793a\u5c06\u81ea\u5df1\u6ce8\u518c\u8fdbEurekaServer\u9ed8\u8ba4\u4e3atrue\n    register-with-eureka: true\n    # \u8868\u793a\u53ef\u4ee5\u4eceEureka\u6293\u53d6\u5df2\u6709\u7684\u6ce8\u518c\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e3atrue\u3002\u5355\u8282\u70b9\u65e0\u6240\u8c13\uff0c\u96c6\u7fa4\u5fc5\u987b\u8bbe\u7f6e\u4e3atrue\u624d\u80fd\u914d\u5408ribbon\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\n    fetch-registry: true\n    service-url: \n      defaultZone: http://localhost:7001/eureka\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u8d1f\u8f7d\u5747\u8861",children:"\u8d1f\u8f7d\u5747\u8861"}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u8d39\u8005\u7aef\u7684 Controller"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// public static final String PAYMENT_URL = "http://localhost:8001";\npublic static final String PAYMENT_URL = "http://localhost:8002";\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u7531\u4e8e\u5df2\u7ecf\u5efa\u7acb\u4e86\u751f\u4ea7\u8005\u96c6\u7fa4\uff0c\u6240\u4ee5\u53ef\u4ee5\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u7684\u64cd\u4f5c\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a\u53ea\u4fee\u6539 PAYMENT_URL \u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a CLOUD-PAYMENT-SERVICE \u5bf9\u5e94\u591a\u4e2a\u5fae\u670d\u52a1\uff0c\u9700\u8981\u89c4\u5219\u6765\u5224\u65ad\u8c03\u7528\u54ea\u4e2a\u7aef\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public static final String PAYMENT_URL = "http://CLOUD-PAYMENT-SERVICE";\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528 @LoadBlanced \u6ce8\u89e3\u8d4b\u4e88 RestTemplate \u8d1f\u8f7d\u5747\u8861\u7684\u80fd\u529b\uff0c\u589e\u52a0 config.ApplicationContextConfig \u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class ApplicationContextConfig {\n    @Bean\n    @LoadBalanced\n    public RestTemplate getRestTemplate() {\n        return new RestTemplate();\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u53d1\u73b0",children:"\u670d\u52a1\u53d1\u73b0"}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u53d1\u73b0\uff1a\u5bf9\u4e8e\u6ce8\u518c\u8fdb Eureka \u91cc\u9762\u7684\u5fae\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u670d\u52a1\u53d1\u73b0\u6765\u83b7\u5f97\u8be5\u670d\u52a1\u7684\u4fe1\u606f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\u589e\u52a0\u6ce8\u89e3 @EnableDiscoveryClient\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\n@EnableDiscoveryClient\npublic class PaymentMain8001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentMain8001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539\u751f\u4ea7\u8005\u7684 Controller"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class PaymentController {\n    @Autowired\n    private DiscoveryClient discoveryClient;\n    \n    @GetMapping(value = "/payment/discovery")\n    public Object discovery() {\n        List<String> services = discoveryClient.getServices();\n        for (String service : services) {\n            log.info("**** element:" + service);\n        }\n\n        List<ServiceInstance> instances = discoveryClient.getInstances("PAYMENT-SERVICE");\n        for (ServiceInstance instance : instances) {\n            log.info(instance.getServiceId() + "\\t" + instance.getHost() + "\\t" + instance.getPort());\n        }\n        return this.discoveryClient;\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u81ea\u6211\u4fdd\u62a4",children:"\u81ea\u6211\u4fdd\u62a4"}),"\n",(0,i.jsx)(e.p,{children:"\u4fdd\u62a4\u6a21\u5f0f\u7528\u4e8e\u5ba2\u6237\u7aef\u548c EurekaServer \u4e4b\u95f4\u5b58\u5728\u7f51\u7edc\u5206\u533a\u573a\u666f\u4e0b\u7684\u4fdd\u62a4\uff0c\u4e00\u65e6\u8fdb\u5165\u4fdd\u62a4\u6a21\u5f0f EurekaServer \u5c06\u4f1a\u5c1d\u8bd5\u4fdd\u62a4\u5176\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u7684\u4fe1\u606f\uff0c\u4e0d\u5728\u5220\u9664\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u7684\u6570\u636e\uff0c\u5c5e\u4e8e CAP \u91cc\u9762\u7684 AP \u601d\u60f3\uff08\u53ef\u7528\u6027\u548c\u5206\u533a\u5bb9\u9519\u6027\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Eureka\u81ea\u6211\u4fdd\u62a4\u673a\u5236",src:s(75977).A+"",width:"1801",height:"426"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679c\u4e00\u5b9a\u65f6\u95f4\u5185\u4e22\u5931\u5927\u91cf\u8be5\u5fae\u670d\u52a1\u7684\u5b9e\u4f8b\uff0c\u8fd9\u65f6 Eureka \u5c31\u4f1a\u5f00\u542f\u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff0c\u4e0d\u4f1a\u5254\u9664\u8be5\u670d\u52a1\u3002 \u56e0\u4e3a\u8fd9\u4e2a\u73b0\u8c61\u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u6682\u65f6\u4e0d\u901a\uff0c\u51fa\u73b0\u4e86 Eureka \u7684\u5047\u6b7b\u3001\u62e5\u5835\u3001\u5361\u987f\uff0c\u5ba2\u6237\u7aef\u6062\u590d\u540e\u8fd8\u80fd\u6b63\u5e38\u53d1\u9001\u5fc3\u8df3"}),"\n",(0,i.jsx)(e.p,{children:"\u7981\u6b62\u81ea\u6211\u4fdd\u62a4\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Server\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"eureka:\n  server:\n    # \u5173\u95ed\u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff0c\u4e0d\u53ef\u7528\u7684\u670d\u52a1\u76f4\u63a5\u5220\u9664\n    enable-self-preservation: false\n    eviction-interval-timer-in-ms: 2000\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Client\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"eureka:\n  instance:\n    # Eureka\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5fc3\u8df3\u7684\u65f6\u95f4\u95f4\u9694\u9ed8\u8ba430\u79d2 \n    lease-renewal-interval-in-seconds: 1\n    # Eureka\u670d\u52a1\u7aef\u5728\u6536\u5230\u6700\u540e\u4e00\u6b21\u5fc3\u8df3\u540e\uff0c90s\u6ca1\u6709\u6536\u5230\u5fc3\u8df3\uff0c\u5254\u9664\u670d\u52a1\n    lease-expiration-duration-in-seconds: 2\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"consul",children:"Consul"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-9",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsxs)(e.p,{children:["Consul \u662f\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u670d\u52a1\u53d1\u73b0\u548c\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf\uff0c\u91c7\u7528 Go \u8bed\u8a00\u5f00\u53d1\uff0c\u5b98\u7f51\uff1a",(0,i.jsx)(e.a,{href:"https://developer.hashicorp.com/consul",children:"https://developer.hashicorp.com/consul"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u4e86\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\u5fc3\u7684\u670d\u52a1\u6cbb\u7406\uff0c\u914d\u7f6e\u4e2d\u5fc3\uff0c\u63a7\u5236\u603b\u7ebf\u7b49\u529f\u80fd"}),"\n",(0,i.jsx)(e.li,{children:"\u57fa\u4e8e Raft \u534f\u8bae\uff0c\u652f\u6301\u5065\u5eb7\u68c0\u67e5\uff0c\u540c\u65f6\u652f\u6301 HTTP \u548c DNS \u534f\u8bae\u652f\u6301\u8de8\u6570\u636e\u4e2d\u5fc3\u7684 WAN \u96c6\u7fa4"}),"\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u56fe\u5f62\u754c\u9762"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0b\u8f7d Consul \u540e\uff0c\u8fd0\u884c\u6307\u4ee4\uff1a",(0,i.jsx)(e.code,{children:"consul -version"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"D:\\Program Files\\Java>consul -version\nConsul v1.15.1\nRevision 7c04b6a0\nBuild Date 2023-03-07T20:35:33Z\nProtocol 2 spoken by default, understands 2 to 3 (.....)\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u542f\u52a8\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"consul agent -dev\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee\u6d4f\u89c8\u5668\uff1a",(0,i.jsx)(e.a,{href:"http://localhost:8500/",children:"http://localhost:8500/"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e2d\u6587\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://www.springcloud.cc/spring-cloud-consul.html",children:"https://www.springcloud.cc/spring-cloud-consul.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-4",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u65e0\u9700 Server \u7aef\u4ee3\u7801\u7684\u7f16\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u4ea7\u8005\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-consul-discovery</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"###consul \u670d\u52a1\u7aef\u53e3\u53f7\nserver:\n  port: 8006\n\nspring:\n  application:\n    name: consul-provider-payment\n  ####consul\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\n  cloud:\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        service-name: ${spring.application.name}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableDiscoveryClient\npublic class PaymentMain8006 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentMain8006.class, args);\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u8d39\u8005\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"###consul\u670d\u52a1\u7aef\u53e3\u53f7\nserver:\n  port: 80\n\nspring:\n  application:\n    name: cloud-consumer-order\n  ####consul\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\n  cloud:\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        #hostname: 127.0.0.1\n        service-name: ${spring.application.name}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a\u540c\u751f\u4ea7\u8005"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class ApplicationContextConfig {\n    @Bean\n    @LoadBalanced\n    public RestTemplate getRestTemplate() {\n        return new RestTemplate();\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class OrderConsulController {\n    public static final String INVOKE_URL = "http://cloud-provider-pament";\n\n    @Resource\n    private RestTemplate restTemplate;\n\n    @GetMapping("/consumer/payment/consul")\n    public String paymentInfo() {\n        return restTemplate.getForObject(INVOKE_URL, String.class);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u670d\u52a1\u8c03\u7528",children:"\u670d\u52a1\u8c03\u7528"}),"\n",(0,i.jsx)(e.h3,{id:"ribbon",children:"Ribbon"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-10",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"SpringCloud Ribbon \u662f\u57fa\u4e8e Netflix Ribbon \u5b9e\u73b0\u7684\u4e00\u5957\u8d1f\u8f7d\u5747\u8861\u5de5\u5177\uff0c\u63d0\u4f9b\u5ba2\u6237\u7aef\u7684\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u548c\u670d\u52a1\u8c03\u7528\uff0cRibbon \u5ba2\u6237\u7aef\u7ec4\u4ef6\u63d0\u4f9b\u4e00\u7cfb\u5217\u5b8c\u5584\u7684\u914d\u7f6e\u9879\u5982\u8fde\u63a5\u8d85\u65f6\uff0c\u91cd\u8bd5\u7b49"}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u7f51\uff1a ",(0,i.jsx)(e.code,{children:"https://github.com/Netflix/ribbon/wiki/Getting-Started"})," \uff08\u5df2\u8fdb\u5165\u7ef4\u62a4\u6a21\u5f0f\uff0c\u672a\u6765\u66ff\u6362\u4e3a Load Banlancer\uff09"]}),"\n",(0,i.jsx)(e.p,{children:"\u8d1f\u8f7d\u5747\u8861 Load Balance (LB) \u5c31\u662f\u5c06\u7528\u6237\u7684\u8bf7\u6c42\u5e73\u644a\u7684\u5206\u914d\u5230\u591a\u4e2a\u670d\u52a1\u4e0a\uff0c\u4ece\u800c\u8fbe\u5230\u7cfb\u7edf\u7684 HA\uff08\u9ad8\u53ef\u7528\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5e38\u89c1\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1a"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8f6e\u8be2\uff1a\u4e3a\u8bf7\u6c42\u9009\u62e9\u5065\u5eb7\u6c60\u4e2d\u7684\u7b2c\u4e00\u4e2a\u540e\u7aef\u670d\u52a1\u5668\uff0c\u7136\u540e\u6309\u987a\u5e8f\u5f80\u540e\u4f9d\u6b21\u9009\u62e9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6700\u5c0f\u8fde\u63a5\uff1a\u4f18\u5148\u9009\u62e9\u8fde\u63a5\u6570\u6700\u5c11\uff0c\u5373\u538b\u529b\u6700\u5c0f\u7684\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5728\u4f1a\u8bdd\u8f83\u957f\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u91c7\u53d6\u8fd9\u79cd\u65b9\u5f0f"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6563\u5217\uff1a\u6839\u636e\u8bf7\u6c42\u6e90\u7684 IP \u7684\u6563\u5217\uff08hash\uff09\u6765\u9009\u62e9\u8981\u8f6c\u53d1\u7684\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u4fdd\u8bc1\u7279\u5b9a\u7528\u6237\u80fd\u8fde\u63a5\u5230\u76f8\u540c\u7684\u670d\u52a1\u5668\uff0c\u5982\u679c\u5e94\u7528\u9700\u8981\u5904\u7406\u72b6\u6001\u800c\u8981\u6c42\u7528\u6237\u80fd\u8fde\u63a5\u5230\u548c\u4e4b\u524d\u76f8\u540c\u7684\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u91c7\u53d6\u8fd9\u79cd\u65b9\u5f0f"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Ribbon \u672c\u5730\u8d1f\u8f7d\u5747\u8861\u5ba2\u6237\u7aef\u4e0e Nginx \u670d\u52a1\u7aef\u8d1f\u8f7d\u5747\u8861\u533a\u522b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Nginx \u662f\u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861\uff0c\u5ba2\u6237\u7aef\u6240\u6709\u8bf7\u6c42\u90fd\u4f1a\u4ea4\u7ed9 Nginx\uff0c\u7136\u540e\u7531 Nginx \u5b9e\u73b0\u8f6c\u53d1\u8bf7\u6c42\uff0c\u5373\u8d1f\u8f7d\u5747\u8861\u662f\u7531\u670d\u52a1\u7aef\u5b9e\u73b0\u7684"}),"\n",(0,i.jsx)(e.li,{children:"Ribbon \u672c\u5730\u8d1f\u8f7d\u5747\u8861\uff0c\u5728\u8c03\u7528\u5fae\u670d\u52a1\u63a5\u53e3\u65f6\u4f1a\u5728\u6ce8\u518c\u4e2d\u5fc3\u4e0a\u83b7\u53d6\u6ce8\u518c\u4fe1\u606f\u670d\u52a1\u5217\u8868\uff0c\u7136\u540e\u7f13\u5b58\u5230 JVM \u672c\u5730\uff0c\u4ece\u800c\u5728\u672c\u5730\u5b9e\u73b0 RPC \u8fdc\u7a0b\u670d\u52a1\u8c03\u7528\u6280\u672f"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u96c6\u4e2d\u5f0f LB \u548c\u8fdb\u7a0b\u5185 LB \u7684\u5bf9\u6bd4\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u96c6\u4e2d\u5f0f LB\uff1a\u5728\u670d\u52a1\u7684\u6d88\u8d39\u65b9\u548c\u63d0\u4f9b\u65b9\u4e4b\u95f4\u4f7f\u7528\u72ec\u7acb\u7684 LB \u8bbe\u65bd\uff08\u5982 Nginx\uff09\uff0c\u7531\u8be5\u8bbe\u65bd\u628a\u8bbf\u95ee\u8bf7\u6c42\u901a\u8fc7\u67d0\u79cd\u7b56\u7565\u8f6c\u53d1\u81f3\u670d\u52a1\u7684\u63d0\u4f9b\u65b9"}),"\n",(0,i.jsx)(e.li,{children:"\u8fdb\u7a0b\u5185 LB\uff1a\u5c06 LB \u903b\u8f91\u96c6\u6210\u5230\u6d88\u8d39\u65b9\uff0c\u6d88\u8d39\u65b9\u4ece\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u83b7\u77e5\u6709\u54ea\u4e9b\u670d\u52a1\u53ef\u7528\uff0c\u7136\u540e\u4ece\u4e2d\u9009\u62e9\u51fa\u4e00\u4e2a\u670d\u52a1\u5668\uff0cRibbon \u5c5e\u4e8e\u8be5\u7c7b"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5de5\u4f5c\u6d41\u7a0b",children:"\u5de5\u4f5c\u6d41\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"Ribbon \u662f\u4e00\u4e2a\u8f6f\u8d1f\u8f7d\u5747\u8861\u7684\u5ba2\u6237\u7aef\u7ec4\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Ribbon\u67b6\u6784\u539f\u7406",src:s(87165).A+"",width:"690",height:"373"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7b2c\u4e00\u6b65\u5148\u9009\u62e9 EurekaServer\uff0c\u4f18\u5148\u9009\u62e9\u5728\u540c\u4e00\u4e2a\u533a\u57df\u5185\u8d1f\u8f7d\u8f83\u5c11\u7684 Server"}),"\n",(0,i.jsx)(e.li,{children:"\u7b2c\u4e8c\u6b65\u6839\u636e\u7528\u6237\u6307\u5b9a\u7684\u7b56\u7565\uff0c\u518d\u4ece Server \u53d6\u5230\u7684\u670d\u52a1\u6ce8\u518c\u5217\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u5730\u5740"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6838\u5fc3\u7ec4\u4ef6",children:"\u6838\u5fc3\u7ec4\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"Ribbon \u6838\u5fc3\u7ec4\u4ef6 IRule \u63a5\u53e3\uff0c\u4e3b\u8981\u5b9e\u73b0\u7c7b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"RoundRobinRule\uff1a\u8f6e\u8be2"}),"\n",(0,i.jsx)(e.li,{children:"RandomRule\uff1a\u968f\u673a"}),"\n",(0,i.jsx)(e.li,{children:"RetryRule\uff1a\u5148\u6309\u7167 RoundRobinRule \u7684\u7b56\u7565\u83b7\u53d6\u670d\u52a1\uff0c\u5982\u679c\u83b7\u53d6\u670d\u52a1\u5931\u8d25\u5219\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u4f1a\u8fdb\u884c\u91cd\u8bd5"}),"\n",(0,i.jsx)(e.li,{children:"WeightedResponseTimeRule\uff1a\u5bf9 RoundRobinRule \u7684\u6269\u5c55\uff0c\u54cd\u5e94\u901f\u5ea6\u8d8a\u5feb\u7684\u5b9e\u4f8b\u9009\u62e9\u6743\u91cd\u8d8a\u5927\uff0c\u8d8a\u5bb9\u6613\u88ab\u9009\u62e9"}),"\n",(0,i.jsx)(e.li,{children:"BestAvailableRule\uff1a\u4f1a\u5148\u8fc7\u6ee4\u6389\u7531\u4e8e\u591a\u6b21\u8bbf\u95ee\u6545\u969c\u800c\u5904\u4e8e\u65ad\u8def\u5668\u8df3\u95f8\u72b6\u6001\u7684\u670d\u52a1\uff0c\u7136\u540e\u9009\u62e9\u4e00\u4e2a\u5e76\u53d1\u91cf\u6700\u5c0f\u7684\u670d\u52a1"}),"\n",(0,i.jsx)(e.li,{children:"AvailabilityFilteringRule\uff1a\u5148\u8fc7\u6ee4\u6389\u6545\u969c\u5b9e\u4f8b\uff0c\u518d\u9009\u62e9\u5e76\u53d1\u8f83\u5c0f\u7684\u5b9e\u4f8b"}),"\n",(0,i.jsx)(e.li,{children:"ZoneAvoidanceRule\uff1a\u9ed8\u8ba4\u89c4\u5219\uff0c\u590d\u5408\u5224\u65ad Server \u6240\u5728\u533a\u57df\u7684\u6027\u80fd\u548c Server \u7684\u53ef\u7528\u6027\u9009\u62e9\u670d\u52a1\u5668"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-IRule\u7c7b\u56fe",src:s(15202).A+"",width:"833",height:"298"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5b98\u65b9\u6587\u6863\u660e\u786e\u7ed9\u51fa\u4e86\u8b66\u544a\uff0c\u81ea\u5b9a\u4e49\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e\u7c7b\u4e0d\u80fd\u653e\u5728 @ComponentScan \u6240\u626b\u63cf\u7684\u5f53\u524d\u5305\u4e0b\u4ee5\u53ca\u5b50\u5305\u4e0b"}),"\n",(0,i.jsx)(e.p,{children:"\u66f4\u6362\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u65b9\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e\u7c7b MySelfRule\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class MySelfRule {\n    @Bean\n    public IRule myRule() {\n        return new RandomRule();//\u5b9a\u4e49\u4e3a\u968f\u673a\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\u6dfb\u52a0 @RibbonCilent \u6ce8\u89e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@SpringBootApplication\n@EnableEurekaClient\n// \u6307\u660e\u8bbf\u95ee\u7684\u670d\u52a1CLOUD-PAYMENT-SERVICE\uff0c\u4ee5\u53ca\u6307\u5b9a\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\n@RibbonClient(name = "CLOUD-PAYMENT-SERVICE", configuration= MySelfRule.class)\npublic class OrderMain80 {\n    public static void main(String[] args) {\n        SpringApplication.run(OrderMain80.class, args);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"openfeign",children:"OpenFeign"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-11",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsxs)(e.p,{children:["Feign \u662f\u4e00\u4e2a\u58f0\u660e\u5f0f WebService \u5ba2\u6237\u7aef\uff0c\u80fd\u8ba9\u7f16\u5199 Web \u5ba2\u6237\u7aef\u66f4\u52a0\u7b80\u5355\uff0c\u53ea\u8981\u521b\u5efa\u4e00\u4e2a\u63a5\u53e3\u5e76\u6dfb\u52a0\u6ce8\u89e3 @Feign \u5373\u53ef\uff0c\u53ef\u4ee5\u4e0e Eureka \u548c Ribbon \u7ec4\u5408\u4f7f\u7528\u652f\u6301\u8d1f\u8f7d\u5747\u8861\uff0c\u6240\u4ee5\u4e00\u822c",(0,i.jsx)(e.strong,{children:"\u7528\u5728\u6d88\u8d39\u8005\u7aef"})]}),"\n",(0,i.jsx)(e.p,{children:"OpenFeign \u5728 Feign \u7684\u57fa\u7840\u4e0a\u652f\u6301\u4e86 SpringMVC \u6ce8\u89e3\uff0c\u5e76\u4e14 @FeignClient \u6ce8\u89e3\u53ef\u4ee5\u89e3\u6790 @RequestMapping \u6ce8\u89e3\u4e0b\u7684\u63a5\u53e3\uff0c\u5e76\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u4ea7\u751f\u5b9e\u73b0\u7c7b\uff0c\u5728\u5b9e\u73b0\u7c7b\u4e2d\u505a\u8d1f\u8f7d\u5747\u8861\u548c\u670d\u52a1\u8c03\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u4f18\u70b9\uff1a\u5229\u7528 RestTemplate \u5bf9 HTTP \u8bf7\u6c42\u7684\u5c01\u88c5\u5904\u7406\uff0c\u5f62\u6210\u4e86\u4e00\u5957\u6a21\u7248\u5316\u7684\u8c03\u7528\u65b9\u6cd5\u3002\u4f46\u662f\u5bf9\u670d\u52a1\u4f9d\u8d56\u7684\u8c03\u7528\u53ef\u80fd\u4e0d\u6b62\u4e00\u5904\uff0c\u5f80\u5f80\u4e00\u4e2a\u63a5\u53e3\u4f1a\u88ab\u591a\u5904\u8c03\u7528\uff0c\u6240\u4ee5\u4e00\u4e2a\u5fae\u670d\u52a1\u63a5\u53e3\u4e0a\u9762\u6807\u6ce8\u4e00\u4e2a @Feign \u6ce8\u89e3\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u5305\u88c5\u4f9d\u8d56\u670d\u52a1\u7684\u8c03\u7528"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-5",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:'@FeignClient("provider name") \u6ce8\u89e3\u4f7f\u7528\u89c4\u5219\uff1a'}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u58f0\u660e\u7684\u65b9\u6cd5\u7b7e\u540d\u5fc5\u987b\u548c provider \u5fae\u670d\u52a1\u4e2d\u7684 controller \u4e2d\u7684\u65b9\u6cd5\u7b7e\u540d\u4e00\u81f4"}),"\n",(0,i.jsxs)(e.li,{children:["\u5982\u679c\u9700\u8981\u4f20\u9012\u53c2\u6570\uff0c\u90a3\u4e48 ",(0,i.jsx)(e.code,{children:"@RequestParam"})," \u3001",(0,i.jsx)(e.code,{children:"@RequestBody"})," \u3001",(0,i.jsx)(e.code,{children:"@PathVariable"})," \u4e5f\u9700\u8981\u52a0\u4e0a"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6539\u9020\u6d88\u8d39\u8005\u670d\u52a1"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1aOpenFeign \u6574\u5408\u4e86 Ribbon\uff0c\u5177\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-openfeign</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a\u4e0d\u5c06\u5176\u6ce8\u518c\u5230 Eureka \u4f5c\u4e3a\u5fae\u670d\u52a1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 80\n\neureka:\n  client:\n    # \u8868\u793a\u4e0d\u5c06\u5176\u6ce8\u5165Eureka\u4f5c\u4e3a\u5fae\u670d\u52a1\uff0c\u4e0d\u4f5c\u4e3aEureak\u5ba2\u6237\u7aef\u4e86\uff0c\u800c\u662f\u4f5c\u4e3aFeign\u5ba2\u6237\u7aef\n    register-with-eureka: false\n    service-url:\n      # \u96c6\u7fa4\u7248\n      defaultZone: http://eureka7001.com:7001/eureka,http://eureka7002.com:7002/eureka\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a\u5f00\u542f Feign"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableFeignClients //\u4e0d\u4f5c\u4e3aEureak\u5ba2\u6237\u7aef\u4e86\uff0c\u800c\u662f\u4f5c\u4e3aFeign\u5ba2\u6237\u7aef\npublic class OrderOpenFeignMain80 {\n    public static void main(String[] args) {\n        SpringApplication.run(OrderOpenFeignMain80.class, args);\n    }\n\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b0\u5efa Service \u63a5\u53e3\uff1aPaymentFeignService \u63a5\u53e3\u548c @FeignClient \u6ce8\u89e3\uff0c\u5b8c\u6210 Feign \u7684\u5305\u88c5\u8c03\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@FeignClient(value = "CLOUD-PAYMENT-SERVICE") // \u4f5c\u4e3a\u4e00\u4e2aFeign\u529f\u80fd\u7ed1\u5b9a\u7684\u7684\u63a5\u53e3\npublic interface PaymentFeignService {\n    @GetMapping(value = "/payment/get/{id}")\n    public CommonResult<Payment> getPaymentById(@PathVariable("id") long id);\n    \n    @GetMapping("/payment/feign/timeout")\n    public String paymentFeignTimeout();\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class OrderFeignController {\n    @Autowired\n    private PaymentFeignService paymentFeignService;\n\n    @GetMapping("/consumer/payment/get/{id}")\n    public CommonResult<Payment> getPayment(@PathVariable("id") long id) {\n        // \u8fd4\u56de\u5bf9\u8c61\u4e3a\u54cd\u5e94\u4f53\u4e2d\u6570\u636e\u8f6c\u5316\u6210\u7684\u5bf9\u8c61\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u7406\u89e3\u4e3aJSON\n        return paymentFeignService.getPaymentById(id);\n    }\n    \n    @GetMapping("/consumer/payment/feign/timeout")\n    public String paymentFeignTimeout() {\n        // openfeign-ribbon\uff0c\u5ba2\u6237\u7aef\u4e00\u822c\u9ed8\u8ba4\u7b49\u5f851s\n        return paymentFeignService.paymentFeignTimeout();\n    }\n}\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u8d85\u65f6\u95ee\u9898",children:"\u8d85\u65f6\u95ee\u9898"}),"\n",(0,i.jsx)(e.p,{children:"Feign \u9ed8\u8ba4\u662f\u652f\u6301 Ribbon\uff0cFeign \u5ba2\u6237\u7aef\u7684\u8d1f\u8f7d\u5747\u8861\u548c\u8d85\u65f6\u63a7\u5236\u90fd\u7531 Ribbon \u63a7\u5236"}),"\n",(0,i.jsx)(e.p,{children:"\u8bbe\u7f6e Feign \u5ba2\u6237\u7aef\u7684\u8d85\u65f6\u7b49\u5f85\u65f6\u95f4\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"ribbon:\n  #\u6307\u7684\u662f\u5efa\u7acb\u8fde\u63a5\u540e\u4ece\u670d\u52a1\u5668\u8bfb\u53d6\u5230\u53ef\u7528\u8d44\u6e90\u6240\u7528\u7684\u65f6\u95f4\n  ReadTimeout: 5000\n  #\u6307\u7684\u662f\u5efa\u7acb\u8fde\u63a5\u6240\u7528\u7684\u65f6\u95f4\uff0c\u9002\u7528\u4e8e\u7f51\u7edc\u72b6\u51b5\u6b63\u5e38\u7684\u60c5\u51b5\u4e0b,\u4e24\u7aef\u8fde\u63a5\u6240\u7528\u7684\u65f6\u95f4\n  ConnectTimeout: 5000\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6f14\u793a\u8d85\u65f6\u73b0\u8c61\uff1aOpenFeign \u9ed8\u8ba4\u7b49\u5f85\u65f6\u95f4\u4e3a 1 \u79d2\u949f\uff0c\u8d85\u8fc7\u540e\u4f1a\u62a5\u9519"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u63d0\u4f9b\u65b9 Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/payment/feign/timeout")\npublic String paymentFeignTimeout() {\n    try {\n        TimeUnit.SECONDS.sleep(3);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n    return serverPort;\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d88\u8d39\u8005 PaymentFeignService \u548c OrderFeignController \u53c2\u8003\u4e0a\u4e00\u5c0f\u8282\u4ee3\u7801"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\u62a5\u9519\uff1a"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.img,{alt:"Cloud-OpenFeign\u8d85\u65f6\u9519\u8bef",src:s(33564).A+"",width:"899",height:"264"}),"!](C:\\Users\\Seazean\\Desktop\\123\\Cloud-OpenFeign\u8d85\u65f6\u9519\u8bef.png)"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u65e5\u5fd7\u7ea7\u522b",children:"\u65e5\u5fd7\u7ea7\u522b"}),"\n",(0,i.jsx)(e.p,{children:"Feign \u63d0\u4f9b\u4e86\u65e5\u5fd7\u6253\u5370\u529f\u80fd\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6765\u8c03\u6574\u65e5\u5fd7\u7ea7\u522b\uff0c\u4ece\u800c\u4e86\u89e3 Feign \u4e2d HTTP \u8bf7\u6c42\u7684\u7ec6\u8282"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"NONE"}),(0,i.jsx)(e.th,{children:"\u9ed8\u8ba4\u7684\uff0c\u4e0d\u663e\u793a\u4efb\u4f55\u65e5\u5fd7"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"BASIC"}),(0,i.jsx)(e.td,{children:"\u4ec5\u8bb0\u5f55\u8bf7\u6c42\u65b9\u6cd5\u3001URL\u3001\u54cd\u5e94\u72b6\u6001\u7801\u53ca\u6267\u884c\u65f6\u95f4"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"HEADERS"}),(0,i.jsx)(e.td,{children:"\u9664\u4e86 BASIC \u4e2d\u5b9a\u4e49\u7684\u4fe1\u606f\u4e4b\u5916\uff0c\u8fd8\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u5934\u4fe1\u606f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"FULL"}),(0,i.jsx)(e.td,{children:"\u9664\u4e86 HEADERS \u4e2d\u5b9a\u4e49\u7684\u4fe1\u606f\u5916\uff0c\u8fd8\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u6b63\u6587\u53ca\u5143\u6570\u636e"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u5728\u6d88\u8d39\u8005\u7aef"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b0\u5efa config.FeignConfig \u6587\u4ef6\uff1a\u914d\u7f6e\u65e5\u5fd7 Bean"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class FeignConfig {\n    @Bean\n    Logger.Level feignLoggerLevel() {\n        return Logger.Level.FULL;\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"logging:\n  level:\n    # feign \u65e5\u5fd7\u4ee5\u4ec0\u4e48\u7ea7\u522b\u76d1\u63a7\u54ea\u4e2a\u63a5\u53e3\n    com.atguigu.springcloud.service.PaymentFeignService: debug\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Debug \u540e\u67e5\u770b\u540e\u53f0\u65e5\u5fd7"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u670d\u52a1\u7194\u65ad",children:"\u670d\u52a1\u7194\u65ad"}),"\n",(0,i.jsx)(e.h3,{id:"hystrix",children:"Hystrix"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-12",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u662f\u4e00\u4e2a\u7528\u4e8e\u5904\u7406\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5ef6\u8fdf\u548c\u5bb9\u9519\u7684\u5f00\u6e90\u5e93\uff0c\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u91cc\uff0c\u8bb8\u591a\u4f9d\u8d56\u4f1a\u51fa\u73b0\u8c03\u7528\u5931\u8d25\uff0c\u6bd4\u5982\u8d85\u65f6\u3001\u5f02\u5e38\u7b49\uff0cHystrix \u80fd\u591f\u4fdd\u8bc1\u5728\u4e00\u4e2a\u4f9d\u8d56\u51fa\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u6574\u4f53\u670d\u52a1\u5931\u8d25\uff0c\u907f\u514d\u7ea7\u8054\u6545\u969c\uff0c\u4ee5\u63d0\u9ad8\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5f39\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u65ad\u8def\u5668\u672c\u8eab\u662f\u4e00\u79cd\u5f00\u5173\u88c5\u7f6e\uff0c\u5f53\u67d0\u4e2a\u670d\u52a1\u5355\u5143\u53d1\u751f\u6545\u969c\u4e4b\u540e\uff0c\u901a\u8fc7\u65ad\u8def\u5668\u7684\u6545\u969c\u76d1\u63a7\uff08\u7c7b\u4f3c\u7194\u65ad\u4fdd\u9669\u4e1d\uff09\uff0c\u5411\u8c03\u7528\u65b9\u8fd4\u56de\u4e00\u4e2a\u7b26\u5408\u9884\u671f\u7684\u3001\u53ef\u5904\u7406\u7684\u5907\u9009\u54cd\u5e94\uff08FallBack\uff09\uff0c\u800c\u4e0d\u662f\u957f\u65f6\u95f4\u7684\u7b49\u5f85\u6216\u8005\u629b\u51fa\u8c03\u7528\u65b9\u65e0\u6cd5\u5904\u7406\u7684\u5f02\u5e38\uff0c\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86\u670d\u52a1\u8c03\u7528\u65b9\u7684\u7ebf\u7a0b\u4e0d\u4f1a\u88ab\u957f\u65f6\u95f4\u5730\u5360\u7528\uff0c\u907f\u514d\u4e86\u6545\u969c\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u8513\u5ef6\uff0c\u4e43\u81f3\u96ea\u5d29"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u964d\u7ea7 Fallback\uff1a\u7cfb\u7edf\u4e0d\u53ef\u7528\u65f6\u9700\u8981\u4e00\u4e2a\u515c\u5e95\u7684\u89e3\u51b3\u65b9\u6848\u6216\u5907\u9009\u54cd\u5e94\uff0c\u5411\u8c03\u7528\u65b9\u8fd4\u56de\u4e00\u4e2a\u53ef\u5904\u7406\u7684\u54cd\u5e94"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7194\u65ad Break\uff1a\u8fbe\u5230\u6700\u5927\u670d\u52a1\u8bbf\u95ee\u540e\uff0c\u76f4\u63a5\u62d2\u7edd\u8bbf\u95ee"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u9650\u6d41 Flowlimit\uff1a\u9ad8\u5e76\u53d1\u64cd\u4f5c\u65f6\u4e25\u7981\u6240\u6709\u8bf7\u6c42\u4e00\u6b21\u6027\u8fc7\u6765\u62e5\u6324\uff0c\u4e00\u79d2\u949f N \u4e2a\uff0c\u6709\u5e8f\u6392\u961f\u8fdb\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/Netflix/Hystrix/wiki/How-To-Use",children:"https://github.com/Netflix/Hystrix/wiki/How-To-Use"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u964d\u7ea7",children:"\u670d\u52a1\u964d\u7ea7"}),"\n",(0,i.jsx)(e.h5,{id:"\u6848\u4f8b\u6784\u5efa",children:"\u6848\u4f8b\u6784\u5efa"}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u4ea7\u8005\u6a21\u5757\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a\u5f00\u542f Feign"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\n@EnableCircuitBreaker // \u964d\u7ea7\u4f7f\u7528\npublic class PaymentHystrixMain8001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentHystrixMain8001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class PaymentController {\n    @Resource\n    private PaymentService paymentService;\n    @Value("${server.port}")\n    private String serverPort;\n\n    // \u6b63\u5e38\u8bbf\u95ee\n    @GetMapping("/payment/hystrix/ok/{id}")\n    private String paymentInfo_Ok(@PathVariable("id") Integer id) {\n        return paymentService.paymentInfo_Ok(id);\n    }\n\t// \u8d85\u65f6\n    @GetMapping("/payment/hystrix/timeout/{id}")\n    private String paymentInfo_Timeout(@PathVariable("id") Integer id) {\n        // service \u5c42\u6709 Thread.sleep() \u64cd\u4f5c\uff0c\u4fdd\u8bc1\u8d85\u65f6\n        return paymentService.paymentInfo_Timeout(id);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Service\npublic class PaymentService {\n    public String paymentInfo_Ok(Integer id) {\n        return "\u7ebf\u7a0b\u6c60: " + Thread.currentThread().getName() + "paymentInfo_OK, id:  " + id";\n    }\n\n    public String paymentInfo_Timeout(Integer id) {\n        int timeNumber = 3;\n        try {\n            TimeUnit.SECONDS.sleep(timeNumber);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        return "\u7ebf\u7a0b\u6c60: " + Thread.currentThread().getName() + " payment_Timeout, id:  " + id;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"jmeter \u538b\u6d4b\u4e24\u4e2a\u63a5\u53e3\uff0c\u53d1\u73b0\u63a5\u53e3 paymentInfo_Ok \u4e5f\u53d8\u7684\u5361\u987f"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u8d39\u8005\u6a21\u5757\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service \u63a5\u53e3\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@FeignClient(value = "CLOUD-PROVIDER-HYSTRIX-PAYMENT")\npublic interface PaymentHystrixService {\n    @GetMapping("/payment/hystrix/ok/{id}")\n    public String paymentInfo_Ok(@PathVariable("id") Integer id);\n\n    @GetMapping("/payment/hystrix/timeout/{id}")\n    public String paymentInfo_Timeout(@PathVariable("id") Integer id);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class OrderHystirxController {\n    @Resource\n    PaymentHystrixService paymentHystrixService;\n\n    @GetMapping("/consumer/payment/hystrix/ok/{id}")\n    public String paymentInfo_Ok(@PathVariable("id") Integer id) {\n        return paymentHystrixService.paymentInfo_Ok(id);\n    }\n\n    @GetMapping("/consumer/payment/hystrix/timeout/{id}")\n    public String paymentInfo_Timeout(@PathVariable("id") Integer id) {\n        return paymentHystrixService.paymentInfo_Timeout(id);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\uff1a\u4f7f\u7528\u7684\u662f Feign \u4f5c\u4e3a\u5ba2\u6237\u7aef\uff0c\u9ed8\u8ba4 1s \u6ca1\u6709\u5f97\u5230\u54cd\u5e94\u5c31\u4f1a\u62a5\u8d85\u65f6\u9519\u8bef\uff0c\u8fdb\u884c\u5e76\u53d1\u538b\u6d4b"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8d85\u65f6\u5bfc\u81f4\u670d\u52a1\u5668\u53d8\u6162\uff08\u8f6c\u5708\uff09\uff1a\u8d85\u65f6\u4e0d\u518d\u7b49\u5f85"}),"\n",(0,i.jsx)(e.li,{children:"\u51fa\u9519\uff08\u5b95\u673a\u6216\u7a0b\u5e8f\u8fd0\u884c\u51fa\u9519\uff09\uff1a\u51fa\u9519\u8981\u6709\u515c\u5e95"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u964d\u7ea7\u64cd\u4f5c",children:"\u964d\u7ea7\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u4ea7\u8005\u7aef\u548c\u6d88\u8d39\u8005\u7aef\u90fd\u53ef\u4ee5\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\uff0c\u4f7f\u7528 @HystrixCommand \u6ce8\u89e3\u6307\u5b9a\u964d\u7ea7\u540e\u7684\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u4ea7\u8005\u7aef\uff1a\u4e3b\u542f\u52a8\u7c7b\u6dfb\u52a0\u65b0\u6ce8\u89e3 @EnableCircuitBreaker\uff0c\u4e1a\u52a1\u7c7b\uff08Service\uff09\u65b9\u6cd5\u8fdb\u884c\u5982\u4e0b\u4fee\u6539\uff0c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u6a21\u62df\u62e5\u5835\u7684\u60c5\u51b5\n@HystrixCommand(fallbackMethod = "paymentInfo_TimeoutHandler", commandProperties = {\n    //\u89c4\u5b9a\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u8d85\u65f6\u65f6\u95f4\u662f3s\uff0c3s\u540e\u5c31\u7531fallbackMethod\u6307\u5b9a\u7684\u65b9\u6cd5\u201c\u515c\u5e95\u201d\uff08\u670d\u52a1\u964d\u7ea7\uff09\n    @HystrixProperty(name="execution.isolation.thread.timeoutInMilliseconds", value = "3000")\n})\npublic String paymentInfo_Timeout(Integer id) {\n    // \u8d85\u65f6\u6216\u8005\u51fa\u9519\n}\n\npublic String paymentInfo_TimeoutHandler(Integer id) {\n    return "\u7ebf\u7a0b\u6c60\uff1a" + Thread.currentThread().getName() + " paymentInfo_TimeoutHandler, id: " + id";\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u964d\u7ea7\u7684\u65b9\u6cd5\u548c\u4e1a\u52a1\u5904\u7406\u7684\u65b9\u6cd5\u6df7\u6742\u5728\u4e86\u4e00\u5757\uff0c\u8026\u5408\u5ea6\u5f88\u9ad8\uff0c\u5e76\u4e14\u6bcf\u4e2a\u65b9\u6cd5\u914d\u7f6e\u4e00\u4e2a\u670d\u52a1\u964d\u7ea7\u65b9\u6cd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:'\u5728\u4e1a\u52a1\u7c7bController\u4e0a\u52a0 @DefaultProperties(defaultFallback = "method_name") \u6ce8\u89e3'}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u9700\u8981\u670d\u52a1\u964d\u7ea7\u7684\u65b9\u6cd5\u4e0a\u6807\u6ce8 @HystrixCommand \u6ce8\u89e3\uff0c\u5982\u679c @HystrixCommand \u91cc\u6ca1\u6709\u6307\u660e fallbackMethod\uff0c\u5c31\u9ed8\u8ba4\u4f7f\u7528 @DefaultProperties \u4e2d\u6307\u660e\u7684\u964d\u7ea7\u670d\u52a1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\n@DefaultProperties(defaultFallback = "payment_Global_FallbackMethod")\npublic class OrderHystrixController {\n    @Resource\n    PaymentHystrixService paymentHystrixService;\n\n    @GetMapping("/consumer/payment/hystrix/ok/{id}")\n    public String paymentInfo_Ok(@PathVariable("id") Integer id) {\n        return paymentHystrixService.paymentInfo_OK(id);\n    }\n\n    @HystrixCommand\n    public String paymentInfo_Timeout(@PathVariable("id") Integer id) {\n        return paymentHystrixService.paymentInfo_Timeout(id);\n    }\n\n    public String paymentTimeOutFallbackMethod(@PathVariable("id") Integer id) {\n        return "fallback";\n    }\n\n    // \u4e0b\u9762\u662f\u5168\u5c40fallback\u65b9\u6cd5\n    public String payment_Global_FallbackMethod() {\n        return "Global fallback";\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5ba2\u6237\u7aef\u8c03\u7528\u670d\u52a1\u7aef\uff0c\u9047\u5230\u670d\u52a1\u7aef\u5b95\u673a\u6216\u5173\u95ed\u7b49\u6781\u7aef\u60c5\u51b5\uff0c\u4e3a Feign \u5ba2\u6237\u7aef\u5b9a\u4e49\u7684\u63a5\u53e3\u6dfb\u52a0\u4e00\u4e2a\u670d\u52a1\u964d\u7ea7\u5b9e\u73b0\u7c7b\u5373\u53ef\u5b9e\u73b0\u89e3\u8026"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u4e86 Hystrix"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# \u7528\u4e8e\u670d\u52a1\u964d\u7ea7 \u5728\u6ce8\u89e3 @FeignClient\u4e2d\u6dfb\u52a0fallbackFactory\u5c5e\u6027\u503c\nfeign:\n  hystrix:\n    enabled: true  #\u5728Feign\u4e2d\u5f00\u542fHystrix\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Service\uff1a\u7edf\u4e00\u4e3a\u63a5\u53e3\u91cc\u9762\u7684\u65b9\u6cd5\u8fdb\u884c\u5f02\u5e38\u5904\u7406\uff0c\u670d\u52a1\u5f02\u5e38\u627e PaymentFallbackService\uff0c\u6765\u7edf\u4e00\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\u7684\u5904\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@FeignClient(value = "PROVIDER-HYSTRIX-PAYMENT", fallback = PaymentFallbackService.class)\npublic interface PaymentHystrixService {\n\n    @GetMapping("/payment/hystrix/ok/{id}")\n    public String paymentInfo_OK(@PathVariable("id") Integer id);\n\n    @GetMapping("/payment/hystrix/timeout/{id}")\n    public String paymentInfo_Timeout(@PathVariable("id") Integer id);\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"PaymentFallbackService\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\npublic class PaymentFallbackService implements PaymentHystrixService {\n    @Override\n    public String paymentInfo_OK(Integer id) {\n        return "------PaymentFallbackService-paymentInfo_Ok, fallback";\n    }\n\n    @Override\n    public String paymentInfo_Timeout(Integer id) {\n        return "------PaymentFallbackService-paymentInfo_Timeout, fallback";\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u7194\u65ad-1",children:"\u670d\u52a1\u7194\u65ad"}),"\n",(0,i.jsx)(e.h5,{id:"\u7194\u65ad\u7c7b\u578b",children:"\u7194\u65ad\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"\u7194\u65ad\u673a\u5236\u662f\u5e94\u5bf9\u96ea\u5d29\u6548\u5e94\u7684\u4e00\u79cd\u5fae\u670d\u52a1\u94fe\u8def\u4fdd\u62a4\u673a\u5236\uff0c\u5f53\u6247\u51fa\u94fe\u8def\u7684\u67d0\u4e2a\u5fae\u670d\u52a1\u51fa\u9519\u4e0d\u53ef\u7528\u6216\u8005\u54cd\u5e94\u65f6\u95f4\u592a\u957f\u65f6\uff0c\u4f1a\u8fdb\u884c\u670d\u52a1\u7684\u964d\u7ea7\uff0c\u8fdb\u800c\u7194\u65ad\u8be5\u8282\u70b9\u5fae\u670d\u52a1\u7684\u8c03\u7528\uff0c\u5feb\u901f\u8fd4\u56de\u9519\u8bef\u7684\u54cd\u5e94\u4fe1\u606f"}),"\n",(0,i.jsx)(e.p,{children:"Hystrix \u4f1a\u76d1\u63a7\u5fae\u670d\u52a1\u95f4\u8c03\u7528\u7684\u72b6\u51b5\uff0c\u5f53\u5931\u8d25\u7684\u8c03\u7528\u5230\u4e00\u5b9a\u9608\u503c\uff0c\u7f3a\u7701\u65f6 5 \u79d2\u5185 20 \u6b21\u8c03\u7528\u5931\u8d25\uff0c\u5c31\u4f1a\u542f\u52a8\u7194\u65ad\u673a\u5236\uff1b\u5f53\u68c0\u6d4b\u5230\u8be5\u8282\u70b9\u5fae\u670d\u52a1\u8c03\u7528\u54cd\u5e94\u6b63\u5e38\u540e\uff08\u68c0\u6d4b\u65b9\u5f0f\u662f\u5c1d\u8bd5\u6027\u653e\u5f00\u8bf7\u6c42\uff09\uff0c\u81ea\u52a8\u6062\u590d\u8c03\u7528\u94fe\u8def"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u6253\u5f00\uff1a\u8bf7\u6c42\u4e0d\u518d\u8fdb\u884c\u8c03\u7528\u5f53\u524d\u670d\u52a1\uff0c\u518d\u6709\u8bf7\u6c42\u8c03\u7528\u65f6\u5c06\u4e0d\u4f1a\u8c03\u7528\u4e3b\u903b\u8f91\uff0c\u800c\u662f\u76f4\u63a5\u8c03\u7528\u964d\u7ea7 fallback\u3002\u5b9e\u73b0\u4e86\u81ea\u52a8\u7684\u53d1\u73b0\u9519\u8bef\u5e76\u5c06\u964d\u7ea7\u903b\u8f91\u5207\u6362\u4e3a\u4e3b\u903b\u8f91\uff0c\u51cf\u5c11\u54cd\u5e94\u5ef6\u8fdf\u6548\u679c\u3002\u5185\u90e8\u8bbe\u7f6e\u65f6\u949f\u4e00\u822c\u4e3a MTTR\uff08Mean time to repair\uff0c\u5e73\u5747\u6545\u969c\u5904\u7406\u65f6\u95f4\uff09\uff0c\u5f53\u6253\u5f00\u65f6\u957f\u8fbe\u5230\u6240\u8bbe\u65f6\u949f\u5219\u8fdb\u5165\u534a\u7194\u65ad\u72b6\u6001"}),"\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u5173\u95ed\uff1a\u7194\u65ad\u5173\u95ed\u4e0d\u4f1a\u5bf9\u670d\u52a1\u8fdb\u884c\u7194\u65ad\uff0c\u670d\u52a1\u6b63\u5e38\u8c03\u7528"}),"\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u534a\u5f00\uff1a\u90e8\u5206\u8bf7\u6c42\u6839\u636e\u89c4\u5219\u8c03\u7528\u5f53\u524d\u670d\u52a1\uff0c\u5982\u679c\u8bf7\u6c42\u6210\u529f\u4e14\u7b26\u5408\u89c4\u5219\u5219\u8ba4\u4e3a\u5f53\u524d\u670d\u52a1\u6062\u590d\u6b63\u5e38\uff0c\u5173\u95ed\u7194\u65ad\uff0c\u53cd\u4e4b\u7ee7\u7eed\u7194\u65ad"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Hystrix\u7194\u65ad\u673a\u5236",src:s(77158).A+"",width:"450",height:"406"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u7194\u65ad\u64cd\u4f5c",children:"\u7194\u65ad\u64cd\u4f5c"}),"\n",(0,i.jsxs)(e.p,{children:["\u6d89\u53ca\u5230\u65ad\u8def\u5668\u7684\u56db\u4e2a\u91cd\u8981\u53c2\u6570\uff1a",(0,i.jsx)(e.strong,{children:"\u5feb\u7167\u65f6\u95f4\u7a97\u3001\u8bf7\u6c42\u603b\u6570\u9600\u503c\u3001\u7a97\u53e3\u7761\u7720\u65f6\u95f4\u3001\u9519\u8bef\u767e\u5206\u6bd4\u9600\u503c"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"circuitBreaker.enabled\uff1a\u662f\u5426\u5f00\u542f\u65ad\u8def\u5668"}),"\n",(0,i.jsx)(e.li,{children:"metrics.rollingStats.timeInMilliseconds\uff1a\u5feb\u7167\u65f6\u95f4\u7a97\u53e3\uff0c\u65ad\u8def\u5668\u786e\u5b9a\u662f\u5426\u6253\u5f00\u9700\u8981\u7edf\u8ba1\u4e00\u4e9b\u8bf7\u6c42\u548c\u9519\u8bef\u6570\u636e\uff0c\u800c\u7edf\u8ba1\u7684\u65f6\u95f4\u8303\u56f4\u5c31\u662f\u5feb\u7167\u65f6\u95f4\u7a97\uff0c\u9ed8\u8ba4\u4e3a\u6700\u8fd1\u7684 10 \u79d2"}),"\n",(0,i.jsx)(e.li,{children:"circuitBreaker.requestVolumeThreshold\uff1a\u8bf7\u6c42\u603b\u6570\u9600\u503c\uff0c\u8be5\u5c5e\u6027\u8bbe\u7f6e\u5728\u5feb\u7167\u65f6\u95f4\u7a97\u5185\uff08\u9ed8\u8ba4 10s\uff09\u4f7f\u65ad\u8def\u5668\u8df3\u95f8\u7684\u6700\u5c0f\u8bf7\u6c42\u6570\u91cf\uff08\u9ed8\u8ba4\u662f 20\uff09\uff0c\u5982\u679c 10s \u5185\u8bf7\u6c42\u6570\u5c0f\u4e8e\u8bbe\u5b9a\u503c\uff0c\u5c31\u7b97\u8bf7\u6c42\u5168\u90e8\u5931\u8d25\u4e5f\u4e0d\u4f1a\u89e6\u53d1\u65ad\u8def\u5668"}),"\n",(0,i.jsx)(e.li,{children:"circuitBreaker.sleepWindowInMilliseconds\uff1a\u7a97\u53e3\u7761\u7720\u65f6\u95f4\uff0c\u77ed\u8def\u591a\u4e45\u4ee5\u540e\u5f00\u59cb\u5c1d\u8bd5\u662f\u5426\u6062\u590d\u8fdb\u5165\u534a\u5f00\u72b6\u6001\uff0c\u9ed8\u8ba4 5s"}),"\n",(0,i.jsx)(e.li,{children:"circuitBreaker.errorThresholdPercentage\uff1a\u9519\u8bef\u767e\u5206\u6bd4\u9600\u503c\uff0c\u5931\u8d25\u7387\u8fbe\u5230\u591a\u5c11\u540e\u5c06\u65ad\u8def\u5668\u6253\u5f00"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:' //\u603b\u7684\u610f\u601d\u5c31\u662f\u5728n(10)\u6beb\u79d2\u5185\u7684\u65f6\u95f4\u7a97\u53e3\u671f\u5185\uff0cm\u6b21\u8bf7\u6c42\u4e2d\u6709p% (60%)\u7684\u8bf7\u6c42\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u65ad\u8def\u5668\u542f\u52a8\n@HystrixCommand(fallbackMethod = "paymentCircuitBreaker_fallback", commandProperties = {\n        @HystrixProperty(name = "circuitBreaker.enabled", value = "true"),\n        @HystrixProperty(name = "circuitBreaker.requestVolumeThreshold", value = "10"), \n        @HystrixProperty(name = "circuitBreaker.sleepWindowInMilliseconds", value = "10000"),\n        @HystrixProperty(name = "circuitBreaker.errorThresholdPercentage", value = "60")  \n})\npublic String paymentCircuitBreaker(@PathVariable("id") Integer id) {\n    if (id < 0) {\n        throw new RuntimeException("******id \u4e0d\u80fd\u8d1f\u6570");\n    }\n    String serialNumber = IdUtil.simpleUUID();  // \u7b49\u4ef7\u4e8eUUID.randomUUID().toString()\n\n    return Thread.currentThread().getName() + "\\t" + "\u8c03\u7528\u6210\u529f\uff0c\u6d41\u6c34\u53f7: " + serialNumber;\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5f00\u542f\uff1a\u6ee1\u8db3\u4e00\u5b9a\u7684\u9608\u503c\uff08\u9ed8\u8ba4 10 \u79d2\u5185\u8d85\u8fc7 20 \u4e2a\u8bf7\u6c42\u6b21\u6570\uff09\u3001\u5931\u8d25\u7387\u8fbe\u5230\u9608\u503c\uff08\u9ed8\u8ba4 10 \u79d2\u5185\u8d85\u8fc7 50% \u7684\u8bf7\u6c42\u5931\u8d25\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u5173\u95ed\uff1a\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff08\u9ed8\u8ba4\u662f 5 \u79d2\uff09\uff0c\u65ad\u8def\u5668\u662f\u534a\u5f00\u72b6\u6001\uff0c\u4f1a\u8ba9\u5176\u4e2d\u4e00\u4e2a\u8bf7\u6c42\u8fdb\u884c\u8f6c\u53d1\uff0c\u5982\u679c\u6210\u529f\u65ad\u8def\u5668\u4f1a\u5173\u95ed\uff0c\u53cd\u4e4b\u7ee7\u7eed\u5f00\u542f"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5de5\u4f5c\u6d41\u7a0b-1",children:"\u5de5\u4f5c\u6d41\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u5177\u4f53\u5de5\u4f5c\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u521b\u5efa HystrixCommand\uff08\u7528\u5728\u4f9d\u8d56\u7684\u670d\u52a1\u8fd4\u56de\u5355\u4e2a\u64cd\u4f5c\u7ed3\u679c\u7684\u65f6\u5019\uff09 \u6216 HystrixObserableCommand\uff08\u7528\u5728\u4f9d\u8d56\u7684\u670d\u52a1\u8fd4\u56de\u591a\u4e2a\u64cd\u4f5c\u7ed3\u679c\u7684\u65f6\u5019\uff09 \u5bf9\u8c61"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u547d\u4ee4\u6267\u884c\uff0c\u5176\u4e2d HystrixComand \u5b9e\u73b0\u4e86\u4e0b\u9762\u524d\u4e24\u79cd\u6267\u884c\u65b9\u5f0f\uff0c\u800c HystrixObservableCommand \u5b9e\u73b0\u4e86\u540e\u4e24\u79cd\u6267\u884c\u65b9\u5f0f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"execute()\uff1a\u540c\u6b65\u6267\u884c\uff0c\u4ece\u4f9d\u8d56\u7684\u670d\u52a1\u8fd4\u56de\u4e00\u4e2a\u5355\u4e00\u7684\u7ed3\u679c\u5bf9\u8c61\uff0c \u6216\u662f\u5728\u53d1\u751f\u9519\u8bef\u7684\u65f6\u5019\u629b\u51fa\u5f02\u5e38"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"queue()\uff1a\u5f02\u6b65\u6267\u884c\uff0c \u76f4\u63a5\u8fd4\u56de \u4e00\u4e2a Future \u5bf9\u8c61\uff0c \u5176\u4e2d\u5305\u542b\u4e86\u670d\u52a1\u6267\u884c\u7ed3\u675f\u65f6\u8981\u8fd4\u56de\u7684\u5355\u4e00\u7ed3\u679c\u5bf9\u8c61"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"observe()\uff1a\u8fd4\u56de Observable \u5bf9\u8c61\uff0c\u4ee3\u8868\u4e86\u64cd\u4f5c\u7684\u591a\u4e2a\u7ed3\u679c\uff0c\u5b83\u662f\u4e00\u4e2a Hot Obserable\uff08\u4e0d\u8bba\u4e8b\u4ef6\u6e90\u662f\u5426\u6709\u8ba2\u9605\u8005\uff0c\u90fd\u4f1a\u5728\u521b\u5efa\u540e\u5bf9\u4e8b\u4ef6\u8fdb\u884c\u53d1\u5e03\uff0c\u6240\u4ee5\u5bf9\u4e8e Hot Observable \u7684\u6bcf\u4e2a\u8ba2\u9605\u8005\u90fd\u6709\u53ef\u80fd\u662f\u4ece\u4e8b\u4ef6\u6e90\u7684\u4e2d\u9014\u5f00\u59cb\u7684\uff0c\u5e76\u53ef\u80fd\u53ea\u662f\u770b\u5230\u4e86\u6574\u4e2a\u64cd\u4f5c\u7684\u5c40\u90e8\u8fc7\u7a0b\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"toObservable()\uff1a\u540c\u6837\u4f1a\u8fd4\u56de Observable \u5bf9\u8c61\uff0c\u4e5f\u4ee3\u8868\u4e86\u64cd\u4f5c\u7684\u591a\u4e2a\u7ed3\u679c\uff0c\u4f46\u5b83\u8fd4\u56de\u7684\u662f\u4e00\u4e2a Cold Observable\uff08\u6ca1\u6709\u8ba2\u9605\u8005\u7684\u65f6\u5019\u5e76\u4e0d\u4f1a\u53d1\u5e03\u4e8b\u4ef6\uff0c\u800c\u662f\u8fdb\u884c\u7b49\u5f85\uff0c\u76f4\u5230\u6709\u8ba2\u9605\u8005\u4e4b\u540e\u624d\u53d1\u5e03\u4e8b\u4ef6\uff0c\u6240\u4ee5\u5bf9\u4e8e Cold Observable \u7684\u8ba2\u9605\u8005\uff0c\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u4ece\u4e00\u5f00\u59cb\u770b\u5230\u6574\u4e2a\u64cd\u4f5c\u7684\u5168\u90e8\u8fc7\u7a0b\uff09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u82e5\u5f53\u524d\u547d\u4ee4\u7684\u8bf7\u6c42\u7f13\u5b58\u529f\u80fd\u662f\u88ab\u542f\u7528\u7684\uff0c\u5e76\u4e14\u8be5\u547d\u4ee4\u7f13\u5b58\u547d\u4e2d\uff0c\u90a3\u4e48\u7f13\u5b58\u7684\u7ed3\u679c\u4f1a\u7acb\u5373\u4ee5 Observable \u5bf9\u8c61\u7684\u5f62\u5f0f\u8fd4\u56de"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u68c0\u67e5\u65ad\u8def\u5668\u662f\u5426\u4e3a\u6253\u5f00\u72b6\u6001\uff0c\u5982\u679c\u65ad\u8def\u5668\u662f\u6253\u5f00\u7684\uff0c\u90a3\u4e48 Hystrix \u4e0d\u4f1a\u6267\u884c\u547d\u4ee4\uff0c\u800c\u662f\u8f6c\u63a5\u5230 fallback \u5904\u7406\u903b\u8f91\uff08\u7b2c 8 \u6b65\uff09\uff1b\u5982\u679c\u65ad\u8def\u5668\u662f\u5173\u95ed\u7684\uff0c\u68c0\u67e5\u662f\u5426\u6709\u53ef\u7528\u8d44\u6e90\u6765\u6267\u884c\u547d\u4ee4\uff08\u7b2c 5 \u6b65\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60/\u8bf7\u6c42\u961f\u5217/\u4fe1\u53f7\u91cf\u662f\u5426\u5360\u6ee1\uff0c\u5982\u679c\u547d\u4ee4\u4f9d\u8d56\u670d\u52a1\u7684\u4e13\u6709\u7ebf\u7a0b\u6c60\u548c\u8bf7\u6c42\u961f\u5217\uff0c\u6216\u8005\u4fe1\u53f7\u91cf\uff08\u4e0d\u4f7f\u7528\u7ebf\u7a0b\u6c60\u65f6\uff09\u5df2\u7ecf\u88ab\u5360\u6ee1\uff0c \u90a3\u4e48 Hystrix \u4e5f\u4e0d\u4f1a\u6267\u884c\u547d\u4ee4\uff0c \u800c\u662f\u8f6c\u63a5\u5230 fallback \u5904\u7406\u903b\u8f91\uff08\u7b2c 8 \u6b65\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Hystrix \u4f1a\u6839\u636e\u6211\u4eec\u7f16\u5199\u7684\u65b9\u6cd5\u6765\u51b3\u5b9a\u91c7\u53d6\u4ec0\u4e48\u6837\u7684\u65b9\u5f0f\u53bb\u8bf7\u6c42\u4f9d\u8d56\u670d\u52a1"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"HystrixCommand.run()\uff1a\u8fd4\u56de\u4e00\u4e2a\u5355\u4e00\u7684\u7ed3\u679c\uff0c\u6216\u8005\u629b\u51fa\u5f02\u5e38"}),"\n",(0,i.jsx)(e.li,{children:"HystrixObservableCommand.construct()\uff1a\u8fd4\u56de\u4e00\u4e2aObservable \u5bf9\u8c61\u6765\u53d1\u5c04\u591a\u4e2a\u7ed3\u679c\uff0c\u6216\u901a\u8fc7 onError \u53d1\u9001\u9519\u8bef\u901a\u77e5"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:'Hystrix\u4f1a\u5c06"\u6210\u529f"\u3001"\u5931\u8d25"\u3001"\u62d2\u7edd"\u3001"\u8d85\u65f6"\u7b49\u4fe1\u606f\u62a5\u544a\u7ed9\u65ad\u8def\u5668\uff0c\u800c\u65ad\u8def\u5668\u4f1a\u7ef4\u62a4\u4e00\u7ec4\u8ba1\u6570\u5668\u6765\u7edf\u8ba1\u8fd9\u4e9b\u6570\u636e\u3002\u65ad\u8def\u5668\u4f1a\u4f7f\u7528\u8fd9\u4e9b\u7edf\u8ba1\u6570\u636e\u6765\u51b3\u5b9a\u662f\u5426\u8981\u5c06\u65ad\u8def\u5668\u6253\u5f00\uff0c\u6765\u5bf9\u67d0\u4e2a\u4f9d\u8d56\u670d\u52a1\u7684\u8bf7\u6c42\u8fdb\u884c"\u7194\u65ad/\u77ed\u8def"'}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:'\u5f53\u547d\u4ee4\u6267\u884c\u5931\u8d25\u7684\u65f6\u5019\uff0cHystrix \u4f1a\u8fdb\u5165 fallback \u5c1d\u8bd5\u56de\u9000\u5904\u7406\uff0c\u901a\u5e38\u4e5f\u79f0\u8be5\u64cd\u4f5c\u4e3a"\u670d\u52a1\u964d\u7ea7"\uff0c\u800c\u80fd\u591f\u5f15\u8d77\u670d\u52a1\u964d\u7ea7\u60c5\u51b5\uff1a'}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:'\u7b2c 4 \u6b65\uff1a\u5f53\u524d\u547d\u4ee4\u5904\u4e8e"\u7194\u65ad/\u77ed\u8def"\u72b6\u6001\uff0c\u65ad\u8def\u5668\u662f\u6253\u5f00\u7684\u65f6\u5019'}),"\n",(0,i.jsx)(e.li,{children:"\u7b2c 5 \u6b65\uff1a\u5f53\u524d\u547d\u4ee4\u7684\u7ebf\u7a0b\u6c60\u3001\u8bf7\u6c42\u961f\u5217\u6216 \u8005\u4fe1\u53f7\u91cf\u88ab\u5360\u6ee1\u7684\u65f6\u5019"}),"\n",(0,i.jsx)(e.li,{children:"\u7b2c 6 \u6b65\uff1aHystrixObservableCommand.construct() \u6216 HystrixCommand.run() \u629b\u51fa\u5f02\u5e38\u7684\u65f6\u5019"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f53 Hystrix \u547d\u4ee4\u6267\u884c\u6210\u529f\u4e4b\u540e\uff0c \u5b83\u4f1a\u5c06\u5904\u7406\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u6216\u662f\u4ee5 Observable \u7684\u5f62\u5f0f\u8fd4\u56de"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u5982\u679c\u3001\u6ca1\u6709\u4e3a\u547d\u4ee4\u5b9e\u73b0\u964d\u7ea7\u903b\u8f91\u6216\u8005\u5728\u964d\u7ea7\u5904\u7406\u903b\u8f91\u4e2d\u629b\u51fa\u4e86\u5f02\u5e38\uff0c Hystrix \u4f9d\u7136\u4f1a\u8fd4\u56de\u4e00\u4e2a Observable \u5bf9\u8c61\uff0c \u4f46\u662f\u5b83\u4e0d\u4f1a\u53d1\u5c04\u4efb\u4f55\u7ed3\u679c\u6570\u636e\uff0c\u800c\u662f\u901a\u8fc7 onError \u65b9\u6cd5\u901a\u77e5\u547d\u4ee4\u7acb\u5373\u4e2d\u65ad\u8bf7\u6c42\uff0c\u5e76\u901a\u8fc7 onError() \u65b9\u6cd5\u5c06\u5f15\u8d77\u547d\u4ee4\u5931\u8d25\u7684\u5f02\u5e38\u53d1\u9001\u7ed9\u8c03\u7528\u8005"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Hystrix\u5de5\u4f5c\u6d41\u7a0b",src:s(15832).A+"",width:"1372",height:"667"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/Netflix/Hystrix/wiki/How-it-Works",children:"https://github.com/Netflix/Hystrix/wiki/How-it-Works"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u76d1\u63a7",children:"\u670d\u52a1\u76d1\u63a7"}),"\n",(0,i.jsxs)(e.p,{children:["Hystrix \u63d0\u4f9b\u4e86\u51c6\u5b9e\u65f6\u7684\u8c03\u7528\u76d1\u63a7\uff08Hystrix Dashboard\uff09\uff0cHystrix \u4f1a\u6301\u7eed\u7684\u8bb0\u5f55\u6240\u6709\u901a\u8fc7 Hystrix \u53d1\u8d77\u7684\u8bf7\u6c42\u7684\u6267\u884c\u4fe1\u606f\uff0c\u5e76\u4ee5\u7edf\u8ba1\u62a5\u8868\u548c\u56fe\u5f62\u7684\u5f62\u5f0f\u5c55\u793a\u7ed9\u7528\u6237\uff0c\u5305\u62ec\u6bcf\u79d2\u6267\u884c\u591a\u5c11\u8bf7\u6c42\u591a\u5c11\u6210\u529f\uff0c\u591a\u5c11\u5931\u8d25\u7b49\uff0cNetflix \u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"hystrix-metrics-event-stream"})," \u9879\u76ee\u5b9e\u73b0\u4e86\u5bf9\u4ee5\u4e0a\u6307\u6807\u7684\u76d1\u63a7\uff0cSpring Cloud \u63d0\u4f9b\u4e86 Hystrix Dashboard \u7684\u6574\u5408\uff0c\u5bf9\u76d1\u63a7\u5185\u5bb9\u8f6c\u5316\u6210\u53ef\u89c6\u5316\u9875\u9762"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-hystrix-dashboard</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a\u53ea\u9700\u8981\u7aef\u53e3\u5373\u53ef"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 9001\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableHystrixDashboard // \u5f00\u542fHystrix\u4eea\u8868\u76d8\npublic class HystrixDashboardMain9001 {\n    public static void main(String[] args) {\n        SpringApplication.run(HystrixDashboardMain9001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6240\u6709\u5fae\u670d\u52a1\uff08\u751f\u4ea7\u8005\uff09\u63d0\u4f9b\u7c7b 8001/8002/8003 \u90fd\u9700\u8981\u76d1\u63a7\u4f9d\u8d56\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u542f\u52a8\u6d4b\u8bd5\uff1a",(0,i.jsx)(e.a,{href:"http://localhost:9001/hystrix",children:"http://localhost:9001/hystrix"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(62970).A+"",width:"957",height:"618"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b0\u7248\u672c Hystrix \u9700\u8981\u5728\u9700\u8981\u76d1\u63a7\u7684\u5fae\u670d\u52a1\u7aef\u7684\u4e3b\u542f\u52a8\u7c7b\u4e2d\u6307\u5b9a\u76d1\u63a7\u8def\u5f84\uff0c\u4e0d\u7136\u4f1a\u62a5\u9519"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@SpringBootApplication\n@EnableEurekaClient  // \u672c\u670d\u52a1\u542f\u52a8\u540e\u4f1a\u81ea\u52a8\u6ce8\u518c\u8fdbeureka\u670d\u52a1\u4e2d\n@EnableCircuitBreaker  // \u5bf9hystrixR\u7194\u65ad\u673a\u5236\u7684\u652f\u6301\npublic class PaymentHystrixMain8001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentHystrixMain8001.class, args);\n    }\n\n    /** ======================================\u9700\u8981\u6dfb\u52a0\u7684\u4ee3\u7801==================\n     *\u6b64\u914d\u7f6e\u662f\u4e3a\u4e86\u670d\u52a1\u76d1\u63a7\u800c\u914d\u7f6e\uff0c\u4e0e\u670d\u52a1\u5bb9\u9519\u672c\u8eab\u65e0\u5173\uff0cspringcloud\u5347\u7ea7\u540e\u7684\u5751\n     *ServletRegistrationBean\u56e0\u4e3aspringboot\u7684\u9ed8\u8ba4\u8def\u5f84\u4e0d\u662f"/hystrix.stream"\uff0c\n     *\u53ea\u8981\u5728\u81ea\u5df1\u7684\u9879\u76ee\u91cc\u914d\u7f6e\u4e0a\u4e0b\u9762\u7684servlet\u5c31\u53ef\u4ee5\u4e86\n     */\n    @Bean\n    public ServletRegistrationBean getServlet() {\n        HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet();\n        ServletRegistrationBean registrationBean = new ServletRegistrationBean(streamServlet);\n        registrationBean.setLoadOnStartup(1);\n        registrationBean.addUrlMappings("/hystrix.stream");\n        registrationBean.setName("HystrixMetricsStreamServlet");\n        return registrationBean;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6307\u6807\u8bf4\u660e\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Hystrix\u754c\u9762\u56fe\u793a\u8bf4\u660e",src:s(58831).A+"",width:"1356",height:"1071"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u670d\u52a1\u7f51\u5173",children:"\u670d\u52a1\u7f51\u5173"}),"\n",(0,i.jsx)(e.h3,{id:"zuul",children:"Zuul"}),"\n",(0,i.jsx)(e.p,{children:"SpringCloud \u4e2d\u6240\u96c6\u6210\u7684 Zuul \u7248\u672c\uff0c\u91c7\u7528\u7684\u662f Tomcat \u5bb9\u5668\uff0c\u57fa\u4e8e Servlet \u4e4b\u4e0a\u7684\u4e00\u4e2a\u963b\u585e\u5f0f\u5904\u7406\u6a21\u578b\uff0c\u4e0d\u652f\u6301\u4efb\u4f55\u957f\u8fde\u63a5\uff0c\u7528 Java \u5b9e\u73b0\uff0c\u800c JVM \u672c\u8eab\u4f1a\u6709\u7b2c\u4e00\u6b21\u52a0\u8f7d\u8f83\u6162\u7684\u60c5\u51b5\uff0c\u4f7f\u5f97 Zuul \u7684\u6027\u80fd\u76f8\u5bf9\u8f83\u5dee"}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u7f51\uff1a   ",(0,i.jsx)(e.a,{href:"https://github.com/Netflix/zuul/wiki",children:"https://github.com/Netflix/zuul/wiki"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"gateway",children:"Gateway"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-13",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"SpringCloud Gateway \u662f Spring Cloud \u7684\u4e00\u4e2a\u5168\u65b0\u9879\u76ee\uff0c\u57fa\u4e8e Spring 5.0+Spring Boot 2.0 \u548c Project Reactor \u7b49\u6280\u672f\u5f00\u53d1\u7684\u7f51\u5173\uff0c\u65e8\u5728\u4e3a\u5fae\u670d\u52a1\u67b6\u6784\u63d0\u4f9b\u4e00\u79cd\u7b80\u5355\u6709\u6548\u7684\u7edf\u4e00\u7684 API \u8def\u7531\u7ba1\u7406\u65b9\u5f0f\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u57fa\u4e8e WebFlux \u6846\u67b6\u5b9e\u73b0\uff0c\u800c WebFlux \u6846\u67b6\u5e95\u5c42\u5219\u4f7f\u7528\u4e86\u9ad8\u6027\u80fd\u7684 Reactor \u6a21\u5f0f\u901a\u4fe1\u6846\u67b6 Netty\uff08\u5f02\u6b65\u975e\u963b\u585e\u54cd\u5e94\u5f0f\u7684\u6846\u67b6\uff09"}),"\n",(0,i.jsx)(e.li,{children:"\u57fa\u4e8e Filter \u94fe\u7684\u65b9\u5f0f\u63d0\u4f9b\u4e86\u7f51\u5173\u57fa\u672c\u7684\u529f\u80fd\uff0c\u4f8b\u5982\uff1a\u5b89\u5168\u3001\u76d1\u63a7/\u6307\u6807\u3001\u9650\u6d41\u7b49"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Gateway \u7684\u4e09\u4e2a\u6838\u5fc3\u7ec4\u4ef6\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Route\uff1a\u8def\u7531\u662f\u6784\u5efa\u7f51\u5173\u7684\u57fa\u672c\u6a21\u5757\uff0c\u7531 ID\u3001\u76ee\u6807 URI\u3001\u4e00\u7cfb\u5217\u7684\u65ad\u8a00\u548c\u8fc7\u6ee4\u5668\u7ec4\u6210\uff0c\u5982\u679c\u65ad\u8a00\u4e3a true \u5219\u5339\u914d\u8be5\u8def\u7531"}),"\n",(0,i.jsx)(e.li,{children:"Predicate\uff1a\u65ad\u8a00\uff0c\u53ef\u4ee5\u5339\u914d HTTP \u8bf7\u6c42\u4e2d\u7684\u6240\u6709\u5185\u5bb9\uff08\u4f8b\u5982\u8bf7\u6c42\u5934\u6216\u8bf7\u6c42\u53c2\u6570\uff09\uff0c\u5982\u679c\u8bf7\u6c42\u53c2\u6570\u4e0e\u65ad\u8a00\u76f8\u5339\u914d\u5219\u8fdb\u884c\u8def\u7531"}),"\n",(0,i.jsx)(e.li,{children:"Filter\uff1a\u6307 Spring \u6846\u67b6\u4e2d\u7684 GatewayFilter\u5b9e\u4f8b\uff0c\u4f7f\u7528\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5728\u8bf7\u6c42\u88ab\u8def\u7531\u524d\u6216\u4e4b\u540e\uff08\u62e6\u622a\uff09\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4fee\u6539"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Gateway\u5de5\u4f5c\u6d41\u7a0b",src:s(89255).A+"",width:"457",height:"424"})}),"\n",(0,i.jsx)(e.p,{children:"\u6838\u5fc3\u903b\u8f91\uff1a\u8def\u7531\u8f6c\u53d1 + \u6267\u884c\u8fc7\u6ee4\u5668\u94fe"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5ba2\u6237\u7aef\u5411 Spring Cloud Gateway \u53d1\u51fa\u8bf7\u6c42\uff0c\u7136\u540e\u5728 Gateway Handler Mapping \u4e2d\u627e\u5230\u4e0e\u8bf7\u6c42\u76f8\u5339\u914d\u7684\u8def\u7531\uff0c\u5c06\u5176\u53d1\u9001\u5230 Gateway Web Handler"}),"\n",(0,i.jsx)(e.li,{children:"Handler \u901a\u8fc7\u6307\u5b9a\u7684\u8fc7\u6ee4\u5668\u94fe\u6765\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u9645\u7684\u670d\u52a1\u6267\u884c\u4e1a\u52a1\u903b\u8f91\uff0c\u7136\u540e\u8fd4\u56de"}),"\n",(0,i.jsx)(e.li,{children:"\u8fc7\u6ee4\u5668\u4e4b\u95f4\u7528\u865a\u7ebf\u5206\u5f00\u662f\u56e0\u4e3a\u8fc7\u6ee4\u5668\u53ef\u80fd\u4f1a\u5728\u53d1\u9001\u4ee3\u7406\u8bf7\u6c42\u4e4b\u524d\uff08pre\uff09\u6216\u4e4b\u540e\uff08post\uff09\u6267\u884c\u4e1a\u52a1\u903b\u8f91"}),"\n",(0,i.jsx)(e.li,{children:"Filter \u5728 pre \u7c7b\u578b\u7684\u8fc7\u6ee4\u5668\u53ef\u4ee5\u505a\u53c2\u6570\u6821\u9a8c\u3001\u6743\u9650\u6821\u9a8c\u3001\u6d41\u91cf\u76d1\u63a7\u3001\u65e5\u5fd7\u8f93\u51fa\u3001\u534f\u8bae\u8f6c\u6362\u7b49\uff0c\u5728 post \u7c7b\u578b\u7684\u8fc7\u6ee4\u5668\u4e2d\u53ef\u4ee5\u505a\u54cd\u5e94\u5185\u5bb9\u3001\u54cd\u5e94\u5934\u7684\u4fee\u6539\u3001\u65e5\u5fd7\u7684\u8f93\u51fa\u3001\u6d41\u91cf\u76d1\u63a7\u7b49"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u7f51\u5173\u4f7f\u7528",children:"\u7f51\u5173\u4f7f\u7528"}),"\n",(0,i.jsx)(e.h5,{id:"\u914d\u7f6e\u65b9\u5f0f-2",children:"\u914d\u7f6e\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.p,{children:"Gateway \u7f51\u5173\u8def\u7531\u6709\u4e24\u79cd\u914d\u7f6e\u65b9\u5f0f\uff0c\u5206\u522b\u4e3a\u901a\u8fc7 yml \u914d\u7f6e\u548c\u6ce8\u5165 Bean"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1aGateway \u4e0d\u9700\u8981 spring-boot-starter-web \u4f9d\u8d56\uff0c\u5426\u5728\u4f1a\u62a5\u9519\uff0c\u539f\u56e0\u662f\u5e95\u5c42\u4f7f\u7528\u7684\u662f WebFlux \u4e0e Web \u51b2\u7a81"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-gateway</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 9527\n\nspring:\n  application:\n    name: cloud-gateway\n\neureka:\n  instance:\n    hostname: cloud-gateway-service\n  client: #\u670d\u52a1\u63d0\u4f9b\u8005provider\u6ce8\u518c\u8fdbeureka\u670d\u52a1\u5217\u8868\u5185\n    service-url:\n      register-with-eureka: true\n      fetch-registry: true\n      defaultZone: http://eureka7001.com:7001/eureka,http://eureka7002.com:7002/eureka #\u96c6\u7fa4\u7248\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff08\u7f51\u5173\u4e0d\u9700\u8981\u4e1a\u52a1\u7c7b\uff09\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\npublic class GateWayMain9527 {\n    public static void main(String[] args) {\n        SpringApplication.run(GateWayMain9527.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4ee5\u524d\u8bbf\u95ee provider-payment8001 \u4e2d\u7684 Controller \u65b9\u6cd5\uff0c\u901a\u8fc7 localhost:8001/payment/get/id \u548c localhost:8001/payment/lb\uff0c\u9879\u76ee\u4e0d\u60f3\u66b4\u9732 8001 \u7aef\u53e3\u53f7\uff0c\u5e0c\u671b\u5728 8001 \u5916\u9762\u5957\u4e00\u5c42 9527 \u7aef\u53e3\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 9527\n\nspring:\n  application:\n    name: cloud-gateway\n## =====================\u65b0\u589e====================\n  cloud:\n    gateway:\n      routes:\n        - id: payment_routh # payment_route\t#\u8def\u7531\u7684ID\uff0c\u6ca1\u6709\u56fa\u5b9a\u89c4\u5219\u4f46\u8981\u6c42\u3010\u552f\u4e00\u3011\uff0c\u5efa\u8bae\u914d\u5408\u670d\u52a1\u540d\n          uri: http://localhost:8001\t\t#\u5339\u914d\u540e\u63d0\u4f9b\u670d\u52a1\u7684\u8def\u7531\u5730\u5740\n          predicates:\n            - Path=/payment/get/**\t\t\t# \u65ad\u8a00\uff0c\u8def\u5f84\u76f8\u5339\u914d\u7684\u8fdb\u884c\u8def\u7531\n\n        - id: payment_routh2 # payment_route#\u8def\u7531\u7684ID\uff0c\u6ca1\u6709\u56fa\u5b9a\u89c4\u5219\u4f46\u8981\u6c42\u3010\u552f\u4e00\u3011\uff0c\u5efa\u8bae\u914d\u5408\u670d\u52a1\u540d\n          uri: http://localhost:8001     \t#\u5339\u914d\u540e\u63d0\u4f9b\u670d\u52a1\u7684\u8def\u7531\u5730\u5740\n          predicates:\n            - Path=/payment/lb/**\t\t\t# \u65ad\u8a00\uff0c\u8def\u5f84\u76f8\u5339\u914d\u7684\u8fdb\u884c\u8def\u7531\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"uri + predicate \u62fc\u63a5\u5c31\u662f\u5177\u4f53\u7684\u63a5\u53e3\u8bf7\u6c42\u8def\u5f84\uff0c\u901a\u8fc7 localhost:9527 \u6620\u5c04\u7684\u5730\u5740"}),"\n",(0,i.jsxs)(e.li,{children:["predicate \u65ad\u8a00 ",(0,i.jsx)(e.code,{children:"http://localhost:8001"}),"\u4e0b\u9762\u6709\u4e00\u4e2a /payment/get/** \u7684\u5730\u5740\uff0c\u5982\u679c\u627e\u5230\u4e86\u8be5\u5730\u5740\u5c31\u8fd4\u56de true\uff0c\u53ef\u4ee5\u7528 9527 \u7aef\u53e3\u8bbf\u95ee\uff0c\u8fdb\u884c\u7aef\u53e3\u7684\u9002\u914d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"**"})," \u8868\u793a\u901a\u914d\u7b26\uff0c\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u4e0d\u786e\u5b9a\u7684\u53c2\u6570"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u6ce8\u5165bean",children:"\u6ce8\u5165Bean"}),"\n",(0,i.jsxs)(e.p,{children:["\u901a\u8fc7 9527 \u7f51\u5173\u8bbf\u95ee\u5230\u767e\u5ea6\u7684\u7f51\u5740 ",(0,i.jsx)(e.code,{children:"https://www.baidu.com/"}),"\uff0c\u5728 config \u5305\u4e0b\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u7c7b\uff0c\u8def\u7531\u89c4\u5219\u662f\u8bbf\u95ee /baidu \u8df3\u8f6c\u5230\u767e\u5ea6"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\npublic class GatewayConfig {\n    // \u914d\u7f6e\u4e86\u4e00\u4e2a id \u4e3a path_route_cloud \u7684\u8def\u7531\u89c4\u5219\n    @Bean\n    public RouteLocator customRouteLocator(RouteLocatorBuilder routeLocatorBuilder){\n        // \u6784\u5efa\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u8fd9\u4e2aroutes\u76f8\u5f53\u4e8eyml\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684routes\n        RouteLocatorBuilder.Builder routes = routeLocatorBuilder.routes();\n        // \u8def\u7531\u5668\u7684id\u662f\uff1apath_route_cloud\uff0c\u89c4\u5219\u662f\u8bbf\u95ee/baidu \uff0c\u5c06\u4f1a\u8f6c\u53d1\u5230 https://www.baidu.com/\n        routes.route("path_route_cloud",\n                r -> r.path("/baidu").uri(" https://www.baidu.com")).build();\n        return routes.build();\n    }\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u52a8\u6001\u8def\u7531",children:"\u52a8\u6001\u8def\u7531"}),"\n",(0,i.jsx)(e.p,{children:"Gateway \u4f1a\u6839\u636e\u6ce8\u518c\u4e2d\u5fc3\u6ce8\u518c\u7684\u670d\u52a1\u5217\u8868\uff0c\u4ee5\u6ce8\u518c\u4e2d\u5fc3\u4e0a\u5fae\u670d\u52a1\u540d\u4e3a\u8def\u5f84\u521b\u5efa\u52a8\u6001\u8def\u7531\u8fdb\u884c\u8f6c\u53d1\uff0c\u4ece\u800c\u5b9e\u73b0\u52a8\u6001\u8def\u7531\u548c\u8d1f\u8f7d\u5747\u8861\uff0c\u907f\u514d\u51fa\u73b0\u4e00\u4e2a\u8def\u7531\u89c4\u5219\u4ec5\u5bf9\u5e94\u4e00\u4e2a\u63a5\u53e3\u65b9\u6cd5\uff0c\u5f53\u8bf7\u6c42\u5730\u5740\u5f88\u591a\u65f6\u9700\u8981\u5f88\u5927\u7684\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"application.yml \u5f00\u542f\u52a8\u6001\u8def\u7531\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  application:\n    name: cloud-gateway\n  cloud:\n    gateway:\n      discovery:\n        locator:\n          enabled: true\t\t# \u5f00\u542f\u4ece\u6ce8\u518c\u4e2d\u5fc3\u52a8\u6001\u521b\u5efa\u8def\u7531\u7684\u529f\u80fd\uff0c\u5229\u7528\u5fae\u670d\u52a1\u540d\u8fdb\u884c\u8def\u7531\n      routes:\n        - id: payment_routh1   \t\t\t\t\t# \u8def\u7531\u7684ID\uff0c\u6ca1\u6709\u56fa\u5b9a\u89c4\u5219\u4f46\u8981\u6c42\u552f\u4e00\uff0c\u5efa\u8bae\u914d\u5408\u670d\u52a1\u540d\n          uri: lb://cloud-payment-service\t\t# \u5339\u914d\u540e\u63d0\u4f9b\u670d\u52a1\u7684\u8def\u7531\u5730\u5740\n          predicates:\n            - Path=/payment/get/**              # \u65ad\u8a00\uff0c\u8def\u5f84\u76f8\u5339\u914d\u7684\u8fdb\u884c\u8def\u7531\n\n        - id: payment_routh2      \t\t\t\t#\u8def\u7531\u7684ID\uff0c\u6ca1\u6709\u56fa\u5b9a\u89c4\u5219\u4f46\u8981\u6c42\u552f\u4e00\uff0c\u5efa\u8bae\u914d\u5408\u670d\u52a1\u540d\n          uri: lb://cloud-payment-service\t\t#\u5339\u914d\u540e\u63d0\u4f9b\u670d\u52a1\u7684\u8def\u7531\u5730\u5740\n          predicates:\n            - Path=/payment/lb/**               # \u65ad\u8a00\uff0c\u8def\u5f84\u76f8\u5339\u914d\u7684\u8fdb\u884c\u8def\u7531\n            - After=2021-09-28T19:14:51.514+08:00[Asia/Shanghai]\n"})}),"\n",(0,i.jsx)(e.p,{children:"lb:// \u5f00\u5934\u4ee3\u8868\u4ece\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u83b7\u53d6\u670d\u52a1\uff0c\u540e\u9762\u662f\u9700\u8981\u8f6c\u53d1\u5230\u7684\u670d\u52a1\u540d\u79f0"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u65ad\u8a00\u7c7b\u578b",children:"\u65ad\u8a00\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:"After Route Predicate\uff1a\u5339\u914d\u8be5\u65ad\u8a00\u65f6\u95f4\u4e4b\u540e\u7684 URI \u8bf7\u6c42"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u83b7\u53d6\u65f6\u95f4\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class TimeTest {\n    public static void main(String[] args) {\n        ZonedDateTime zbj = ZonedDateTime.now(); // \u9ed8\u8ba4\u65f6\u533a\n        System.out.println(zbj); //2023-01-10T16:31:44.106+08:00[Asia/Shanghai]\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e yml\uff1a\u52a8\u6001\u8def\u7531\u5c0f\u7ed3\u6709\u914d\u7f6e"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d4b\u8bd5\uff1a\u6b63\u5e38\u8bbf\u95ee\u6210\u529f\uff0c\u5c06\u65f6\u95f4\u4fee\u6539\u5230 2023-01-10T16:31:44.106+08:00[Asia/Shanghai] \u4e4b\u540e\u8bbf\u95ee\u5931\u8d25"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Gateway\u65f6\u95f4\u65ad\u8a00",src:s(7749).A+"",width:"691",height:"308"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5e38\u89c1\u65ad\u8a00\u7c7b\u578b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Before Route Predicate\uff1a\u5339\u914d\u8be5\u65ad\u8a00\u65f6\u95f4\u4e4b\u524d\u7684 URI \u8bf7\u6c42"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Between Route Predicate\uff1a\u5339\u914d\u8be5\u65ad\u8a00\u65f6\u95f4\u4e4b\u95f4\u7684 URI \u8bf7\u6c42"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- Between=2022-02-02T17:45:06.206+08:00[Asia/Shanghai],2022-03-25T18:59:06.206+08:00[Asia/Shanghai]\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Cookie Route Predicate\uff1aCookie \u65ad\u8a00\uff0c\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u662f Cookie name \u548c\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8def\u7531\u89c4\u5219\u4f1a\u901a\u8fc7\u83b7\u53d6\u5bf9\u5e94\u7684 Cookie name \u503c\u548c\u6b63\u5219\u8868\u8fbe\u5f0f\u53bb\u5339\u914d\uff0c\u5982\u679c\u5339\u914d\u4e0a\u5c31\u4f1a\u6267\u884c\u8def\u7531"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- Cookie=username, seazean # \u53ea\u6709\u53d1\u9001\u7684\u8bf7\u6c42\u6709 cookie\uff0c\u800c\u4e14\u6709username=seazean\u8fd9\u4e2a\u6570\u636e\u624d\u80fd\u8bbf\u95ee\uff0c\u53cd\u4e4b404\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Header Route Predicate\uff1a\u8bf7\u6c42\u5934\u65ad\u8a00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- Header=X-Request-Id, \\d+ # \u8bf7\u6c42\u5934\u8981\u6709 X-Request-Id \u5c5e\u6027\uff0c\u5e76\u4e14\u503c\u4e3a\u6574\u6570\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Host Route Predicate\uff1a\u6307\u5b9a\u4e3b\u673a\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u7528 ",(0,i.jsx)(e.code,{children:","})," \u5206\u9694\u5f00"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- Host=**.seazean.com\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Method Route Predicate\uff1a\u8bf7\u6c42\u7c7b\u578b\u65ad\u8a00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- Method=GET\t# \u53ea\u6709 Get \u8bf7\u6c42\u624d\u80fd\u8bbf\u95ee\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Path Route Predicate\uff1a\u8def\u5f84\u5339\u914d\u65ad\u8a00"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Query Route Predicate\uff1a\u8bf7\u6c42\u53c2\u6570\u65ad\u8a00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- Query=username, \\d+ # \u8981\u6709\u53c2\u6570\u540d username \u5e76\u4e14\u503c\u8fd8\u8981\u662f\u6574\u6570\u624d\u80fd\u8def\u7531\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"filter\u4f7f\u7528",children:"Filter\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"Filter \u94fe\u662f\u540c\u65f6\u6ee1\u8db3\u4e00\u7cfb\u5217\u7684\u8fc7\u6ee4\u94fe\uff0c\u8def\u7531\u8fc7\u6ee4\u5668\u53ef\u7528\u4e8e\u4fee\u6539\u8fdb\u5165\u7684 HTTP \u8bf7\u6c42\u548c\u8fd4\u56de\u7684 HTTP \u54cd\u5e94\uff0c\u8def\u7531\u8fc7\u6ee4\u5668\u53ea\u80fd\u6307\u5b9a\u8def\u7531\u8fdb\u884c\u4f7f\u7528\uff0cSpring Cloud Gateway \u5185\u7f6e\u4e86\u591a\u79cd\u8def\u7531\u8fc7\u6ee4\u5668\uff0c\u90fd\u7531 GatewayFilter \u7684\u5de5\u5382\u7c7b\u6765\u4ea7\u751f"}),"\n",(0,i.jsxs)(e.p,{children:["\u914d\u7f6e\u6587\u4ef6\uff1a",(0,i.jsx)(e.a,{href:"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gatewayfilter-factories",children:"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gatewayfilter-factories"})]}),"\n",(0,i.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668\uff1a\u5b9e\u73b0\u4e24\u4e2a\u4e3b\u8981\u63a5\u53e3 GlobalFilter, Ordered"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@Slf4j\npublic class MyLogGateWayFilter implements GlobalFilter, Ordered {\n\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        log.info("*********************come in MyLogGateWayFilter:  "+ new Date());\n        // \u53d6\u51fa\u8bf7\u6c42\u53c2\u6570\u7684uname\u5bf9\u5e94\u7684\u503c\n        String uname = exchange.getRequest().getQueryParams().getFirst("uname");\n        // \u5982\u679c uname \u4e3a\u7a7a\uff0c\u5c31\u76f4\u63a5\u8fc7\u6ee4\u6389\uff0c\u4e0d\u8d70\u8def\u7531\n        if(uname == null){\n            log.info("************* \u7528\u6237\u540d\u4e3a NULL \u975e\u6cd5\u7528\u6237 o(\u2565\ufe4f\u2565)o");\n\n            // \u5224\u65ad\u8be5\u8bf7\u6c42\u4e0d\u901a\u8fc7\u65f6\uff1a\u7ed9\u4e00\u4e2a\u56de\u5e94\uff0c\u8fd4\u56de\n            exchange.getResponse().setStatusCode(HttpStatus.NOT_ACCEPTABLE);\n            return exchange.getResponse().setComplete();\n        }\n\n        // \u53cd\u4e4b\uff0c\u8c03\u7528\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u4e5f\u5c31\u662f\u653e\u884c\uff1a\u5728\u8be5\u73af\u8282\u5224\u65ad\u901a\u8fc7\u7684 exchange \u653e\u884c\uff0c\u4ea4\u7ed9\u4e0b\u4e00\u4e2a filter \u5224\u65ad\n        return chain.filter(exchange);\n    }\n\t\n    // \u8bbe\u7f6e\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u5728Filter\u94fe\u4e2d\u7684\u52a0\u8f7d\u987a\u5e8f\uff0c\u6570\u5b57\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\n    @Override\n    public int getOrder() {\n        return 0;\n    }\n}\n\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u670d\u52a1\u914d\u7f6e",children:"\u670d\u52a1\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"config-1",children:"config"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-14",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"SpringCloud Config \u4e3a\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u5fae\u670d\u52a1\u63d0\u4f9b\u96c6\u4e2d\u5316\u7684\u5916\u90e8\u914d\u7f6e\u652f\u6301\uff08Git/GitHub\uff09\uff0c\u4e3a\u5404\u4e2a\u4e0d\u540c\u5fae\u670d\u52a1\u5e94\u7528\u7684\u6240\u6709\u73af\u5883\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e2d\u5fc3\u5316\u7684\u5916\u90e8\u914d\u7f6e\uff08Config Server\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Config\u5de5\u4f5c\u539f\u7406",src:s(49082).A+"",width:"787",height:"257"})}),"\n",(0,i.jsx)(e.p,{children:"SpringCloud Config \u5206\u4e3a\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4e24\u90e8\u5206"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7aef\u4e5f\u79f0\u4e3a\u5206\u5e03\u5f0f\u914d\u7f6e\u4e2d\u5fc3\uff0c\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5fae\u670d\u52a1\u5e94\u7528\uff0c\u8fde\u63a5\u914d\u7f6e\u670d\u52a1\u5668\u5e76\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u52a0\u5bc6/\u89e3\u5bc6\u7b49\u4fe1\u606f\u8bbf\u95ee\u63a5\u53e3"}),"\n",(0,i.jsx)(e.li,{children:"\u5ba2\u6237\u7aef\u901a\u8fc7\u6307\u5b9a\u7684\u914d\u7f6e\u4e2d\u5fc3\u6765\u7ba1\u7406\u5e94\u7528\u8d44\u6e90\uff0c\u4ee5\u53ca\u4e0e\u4e1a\u52a1\u76f8\u5173\u7684\u914d\u7f6e\u5185\u5bb9\uff0c\u5e76\u5728\u542f\u52a8\u65f6\u4ece\u914d\u7f6e\u4e2d\u5fc3\u83b7\u53d6\u548c\u52a0\u8f7d\u914d\u7f6e\u4fe1\u606f\uff0c\u914d\u7f6e\u670d\u52a1\u5668\u9ed8\u8ba4\u91c7\u7528 Git \u6765\u5b58\u50a8\u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u6837\u65e2\u6709\u52a9\u4e8e\u5bf9\u73af\u5883\u914d\u7f6e\u8fdb\u884c\u7248\u672c\u7ba1\u7406\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 Git \u5ba2\u6237\u7aef\u6765\u65b9\u4fbf\u7684\u7ba1\u7406\u548c\u8bbf\u95ee\u914d\u7f6e\u5185\u5bb9"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4f18\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u96c6\u4e2d\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(e.li,{children:"\u4e0d\u540c\u73af\u5883\u4e0d\u540c\u914d\u7f6e\uff0c\u52a8\u6001\u5316\u7684\u914d\u7f6e\u66f4\u65b0\uff0c\u5206\u73af\u5883\u90e8\u7f72\u6bd4\u5982 dev/test/prod/beta/release"}),"\n",(0,i.jsxs)(e.li,{children:["\u8fd0\u884c\u671f\u95f4\u52a8\u6001\u8c03\u6574\u914d\u7f6e\uff0c\u670d\u52a1\u5411\u914d\u7f6e\u4e2d\u5fc3\u7edf\u4e00\u62c9\u53d6\u914d\u7f6e\u7684\u4fe1\u606f\uff0c",(0,i.jsx)(e.strong,{children:"\u670d\u52a1\u4e0d\u9700\u8981\u91cd\u542f\u5373\u53ef\u611f\u77e5\u5230\u914d\u7f6e\u7684\u53d8\u5316\u5e76\u5e94\u7528\u65b0\u7684\u914d\u7f6e"})]}),"\n",(0,i.jsx)(e.li,{children:"\u5c06\u914d\u7f6e\u4fe1\u606f\u4ee5 Rest \u63a5\u53e3\u7684\u5f62\u5f0f\u66b4\u9732"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u7f51\uff1a ",(0,i.jsx)(e.a,{href:"https://cloud.spring.io/spring-cloud-static/spring-cloud-config/2.2.1.RELEASE/reference/html/",children:"https://cloud.spring.io/spring-cloud-static/spring-cloud-config/2.2.1.RELEASE/reference/html/"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u7aef-2",children:"\u670d\u52a1\u7aef"}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u5efa Config Server \u6a21\u5757"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--springCloud Config Server--\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-config-server</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 3344\n\nspring:\n  application:\n    name:  cloud-config-center #\u6ce8\u518c\u8fdbEureka\u670d\u52a1\u5668\u7684\u5fae\u670d\u52a1\u540d\n  cloud:\n    config:\n      server:\n        git:\n          # GitHub\u4e0a\u9762\u7684git\u4ed3\u5e93\u540d\u5b57 \u8fd9\u91cc\u53ef\u4ee5\u5199https\u5730\u5740\u8ddfssh\u5730\u5740\uff0chttps\u5730\u5740\u9700\u8981\u914d\u7f6eusername\u548c password\n          uri: git@github.com:seazean/springcloud-config.git\n          default-label: main\n          search-paths:\n            - springcloud-config\t# \u641c\u7d22\u76ee\u5f55\n          # username: \n          # password:\n      label: main   # \u8bfb\u53d6\u5206\u652f,\u4ee5\u524d\u662fmaster\n\n#\u670d\u52a1\u6ce8\u518c\u5230eureka\u5730\u5740\neureka:\n  client:\n    service-url:\n    defaultZone: http://localhost:7001/eureka,http://localhost:7002/eureka #\u96c6\u7fa4\u7248\n"})}),"\n",(0,i.jsx)(e.p,{children:"search-paths \u8868\u793a\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u6709\u4e00\u4e2a\u53eb\u505a springcloud-config \u7684\uff0clabel \u5219\u8868\u793a\u8bfb\u53d6 main\u5206\u652f\u91cc\u9762\u7684\u5185\u5bb9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\n@EnableConfigServer   //\u5f00\u542fSpringCloud\u7684\npublic class ConfigCenterMain3344 {\n    public static void main(String[] args) {\n        SpringApplication.run(ConfigCenterMain3344.class, args);\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u8bfb\u53d6\u89c4\u5219\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"/{application}/{profile}[/{label}]\n/{application}-{profile}.yml\n/{label}/{application}-{profile}.yml\n/{application}-{profile}.properties\n/{label}/{application}-{profile}.properties\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"label\uff1a\u5206\u652f"}),"\n",(0,i.jsx)(e.li,{children:"name\uff1a\u670d\u52a1\u540d"}),"\n",(0,i.jsx)(e.li,{children:"profile\uff1a\u73af\u5883\uff08dev/test/prod\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6bd4\u5982\uff1a",(0,i.jsx)(e.a,{href:"http://localhost:3344/master/config-dev.yaml",children:"http://localhost:3344/master/config-dev.yaml"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5ba2\u6237\u7aef-1",children:"\u5ba2\u6237\u7aef"}),"\n",(0,i.jsx)(e.h5,{id:"\u57fa\u672c\u914d\u7f6e-1",children:"\u57fa\u672c\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u5ba2\u6237\u7aef Config Client\uff0c\u5ba2\u6237\u7aef\u4ece\u914d\u7f6e\u4e2d\u5fc3\uff08Config Server\uff09\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u8fd9\u91cc\u5c31\u662f\u5ba2\u6237\u7aef\u7684SpringCloud config \u56e0\u4e3a\u662f\u5ba2\u6237\u7aef\u6240\u4ee5\u6ca1\u6709server--\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-config</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"bootstrap.yml\uff1a\u7cfb\u7edf\u7ea7\u914d\u7f6e\uff0c\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0capplication.yml \u662f\u7528\u6237\u7ea7\u7684\u8d44\u6e90\u914d\u7f6e\u9879"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud \u4f1a\u521b\u5efa\u4e00\u4e2a Bootstrap Context \u4f5c\u4e3a Spring \u5e94\u7528\u7684 Application Context \u7684\u7236\u4e0a\u4e0b\u6587\uff0c\u521d\u59cb\u5316\u7684\u65f6\u5019 Bootstrap Context \u8d1f\u8d23\u4ece\u5916\u90e8\u6e90\u52a0\u8f7d\u914d\u7f6e\u5c5e\u6027\u5e76\u89e3\u6790\u914d\u7f6e\uff0c\u8fd9\u4e24\u4e2a\u4e0a\u4e0b\u6587\u5171\u4eab\u4e00\u4e2a\u4ece\u5916\u90e8\u83b7\u53d6\u7684 Environment\uff0c\u4e3a\u4e86\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u987a\u5e8f\u548c\u5206\u7ea7\u7ba1\u7406\uff0c\u8fd9\u91cc\u4f7f\u7528 bootstrap.yml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 3355\t# \u6784\u5efa\u591a\u4e2a\u5fae\u670d\u52a1\uff0c3366 3377 \u7b49\n\nspring:\n  application:\n    name: config-client\n  cloud:\n    #Config\u5ba2\u6237\u7aef\u914d\u7f6e\n    config:\n      label: main \t#\u5206\u652f\u540d\u79f0 \u4ee5\u524d\u662fmaster\n      name: config \t#\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\n      profile: dev \t#\u8bfb\u53d6\u540e\u7f00\u540d\u79f0   \n      # main\u5206\u652f\u4e0aconfig-dev.yml\u7684\u914d\u7f6e\u6587\u4ef6\u88ab\u8bfb\u53d6 http://config-3344.com:3344/master/config-dev.yml\n      uri: http://localhost:3344 # \u914d\u7f6e\u4e2d\u5fc3\u5730\u5740k\n\n#\u670d\u52a1\u6ce8\u518c\u5230eureka\u5730\u5740\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:7001/eureka,http://localhost:7002/eureka\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\npublic class ConfigClientMain3355 {\n    public static void main(String[] args) {\n        SpringApplication.run(ConfigClientMain3355.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a\u5c06\u914d\u7f6e\u4fe1\u606f\u4ee5 REST \u7a97\u53e3\u7684\u5f62\u5f0f\u66b4\u9732"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\npublic class ConfigClientController {\n    @Value("${config.info}")\n    private String configInfo;\n\n    @GetMapping("/configInfo")\n    public String getConfigInfo() {\n        return configInfo;\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u52a8\u6001\u5237\u65b0",children:"\u52a8\u6001\u5237\u65b0"}),"\n",(0,i.jsx)(e.p,{children:"\u5206\u5e03\u5f0f\u914d\u7f6e\u7684\u52a8\u6001\u5237\u65b0\u95ee\u9898\uff0c\u4fee\u6539 GitHub \u4e0a\u7684\u914d\u7f6e\u6587\u4ef6\uff0cConfig Server \u914d\u7f6e\u4e2d\u5fc3\u7acb\u523b\u54cd\u5e94\uff0c\u4f46\u662f Config Client \u5ba2\u6237\u7aef\u6ca1\u6709\u4efb\u4f55\u54cd\u5e94\uff0c\u9700\u8981\u91cd\u542f\u5ba2\u6237\u7aef"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--web/actuator\u8fd9\u4e24\u4e2a\u4e00\u822c\u4e00\u8d77\u4f7f\u7528\uff0c\u5199\u5728\u4e00\u8d77--\x3e\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539 yml\uff0c\u66b4\u9732\u76d1\u63a7\u7aef\u53e3\uff1aSpringBoot \u7684 actuator \u542f\u52a8\u7aef\u70b9\u76d1\u63a7 Web \u7aef\u9ed8\u8ba4\u52a0\u8f7d\u9ed8\u8ba4\u53ea\u6709\u4e24\u4e2a info\uff0chealth \u53ef\u89c1\u7684\u9875\u9762\u8282\u70b9"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'management: \n  endpoints:\n    web:\n      exposure:\n        include: "*" \t\t# \u8868\u793a\u5305\u542b\u6240\u6709\u8282\u70b9\u9875\u9762\n        exclude: env,beans\t# \u8868\u793a\u6392\u9664env\u3001beans\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a\u52a0 @RefreshScope \u6ce8\u89e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@RefreshScope\npublic class ConfigClientController {\n    // \u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u53d6\u524d\u7f00\u4e3aserver.port\u7684\u503c\n    @Value("${config.info}")\n    private String configInfo;\n\t// config-{profile}.yml\n    @GetMapping("/configInfo")\n    public String getConfigInfo() {\n        return configInfo;\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6b64\u65f6\u5ba2\u6237\u7aef\u8fd8\u662f\u6ca1\u6709\u5237\u65b0\uff0c\u9700\u8981\u53d1\u9001 POST \u8bf7\u6c42\u5237\u65b0 3355\uff1a",(0,i.jsx)(e.code,{children:'curl -X POST "http://localhost:3355/actuator/refresh'})]}),"\n",(0,i.jsx)(e.p,{children:"\u5f15\u51fa\u95ee\u9898\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728\u5fae\u670d\u52a1\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u9700\u8981\u6267\u884c\u4e00\u4e2a POST \u8bf7\u6c42\uff0c\u624b\u52a8\u5237\u65b0\u6210\u672c\u592a\u5927"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u5426\u5e7f\u64ad\uff0c\u4e00\u6b21\u901a\u77e5\uff0c\u5904\u5904\u751f\u6548\uff0c\u5927\u8303\u56f4\u7684\u5b9e\u73b0\u81ea\u52a8\u5237\u65b0"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1aBus \u603b\u7ebf"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u670d\u52a1\u6d88\u606f",children:"\u670d\u52a1\u6d88\u606f"}),"\n",(0,i.jsx)(e.h3,{id:"bus",children:"Bus"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-15",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud Bus \u80fd\u7ba1\u7406\u548c\u4f20\u64ad\u5206\u5e03\u5f0f\u7cfb\u7edf\u95f4\u7684\u6d88\u606f\uff0c\u5c31\u50cf\u5206\u5e03\u5f0f\u6267\u884c\u5668\uff0c\u53ef\u7528\u4e8e\u5e7f\u64ad\u72b6\u6001\u66f4\u6539\u3001\u4e8b\u4ef6\u63a8\u9001\u3001\u5fae\u670d\u52a1\u95f4\u7684\u901a\u4fe1\u901a\u9053\u7b49"}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u606f\u603b\u7ebf\uff1a\u5728\u5fae\u670d\u52a1\u67b6\u6784\u7684\u7cfb\u7edf\u4e2d\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u8f7b\u91cf\u7ea7\u7684\u6d88\u606f\u4ee3\u7406\u6765\u6784\u5efa\u4e00\u4e2a\u5171\u7528\u7684\u6d88\u606f\u4e3b\u9898\uff0c\u5e76\u8ba9\u7cfb\u7edf\u4e2d\u6240\u6709\u5fae\u670d\u52a1\u5b9e\u4f8b\u90fd\u8fde\u63a5\u4e0a\u6765\u3002\u7531\u4e8e\u8be5\u4e3b\u9898\u4e2d\u4ea7\u751f\u7684\u6d88\u606f\u4f1a\u88ab\u6240\u6709\u5b9e\u4f8b\u76d1\u542c\u548c\u6d88\u8d39\uff0c\u6240\u4ee5\u79f0\u4e3a\u6d88\u606f\u603b\u7ebf"}),"\n",(0,i.jsx)(e.p,{children:"\u57fa\u672c\u539f\u7406\uff1aConfigClient \u5b9e\u4f8b\u90fd\u76d1\u542c MQ \u4e2d\u540c\u4e00\u4e2a Topic\uff08\u9ed8\u8ba4 springCloudBus)\uff0c\u5f53\u4e00\u4e2a\u670d\u52a1\u5237\u65b0\u6570\u636e\u65f6\uff0c\u4f1a\u628a\u4fe1\u606f\u653e\u5165 Topic \u4e2d\uff0c\u8fd9\u6837\u5176\u5b83\u76d1\u542c\u540c\u4e00 Topic \u7684\u670d\u52a1\u5c31\u80fd\u5f97\u5230\u901a\u77e5\uff0c\u7136\u540e\u53bb\u66f4\u65b0\u81ea\u8eab\u7684\u914d\u7f6e"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5168\u5c40\u5e7f\u64ad",children:"\u5168\u5c40\u5e7f\u64ad"}),"\n",(0,i.jsxs)(e.p,{children:["\u5229\u7528\u6d88\u606f\u603b\u7ebf\u63a5\u89e6\u4e00\u4e2a\u670d\u52a1\u7aef ConfigServer \u7684 ",(0,i.jsx)(e.code,{children:"/bus/refresh"})," \u65ad\u70b9\uff0c\u4ece\u800c\u5237\u65b0\u6240\u6709\u5ba2\u6237\u7aef\u7684\u914d\u7f6e"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(298).A+"",width:"702",height:"605"})}),"\n",(0,i.jsx)(e.p,{children:"\u6539\u9020 ConfigClient\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 MQ \u7684\u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u6dfb\u52a0\u6d88\u606f\u603b\u7ebfRabbitMQ\u652f\u6301--\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-bus-amqp</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"yml \u6587\u4ef6\u6dfb\u52a0 MQ \u4fe1\u606f\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 3344\n\nspring:\n  application:\n    name:  config-client #\u6ce8\u518c\u8fdbEureka\u670d\u52a1\u5668\u7684\u5fae\u670d\u52a1\u540d\n  cloud:\n  # rabbitmq\u76f8\u5173\u914d\u7f6e\n  rabbitmq:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n\n# rabbitmq\u76f8\u5173\u914d\u7f6e,\u66b4\u9732bus\u5237\u65b0\u914d\u7f6e\u7684\u7aef\u70b9\nmanagement:\n  endpoints: # \u66b4\u9732bus\u5237\u65b0\u914d\u7f6e\u7684\u7aef\u70b9\n    web:\n      exposure:\n        include: 'bus-refresh'\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u53ea\u9700\u8981\u8c03\u7528\u4e00\u6b21 ",(0,i.jsx)(e.code,{children:'curl -X POST "http://localhost:3344/actuator/bus-refresh'}),"\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5168\u5c40\u5e7f\u64ad"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u5b9a\u70b9\u901a\u77e5",children:"\u5b9a\u70b9\u901a\u77e5"}),"\n",(0,i.jsx)(e.p,{children:"\u52a8\u6001\u5237\u65b0\u60c5\u51b5\u4e0b\uff0c\u53ea\u901a\u77e5\u6307\u5b9a\u7684\u5fae\u670d\u52a1\uff0c\u6bd4\u5982\u53ea\u901a\u77e5 3355 \u670d\u52a1\uff0c\u4e0d\u901a\u77e5 3366\uff0c\u6307\u5b9a\u5177\u4f53\u67d0\u4e00\u4e2a\u5b9e\u4f8b\u751f\u6548\uff0c\u800c\u4e0d\u662f\u5168\u90e8"}),"\n",(0,i.jsxs)(e.p,{children:["\u516c\u5f0f\uff1a",(0,i.jsx)(e.code,{children:"http://localhost:port/actuator/bus-refresh/{destination}"})]}),"\n",(0,i.jsx)(e.p,{children:"/bus/refresh \u8bf7\u6c42\u4e0d\u518d\u53d1\u9001\u5230\u5177\u4f53\u7684\u670d\u52a1\u5b9e\u4f8b\u4e0a\uff0c\u800c\u662f\u53d1\u7ed9 Config Server \u5e76\u901a\u8fc7 destination \u53c2\u6570\u7c7b\u6307\u5b9a\u9700\u8981\u66f4\u65b0\u914d\u7f6e\u7684\u670d\u52a1\u6216\u5b9e\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Bus\u5de5\u4f5c\u6d41\u7a0b",src:s(74871).A+"",width:"1336",height:"361"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"stream",children:"Stream"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-16",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud Stream \u662f\u4e00\u4e2a\u6784\u5efa\u6d88\u606f\u9a71\u52a8\u5fae\u670d\u52a1\u7684\u6846\u67b6\uff0c\u901a\u8fc7\u5b9a\u4e49\u7ed1\u5b9a\u5668 Binder \u4f5c\u4e3a\u4e2d\u95f4\u5c42\uff0c\u5b9e\u73b0\u4e86\u5e94\u7528\u7a0b\u5e8f\u4e0e\u6d88\u606f\u4e2d\u95f4\u4ef6\u7ec6\u8282\u4e4b\u95f4\u7684\u9694\u79bb\uff0c\u5c4f\u853d\u5e95\u5c42\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u5dee\u5f02\uff0c\u964d\u4f4e\u5207\u6362\u6210\u672c\uff0c\u7edf\u4e00\u6d88\u606f\u7684\u7f16\u7a0b\u6a21\u578b"}),"\n",(0,i.jsx)(e.p,{children:"Stream \u4e2d\u7684\u6d88\u606f\u901a\u4fe1\u65b9\u5f0f\u9075\u5faa\u4e86\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\uff0cBinder \u53ef\u4ee5\u751f\u6210 Binding \u7528\u6765\u7ed1\u5b9a\u6d88\u606f\u5bb9\u5668\u7684\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\uff0cBinding \u6709\u4e24\u79cd\u7c7b\u578b Input \u548c Output\uff0cInput \u5bf9\u5e94\u4e8e\u6d88\u8d39\u8005\uff08\u6d88\u8d39\u8005\u4ece Stream \u63a5\u6536\u6d88\u606f\uff09\uff0cOutput \u5bf9\u5e94\u4e8e\u751f\u4ea7\u8005\uff08\u751f\u4ea7\u8005\u4ece Stream \u53d1\u5e03\u6d88\u606f\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Stream\u5de5\u4f5c\u6d41\u7a0b",src:s(67907).A+"",width:"700",height:"490"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Binder\uff1a\u8fde\u63a5\u4e2d\u95f4\u4ef6"}),"\n",(0,i.jsx)(e.li,{children:"Channel\uff1a\u901a\u9053\uff0c\u662f\u961f\u5217 Queue \u7684\u4e00\u79cd\u62bd\u8c61\uff0c\u5728\u6d88\u606f\u901a\u8baf\u7cfb\u7edf\u4e2d\u5b9e\u73b0\u5b58\u50a8\u548c\u8f6c\u53d1\u7684\u5a92\u4ecb\uff0c\u901a\u8fc7 Channel \u5bf9\u961f\u5217\u8fdb\u884c\u914d\u7f6e"}),"\n",(0,i.jsx)(e.li,{children:"Source\u3001Sink\uff1a\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e2d\u6587\u624b\u518c\uff1a",(0,i.jsx)(e.a,{href:"https://m.wang1314.com/doc/webapp/topic/20971999.html",children:"https://m.wang1314.com/doc/webapp/topic/20971999.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-6",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"Binder \u662f\u5e94\u7528\u4e0e\u6d88\u606f\u4e2d\u95f4\u4ef6\u4e4b\u95f4\u7684\u5c01\u88c5\uff0c\u76ee\u524d\u5b9e\u73b0\u4e86 Kafka \u548c RabbitMQ \u7684 Binder\uff0c\u53ef\u4ee5\u52a8\u6001\u7684\u6539\u53d8\u6d88\u606f\u7c7b\u578b\uff08Kafka \u7684 Topic \u548c RabbitMQ \u7684 Exchange\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u5b9e\u73b0\uff0c\u5e38\u7528\u6ce8\u89e3\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"@Input\uff1a\u6807\u8bc6\u8f93\u5165\u901a\u9053\uff0c\u63a5\u6536\u7684\u6d88\u606f\u901a\u8fc7\u8be5\u901a\u9053\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,i.jsx)(e.li,{children:"@Output\uff1a\u6807\u8bc6\u8f93\u51fa\u901a\u9053\uff0c\u53d1\u5e03\u7684\u6d88\u606f\u901a\u8fc7\u8be5\u901a\u9053\u79bb\u5f00\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,i.jsx)(e.li,{children:"@StreamListener\uff1a\u76d1\u542c\u961f\u5217\uff0c\u7528\u4e8e\u6d88\u8d39\u8005\u961f\u5217\u7684\u6d88\u606f\u63a5\u6536"}),"\n",(0,i.jsx)(e.li,{children:"@EnableBinding\uff1a\u4fe1\u9053 Channel \u548c Exchange \u7ed1\u5b9a"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u4ea7\u8005\u53d1\u6d88\u606f\u6a21\u5757\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1aRabbitMQ"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-stream-rabbit</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8801\n\nspring:\n  application:\n    name: cloud-stream-provider\n  cloud:\n    stream:\n      binders: # \u5728\u6b64\u5904\u914d\u7f6e\u8981\u7ed1\u5b9a\u7684rabbitmq\u7684\u670d\u52a1\u4fe1\u606f\uff1b\n        defaultRabbit: # \u8868\u793a\u5b9a\u4e49\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u4e8ebinding\u6574\u5408\n          type: rabbit # \u6d88\u606f\u7ec4\u4ef6\u7c7b\u578b\n          environment: # \u8bbe\u7f6erabbitmq\u7684\u76f8\u5173\u7684\u73af\u5883\u914d\u7f6e\n            spring:\n              rabbitmq:\n                host: localhost\n                port: 5672\n                username: guest\n                password: guest\n      bindings: # \u670d\u52a1\u7684\u6574\u5408\u5904\u7406\n        output: # \u8fd9\u4e2a\u540d\u5b57\u662f\u4e00\u4e2a\u901a\u9053\u7684\u540d\u79f0\n          destination: studyExchange \t\t# \u8868\u793a\u8981\u4f7f\u7528\u7684Exchange\u540d\u79f0\u5b9a\u4e49\n          content-type: application/json\t# \u8bbe\u7f6e\u6d88\u606f\u7c7b\u578b\uff0c\u672c\u6b21\u4e3ajson\uff0c\u6587\u672c\u5219\u8bbe\u7f6e\u201ctext/plain\u201d\n          binder: defaultRabbit \t\t\t# \u8bbe\u7f6e\u8981\u7ed1\u5b9a\u7684\u6d88\u606f\u670d\u52a1\u7684\u5177\u4f53\u8bbe\u7f6e\n\neureka:\n  client: # \u5ba2\u6237\u7aef\u8fdb\u884cEureka\u6ce8\u518c\u7684\u914d\u7f6e\n    service-url:\n      defaultZone: http://localhost:7001/eureka,http://localhost:7002/eureka\n  instance:\n    lease-renewal-interval-in-seconds: 2 # \u8bbe\u7f6e\u5fc3\u8df3\u7684\u65f6\u95f4\u95f4\u9694\uff08\u9ed8\u8ba4\u662f30\u79d2\uff09\n    lease-expiration-duration-in-seconds: 5 # \u5982\u679c\u73b0\u5728\u8d85\u8fc7\u4e865\u79d2\u7684\u95f4\u9694\uff08\u9ed8\u8ba4\u662f90\u79d2\uff09\n    instance-id: send-8801.com  # \u5728\u4fe1\u606f\u5217\u8868\u65f6\u663e\u793a\u4e3b\u673a\u540d\u79f0\n    prefer-ip-address: true     # \u8bbf\u95ee\u7684\u8def\u5f84\u53d8\u4e3aIP\u5730\u5740\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableEurekaClient\npublic class StreamMQMain8801 {\n    public static void main(String[] args) {\n        SpringApplication.run(StreamMQMain8801.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1aMessageChannel \u7684\u5b9e\u4f8b\u540d\u5fc5\u987b\u662f output\uff0c\u5426\u5219\u65e0\u6cd5\u542f\u52a8"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u53ef\u4ee5\u7406\u89e3\u4e3a\u5b9a\u4e49\u6d88\u606f\u7684\u53d1\u9001\u7ba1\u9053Source\u5bf9\u5e94output(\u751f\u4ea7\u8005)\uff0cSink\u5bf9\u5e94input(\u6d88\u8d39\u8005)\n@EnableBinding(Source.class)\n// @Service\uff1a\u8fd9\u91cc\u4e0d\u9700\u8981\uff0c\u4e0d\u662f\u4f20\u7edf\u7684controller\u8c03\u7528service\u3002\u8fd9\u4e2aservice\u662f\u548crabbitMQ\u6253\u4ea4\u9053\u7684\n// IMessageProvider \u53ea\u6709\u4e00\u4e2a send \u65b9\u6cd5\u7684\u63a5\u53e3\npublic class MessageProviderImpl implements IMessageProvider {\n    @Resource\n    private MessageChannel output; // \u6d88\u606f\u7684\u53d1\u9001\u7ba1\u9053\n\n    @Override\n    public String send() {\n        String serial = UUID.randomUUID().toString();\n\n        //\u521b\u5efa\u6d88\u606f\uff0c\u901a\u8fc7output\u8fd9\u4e2a\u7ba1\u9053\u5411\u6d88\u606f\u4e2d\u95f4\u4ef6\u53d1\u6d88\u606f\n        this.output.send(MessageBuilder.withPayload(serial).build());\n        System.out.println("***serial: " + serial);\n        return serial;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\npublic class SendMessageController {\n    @Resource\n    private IMessageProvider messageProvider;\n\n    @GetMapping(value = "/sendMessage")\n    public String sendMessage() {\n        return messageProvider.send();\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u8d39\u8005\u6a21\u5757\uff1a8802 \u548c 8803 \u4e24\u4e2a\u6d88\u8d39\u8005"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a\u53ea\u6807\u6ce8\u51fa\u4e0e\u751f\u4ea7\u8005\u4e0d\u540c\u7684\u5730\u65b9"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8802\n\nspring:\n  application:\n    name: cloud-stream-consumer\n  cloud:\n    stream:\n      # ...\n      bindings: # \u670d\u52a1\u7684\u6574\u5408\u5904\u7406\n        input: # \u8fd9\u4e2a\u540d\u5b57\u662f\u4e00\u4e2a\u901a\u9053\u7684\u540d\u79f0\n          # ...\n          binder: { defaultRabbit } # \u8bbe\u7f6e\u8981\u7ed1\u5b9a\u7684\u6d88\u606f\u670d\u52a1\u7684\u5177\u4f53\u8bbe\u7f6e\n\neureka:\n  # ...\n  instance:\n    # ...\n    instance-id: receive-8802.com  # \u5728\u4fe1\u606f\u5217\u8868\u65f6\u663e\u793a\u4e3b\u673a\u540d\u79f0\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component\n@EnableBinding(Sink.class) // \u7406\u89e3\u4e3a\u5b9a\u4e49\u4e00\u4e2a\u6d88\u606f\u6d88\u8d39\u8005\u7684\u63a5\u6536\u7ba1\u9053\npublic class ReceiveMessageListener {\n    @Value("${server.port}")\n    private String serverPort;\n\n    @StreamListener(Sink.INPUT) //\u8f93\u5165\u6e90\uff1a\u4f5c\u4e3a\u4e00\u4e2a\u6d88\u606f\u76d1\u542c\u8005\n    public void input(Message<String> message) {\n        // \u83b7\u53d6\u5230\u6d88\u606f\n        String messageStr = message.getPayload();\n        System.out.println("\u6d88\u8d39\u80051\u53f7\uff0c-------\x3e\u63a5\u6536\u5230\u7684\u6d88\u606f\uff1a" + messageStr + "\\t port: " + serverPort);\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u9ad8\u7ea7\u7279\u6027",children:"\u9ad8\u7ea7\u7279\u6027"}),"\n",(0,i.jsx)(e.p,{children:"\u91cd\u590d\u6d88\u8d39\u95ee\u9898\uff1a\u751f\u4ea7\u8005 8801 \u53d1\u9001\u4e00\u6761\u6d88\u606f\u540e\uff0c8802 \u548c 8803 \u4f1a\u540c\u65f6\u6536\u5230 8801 \u7684\u6d88\u606f"}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\u65b9\u6cd5\uff1a\u5fae\u670d\u52a1\u5e94\u7528\u653e\u7f6e\u4e8e\u540c\u4e00\u4e2a group \u4e2d\uff0c\u80fd\u591f\u4fdd\u8bc1\u6d88\u606f\u53ea\u4f1a\u88ab\u5176\u4e2d\u4e00\u4e2a\u5e94\u7528\u6d88\u8d39\u4e00\u6b21\u3002\u4e0d\u540c\u7684\u7ec4\u662f\u53ef\u4ee5\u5168\u9762\u6d88\u8d39\u7684\uff08\u91cd\u590d\u6d88\u8d39\uff09\uff0c\u540c\u4e00\u4e2a\u7ec4\u5185\u7684\u591a\u4e2a\u6d88\u8d39\u8005\u4f1a\u53d1\u751f\u7ade\u4e89\u5173\u7cfb\uff0c\u53ea\u6709\u5176\u4e2d\u4e00\u4e2a\u53ef\u4ee5\u6d88\u8d39"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"bindings:\n  input:\n    destination: studyExchange\n    content-type: application/json\n    binder: { defaultRabbit }\n    group: seazean\t# \u8bbe\u7f6e\u5206\u7ec4\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u606f\u6301\u4e45\u5316\u95ee\u9898\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u505c\u6b62 8802/8803 \u5e76\u53bb\u9664\u6389 8802 \u7684\u5206\u7ec4 group: seazean\uff0c8801 \u5148\u53d1\u9001 4 \u6761\u6d88\u606f\u5230 MQ"}),"\n",(0,i.jsx)(e.li,{children:"\u5148\u542f\u52a8 8802\uff0c\u65e0\u5206\u7ec4\u5c5e\u6027\u914d\u7f6e\uff0c\u540e\u53f0\u6ca1\u6709\u6253\u51fa\u6765\u6d88\u606f\uff0c\u6d88\u606f\u4e22\u5931"}),"\n",(0,i.jsx)(e.li,{children:"\u518d\u542f\u52a8 8803\uff0c\u6709\u5206\u7ec4\u5c5e\u6027\u914d\u7f6e\uff0c\u540e\u53f0\u6253\u5370\u51fa\u6765\u4e86 MQ \u4e0a\u7684\u6d88\u606f"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"sleuth",children:"Sleuth"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-17",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud Sleuth \u63d0\u4f9b\u4e86\u4e00\u5957\u5b8c\u6574\u7684\u5206\u5e03\u5f0f\u8bf7\u6c42\u94fe\u8def\u8ddf\u8e2a\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5e76\u4e14\u517c\u5bb9\u652f\u6301\u4e86 zipkin"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u5fae\u670d\u52a1\u6846\u67b6\u4e2d\uff0c\u4e00\u4e2a\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8bf7\u6c42\u5728\u540e\u7aef\u7cfb\u7edf\u4e2d\u4f1a\u7ecf\u8fc7\u591a\u6b21\u4e0d\u540c\u7684\u670d\u52a1\u8282\u70b9\u8c03\u7528\u6765\u534f\u540c\u4ea7\u751f\u6700\u540e\u7684\u8bf7\u6c42\u7ed3\u679c\uff0c\u5f62\u6210\u4e00\u6761\u590d\u6742\u7684\u5206\u5e03\u5f0f\u670d\u52a1\u8c03\u7528\u94fe\u8def\uff0c\u94fe\u8def\u4e2d\u7684\u4efb\u4f55\u4e00\u73af\u51fa\u73b0\u9ad8\u5ef6\u65f6\u6216\u9519\u8bef\u90fd\u4f1a\u5f15\u8d77\u6574\u4e2a\u8bf7\u6c42\u6700\u540e\u7684\u5931\u8d25\uff0c\u6240\u4ee5\u9700\u8981\u94fe\u8def\u8ffd\u8e2a"}),"\n",(0,i.jsxs)(e.p,{children:["Sleuth \u5b98\u7f51\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/spring-cloud/spring-cloud-sleuth",children:"https://github.com/spring-cloud/spring-cloud-sleuth"})]}),"\n",(0,i.jsxs)(e.p,{children:["zipkin \u4e0b\u8f7d\u5730\u5740\uff1a",(0,i.jsx)(e.a,{href:"https://repo1.maven.org/maven2/io/zipkin/java/zipkin-server/",children:"https://repo1.maven.org/maven2/io/zipkin/java/zipkin-server/"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u94fe\u8def\u76d1\u63a7",children:"\u94fe\u8def\u76d1\u63a7"}),"\n",(0,i.jsx)(e.p,{children:"Sleuth \u8d1f\u8d23\u8ddf\u8e2a\u6574\u7406\uff0czipkin \u8d1f\u8d23\u53ef\u89c6\u5316\u5c55\u793a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"java -jar zipkin-server-2.12.9-exec.jar # \u542f\u52a8 zipkin \n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://localhost:9411/zipkin/"})," \u5c55\u793a\u4ea4\u4e92\u754c\u9762"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u6761\u8bf7\u6c42\u94fe\u8def\u901a\u8fc7 Trace ID \u552f\u4e00\u6807\u8bc6\uff0cSpan \u6807\u8bc6\u53d1\u8d77\u7684\u8bf7\u6c42\u4fe1\u606f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Trace\uff1a\u7c7b\u4f3c\u4e8e\u6811\u7ed3\u6784\u7684 Span \u96c6\u5408\uff0c\u8868\u793a\u4e00\u6761\u8c03\u7528\u94fe\u8def\uff0c\u5b58\u5728\u552f\u4e00 ID \u6807\u8bc6"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Span\uff1a\u8868\u793a\u8c03\u7528\u94fe\u8def\u6765\u6e90\uff0c\u901a\u4fd7\u7684\u7406\u89e3 Span \u5c31\u662f\u4e00\u6b21\u8bf7\u6c42\u4fe1\u606f\uff0c\u5404\u4e2a Span \u901a\u8fc7 ParentID \u5173\u8054\u8d77\u6765"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u751f\u4ea7\u8005\u6a21\u5757\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--\u5305\u542b\u4e86sleuth+zipkin--\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-zipkin</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8001\n\nspring:\n  application:\n    name: cloud-payment-service\n  zipkin:\n    base-url: http://localhost:9411\n  sleuth:\n    sampler:\n      #\u91c7\u6837\u7387\u503c\u4ecb\u4e8e 0 \u5230 1 \u4e4b\u95f4\uff0c1 \u5219\u8868\u793a\u5168\u90e8\u91c7\u96c6\n      probability: 1\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/payment/zipkin")\npublic String paymentZipkin() {\n    return "hi ,i\'am paymentzipkin server fall back\uff0cwelcome to seazean";\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u6d88\u8d39\u8005\u6a21\u5757\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 80\n\n# \u5fae\u670d\u52a1\u540d\u79f0\nspring:\n  application:\n    name: cloud-order-service\n  zipkin:\n    base-url: http://localhost:9411\n  sleuth:\n    sampler:\n      probability: 1\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/comsumer/payment/zipkin")\npublic String paymentZipKin() {\n    String result = restTemplate.getForObject("http://localhost:8001" + "/payment/zipkin/", String.class);\n    return result;\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"alibaba",children:"Alibaba"}),"\n",(0,i.jsx)(e.p,{children:"Spring Cloud Alibaba \u81f4\u529b\u4e8e\u63d0\u4f9b\u5fae\u670d\u52a1\u5f00\u53d1\u7684\u4e00\u7ad9\u5f0f\u89e3\u51b3\u65b9\u6848\uff0c\u6b64\u9879\u76ee\u5305\u542b\u5f00\u53d1\u5206\u5e03\u5f0f\u5e94\u7528\u5fae\u670d\u52a1\u7684\u5fc5\u9700\u7ec4\u4ef6\uff0c\u65b9\u4fbf\u5f00\u53d1\u8005\u901a\u8fc7 Spring Cloud \u7f16\u7a0b\u6a21\u578b\u8f7b\u677e\u4f7f\u7528\u8fd9\u4e9b\u7ec4\u4ef6\u6765\u5f00\u53d1\u5206\u5e03\u5f0f\u5e94\u7528\u670d\u52a1"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u9650\u6d41\u964d\u7ea7\uff1a\u9ed8\u8ba4\u652f\u6301 WebServlet\u3001WebFlux\u3001OpenFeign\u3001RestTemplate\u3001Spring Cloud Gateway\u3001Zuul\u3001Dubbo \u548c RocketMQ \u9650\u6d41\u964d\u7ea7\u529f\u80fd\u7684\u63a5\u5165\uff0c\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u901a\u8fc7\u63a7\u5236\u53f0\u5b9e\u65f6\u4fee\u6539\u9650\u6d41\u964d\u7ea7\u89c4\u5219\uff0c\u8fd8\u652f\u6301\u67e5\u770b\u9650\u6d41\u964d\u7ea7 Metrics \u76d1\u63a7\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\uff1a\u9002\u914d Spring Cloud \u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\u6807\u51c6\uff0c\u9ed8\u8ba4\u96c6\u6210\u4e86 Ribbon \u7684\u652f\u6301"}),"\n",(0,i.jsx)(e.li,{children:"\u5206\u5e03\u5f0f\u914d\u7f6e\u7ba1\u7406\uff1a\u652f\u6301\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u5916\u90e8\u5316\u914d\u7f6e\uff0c\u914d\u7f6e\u66f4\u6539\u65f6\u81ea\u52a8\u5237\u65b0"}),"\n",(0,i.jsx)(e.li,{children:"\u6d88\u606f\u9a71\u52a8\u80fd\u529b\uff1a\u57fa\u4e8e Spring Cloud Stream \u4e3a\u5fae\u670d\u52a1\u5e94\u7528\u6784\u5efa\u6d88\u606f\u9a71\u52a8\u80fd\u529b"}),"\n",(0,i.jsx)(e.li,{children:"\u5206\u5e03\u5f0f\u4e8b\u52a1\uff1a\u4f7f\u7528 @GlobalTransactional \u6ce8\u89e3\uff0c \u9ad8\u6548\u5e76\u4e14\u5bf9\u4e1a\u52a1\u96f6\u4fb5\u5165\u5730\u89e3\u51b3\u5206\u5e03\u5f0f\u4e8b\u52a1\u95ee\u9898"}),"\n",(0,i.jsx)(e.li,{children:"\u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\uff1a\u963f\u91cc\u4e91\u63d0\u4f9b\u7684\u6d77\u91cf\u3001\u5b89\u5168\u3001\u4f4e\u6210\u672c\u3001\u9ad8\u53ef\u9760\u7684\u4e91\u5b58\u50a8\u670d\u52a1"}),"\n",(0,i.jsx)(e.li,{children:"\u5206\u5e03\u5f0f\u4efb\u52a1\u8c03\u5ea6\uff1a\u63d0\u4f9b\u79d2\u7ea7\u3001\u7cbe\u51c6\u3001\u9ad8\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u7684\u5b9a\u65f6\uff08\u57fa\u4e8e Cron \u8868\u8fbe\u5f0f\uff09\u4efb\u52a1\u8c03\u5ea6\u670d\u52a1\u3002\u540c\u65f6\u63d0\u4f9b\u5206\u5e03\u5f0f\u7684\u4efb\u52a1\u6267\u884c\u6a21\u578b\uff0c\u5982\u7f51\u683c\u4efb\u52a1\u3002\u7f51\u683c\u4efb\u52a1\u652f\u6301\u6d77\u91cf\u5b50\u4efb\u52a1\u5747\u5300\u5206\u914d\u5230\u6240\u6709 Worker\uff08schedulerx-client\uff09\u4e0a\u6267\u884c"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u65b9\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md",children:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u65b9\u624b\u518c\uff1a",(0,i.jsx)(e.a,{href:"https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html",children:"https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html"})]}),"\n",(0,i.jsx)(e.h3,{id:"nacos",children:"Nacos"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-18",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Nacos \u5168\u79f0 Dynamic Naming and Configuration Service\uff0c\u4e00\u4e2a\u66f4\u6613\u4e8e\u6784\u5efa\u4e91\u539f\u751f\u5e94\u7528\u7684\u52a8\u6001\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u7ba1\u7406\u548c\u670d\u52a1\u7684\u7ba1\u7406\u5e73\u53f0\uff0cNacos = Eureka + Config + Bus"}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0b\u8f7d\u5730\u5740\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/alibaba/nacos/releases",children:"https://github.com/alibaba/nacos/releases"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u542f\u52a8\u547d\u4ee4\uff1a\u547d\u4ee4\u8fd0\u884c\u6210\u529f\u540e\u76f4\u63a5\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:8848/nacos%EF%BC%8C%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%83%BD%E6%98%AF",children:"http://localhost:8848/nacos\uff0c\u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\u90fd\u662f"})," nacos"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"startup.cmd -m standalone # standalone \u4ee3\u8868\u7740\u5355\u673a\u6a21\u5f0f\u8fd0\u884c\uff0c\u975e\u96c6\u7fa4\u6a21\u5f0f\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5173\u95ed\u547d\u4ee4\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"shutdown.cmd\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u518c\u4e2d\u5fc3\u5bf9\u6bd4\uff1aC \u4e00\u81f4\u6027\uff0cA \u53ef\u7528\u6027\uff0cP \u5206\u533a\u5bb9\u9519\u6027"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"center"},children:"\u6ce8\u518c\u4e2d\u5fc3"}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:"CAP \u6a21\u578b"}),(0,i.jsx)(e.th,{style:{textAlign:"center"},children:"\u63a7\u5236\u53f0\u7ba1\u7406"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"Eureka"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"AP"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u652f\u6301"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"Zookeeper"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"CP"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u4e0d\u652f\u6301"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"Consul"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"CP"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u652f\u6301"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"Nacos"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"AP"}),(0,i.jsx)(e.td,{style:{textAlign:"center"},children:"\u652f\u6301"})]})]})]}),"\n",(0,i.jsxs)(e.p,{children:["\u5207\u6362\u6a21\u5f0f\uff1a",(0,i.jsx)(e.code,{children:"curl -X PUT '$NACOS_SERVER:8848/nacos/v1/ns/operator/switches?entry=serverMode&value=CP"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u7f51\uff1a",(0,i.jsx)(e.a,{href:"https://nacos.io",children:"https://nacos.io"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6ce8\u518c\u4e2d\u5fc3",children:"\u6ce8\u518c\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.p,{children:"Nacos \u4f5c\u4e3a\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u63d0\u4f9b\u8005\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 9001\n\nspring:\n  application:\n    name: nacos-payment-provider\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848 #\u914d\u7f6eNacos\u5730\u5740\uff0c\u6ce8\u518c\u5230Nacos\n# \u505a\u76d1\u63a7\u9700\u8981\u628a\u8fd9\u4e2a\u5168\u90e8\u66b4\u9732\u51fa\u6765\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a\u6ce8\u89e3\u662f EnableDiscoveryClient"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@EnableDiscoveryClient\n@SpringBootApplication\npublic class PaymentMain9001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentMain9001.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\npublic class PaymentController {\n    @Value("${server.port}")\n    private String serverPort;\n\n    @GetMapping(value = "/payment/nacos/{id}")\n    public String getPayment(@PathVariable("id") Integer id) {\n        return "nacos registry, serverPort: " + serverPort + "\\t id" + id;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7ba1\u7406\u540e\u53f0\u670d\u52a1\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Nacos\u670d\u52a1\u5217\u8868",src:s(21021).A+"",width:"1937",height:"590"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u65b0\u5efa\u4e00\u4e2a\u6a21\u5757\u7aef\u53e3\u662f 9002\uff0c\u5176\u4ed6\u4e0e 9001 \u670d\u52a1\u4e00\u6837\uff0cnacos-payment-provider \u7684\u5b9e\u4f8b\u6570\u5c31\u53d8\u4e3a 2"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u670d\u52a1\u6d88\u8d39\u8005\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 83\n\nspring:\n  application:\n    name: nacos-order-consumer\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n\n# \u6d88\u8d39\u8005\u5c06\u8981\u53bb\u8bbf\u95ee\u7684\u5fae\u670d\u52a1\u540d\u79f0(\u6ce8\u518c\u6210\u529f\u8fdbnacos\u7684\u5fae\u670d\u52a1\u63d0\u4f9b\u8005)\nservice-url:\n  nacos-user-service: http://nacos-payment-provider\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableDiscoveryClient\npublic class OrderNacosMain83 {\n    public static void main(String[] args) {\n        SpringApplication.run(OrderNacosMain83.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class ApplicationContextBean {\n    @Bean\n    @LoadBalanced // \u751f\u4ea7\u8005\u96c6\u7fa4\u72b6\u6001\u4e0b\uff0c\u5fc5\u987b\u6dfb\u52a0\uff0c\u9632\u6b62\u627e\u4e0d\u5230\u5b9e\u4f8b\n    public RestTemplate getRestTemplate() {\n        return new RestTemplate();\n    }\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class OrderNacosController {\n    @Resource\n    private RestTemplate restTemplate;\n\t// \u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6 URL\n    @Value("${service-url.nacos-user-service}")\n    private String serverURL;\n\n    @GetMapping("/consumer/payment/nacos/{id}")\n    public String paymentInfo(@PathVariable("id") Long id) {\n        String result = restTemplate.getForObject(serverURL + "/payment/nacos/" + id, String.class);\n        return result;\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u914d\u7f6e\u4e2d\u5fc3",children:"\u914d\u7f6e\u4e2d\u5fc3"}),"\n",(0,i.jsx)(e.h5,{id:"\u57fa\u7840\u914d\u7f6e",children:"\u57fa\u7840\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u628a\u914d\u7f6e\u6587\u4ef6\u5199\u8fdb Nacos\uff0c\u7136\u540e\u518d\u7528 Nacos \u505a config \u8fd9\u6837\u7684\u529f\u80fd\uff0c\u76f4\u63a5\u4ece Nacos \u4e0a\u6293\u53d6\u670d\u52a1\u7684\u914d\u7f6e\u4fe1\u606f"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728 Nacos \u4e2d\uff0cdataId \u7684\u5b8c\u6574\u683c\u5f0f\u5982\u4e0b ",(0,i.jsx)(e.code,{children:"${prefix}-${spring.profiles.active}.${file-extension}"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"prefix"}),"\uff1a\u9ed8\u8ba4\u4e3a ",(0,i.jsx)(e.code,{children:"spring.application.name"})," \u7684\u503c\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u9879 ",(0,i.jsx)(e.code,{children:"spring.cloud.nacos.config.prefix"})," \u6765\u914d\u7f6e"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"spring.profiles.active"}),"\uff1a\u5f53\u524d\u73af\u5883\u5bf9\u5e94\u7684 profile\uff0c\u5f53\u8be5\u503c\u4e3a\u7a7a\u65f6\uff0cdataId \u7684\u62fc\u63a5\u683c\u5f0f\u53d8\u6210 ",(0,i.jsx)(e.code,{children:"${prefix}.${file-extension}"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"file-exetension"}),"\uff1a\u914d\u7f6e\u5185\u5bb9\u7684\u6570\u636e\u683c\u5f0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u9879 ",(0,i.jsx)(e.code,{children:"spring.cloud.nacos.config.file-extension"})," \u6765\u914d\u7f6e\uff0c\u76ee\u524d\u53ea\u652f\u6301 properties \u548c yaml \u7c7b\u578b\uff08\u4e0d\u662f yml\uff09"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u5efa\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u4e24\u4e2a yml \u6587\u4ef6\uff1a\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u662f\u5b58\u5728\u4f18\u5148\u7ea7\u987a\u5e8f\u7684\uff0cbootstrap \u4f18\u5148\u7ea7\u9ad8\u4e8e application"}),"\n",(0,i.jsx)(e.p,{children:"bootstrap.yml\uff1a\u5168\u5c40\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# nacos\u914d\u7f6e\nserver:\n  port: 3377\n\nspring:\n  application:\n    name: nacos-config-client\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848 #Nacos\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\n      config:\n        server-addr: localhost:8848 #Nacos\u4f5c\u4e3a\u914d\u7f6e\u4e2d\u5fc3\u5730\u5740\n        file-extension: yaml #\u6307\u5b9ayaml\u683c\u5f0f\u7684\u914d\u7f6e\n\n# ${spring.application.name}-${spring.profile.active}.${spring.cloud.nacos.config.file-extension}\n"})}),"\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a\u670d\u52a1\u72ec\u7acb\u914d\u7f6e\uff0c\u8868\u793a\u670d\u52a1\u8981\u53bb\u914d\u7f6e\u4e2d\u5fc3\u627e\u540d\u4e3a nacos-config-client-dev.yaml \u7684\u6587\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"spring:\n  profiles:\n    active: dev # \u8868\u793a\u5f00\u53d1\u73af\u5883\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n@EnableDiscoveryClient\npublic class NacosConfigClientMain3377 {\n    public static void main(String[] args) {\n        SpringApplication.run(NacosConfigClientMain3377.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a@RefreshScope \u6ce8\u89e3\u4f7f\u5f53\u524d\u7c7b\u4e0b\u7684\u914d\u7f6e\u652f\u6301 Nacos \u7684\u52a8\u6001\u5237\u65b0\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@RefreshScope\npublic class ConfigClientController {\n    @Value("${config.info}")\n    private String configInfo;\n\n    @GetMapping("/config/info")\n    public String getConfigInfo() {\n        return configInfo;\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u65b0\u589e\u914d\u7f6e\uff0c\u7136\u540e\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:3377/config/info",children:"http://localhost:3377/config/info"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Nacos\u65b0\u589e\u914d\u7f6e",src:s(61182).A+"",width:"1918",height:"721"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u5206\u7c7b\u914d\u7f6e",children:"\u5206\u7c7b\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"\u5206\u5e03\u5f0f\u5f00\u53d1\u4e2d\u7684\u591a\u73af\u5883\u591a\u9879\u76ee\u7ba1\u7406\u95ee\u9898\uff0cNamespace \u7528\u4e8e\u533a\u5206\u90e8\u7f72\u73af\u5883\uff0cGroup \u548c DataID \u903b\u8f91\u4e0a\u533a\u5206\u4e24\u4e2a\u76ee\u6807\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Nacos\u914d\u7f6e\u8bf4\u660e",src:s(84881).A+"",width:"1941",height:"690"})}),"\n",(0,i.jsx)(e.p,{children:"Namespace \u9ed8\u8ba4 public\uff0c\u4e3b\u8981\u7528\u6765\u5b9e\u73b0\u9694\u79bb\uff0c\u56fe\u793a\u4e09\u4e2a\u5f00\u53d1\u73af\u5883"}),"\n",(0,i.jsx)(e.p,{children:"Group \u9ed8\u8ba4\u662f DEFAULT_GROUP\uff0cGroup \u53ef\u4ee5\u628a\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u5212\u5206\u5230\u540c\u4e00\u4e2a\u5206\u7ec4\u91cc\u9762\u53bb"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h5,{id:"\u52a0\u8f7d\u914d\u7f6e",children:"\u52a0\u8f7d\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.p,{children:["DataID \u65b9\u6848\uff1a\u6307\u5b9a ",(0,i.jsx)(e.code,{children:"spring.profile.active"})," \u548c\u914d\u7f6e\u6587\u4ef6\u7684 DataID \u6765\u4f7f\u4e0d\u540c\u73af\u5883\u4e0b\u8bfb\u53d6\u4e0d\u540c\u7684\u914d\u7f6e"]}),"\n",(0,i.jsx)(e.p,{children:"Group \u65b9\u6848\uff1a\u901a\u8fc7 Group \u5b9e\u73b0\u73af\u5883\u5206\u533a\uff0c\u5728 config \u4e0b\u589e\u52a0\u4e00\u6761 Group \u7684\u914d\u7f6e\u5373\u53ef"}),"\n",(0,i.jsx)(e.p,{children:"Namespace \u65b9\u6848\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 3377\n\nspring:\n  application:\n    name: nacos-config-client\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848 #Nacos\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\n      config:\n        server-addr: localhost:8848 #Nacos\u4f5c\u4e3a\u914d\u7f6e\u4e2d\u5fc3\u5730\u5740\n        file-extension: yaml #\u6307\u5b9ayaml\u683c\u5f0f\u7684\u914d\u7f6e\n        group: DEV_GROUP\n        namespace: 95d44530-a4a6-4ead-98c6-23d192cee298\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Cloud-Nacos\u547d\u540d\u7a7a\u95f4",src:s(87334).A+"",width:"1944",height:"411"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u96c6\u7fa4\u67b6\u6784",children:"\u96c6\u7fa4\u67b6\u6784"}),"\n",(0,i.jsx)(e.p,{children:"\u96c6\u7fa4\u90e8\u7f72\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff0cNacos \u652f\u6301\u7684\u4e09\u79cd\u90e8\u7f72\u6a21\u5f0f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5355\u673a\u6a21\u5f0f\uff1a\u7528\u4e8e\u6d4b\u8bd5\u548c\u5355\u673a\u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:"\u96c6\u7fa4\u6a21\u5f0f\uff1a\u7528\u4e8e\u751f\u4ea7\u73af\u5883\uff0c\u786e\u4fdd\u9ad8\u53ef\u7528"}),"\n",(0,i.jsx)(e.li,{children:"\u591a\u96c6\u7fa4\u6a21\u5f0f\uff1a\u7528\u4e8e\u591a\u6570\u636e\u4e2d\u5fc3\u573a\u666f"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u96c6\u7fa4\u90e8\u7f72\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://nacos.io/zh-cn/docs/v2/guide/admin/cluster-mode-quick-start.html",children:"https://nacos.io/zh-cn/docs/v2/guide/admin/cluster-mode-quick-start.html"})]}),"\n",(0,i.jsx)(e.p,{children:"\u9ed8\u8ba4 Nacos \u4f7f\u7528\u5d4c\u5165\u5f0f\u6570\u636e\u5e93 derby \u5b9e\u73b0\u6570\u636e\u7684\u5b58\u50a8\uff0c\u91cd\u542f Nacos \u540e\u914d\u7f6e\u6587\u4ef6\u4e0d\u4f1a\u6d88\u5931\uff0c\u4f46\u662f\u591a\u4e2a Nacos \u8282\u70b9\u6570\u636e\u5b58\u50a8\u5b58\u5728\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u6bcf\u4e2a Nacos \u90fd\u6709\u72ec\u7acb\u7684\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\uff0c\u6240\u4ee5 Nacos \u91c7\u7528\u4e86\u96c6\u4e2d\u5f0f\u5b58\u50a8\u7684\u65b9\u5f0f\u6765\u652f\u6301\u96c6\u7fa4\u5316\u90e8\u7f72\uff0c\u76ee\u524d\u53ea\u652f\u6301 MySQL \u7684\u5b58\u50a8"}),"\n",(0,i.jsx)(e.p,{children:"Windows \u4e0b Nacos \u5207\u6362 MySQL \u5b58\u50a8\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5728 Nacos \u5b89\u88c5\u76ee\u5f55\u7684 conf \u76ee\u5f55\u4e0b\u627e\u5230\u4e00\u4e2a\u540d\u4e3a ",(0,i.jsx)(e.code,{children:"nacos-mysql.sql"})," \u7684\u811a\u672c\u5e76\u6267\u884c"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5728 conf \u76ee\u5f55\u4e0b\u627e\u5230 ",(0,i.jsx)(e.code,{children:"application.properties"}),"\uff0c\u589e\u52a0\u5982\u4e0b\u6570\u636e"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"spring.datasource.platform=mysql\n \ndb.num=1\ndb.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true\ndb.user=username\ndb.password=password\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u91cd\u65b0\u542f\u52a8 Nacos\uff0c\u53ef\u4ee5\u770b\u5230\u662f\u4e2a\u5168\u65b0\u7684\u7a7a\u8bb0\u5f55\u754c\u9762"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Linux \u53c2\u8003\uff1a",(0,i.jsx)(e.a,{href:"https://www.yuque.com/mrlinxi/pxvr4g/rnahsn#dPvMy",children:"https://www.yuque.com/mrlinxi/pxvr4g/rnahsn#dPvMy"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"sentinel",children:"Sentinel"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4ecb\u7ecd-19",children:"\u57fa\u672c\u4ecb\u7ecd"}),"\n",(0,i.jsx)(e.p,{children:"Sentinel \u662f\u9762\u5411\u5206\u5e03\u5f0f\u3001\u591a\u8bed\u8a00\u5f02\u6784\u5316\u670d\u52a1\u67b6\u6784\u7684\u6d41\u91cf\u6cbb\u7406\u7ec4\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"Sentinel \u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6838\u5fc3\u5e93\uff08Java \u5ba2\u6237\u7aef\uff09\u4e0d\u4f9d\u8d56\u4efb\u4f55\u6846\u67b6/\u5e93\uff0c\u80fd\u591f\u8fd0\u884c\u4e8e Java 8 \u53ca\u4ee5\u4e0a\u7684\u7248\u672c\u7684\u8fd0\u884c\u65f6\u73af\u5883"}),"\n",(0,i.jsx)(e.li,{children:"\u63a7\u5236\u53f0\uff08Dashboard\uff09\u4e3b\u8981\u8d1f\u8d23\u7ba1\u7406\u63a8\u9001\u89c4\u5219\u3001\u76d1\u63a7\u3001\u7ba1\u7406\u673a\u5668\u4fe1\u606f\u7b49"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u8fd0\u884c\u547d\u4ee4\uff1a",(0,i.jsx)(e.code,{children:"java -jar sentinel-dashboard-1.8.2.jar"})," \uff08\u8981\u6c42 Java8\uff0c\u4e14 8080 \u7aef\u53e3\u4e0d\u80fd\u88ab\u5360\u7528\uff09\uff0c\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:8080/%EF%BC%8C%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E5%9D%87%E4%B8%BA",children:"http://localhost:8080/\uff0c\u8d26\u53f7\u5bc6\u7801\u5747\u4e3a"})," sentinel"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u7f51\uff1a",(0,i.jsx)(e.a,{href:"https://sentinelguard.io",children:"https://sentinelguard.io"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0b\u8f7d\u5730\u5740\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/alibaba/Sentinel/releases",children:"https://github.com/alibaba/Sentinel/releases"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-7",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u6784\u5efa\u6f14\u793a\u5de5\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1asentinel.transport.port \u7aef\u53e3\u914d\u7f6e\u4f1a\u5728\u5e94\u7528\u5bf9\u5e94\u7684\u673a\u5668\u4e0a\u542f\u52a8\u4e00\u4e2a HTTP Server\uff0c\u8be5 Server \u4e0e Sentinel \u63a7\u5236\u53f0\u505a\u4ea4\u4e92\u3002\u6bd4\u5982 Sentinel \u63a7\u5236\u53f0\u6dfb\u52a0\u4e86 1 \u4e2a\u9650\u6d41\u89c4\u5219\uff0c\u4f1a\u628a\u89c4\u5219\u6570\u636e Push \u7ed9 Server \u63a5\u6536\uff0cServer \u518d\u5c06\u89c4\u5219\u6ce8\u518c\u5230 Sentinel \u4e2d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8401\n\nspring:\n  application:\n    name: cloudalibaba-sentinel-service\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848 # Nacos \u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\u3010\u9700\u8981\u542f\u52a8Nacos8848\u3011\n    sentinel:\n      transport:\n        # \u914d\u7f6eSentinel dashboard\u5730\u5740\n        dashboard: localhost:8080\n        # \u9ed8\u8ba48719\u7aef\u53e3\uff0c\u5047\u5982\u88ab\u5360\u7528\u4f1a\u81ea\u52a8\u4ece8719\u5f00\u59cb\u4f9d\u6b21+1\u626b\u63cf,\u76f4\u81f3\u627e\u5230\u672a\u88ab\u5360\u7528\u7684\u7aef\u53e3\n        port: 8719\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@EnableDiscoveryClient\n@SpringBootApplication\npublic class SentinelMainApp8401 {\n    public static void main(String[] args) {\n        SpringApplication.run(SentinelMainApp8401.class, args);\n    }\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d41\u91cf\u63a7\u5236 Controller\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@RestController\n@Slf4j\npublic class FlowLimitController {\n    @GetMapping("/testA")\n    public String testA() {\n        return "------testA";\n    }\n\n    @GetMapping("/testB")\n    public String testB() {\n        return "------testB";\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Sentinel \u91c7\u7528\u61d2\u52a0\u8f7d\u673a\u5236\uff0c\u9700\u8981\u5148\u8bbf\u95ee ",(0,i.jsx)(e.a,{href:"http://localhost:8401/testA%EF%BC%8C%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%89%8D%E8%83%BD%E7%9C%8B%E5%88%B0",children:"http://localhost:8401/testA\uff0c\u63a7\u5236\u53f0\u624d\u80fd\u770b\u5230"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6d41\u63a7\u89c4\u5219",children:"\u6d41\u63a7\u89c4\u5219"}),"\n",(0,i.jsx)(e.p,{children:"\u6d41\u91cf\u63a7\u5236\u89c4\u5219 FlowRule\uff1a\u540c\u4e00\u4e2a\u8d44\u6e90\u53ef\u4ee5\u540c\u65f6\u6709\u591a\u4e2a\u9650\u6d41\u89c4\u5219"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8d44\u6e90\u540d resource\uff1a\u9650\u6d41\u89c4\u5219\u7684\u4f5c\u7528\u5bf9\u8c61\uff0cDemo \u4e2d\u4e3a testA"}),"\n",(0,i.jsx)(e.li,{children:"\u9488\u5bf9\u8d44\u6e90 limitApp\uff1a\u9488\u5bf9\u8c03\u7528\u8005\u8fdb\u884c\u9650\u6d41\uff0c\u9ed8\u8ba4\u4e3a default \u4ee3\u8868\u4e0d\u533a\u5206\u8c03\u7528\u6765\u6e90"}),"\n",(0,i.jsx)(e.li,{children:"\u9608\u503c\u7c7b\u578b grade\uff1aQPS \u6216\u7ebf\u7a0b\u6570\u6a21\u5f0f"}),"\n",(0,i.jsx)(e.li,{children:"\u5355\u673a\u9608\u503c count\uff1a\u9650\u6d41\u9608\u503c"}),"\n",(0,i.jsxs)(e.li,{children:["\u6d41\u63a7\u6a21\u5f0f strategy\uff1a\u8c03\u7528\u5173\u7cfb\u9650\u6d41\u7b56\u7565\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u76f4\u63a5\uff1a\u8d44\u6e90\u672c\u8eab\u8fbe\u5230\u9650\u6d41\u6761\u4ef6\u76f4\u63a5\u9650\u6d41"}),"\n",(0,i.jsx)(e.li,{children:"\u5173\u8054\uff1a\u5f53\u5173\u8054\u7684\u8d44\u6e90\u8fbe\u5230\u9608\u503c\u65f6\uff0c\u9650\u6d41\u81ea\u8eab"}),"\n",(0,i.jsx)(e.li,{children:"\u94fe\u8def\uff1a\u53ea\u8bb0\u5f55\u6307\u5b9a\u94fe\u8def\u4e0a\u7684\u6d41\u91cf\uff0c\u4ece\u5165\u53e3\u8d44\u6e90\u8fdb\u6765\u7684\u6d41\u91cf"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6d41\u63a7\u6548\u679c controlBehavior\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5feb\u901f\u5931\u8d25\uff1a\u76f4\u63a5\u5931\u8d25\uff0c\u629b\u51fa\u5f02\u5e38"}),"\n",(0,i.jsx)(e.li,{children:"Warm Up\uff1a\u51b7\u542f\u52a8\uff0c\u6839\u636e codeFactory\uff08\u51b7\u52a0\u8f7d\u56e0\u5b50\uff0c\u9ed8\u8ba4 3\uff09\u7684\u503c\uff0c\u4ece count/codeFactory \u5f00\u59cb\u7f13\u6162\u589e\u52a0\uff0c\u7ed9\u7cfb\u7edf\u9884\u70ed\u65f6\u95f4"}),"\n",(0,i.jsx)(e.li,{children:"\u6392\u961f\u7b49\u5f85\uff1a\u5300\u901f\u6392\u961f\uff0c\u8ba9\u8bf7\u6c42\u4ee5\u5300\u901f\u7684\u65b9\u5f0f\u901a\u8fc7\uff0c\u9608\u503c\u7c7b\u578b\u5fc5\u987b\u8bbe\u7f6e\u4e3a QPS\uff0c\u5426\u5219\u65e0\u6548"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(56739).A+"",width:"1900",height:"985"})}),"\n",(0,i.jsxs)(e.p,{children:["\u901a\u8fc7\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"SystemRuleManager.loadRules()"})," \u65b9\u6cd5\u6765\u7528\u786c\u7f16\u7801\u7684\u65b9\u5f0f\u5b9a\u4e49\u6d41\u91cf\u63a7\u5236\u89c4\u5219\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"private void initSystemProtectionRule() {\n  List<SystemRule> rules = new ArrayList<>();\n  SystemRule rule = new SystemRule();\n  rule.setHighestSystemLoad(10);\n  rules.add(rule);\n  SystemRuleManager.loadRules(rules);\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8be6\u7ec6\u5185\u5bb9\u53c2\u8003\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://sentinelguard.io/zh-cn/docs/flow-control.html",children:"https://sentinelguard.io/zh-cn/docs/flow-control.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u964d\u7ea7\u7194\u65ad",children:"\u964d\u7ea7\u7194\u65ad"}),"\n",(0,i.jsx)(e.p,{children:"Sentinel \u7194\u65ad\u964d\u7ea7\u4f1a\u5728\u8c03\u7528\u94fe\u8def\u4e2d\u67d0\u4e2a\u8d44\u6e90\u51fa\u73b0\u4e0d\u7a33\u5b9a\u72b6\u6001\u65f6\uff0c\u5bf9\u8fd9\u4e2a\u8d44\u6e90\u7684\u8c03\u7528\u8fdb\u884c\u9650\u5236\uff0c\u8ba9\u8bf7\u6c42\u5feb\u901f\u5931\u8d25\uff0c\u907f\u514d\u5f71\u54cd\u5230\u5176\u5b83\u7684\u8d44\u6e90\u800c\u5bfc\u81f4\u7ea7\u8054\u9519\u8bef\u3002\u5f53\u8d44\u6e90\u88ab\u964d\u7ea7\u540e\uff0c\u5728\u63a5\u4e0b\u6765\u7684\u964d\u7ea7\u65f6\u95f4\u7a97\u53e3\u4e4b\u5185\uff0c\u5bf9\u8be5\u8d44\u6e90\u7684\u8c03\u7528\u90fd\u81ea\u52a8\u7194\u65ad\uff08\u9ed8\u8ba4\u884c\u4e3a\u662f\u629b\u51fa DegradeException\uff09"}),"\n",(0,i.jsx)(e.p,{children:"Sentinel \u63d0\u4f9b\u4ee5\u4e0b\u51e0\u79cd\u7194\u65ad\u7b56\u7565\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8d44\u6e90\u540d resource\uff1a\u9650\u6d41\u89c4\u5219\u7684\u4f5c\u7528\u5bf9\u8c61\uff0cDemo \u4e2d\u4e3a testA"}),"\n",(0,i.jsxs)(e.li,{children:["\u7194\u65ad\u7b56\u7565 grade\uff1a\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6162\u8c03\u7528\u6bd4\u4f8b\uff08SLOW_REQUEST_RATIO\uff09\uff1a\u4ee5\u6162\u8c03\u7528\u6bd4\u4f8b\u4f5c\u4e3a\u9608\u503c\uff0c\u9700\u8981\u8bbe\u7f6e\u5141\u8bb8\u7684\u6162\u8c03\u7528 RT\uff08\u5373\u6700\u5927\u7684\u54cd\u5e94\u65f6\u95f4\uff09\uff0c\u8bf7\u6c42\u7684\u54cd\u5e94\u65f6\u95f4\u5927\u4e8e\u8be5\u503c\u5219\u7edf\u8ba1\u4e3a\u6162\u8c03\u7528\u3002\u5f53\u5355\u4f4d\u7edf\u8ba1\u65f6\u957f\uff08statIntervalMs\uff09\u5185\u8bf7\u6c42\u6570\u76ee\u5927\u4e8e\u8bbe\u7f6e\u7684\u6700\u5c0f\u8bf7\u6c42\u6570\u76ee\uff0c\u5e76\u4e14\u6162\u8c03\u7528\u7684\u6bd4\u4f8b\u5927\u4e8e\u9608\u503c\uff0c\u5219\u63a5\u4e0b\u6765\u7684\u7194\u65ad\u65f6\u957f\u5185\u8bf7\u6c42\u4f1a\u81ea\u52a8\u88ab\u7194\u65ad\u3002\u7ecf\u8fc7\u7194\u65ad\u65f6\u957f\u540e\u7194\u65ad\u5668\u4f1a\u8fdb\u5165\u63a2\u6d4b\u6062\u590d\u72b6\u6001\uff08HALF-OPEN \u72b6\u6001\uff09\uff0c\u82e5\u63a5\u4e0b\u6765\u7684\u4e00\u4e2a\u8bf7\u6c42\u54cd\u5e94\u65f6\u95f4\u5c0f\u4e8e\u8bbe\u7f6e\u7684\u6162\u8c03\u7528 RT \u5219\u7ed3\u675f\u7194\u65ad\uff0c\u82e5\u5927\u4e8e\u8bbe\u7f6e\u7684\u6162\u8c03\u7528 RT \u5219\u4f1a\u518d\u6b21\u88ab\u7194\u65ad"}),"\n",(0,i.jsxs)(e.li,{children:["\u5f02\u5e38\u6bd4\u4f8b\uff08ERROR_RATIO\uff09\uff1a\u5f53\u5355\u4f4d\u7edf\u8ba1\u65f6\u957f\u5185\u8bf7\u6c42\u6570\u76ee\u5927\u4e8e\u8bbe\u7f6e\u7684\u6700\u5c0f\u8bf7\u6c42\u6570\u76ee\uff0c\u5e76\u4e14\u5f02\u5e38\u7684\u6bd4\u4f8b\u5927\u4e8e\u9608\u503c\uff0c\u5219\u63a5\u4e0b\u6765\u7684\u7194\u65ad\u65f6\u957f\u5185\u8bf7\u6c42\u4f1a\u81ea\u52a8\u88ab\u7194\u65ad\u3002\u7ecf\u8fc7\u7194\u65ad\u65f6\u957f\u540e\u7194\u65ad\u5668\u4f1a\u8fdb\u5165\u63a2\u6d4b\u6062\u590d\u72b6\u6001\uff0c\u82e5\u63a5\u4e0b\u6765\u7684\u4e00\u4e2a\u8bf7\u6c42\u6210\u529f\u5b8c\u6210\uff08\u6ca1\u6709\u9519\u8bef\uff09\u5219\u7ed3\u675f\u7194\u65ad\uff0c\u5426\u5219\u4f1a\u518d\u6b21\u88ab\u7194\u65ad\u3002\u5f02\u5e38\u6bd4\u7387\u7684\u9608\u503c\u8303\u56f4\u662f ",(0,i.jsx)(e.code,{children:"[0.0, 1.0]"}),"\uff0c\u4ee3\u8868 0% - 100%"]}),"\n",(0,i.jsx)(e.li,{children:"\u5f02\u5e38\u6570 \uff08ERROR_COUNT\uff09\uff1a\u5f53\u5355\u4f4d\u7edf\u8ba1\u65f6\u957f\u5185\u7684\u5f02\u5e38\u6570\u76ee\u8d85\u8fc7\u9608\u503c\u4e4b\u540e\u4f1a\u81ea\u52a8\u8fdb\u884c\u7194\u65ad\u3002\u7ecf\u8fc7\u7194\u65ad\u65f6\u957f\u540e\u7194\u65ad\u5668\u4f1a\u8fdb\u5165\u63a2\u6d4b\u6062\u590d\u72b6\u6001\uff0c\u82e5\u63a5\u4e0b\u6765\u7684\u4e00\u4e2a\u8bf7\u6c42\u6210\u529f\u5b8c\u6210\uff08\u6ca1\u6709\u9519\u8bef\uff09\u5219\u7ed3\u675f\u7194\u65ad\uff0c\u5426\u5219\u4f1a\u518d\u6b21\u88ab\u7194\u65ad"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u5355\u673a\u9608\u503c count\uff1a\u6162\u8c03\u7528\u6bd4\u4f8b\u6a21\u5f0f\u4e0b\u4e3a\u6162\u8c03\u7528\u4e34\u754c RT\uff1b\u5f02\u5e38\u6bd4\u4f8b/\u5f02\u5e38\u6570\u6a21\u5f0f\u4e0b\u4e3a\u5bf9\u5e94\u7684\u9608\u503c"}),"\n",(0,i.jsx)(e.li,{children:"\u7194\u65ad\u65f6\u957f timeWindow\uff1a\u5355\u4f4d\u4e3a s"}),"\n",(0,i.jsx)(e.li,{children:"\u6700\u5c0f\u8bf7\u6c42\u6570 minRequestAmount\uff1a\u7194\u65ad\u89e6\u53d1\u7684\u6700\u5c0f\u8bf7\u6c42\u6570\uff0c\u8bf7\u6c42\u6570\u5c0f\u4e8e\u8be5\u503c\u65f6\u5373\u4f7f\u5f02\u5e38\u6bd4\u7387\u8d85\u51fa\u9608\u503c\u4e5f\u4e0d\u4f1a\u7194\u65ad\uff0c\u9ed8\u8ba4 5"}),"\n",(0,i.jsx)(e.li,{children:"\u7edf\u8ba1\u65f6\u957f statIntervalMs\uff1a\u5355\u4f4d\u7edf\u8ba1\u65f6\u957f"}),"\n",(0,i.jsx)(e.li,{children:"\u6162\u8c03\u7528\u6bd4\u4f8b\u9608\u503c slowRatioThreshold\uff1a\u4ec5\u6162\u8c03\u7528\u6bd4\u4f8b\u6a21\u5f0f\u6709\u6548"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(51498).A+"",width:"1017",height:"614"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6ce8\u610f\u5f02\u5e38\u964d\u7ea7\u4ec5\u9488\u5bf9\u4e1a\u52a1\u5f02\u5e38\uff0c\u5bf9 Sentinel \u9650\u6d41\u964d\u7ea7\u672c\u8eab\u7684\u5f02\u5e38 BlockException \u4e0d\u751f\u6548\uff0c\u4e3a\u4e86\u7edf\u8ba1\u5f02\u5e38\u6bd4\u4f8b\u6216\u5f02\u5e38\u6570\uff0c\u9700\u8981\u901a\u8fc7 ",(0,i.jsx)(e.code,{children:"Tracer.trace(ex)"})," \u8bb0\u5f55\u4e1a\u52a1\u5f02\u5e38\u6216\u8005\u901a\u8fc7",(0,i.jsx)(e.code,{children:"@SentinelResource"})," \u6ce8\u89e3\u4f1a\u81ea\u52a8\u7edf\u8ba1\u4e1a\u52a1\u5f02\u5e38"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"Entry entry = null;\ntry {\n  entry = SphU.entry(resource);\n\n  // Write your biz code here.\n  // <<BIZ CODE>>\n} catch (Throwable t) {\n  if (!BlockException.isBlockException(t)) {\n    Tracer.trace(t);\n  }\n} finally {\n  if (entry != null) {\n    entry.exit();\n  }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8be6\u7ec6\u5185\u5bb9\u53c2\u8003\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://sentinelguard.io/zh-cn/docs/circuit-breaking.html",children:"https://sentinelguard.io/zh-cn/docs/circuit-breaking.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u70ed\u70b9\u9650\u6d41",children:"\u70ed\u70b9\u9650\u6d41"}),"\n",(0,i.jsx)(e.p,{children:"\u70ed\u70b9\u53c2\u6570\u9650\u6d41\u4f1a\u7edf\u8ba1\u4f20\u5165\u53c2\u6570\u4e2d\u7684\u70ed\u70b9\u53c2\u6570\uff0c\u5e76\u6839\u636e\u914d\u7f6e\u7684\u9650\u6d41\u9608\u503c\u4e0e\u6a21\u5f0f\uff0c\u5bf9\u5305\u542b\u70ed\u70b9\u53c2\u6570\u7684\u8d44\u6e90\u8c03\u7528\u8fdb\u884c\u9650\u6d41\uff0cSentinel \u5229\u7528 LRU \u7b56\u7565\u7edf\u8ba1\u6700\u8fd1\u6700\u5e38\u8bbf\u95ee\u7684\u70ed\u70b9\u53c2\u6570\uff0c\u7ed3\u5408\u4ee4\u724c\u6876\u7b97\u6cd5\u6765\u8fdb\u884c\u53c2\u6570\u7ea7\u522b\u7684\u6d41\u63a7"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(61013).A+"",width:"902",height:"274"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5f15\u5165 @SentinelResource \u6ce8\u89e3\uff1a",(0,i.jsx)(e.a,{href:"https://sentinelguard.io/zh-cn/docs/annotation-support.html",children:"https://sentinelguard.io/zh-cn/docs/annotation-support.html"})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"value\uff1aSentinel \u8d44\u6e90\u540d\uff0c\u9ed8\u8ba4\u4e3a\u8bf7\u6c42\u8def\u5f84\uff0c\u8fd9\u91cc value \u7684\u503c\u53ef\u4ee5\u4efb\u610f\u5199\uff0c\u4f46\u662f\u7ea6\u5b9a\u4e0e Restful \u5730\u5740\u4e00\u81f4"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["blockHandler\uff1a\u8868\u793a\u89e6\u53d1\u4e86 Sentinel \u4e2d\u914d\u7f6e\u7684\u6d41\u63a7\u89c4\u5219\uff0c\u5c31\u4f1a\u8c03\u7528\u515c\u5e95\u65b9\u6cd5 ",(0,i.jsx)(e.code,{children:"del_testHotKey"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"blockHandlerClass\uff1a\u5982\u679c\u8bbe\u7f6e\u4e86\u8be5\u503c\uff0c\u5c31\u4f1a\u53bb\u8be5\u7c7b\u4e2d\u5bfb\u627e blockHandler \u65b9\u6cd5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"fallback\uff1a\u7528\u4e8e\u5728\u629b\u51fa\u5f02\u5e38\u7684\u65f6\u5019\u63d0\u4f9b fallback \u5904\u7406\u903b\u8f91"}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1afallback \u5bf9\u5e94\u670d\u52a1\u964d\u7ea7\uff08\u670d\u52a1\u51fa\u9519\u4e86\u9700\u8981\u6709\u4e2a\u515c\u5e95\u65b9\u6cd5\uff09\uff0cblockHandler \u5bf9\u5e94\u670d\u52a1\u7194\u65ad\uff08\u670d\u52a1\u4e0d\u53ef\u7528\u7684\u515c\u5e95\u65b9\u6cd5\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@GetMapping("/testHotKey")\n@SentinelResource(value = "testHotKey", blockHandler = "del_testHotKey")\npublic String testHotkey(@RequestParam(value = "p1", required = false) String p1,\n                         @RequestParam(value = "p1", required = false) String p2) {\n    return "------testHotkey";\n}\n\n// \u81ea\u5b9a\u4e49\u7684\u515c\u5e95\u65b9\u6cd5\uff0c\u5fc5\u987b\u662f BlockException\npublic String del_testHotKey(String p1, String p2, BlockException e) {\n    return "\u4e0d\u7528\u9ed8\u8ba4\u7684\u515c\u5e95\u63d0\u793a Blocked by Sentinel(flow limiting)\uff0c\u81ea\u5b9a\u4e49\u63d0\u793a\uff1adel_testHotKeyo.";\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u56fe\u793a\u8bbe\u7f6e p1 \u53c2\u6570\u9650\u6d41\uff0c\u89c4\u5219\u662f 1s \u8bbf\u95ee 1 \u6b21\uff0c\u5f53 p1=5 \u65f6 QPS > 100\uff0c\u53ea\u8bbf\u95ee p2 \u4e0d\u4f1a\u51fa\u73b0\u9650\u6d41 ",(0,i.jsx)(e.code,{children:"http://localhost:8401/testHotKey?p2=b"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(21470).A+"",width:"994",height:"816"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53c2\u6570\u7d22\u5f15 paramIdx\uff1a\u70ed\u70b9\u53c2\u6570\u7684\u7d22\u5f15\uff0c\u56fe\u4e2d\u7d22\u5f15 0 \u5bf9\u5e94\u65b9\u6cd5\u4e2d\u7684 p1 \u53c2\u6570"}),"\n",(0,i.jsxs)(e.li,{children:["\u53c2\u6570\u4f8b\u5916\u9879 paramFlowItemList\uff1a\u9488\u5bf9\u6307\u5b9a\u7684\u53c2\u6570\u503c\u5355\u72ec\u8bbe\u7f6e\u9650\u6d41\u9608\u503c\uff0c\u4e0d\u53d7 count \u9608\u503c\u7684\u9650\u5236\uff0c",(0,i.jsx)(e.strong,{children:"\u4ec5\u652f\u6301\u57fa\u672c\u7c7b\u578b\u548c\u5b57\u7b26\u4e32\u7c7b\u578b"})]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8bf4\u660e\uff1a@SentinelResource \u53ea\u7ba1\u63a7\u5236\u53f0\u914d\u7f6e\u89c4\u5219\u95ee\u9898\uff0c\u51fa\u73b0\u8fd0\u884c\u65f6\u5f02\u5e38\u4f9d\u7136\u4f1a\u62a5\u9519"}),"\n",(0,i.jsxs)(e.p,{children:["\u8be6\u7ec6\u5185\u5bb9\u53c2\u8003\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://sentinelguard.io/zh-cn/docs/parameter-flow-control.html",children:"https://sentinelguard.io/zh-cn/docs/parameter-flow-control.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u7cfb\u7edf\u89c4\u5219",children:"\u7cfb\u7edf\u89c4\u5219"}),"\n",(0,i.jsxs)(e.p,{children:["Sentinel \u7cfb\u7edf\u81ea\u9002\u5e94\u4fdd\u62a4\u4ece\u6574\u4f53\u7ef4\u5ea6\u5bf9",(0,i.jsx)(e.strong,{children:"\u5e94\u7528\u5165\u53e3\u6d41\u91cf"}),"\u8fdb\u884c\u63a7\u5236\uff0c\u8ba9\u7cfb\u7edf\u5c3d\u53ef\u80fd\u8dd1\u5728\u6700\u5927\u541e\u5410\u91cf\u7684\u540c\u65f6\u4fdd\u8bc1\u7cfb\u7edf\u6574\u4f53\u7684\u7a33\u5b9a\u6027"]}),"\n",(0,i.jsx)(e.p,{children:"\u7cfb\u7edf\u89c4\u5219\u652f\u6301\u4ee5\u4e0b\u7684\u9608\u503c\u7c7b\u578b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Load\uff08\u4ec5\u5bf9 Linux/Unix-like \u673a\u5668\u751f\u6548\uff09\uff1a\u5f53\u7cfb\u7edf load1 \u8d85\u8fc7\u9608\u503c\uff0c\u4e14\u7cfb\u7edf\u5f53\u524d\u7684\u5e76\u53d1\u7ebf\u7a0b\u6570\u8d85\u8fc7\u7cfb\u7edf\u5bb9\u91cf\u65f6\u624d\u4f1a\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\uff0c\u7cfb\u7edf\u5bb9\u91cf\u7531\u7cfb\u7edf\u7684 ",(0,i.jsx)(e.code,{children:"maxQps * minRt"})," \u8ba1\u7b97\u5f97\u51fa\uff0c\u8bbe\u5b9a\u53c2\u8003\u503c\u4e00\u822c\u662f ",(0,i.jsx)(e.code,{children:"CPU cores * 2.5"})]}),"\n",(0,i.jsx)(e.li,{children:"RT\uff1a\u5f53\u5355\u53f0\u673a\u5668\u4e0a\u6240\u6709\u5165\u53e3\u6d41\u91cf\u7684\u5e73\u5747 RT \u8fbe\u5230\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2"}),"\n",(0,i.jsx)(e.li,{children:"\u7ebf\u7a0b\u6570\uff1a\u5f53\u5355\u53f0\u673a\u5668\u4e0a\u6240\u6709\u5165\u53e3\u6d41\u91cf\u7684\u5e76\u53d1\u7ebf\u7a0b\u6570\u8fbe\u5230\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4"}),"\n",(0,i.jsx)(e.li,{children:"\u5165\u53e3 QPS\uff1a\u5f53\u5355\u53f0\u673a\u5668\u4e0a\u6240\u6709\u5165\u53e3\u6d41\u91cf\u7684 QPS \u8fbe\u5230\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4"}),"\n",(0,i.jsx)(e.li,{children:"CPU usage\uff1a\u5f53\u7cfb\u7edf CPU \u4f7f\u7528\u7387\u8d85\u8fc7\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\uff08\u53d6\u503c\u8303\u56f4 0.0-1.0\uff09"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(96965).A+"",width:"1014",height:"404"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8be6\u7ec6\u5185\u5bb9\u53c2\u8003\u6587\u6863\uff1a",(0,i.jsx)(e.a,{href:"https://sentinelguard.io/zh-cn/docs/system-adaptive-protection.html",children:"https://sentinelguard.io/zh-cn/docs/system-adaptive-protection.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u670d\u52a1\u8c03\u7528-1",children:"\u670d\u52a1\u8c03\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u6d88\u8d39\u8005\u9700\u8981\u8fdb\u884c\u670d\u52a1\u8c03\u7528"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-openfeign</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a\u6fc0\u6d3b Sentinel \u5bf9 Feign \u7684\u652f\u6301"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"feign:\n  sentinel:\n    enabled: true\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e3b\u542f\u52a8\u7c7b\uff1a\u52a0\u4e0a @EnableFeignClient \u6ce8\u89e3\u5f00\u542f OpenFeign"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u7c7b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u6307\u660e\u8c03\u7528\u5931\u8d25\u7684\u515c\u5e95\u65b9\u6cd5\u5728PaymentFallbackService\uff0c\u4f7f\u7528 fallback \u65b9\u5f0f\u662f\u65e0\u6cd5\u83b7\u53d6\u5f02\u5e38\u4fe1\u606f\u7684\uff0c\n// \u5982\u679c\u60f3\u8981\u83b7\u53d6\u5f02\u5e38\u4fe1\u606f\uff0c\u53ef\u4ee5\u4f7f\u7528 fallbackFactory \u53c2\u6570\n@FeignClient(value = "nacos-payment-provider", fallback = PaymentFallbackService.class)\npublic interface PaymentFeignService {\n    // \u53bb\u751f\u4ea7\u5219\u670d\u52a1\u4e2d\u627e\u76f8\u5e94\u7684\u63a5\u53e3\uff0c\u65b9\u6cd5\u7b7e\u540d\u4e00\u5b9a\u8981\u548c\u751f\u4ea7\u8005\u4e2d controller \u7684\u4e00\u81f4\n    @GetMapping(value = "/paymentSQL/{id}")\n    public CommonResult<Payment> paymentSQL(@PathVariable("id") Long id);\n}\n\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Component   //\u4e0d\u8981\u5fd8\u8bb0\u6ce8\u89e3\uff0c\u964d\u7ea7\u65b9\u6cd5\npublic class PaymentFallbackService implements PaymentFeignService {\n    @Override\n    public CommonResult<Payment> paymentSQL(Long id) {\n        return new CommonResult<>(444,"\u670d\u52a1\u964d\u7ea7\u8fd4\u56de,\u6ca1\u6709\u8be5\u6d41\u6c34\u4fe1\u606f-------PaymentFallbackSe\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u6301\u4e45\u5316",children:"\u6301\u4e45\u5316"}),"\n",(0,i.jsx)(e.p,{children:"\u914d\u7f6e\u6301\u4e45\u5316\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"\x3c!--SpringCloud ailibaba sentinel-datasource-nacos \u540e\u7eed\u505a\u6301\u4e45\u5316\u7528\u5230--\x3e\n<dependency>\n    <groupId>com.alibaba.csp</groupId>\n    <artifactId>sentinel-datasource-nacos</artifactId>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6dfb\u52a0 Nacos \u6570\u636e\u6e90\u914d\u7f6e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"server:\n  port: 8401\n\nspring:\n  application:\n    name: cloudalibaba-sentinel-service\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848 #Nacos\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\n    sentinel:\n      transport:\n        dashboard: localhost:8080\n        port: 8719\n      # \u5173\u95ed\u9ed8\u8ba4\u6536\u655b\u6240\u6709URL\u7684\u5165\u53e3context\uff0c\u4e0d\u7136\u94fe\u8def\u9650\u6d41\u4e0d\u751f\u6548\n      web-context-unify: false\n      # filter:\n        # enabled: false  # \u5173\u95ed\u81ea\u52a8\u6536\u655b\n\n      #\u6301\u4e45\u5316\u914d\u7f6e\n      datasource:\n        ds1:\n          nacos:\n            server-addr: localhost:8848\n            dataId: cloudalibaba-sentinel-service\n            groupId: DEFAULT_GROUP\n            data-type: json\n            rule-type: flow\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"seata",children:"Seata"}),"\n",(0,i.jsx)(e.h4,{id:"\u5206\u5e03\u4e8b\u7269",children:"\u5206\u5e03\u4e8b\u7269"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u7528\u5206\u5e03\u5f0f\u5904\u7406\u8fc7\u7a0b\u7684\u4e00 ID + \u4e09\u7ec4\u4ef6\u6a21\u578b\u6765\u63cf\u8ff0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"XID (Transaction ID)\uff1a\u5168\u5c40\u552f\u4e00\u7684\u4e8b\u52a1 ID\uff0c\u5728\u8fd9\u4e2a\u4e8b\u52a1ID\u4e0b\u7684\u6240\u6709\u4e8b\u52a1\u4f1a\u88ab\u7edf\u4e00\u63a7\u5236"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"TC (Transaction Coordinator)\uff1a\u4e8b\u52a1\u534f\u8c03\u8005\uff0c\u7ef4\u62a4\u5168\u5c40\u548c\u5206\u652f\u4e8b\u52a1\u7684\u72b6\u6001\uff0c\u9a71\u52a8\u5168\u5c40\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"TM (Transaction Manager)\uff1a\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u5b9a\u4e49\u5168\u5c40\u4e8b\u52a1\u7684\u8303\u56f4\uff0c\u5f00\u59cb\u5168\u5c40\u4e8b\u52a1\u3001\u63d0\u4ea4\u6216\u56de\u6eda\u5168\u5c40\u4e8b\u52a1"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RM (Resource Manager)\uff1a\u8d44\u6e90\u7ba1\u7406\u5668\uff0c\u7ba1\u7406\u5206\u652f\u4e8b\u52a1\u5904\u7406\u7684\u8d44\u6e90\uff0c\u4e0e TC \u4ea4\u8c08\u4ee5\u6ce8\u518c\u5206\u652f\u4e8b\u52a1\u548c\u62a5\u544a\u5206\u652f\u4e8b\u52a1\u7684\u72b6\u6001\uff0c\u5e76\u9a71\u52a8\u5206\u652f\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5178\u578b\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u6d41\u7a0b\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"TM \u5411 TC \u7533\u8bf7\u5f00\u542f\u4e00\u4e2a\u5168\u5c40\u4e8b\u52a1\uff0c\u5168\u5c40\u4e8b\u52a1\u521b\u5efa\u6210\u529f\u5e76\u751f\u6210\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684 XID"}),"\n",(0,i.jsx)(e.li,{children:"XID \u5728\u5fae\u670d\u52a1\u8c03\u7528\u94fe\u8def\u7684\u4e0a\u4e0b\u6587\u4e2d\u4f20\u64ad\uff08\u4e5f\u5c31\u662f\u5728\u591a\u4e2a TM\uff0cRM \u4e2d\u4f20\u64ad\uff09"}),"\n",(0,i.jsx)(e.li,{children:"RM \u5411 TC \u6ce8\u518c\u5206\u652f\u4e8b\u52a1\uff0c\u5c06\u5176\u7eb3\u5165 XID \u5bf9\u5e94\u5168\u5c40\u4e8b\u52a1\u7684\u7ba1\u8f96"}),"\n",(0,i.jsx)(e.li,{children:"TM \u5411 TC \u53d1\u8d77\u9488\u5bf9 XID \u7684\u5168\u5c40\u63d0\u4ea4\u6216\u56de\u6eda\u51b3\u8bae"}),"\n",(0,i.jsx)(e.li,{children:"TC \u8c03\u5ea6 XID \u4e0b\u7ba1\u8f96\u7684\u5168\u90e8\u5206\u652f\u4e8b\u52a1\u5b8c\u6210\u63d0\u4ea4\u6216\u56de\u6eda\u8bf7\u6c42"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(78234).A+"",width:"836",height:"487"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u914d\u7f6e-2",children:"\u57fa\u672c\u914d\u7f6e"}),"\n",(0,i.jsx)(e.p,{children:"Seata \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848\uff0c\u81f4\u529b\u4e8e\u63d0\u4f9b\u9ad8\u6027\u80fd\u548c\u7b80\u5355\u6613\u7528\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u670d\u52a1\u3002Seata \u5c06\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86 AT\u3001TCC\u3001SAGA \u548c XA \u4e8b\u52a1\u6a21\u5f0f\uff0c\u4e3a\u7528\u6237\u6253\u9020\u4e00\u7ad9\u5f0f\u7684\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u8f7d seata-server \u6587\u4ef6\u4fee\u6539 conf \u76ee\u5f55\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"file.conf\uff1a\u81ea\u5b9a\u4e49\u4e8b\u52a1\u7ec4\u540d\u79f0\u3001\u4e8b\u52a1\u65e5\u5fd7\u5b58\u50a8\u6a21\u5f0f\u4e3a db\u3001\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u4e8b\u52a1\u5206\u7ec4"}),"\uff1aseata \u7684\u8d44\u6e90\u903b\u8f91\uff0c\u53ef\u4ee5\u6309\u5fae\u670d\u52a1\u7684\u9700\u8981\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\uff08\u5ba2\u6237\u7aef\uff09\u5bf9\u81ea\u884c\u5b9a\u4e49\u4e8b\u52a1\u5206\u7ec4\uff0c\u6bcf\u7ec4\u53d6\u4e00\u4e2a\u540d\u5b57"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(33152).A+"",width:"1259",height:"740"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6570\u636e\u5e93\u65b0\u5efa\u5e93 seata\uff0c\u5efa\u8868 db_store.sql \u5728 ",(0,i.jsx)(e.code,{children:"https://github.com/seata/seata/tree/2.x/script/server/db"})," \u76ee\u5f55\u91cc\u9762"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"registry.conf\uff1a\u6307\u660e\u6ce8\u518c\u4e2d\u5fc3\u4e3a Nacos\uff0c\u53ca\u4fee\u6539 Nacos \u8fde\u63a5\u4fe1\u606f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(59759).A+"",width:"887",height:"212"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u542f\u52a8 Nacos \u548c Seata\uff0c\u5982\u679c DB \u62a5\u9519\uff0c\u9700\u8981\u628a\u5c06 lib \u6587\u4ef6\u5939\u4e0b mysql-connector-java-5.1.30.jar \u5220\u9664\uff0c\u66ff\u6362\u4e3a\u81ea\u5df1 MySQL \u8fde\u63a5\u5668\u7248\u672c"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:s(49804).A+"",width:"861",height:"224"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5b98\u7f51\uff1a",(0,i.jsx)(e.a,{href:"https://seata.io",children:"https://seata.io"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u4e0b\u8f7d\u5730\u5740\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/seata/seata/releases",children:"https://github.com/seata/seata/releases"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u57fa\u672c\u4ecb\u7ecd\uff1a",(0,i.jsx)(e.a,{href:"https://seata.io/zh-cn/docs/overview/what-is-seata.html",children:"https://seata.io/zh-cn/docs/overview/what-is-seata.html"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u672c\u4f7f\u7528-8",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u4e24\u4e2a\u6ce8\u89e3\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Spring \u63d0\u4f9b\u7684\u672c\u5730\u4e8b\u52a1\uff1a@Transactional"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Seata \u63d0\u4f9b\u7684\u5168\u5c40\u4e8b\u52a1\uff1a",(0,i.jsx)(e.strong,{children:"@GlobalTransactional"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u642d\u5efa\u7b80\u5355 Demo\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u521b\u5efa UNDO_LOG \u8868\uff1aSEATA AT \u6a21\u5f0f\u9700\u8981 ",(0,i.jsx)(e.code,{children:"UNDO_LOG"})," \u8868\uff0c\u5982\u679c\u4e00\u4e2a\u6a21\u5757\u7684\u4e8b\u52a1\u63d0\u4ea4\u4e86\uff0cSeata \u4f1a\u628a\u63d0\u4ea4\u4e86\u54ea\u4e9b\u6570\u636e\u8bb0\u5f55\u5230 undo_log \u8868\u4e2d\uff0c\u5982\u679c\u8fd9\u65f6 TC \u901a\u77e5\u5168\u5c40\u4e8b\u52a1\u56de\u6eda\uff0c\u90a3\u4e48 RM \u5c31\u4ece undo_log \u8868\u4e2d\u83b7\u53d6\u4e4b\u524d\u4fee\u6539\u4e86\u54ea\u4e9b\u8d44\u6e90\uff0c\u5e76\u6839\u636e\u8fd9\u4e2a\u8868\u56de\u6eda"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"-- \u6ce8\u610f\u6b64\u59040.3.0+ \u589e\u52a0\u552f\u4e00\u7d22\u5f15 ux_undo_log\nCREATE TABLE `undo_log` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `branch_id` bigint(20) NOT NULL,\n  `xid` varchar(100) NOT NULL,\n  `context` varchar(128) NOT NULL,\n  `rollback_info` longblob NOT NULL,\n  `log_status` int(11) NOT NULL,\n  `log_created` datetime NOT NULL,\n  `log_modified` datetime NOT NULL,\n  `ext` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `ux_undo_log` (`xid`,`branch_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 pom \u4f9d\u8d56\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-seata</artifactId>\n    <version>${spring-cloud-alibaba.version}</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"application.yml\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'spring:\n  application:\n    name: seata-order-service\n  cloud:\n    alibaba:\n      seata:\n        # \u81ea\u5b9a\u4e49\u4e8b\u52a1\u7ec4\u540d\u79f0\u9700\u8981\u4e0eseata-server\u4e2dfile.conf\u4e2d\u914d\u7f6e\u7684\u4e8b\u52a1\u7ec4ID\u5bf9\u5e94\n        # vgroup_mapping.my_test_tx_group = "my_group"\n        tx-service-group: my_group\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n  datasource:\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    url: jdbc:mysql://localhost:3306/seata_order?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=UTC\n    username: root\n    password: 123456\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6784\u5efa\u4e09\u4e2a\u670d\u52a1\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u4ed3\u50a8\u670d\u52a1\npublic interface StorageService {\n    // \u6263\u9664\u5b58\u50a8\u6570\u91cf\n    void deduct(String commodityCode, int count);\n}\n\n// \u8ba2\u5355\u670d\u52a1\npublic interface OrderService {\n\t// \u521b\u5efa\u8ba2\u5355\n    Order create(String userId, String commodityCode, int orderCount);\n}\n\n// \u5e10\u6237\u670d\u52a1\npublic interface AccountService {\n    // \u4ece\u7528\u6237\u8d26\u6237\u4e2d\u501f\u51fa\n    void debit(String userId, int money);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e1a\u52a1\u903b\u8f91\uff1a\u589e\u52a0 @GlobalTransactional \u6ce8\u89e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class OrderServiceImpl implements OrderService {\n\t@Resource\n    private OrderDAO orderDAO;\n\t@Resource\n    private AccountService accountService;\n    \n\t@Transactional(rollbackFor = Exception.class)\n    public Order create(String userId, String commodityCode, int orderCount) {\n        int orderMoney = calculate(commodityCode, orderCount);\n\t\t// \u8d26\u6237\u6263\u94b1\n        accountService.debit(userId, orderMoney);\n\n        Order order = new Order();\n        order.userId = userId;\n        order.commodityCode = commodityCode;\n        order.count = orderCount;\n        order.money = orderMoney;\n\n        return orderDAO.insert(order);\n    }\n}\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class BusinessServiceImpl implements BusinessService {\n\t@Resource\n    private StorageService storageService;\n\t@Resource\n    private OrderService orderService;\n\n    // \u91c7\u8d2d\uff0c\u6d89\u53ca\u591a\u670d\u52a1\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u95ee\u9898\n    @GlobalTransactional\n    @Transactional(rollbackFor = Exception.class)\n    public void purchase(String userId, String commodityCode, int orderCount) {\n        storageService.deduct(commodityCode, orderCount);\n        orderService.create(userId, commodityCode, orderCount);\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8be6\u7ec6\u793a\u4f8b\u53c2\u8003\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/seata/seata-samples/tree/master/springcloud-nacos-seata",children:"https://github.com/seata/seata-samples/tree/master/springcloud-nacos-seata"})]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}},97453:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u5207\u5165\u70b9\u5207\u9762\u901a\u77e5-bc90c4a871598f8b6de6aa2d0752c6f0.png"},35716:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u5e95\u5c42\u539f\u7406-cglib-21255646ec320aff5412934af7471b38.png"},95816:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u6ce8\u89e3\u5f00\u53d1-cc91765c4c18554104ce18d19db84611.png"},5858:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u7ec7\u5165-dd7022300f6659959f04b5d5279b111b.png"},8534:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u7ec7\u5165\u65f6\u673a-833eaf34c02db6fd9d766f8dc54928b9.png"},62836:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u8fde\u63a5\u70b9-f36368ac31780f0d72a6b6b7774b796d.png"},34615:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u901a\u77e5\u83b7\u53d6\u53c2\u6570\u65b9\u5f0f\u4e09-1218a4373491d6c55d3b18ee6dfb66eb.png"},52330:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/AOP\u901a\u77e5\u83b7\u53d6\u53c2\u6570\u65b9\u5f0f\u4e8c-d8e09a747bfe69c1edee79f77e2dd2ad.png"},298:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Bus\u5168\u5c40\u5e7f\u64ad\u67b6\u6784-9a426f2605215ecaf43980f3e19d93e5.png"},74871:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Bus\u5de5\u4f5c\u6d41\u7a0b-c1e11ee224ca6dc14649098c25e94df9.png"},49082:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Config\u5de5\u4f5c\u539f\u7406-b57dce0de2e97c6430ef489a90835f2b.png"},12195:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-EurekaServer\u96c6\u7fa4\u6784\u5efa\u6210\u529f-34835c994e54c17d3840af54bc27010a.png"},80692:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Eureka\u53ef\u89c6\u5316\u754c\u9762-a8ecb2e338fcbc84928f6ca57096cd5d.png"},93638:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Eureka\u548cDubbo\u5bf9\u6bd4-3eb11512ecdb250b55f600f1f69a7b62.png"},75977:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Eureka\u81ea\u6211\u4fdd\u62a4\u673a\u5236-4b30beb29273d180e8dc76c2884e884a.png"},13820:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Eureka\u96c6\u7fa4\u539f\u7406-300e91bf5e96939ac40d1ec3cf6e238c.png"},89255:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Gateway\u5de5\u4f5c\u6d41\u7a0b-edfc205c82b6bc88babcbe935753a2f6.png"},7749:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Gateway\u65f6\u95f4\u65ad\u8a00-b59fa7c41849aca1881fe3f7863968c1.png"},62970:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Hystrix\u53ef\u89c6\u5316\u754c\u9762-8a67a4bda1a9955fe7ac31615cb25714.png"},15832:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Hystrix\u5de5\u4f5c\u6d41\u7a0b-c785561edb9fedb3317c075d1baa32ee.png"},77158:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Hystrix\u7194\u65ad\u673a\u5236-4d70ba1aa8f1ca48ccb9e4f42badebb1.png"},58831:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Hystrix\u754c\u9762\u56fe\u793a\u8bf4\u660e-5baac1a2398eefbc27fb8cb34be2dce1.png"},15202:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-IRule\u7c7b\u56fe-7d6bac5499303dbb03c664319e621779.png"},87334:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Nacos\u547d\u540d\u7a7a\u95f4-ae82913385c2472ff68c7384dbbae831.png"},61182:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Nacos\u65b0\u589e\u914d\u7f6e-7ea1b0b2031f71af1aa1684d1158a56e.png"},21021:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Nacos\u670d\u52a1\u5217\u8868-946cb4c5712a47b57e295d893711ecb2.png"},84881:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Nacos\u914d\u7f6e\u8bf4\u660e-ad735c0ceb71e565f60608cdd6106bda.png"},33564:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-OpenFeign\u8d85\u65f6\u9519\u8bef-cdb695492a9ad9cc1a1cc8bbcccbbee3.png"},87165:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Ribbon\u67b6\u6784\u539f\u7406-9d7e0cfa1ebcb4c00e07c255b11bfa42.png"},59759:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Seata\u6ce8\u518c\u4e2d\u5fc3\u914d\u7f6e-fb870d63329907bb3a112bb80d1310aa.png"},49804:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Seata\u914d\u7f6e\u6210\u529f-7475b7120e935663beda0021962ff30d.png"},33152:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Seata\u914d\u7f6e\u6587\u4ef6-dcac7b947768c9d5a93a3fc6adbcedfb.png"},56739:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Sentinel\u589e\u52a0\u6d41\u63a7\u89c4\u5219-cf26a447e6ec8e5a3960950af90f9899.png"},21470:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Sentinel\u589e\u52a0\u70ed\u70b9\u89c4\u5219-be96a81d469b0f46ac6301bc9eb83355.png"},51498:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Sentinel\u589e\u52a0\u7194\u65ad\u89c4\u5219-d3b602a80250cbfa3263ec7353d8cc93.png"},96965:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Sentinel\u589e\u52a0\u7cfb\u7edf\u89c4\u5219-df30cc199dfccce8908152d899d1aa4c.png"},61013:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Sentinel\u70ed\u70b9\u53c2\u6570\u9650\u6d41-4d390cb7ae4e2c2af511f3a0c3129630.png"},67907:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-Stream\u5de5\u4f5c\u6d41\u7a0b-3b3d0d619ba9cb1463ad10181d54e3d9.png"},78234:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-\u5206\u5e03\u5f0f\u4e8b\u52a1\u6d41\u7a0b-979983d28427021ee41ecf32ab8827a9.png"},57552:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Cloud-\u7ec4\u4ef6\u6982\u89c8-2240f82844b8b7a4c62743c40149b9e8.png"},52270:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-ORM\u4ecb\u7ecd-987c5a82cd244e19096741faa5b00bde.png"},55732:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-SQL\u8d44\u6e90\u5bf9\u8c61-5f47ca674297ec68da52ef0a48aba452.png"},61006:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-boundSql\u5bf9\u8c61-ac1b143e999cc33c6acd882d3f421532.png"},41101:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u4e00\u7ea7\u7f13\u5b58-e0672f0b37804a80dd24a0f1c68d340e.png"},89140:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u52a8\u6001sql\u7528\u6237\u8868-b76401f8171aa070f98bccec1eabdf4f.png"},21999:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u6267\u884cSQL\u8fc7\u7a0b-6b28b4e4ab4e241225db6ce38203dd02.png"},20602:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u6267\u884c\u6d41\u7a0b-9796cf5d58ef047485289fde4678985d.png"},72887:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u63d2\u4ef6\u539f\u7406-d36630975fa223d32368df457011af7e.png"},16664:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u7f13\u5b58\u7684\u5b9e\u73b0\u539f\u7406-3f112d03d06a405d0053fc04762c81e0.png"},80630:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u83b7\u53d6\u4ee3\u7406\u5bf9\u8c61-83653353ec18159302bf299f2572fb21.png"},88994:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u83b7\u53d6\u4f1a\u8bdd\u5bf9\u8c61-c4aaa5f347523349980fc06d44f6d4f5.png"},22568:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/MyBatis-\u83b7\u53d6\u5de5\u5382\u5bf9\u8c61-15c50270ed15c8ae5d852ed8ff81b1d1.png"},89213:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-AOP\u52a8\u6001\u4ee3\u7406\u6267\u884c\u65b9\u6cd5-c21e7412e557546a7c525afcb1932396.png"},98431:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-ApplicationContext\u5c42\u7ea7\u7ed3\u6784\u56fe-56b71d77f75e01d57c01cca15fe5ff34.png"},47931:(n,e,s)=>{s.d(e,{A:()=>r});const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD3CAYAAADxCUYeAAAgAElEQVR4nO3dW2wc930v8O/MXnkVKSo06ZUSxccU3fQEsRSdhRsHrEW0RSoQUIg+MChE9LQCIYAvdGDjiA+FohB90EMDk+dBgMBj9AB6EQ9asEJZ4aDNUa0NHASsLKkNjHjFtFYsr8lQvIm3vc+ch/V/OLMXcknu7sz+9/sBCHJvs79dzsx3/v/5z4yi67oOIiIikopqdwFERERUegx4IiIiCTHgiYiIJMSAJyIikhADnoiISEIMeCIiIgkx4ImIiCTEgCciIpIQA56IiEhCDHgiIiIJMeCJiIgkxIAnIiKSEAOeiIhIQm67C6gFuqYhHY8jHd2GnkpDS8ShpzXoWtp4nCpHUVUoqguKxw1FdUH1euCqq4e7rs7u0khiyXTmwp3RZGa5305qSKb1nPvFfUktc3/qy8eT6Z31hHisWB5V2fnblWnXuV2Kcb/HtfPboypwu9TM31/e9rgy99V72CasJgovF1s+qWgU6e0tJNfXGeJVwt3QCM+RIwx7KloyrSOaTFsCO5pMYzuhIZrMLPfbybQR5DKo96io87qM8Be3zb/Jfgz4MkhFo0gsLyEdj9tdCh2Qy+eDp/kIPM3NdpdCDpBM61iPpbCd1BBNpLG0nUIqrUsX3KXW1uCBR1VwxO/iBoANGPAllIpGkVhdQToatbsUKhGXzwffV9rh8vnsLoUqYDupZYI8oSGaTGN5K8UQL5O2Bg/qPZlu/7YGD4O/DBjwJZJYW0NidYVd8ZLytrbCd7TN7jKohESLfD2awtJ2CuuxFIPcATqavKj3ZkK/2e9m6B8CA/6QdE1DbHERqa1Nu0uhMnPV1aH+5YDdZdABiC72F7E0FjYSDPMq09HkxRG/C20NHrQ1eOwup2ow4A+B4V57XD4f6l4OQFHZqnC69VgKS1spBrqEROB3NHvR7OfBYIUw4A+I4V67XD4f6o+fsLsMyiJa6QsbCSxvpfAilrK7JKoAj0vBiRYf2ho86Gjy2l2OozDgDyi6sMBwr2HsrncGc6g/W4uzlU440eIzAr/WMeAPILG2hvjykt1lkM18bcfgbWmxu4yatJ3U8PlqDM/W4thOcmAr5fdKmx9fb6ur2YF6DPh9SsfjiH4R4Wh5AgDUHz/BQ+gqaHkriWdrcSxsJNhap6J1NHnxSpu/5lr1DPh92v4iwuPcyaC6PWj42tfsLkN6y1tJhJ9HsbyVtLsUqmJtDR50f6WuZoKeAb8Pqa1NRBcW7C6DHMb/lXae8a5MkmkdT55v4z+XY3aXQhI50eLDqfZ66bvuGfD7wNY75aOoKhq//ordZUjn2VocHy9ssSueyuZ3OxrwSpvf7jLKRu7NlxJKbW0y3CkvXdOQXF+3uwxpJNM6Pl7YwuPIJsOdykrMZ7JiwBcptbVtdwnkYOkYu5BLIZnW8TiyyS55qphna3H8/KmcG+gM+CLxmHfaTWprk0dWlMCny1EsbCTsLoNqzPJWEv/62YbdZZQcA74I6XicK2/ala5pvDzwIYmR8kR2EKc0lgkDvgjc907FSEe5G+cw2C1PdgsvyrWuZ8AXgftXqRhagsdoH4ZsrSeqPsvbci3DDPgi6Fra7hKoCrAFfzjRFHeDkb1kO2qDAV8EPcmWBVHZybVupSqk2F1AiTHgiUqEAzEPZzvBnjKyl2zzIAO+CFpKrv0yRE70Hysx6VpQVD0UJTMPyoQBT0SOEE9qiLzgoYZUeYoCLG4kEZfs0sMMeCJyjPn1BL5gyFMFKQqwspXCZ6tytd4BBjwROcz8egK/WWV3PZWfgkzL/T+X5Tr+XXDbXQARUbalzSSWNpP41suNcLsY9VR6qbSOT55vS9ctb8aAJyLH+rcvNnGs0YOTrX4eRUcloevA/Hoc8+vyX/OAAU9EjiZa819t9aO90cOgpwPRdWBpKynlvvZCGPBEVBU+W43hs9UYOpu9aG/0suue9qQogKYBn63FsLRZe4c7M+CJqKrMryeM7tVT7fVo9rnYqicLBZmT1jx7EcdGTK6T1+wHA56IqtaTxcz5/zubvWitc6Pey7CvVSLUF7eSNdlaz4cBT0RVz9yqP9bowdF6Dxq9LijsxZeW6H6PJRnqhTDgiUgqYlCe8NVWPxq9KvweBn41E4Ge1DQsbSaxEk1JfYhbKTDgiUhq2aOmReD7PC641MzoanIeRQHSGhD/soW+EU8z0PeJAU9ENSU78H0eFS81endCX+GVaytNAZDWM2G+Gk0hqensci8BBjwR1bR4Ust7bHRnsxd1Hhf8bgUelwqXqrCL/xAUBYCeCfKUpiGe0rGyzZZ5OTHgiYjyKHSmsya/C611HrhVxRL+ao23/M0Brmk6kmkNsZSO9XgK8ZRW04er2YUBT0S0Dxux9J5h1eR3odHrgselGhsCLpcCFQpcaqYbQFUAKM4dAyACG8iENpBpeQNAPKUjltSQTGtIajpb4Q7FgCciKrFiNgKyNfldAACfW4VHzfQMAID7yw0C85n73PvcVZAybUSkvkzr1JetbABIapn74ikNibTOsJYEA56IyAHEBsEG2JVNpcHrwRMREUmIAU9ERCQhBjwREZGEGPBEREQSYsATERFJiKPo6UAUVYWiuuwuo2S0FE+LSdWpPbaMl2IrOL61gIZUFADg1eSYnxOqB4t1bdhy1+FZ/UtY9LfZXVJVYcBTURRVhbuhEe6mJrh8PiiqfJ0/WjIJLRFHamsbyY11u8sh2lV7bBlnlz5GS3LD7lLKxqslcXxrAQDQ/eJTrHqb8Unz1/Fp03GbK6sODHjak6epGd7WVqgej92llJXq8UD1eOBuaITnyBEkX7xg0JPjeLUkvrk2h+4Xn9pdSsW1Jtbxe0v/hqPJdXx09Bt2l+N4DHgqSFFV+Nvb4W5otLuUinP5fHC1t0P1ehFfXrK7HCIAmXD/zuJjvBxdtLsUW3W/+BSt8XX8tPMNu0txNPn6WakkajnczbwtLah7OWB3GUQAgG+thGs+3IX22DJ6Fj+yuwxHY8BTXgz3He66OnhbWuwug2rc8a0FdG38xu4yHOX41oKxj55yMeAph7uhkeGexdd2DC6fz+4yqIZ9a+2J3SU40pvPH9tdgmMx4MlCUVV4W1vtLsORvG3H7C6BalR7bBlHEvKOlj8Ml57G1zc+t7sMR2LAk4Wrrp4t1QLcdXVQ3XIfSUDO1LXxmd0lONqrm8/sLsGRGPBk4a6vt7sER3M3NthdAtWgl6LLdpfgaG2xVbtLcCQGPFm46ursLsHRXH6/3SVQDfKlE3aX4GgKdLtLcCQGPNE+KOyiJxswwHan2F2AQzHgyUL2s9UREdUKBjwREZGEGPBEREQSYsATERFJiAFPREQkIV5Njoikd6L5M3y16XP4XVEAOpQKDrvWdQUJzYOl7WP41QovcUqVw4AvMUVV4aqrh+r1QFFdFX1vXUsjHYshHY1W9H2JnMrvjuHbLz1EnXvbthoURYfPlUCg6Qscq1/Czz7vsa0Wqi0M+BLytrbC29IKRbV3z0c6Hkf8+SLS8bitdRDZze5wz+ZzJfDWiQ/wwbO37C6FagD3wZeIr+0YfEfbbA93AHD5fKg/foJnpaOa9mrLrx0V7oJbTeHVll/bXQbVAPvTSAKepmZHXi+8rqOTF0ehmtXZ+IXdJRTk5NpIHgz4EvAcOWJ3CXkpqgp3E6/rTrXJqybtLqEgr8pzy1P5MeAPyeXzOfryqp6mZrtLILKFojj3/O2VHMVPtYsBf1gO2Oe+G8VV2ZH8RETkDM5OpypQ6UPh9ssJg/6IiKjyuPYnIiKSEAOeiIhIQgx4IiIiCTHgiYiIJMSAJyIikhADnoiISEIMeCIiIgkx4ImIiCTEgCciIpIQA56IiEhCDHgiIiIJMeCJiIgkxIAnIiKSEAOeiIhIQgx4IiIiCTHgiYiIJMSAJyIikhADnoiISEIMeCIiIgkx4ImIiCTEgCciIpIQA56IiEhCDHgiIiIJMeCJSEq6bncFhTm5NpIHA15yuqbZXQKRLWLpertLKCihee0ugWoAA/6Q0tFtu0vYlZZM2l0CkS1+u9VudwkFLW0fs7sEqgEM+EPSNc3RIZra2rS7BCJb/HrtVcTTzmspR1P1+NXKN+wug2oAA74E4svLdpeQl65pSG0w4Kl2/ezzHkeFfEpz46PfnrG7DKoRDPgSSG1tIrm+bncZFrqmIba4CC3l3N4Fokr42ec9iGy8jJTmtuX9dT0T7IvbX8EHz95CLOW3pQ6qPfbM8RKKPV+ElkzA12b/vrV0PI7E6iq754m+9KuVb7BbnGoOA76EEmtrSKytwdvSAigKVLenou+vaxpS21vQ4nGOniciqnEM+DJIrK3ZXQIREdU47oMnInI4nheHDoIBTxbs2t8dvx+yQ1rhqno3KX4/efFbIQsnH9PvBDq/H7LBuqfR7hIcLe7y2V2CIzHgySIdjdpdgqOlYzG7S6Aa9Ky+w+4SHO03DS/bXYIjMeDJIrW5YXcJjqVrGjeAyBYft3ZBh2J3GY6kQ8Gvm79mdxmOxIAni3Q8jnQ8bncZjpTa3OSJg8g2/97SZXcJjvSbhk5suuvsLsORGPCUI/580e4SHEfXNCRWV+0ug2rYx61diHJfs8WWuw4Pjv1Xu8twLAY85UjH4zyWP0t8aYmtd7LdPx7/faQUl91lOEJKceH/df4eEmplTyhWTRjwlFd8eclx59e3S3xlGckNfhdkv4Tqwf85+T1s1XiXdFz14u7x32fX/B4Y8FRQ7Pki4ivOvFJeJYgL9rBrnpzmzolePG14ueYG3ulQ8LThZfzDibcY7kXgqWppV4nVVaS3t+FpPgJPc7Pd5VSErmlIx+OI82p85GA/bz+Nn+M0Xl/5BF/dXkBDchuKZOe80wHoioq46sEX9e34uKWLwb4PDHjaUzoeR/r5IpLrL+Cqq4OrvgGKqkJR5ekA0jUNeiqJdDyO1AZHy1P1eHz0NTw++prdZZADMeCpaMYhdByAR0TkePI0wYiIiMjAgCciIpIQA56IiEhCDHgiIiIJMeCJiIgkxIAnIiKSEAOeiIhIQgx4IiIiCTHgiYiIJMSAJyIikhADnoiISEIMeCIiIgkx4ImIiCTEgCciIpIQA56IiEhCDHgiIiIJue0ugIioUlrUKPo8D/GysgI3NChK6aadhornWhPej79VuokSHQIDvswUVYXq8QBqaTtL0tFoSadHJLsWNYq/8H6AOiVRlum7oKFDfYH/4f8H/M/49xDTPWV5H6JiMeDLRFFVeFuPwtPcDKXE4S7El5eQWFsry7SJZNPneVi2cDfzKBou+j7E/4qxJU/2YsCXgaKq8Hd0wl1XV9b38bUdAwCGPFERTqjLFXuvdryo2HsRFcJBdmXgbmgse7gLvrZjUN3sCiTaiwq9Yu9Vyn37RAfFgC8Dd0N9Zd+vsaGi70dERM7HLvpyUF12V1A1DtL7oKWSZaiEiADAq6Xx6otV1KVS2G9HREJV8UlrGxJcBzoCA55soagq/O3tcDc0Huj1219EeCQBURl0r63Al04f6LVeTcNrq8v497b2EldFB8EuerKFr+3YgcMdAOo6Ost2dAJRLfMeMNyN12taiSqhw+IasggMktJTfb5DvV5R1UNPg4hycXygPJhcRVC4P4mKwA1BInISrpGKoLj4NdHeVA8PVyQi52ByFcFVoWPaqcqxBU9EDsI1UjF41goqgotjAojIQRjwReCKm4rh8vvtLoGIyMCAL4KrrrJnpqPqo6gqVC83BInIORjwRVBUFZ6mZrvLIAdz1dVzkB0ROQoDvkjupia7SyAH8zQd/KQ9RETlwIAvkruujldto7xUt4e7cYjIcRjw++BtbbW7BHIgz5EjPMkNSaNyF9WlcuNaaR88zc0cUU8WLp8PnmaOzyB5JFyHO3NnmocVOwYDfp/8L3XYXYIUDnslOF3ToMXjJarm4Lxtx9h6J6mEW44ifsCQTysK5o6wp9MpeLnYfVI9HnhbWpBYW7O7lKqWWF3JHJ1wgNavlkwivrwM3earVnlbWuDmWQ5Lxu9REUvySmR2S6gu/PLoV+wuwxZ+j1wb6wz4A/C1HUM6Huf1yA9B1zTEni8i9nxx3y1gu4MdyJy+2Nt61O4ypPJaez0eRzbLNv043PAhVbbpmyW4aq1KJ4/KdbIquTZXKqiuo9Mx++P1tP2Bdxi6pu3rx24un4/Xoy+DN06WdyzDw9QrZZ2+2UcVfC8qnTe+Jtd4Gq6hDkhRVdS9HMgb8unodkVr0RL274uuFS6fD/6XOhjuZdDR5MXrgfKdT+Be8newqJV/Bb6kNeHnqVfL/j5UWm+cbJauBa/ous6jIg5p+4uIpbteUVU0fO1kRUIgub6O2PPFsr8PZbrl2XIvv/89u4CnK7GyTf+/uf8DPe4w/EqypNON6R78a/q/YDb1CmI6z5lRTTqavfjvwQ743XIt2wz4EomvLCOxumrcFi29cp6+NBWNIrYw74hua9l5W1rgbT3KcK+Qv//lUln3xxMJr71Uj+9/85h04Q4w4EsqHY8jtrAALbXTMnA3NEL1ljjkdR3paBRpBxwmJjuXzwdvayvcDTwVbaX94jfr+L+/WrG7DJKU36PirVdbpNvvbsaAL4PE2hqSL15Ygp6qi+r2wHPkCDzNzWy122hhI4FfPF1na55K6uRRP773O0fR0eS1u5SyYsCXUWprE6mtbSQ31u0uhYqgqCpUnw+exia4GxsZ7A7ydCWGv//lEtailTnMjeR08qgfb5xsxmvttXHtCAZ8haS2NjPHzsdi0JMp6Fqa+85tpKgqFNUF1eeD6nHDVd8Al8/HUHe4Txa38TiyiU9+W9kjVai6nTzqx1uvtkg3Sn4vDHgiqjoLGwk8jmziF0/ZO0b5+T0qXg804vVAo/Rd8YUw4Imoqn2yuI1PfrvN/fQEv0c1zqfw2kv1Uo6M3w8GPBFJg2Ffe/weFSeP+vFaez1DPQsDnoik9MniNhbWE3i6EivriXOoskQr/eRRP157qR4tdW6GegEMeCKqCQz86mQO9JNH/eho9jLQi8SAJ6Ka9HQlhrVoCgsbCSP4yV5+j4qWOjc6mrzoaM6EOlvoB8eAJyL60lo0ZQS/+M1j70tPBLn4EYHOMC8tBjwR0R7MLf1YSsPCeoLhv4fsEBdBLu5nkJcfA56I6BBE0MdSWuZ3UrPcJ27LxBzeAHKC3O9W4feoDHGbMeCJiCrAHPbib/EbgLERYL4v+29jWsn9nQXT79kJWhG64j4Rxua/zb9FiItQN0+DnI0BT0REJCFuhhEREUmIAU9ERCQhBjwREZGEGPBEREQSYsATERFJiAFPREQkIQY8ERGRhBjwREREEmLAExERSYgBT0REJCEGPBERkYQY8ERERBJiwBMREUmIAU9ERCQhBjwRkWRCoRC6u7sxNzeX9/G5uTl0d3dbfubm5jA4OGi5b3R0tMKVUym57S6Aqs/U1BQWFhYwMjJi3H706BGuX7+e89he0+jo6MDNmzdx7969SpRO5Bi9vb24fPkyBgYGin7N6OgopqenjdszMzPo6upCb28vIpFIzvP7+vost4PBIG7dugUACAQCxnI3ODhoPGdychI9PT3Gck3ViwFfAwYHB3H27Nk9Q9dsYmICN27cMG6Lhd5sbm7OsgIxr3hu3LiB4eHhPd/zzJkzuHbtGkZHR3H9+vWi6yOqNb29vQgEAgiHw5b7REiLsC9kbm4OY2Njxu1IJILu7u6c5w0NDRl/9/f3l6J0sgkDnnIMDg4iEonkXZGYVwg3btxAOBzetQWfbwViZt6IiEQiRuuCiHZMTEwgGAzmbARn93xNTU3h6tWrGBsbw8DAgLER3t/fj0uXLhnP6+rqsizfQGa5HxoaMn6yH6fqw4Ani6mpKQC5Kw5xOxwOY3R0FJ2dnRgZGbF0GZpb8A8ePMCtW7cKriRCoRDu3r3LVjvRl7J7zcw9YHfu3MG1a9cKvvbChQtGkIfDYWMf/MzMjLER3tfXh+HhYQCZMJ+dnc2Zjvk+sXFeTE8cORMDvgaFQiFLN5x5v9zMzEzOfrts09PTCAQC6OjoOHANnZ2dB34tkWympqaMHjGhu7sbHR0dGBgYQCQS2XWZGRkZMULY3ANn3s9v3tdv7ikT64PJyUkMDQ0ZrX+qfhxFX2Pm5uaMhTkcDhsrFDFadq8VydTUFILBIILBIGZmZhCJRDA2NmZMKxwOY2Zmxnj+xMREzmjd7u5uzM/P5x0URFSLZmZmLPvHgUzL2TzIbX5+ftdpiGVtaGjI6HG7d+8eHj16lDOi3rwsinVBT08PwuGw8XzxMzExUcJPSpXEgK8xd+/eRX9/v2XA3NDQkKVrbrcVyc2bN9HX14fOzk7cunULgUAAV69etawQzD0AIyMjRuiLAUJiZcKAJypOf38/7t69m/cx0R0vuveHhoYsy6PYddbX14fu7m6EQiHLRvjs7KyxAZA9Sr+/v5/d81WMAU8WFy5csCz82YLBoOX29evXjdA2B3gxg+WCwSBCodChayaqdn19fbh69arlvhs3buD8+fMAgEuXLmF6ejqnNd3b22u0vMfGxox98Nk//f39lpY6AMvyal6uxfOyexSo+jDga8z58+cxPT1tCdbJyUlcuHABQKbFPTs7m3OCi97eXgCwDIqbmpqytBTEYTfFdu2dPn0ak5OTAGCcZIOoFg0MDGB4eNiy/IyNjRlhLEa937lzx/Kc7MGw09PTeXeJmVvlgnl5NffgiR6A7A0Oqj4cZFdjurq6jME0QnY3XDgcNs5oJeRr1ZsH7vT29uLChQuYn58vODLefNytGNh38+ZNY1T+2bNnS/IZiapBdjibB8oV+5ps/f39eZe/fGek44lu5Kfouq7bXQRVF3Gs+/z8vNEyECfZEMfhAplBQg8ePMDs7KxlZZJNhH6+k+kQSWltDWhpyfz9+DFw8uThbr/+emXrp+qgk9zefnvn73/5F13//vcPd/vTT8tXK1GteP11XV9d1fVHjzLL2GFvE+XBLnrZXbgAnDsH/OhHwMQE8Gd/drjbf/M3dn8iouo3PZ1Zrk6eBN57L3PfYW8TZWEXfS344APgxz/OrFRaWg5/m4gO7+nTzO+TJ0tzmygLA56IiEhCPEyOiIhIQgx4IiIiCTHgiYiIJMSAJ7LTu+8CipL/57vfzfy8+y7w8GHhaZhf8+67laudiByNAU/kVB9+mPn5yU+Ab38b+MEPgGfP7K6KiKoEA56oWkxNAX/8xwx5IioKA/4Apqamci6kIi7ZWEgoFMp7ARfzNZpLbXBwsGzXch4cHMx7fmthdHTUcrGL0dFR4zsy/5g/v/n7EOfCz/7JvvrcxMSE8RnN33/2/2hubi7n/7Pb/0vUMzU1ZTx3t5+S/R91fefno4+Ad96xPv7xx8Bf/VVp3osAZOYNcTGlQkKhUM7FkPLdZzY4OIhQKGRcpz3fj5i/9jPdUsu3XJVab29vwWXYTKwnqDR4JrsDEOdaF9dfDgQCCAQCAKyhMTY2ZlyMZWhoCOFwGL29vZbroJuvnS7O5+405vPLZ8u+SpX5fPLi84dCIeNa1uIiMwD2XKlmn5s+30rvxo0bCIfDRX2OmZkZdHd3Y2ZmBu+//z6A/CEv6r558yYuX74MwHphDvF5Cl1Up2TOnMn8fO97wB/+4c79t28Df/mXwIkT5X3/GtHV1YXLly9jcHCwqMscCz09Pbh79y4mJiZ2vUjMyMgIHjx4gKtXr1qWb3GRJSD/fFhoA9S8XnGS3dYTZVm3PXyY2XV14gTw2Wf7e62iWG8PDGSWK8nwRDf7NDg4iL6+PszMzBgL7MTEBObn53Hp0iW8//77OSv+3t5eXLt2LedCKr29vbh586YjQ91MXFVqr0AbHR3F+fPn0dPTg9HRUUv49/f34/z585ar2AGZBX9+fj7n6naRSMRyCUvBHPrmFrrY2MrH/BqxEjJfdUvUDQDXrl3Le1Ec8T/Mrh845Ar33Xcz+9iFQotj9vP+9m+BP/mTzN/mldU77wB//dcHq6VGTExM7Dq/mIkrK5rnxf7+/ryXXwUy88LCwoJl+sFgEIFAwFg2hN7e3px5LRQKFZwHq9Fu67i5uTlLA6eQgheqOkjAj48DP/xh7v2SBjwvNrMPt2/f1q9cuWLcPnfunOW3ruv6+Pi4fv/+feP2lStX9Pv37+e8VrzuyZMnZa768My1nzt3zvJ5r1y5op86dUp/8uSJ8VnzuX//vn7x4kVd13X94sWL+vj4eM5zzN/HxYsXc6Zlvu/Jkyf6qVOn9Nu3bxuPnzp1ylJz9ntcuXLFqMH8mosXL+ZM6/bt25bPee7cOctnEMbHxy2v27d33jF3yhd+3j//s/V577yz81ih+6lou827um6dfws9N3teOHXqlPG87PnxyZMnOfOSrmfmcfM0xsfH8y4r1WK3dVy+7yDfd2teDi0++igzz584Yb3fuqMr/2PZy8nAwJ6fpRqxi34fBgYG8OjRI0vXmfg7uztNtBCvX7+OUChkdPdmP8+8BSteY25hiK3XUCiEoaEhjI2NGd1g5i3bqakp3Lx5E8FgENPT05iZmcHY2Bj6+vowMDCAiYkJPHjwAIFAwGh9ZLc8zbWJS73eunULAwMDuHr1qjHdrq4uDA4OIhAIGJ9R7HoQnzdfS9f8HrOzs8ZnNHexi658AHmnIe4bGxvLO/1CRHdo9vdrfu/R0VGjdX/p0iXj/2V+zuzsbM7/cL+1HMgf/EH534OKInp+uru7MTk5iUePHuHOnTuWVqbYtz40NGTMT+b55OHDhzh79qxlumLfc7G9QebdfcPDwxgZGcm7nGf3VgEweiTu3btn7LYSy/XZs2dx584dY9rm7nVzN3wwGAQAYx1TqIs+u5Uuai2L7K53cZ+uZ1rvQKa1nt3LJWPrHWALvhQKbmHqmS3/U6dO5bTehSdPnlheL1qmxUzn4sWLxu3bt2/ntELNrYHx8dz8aJkAAAaWSURBVHHL4+Pj4zktVHNL4dy5c3lbGKKO27dv57RyC7l48aLRai/0/L2+JzPRW3DlypV9teDFd7vbT6HWhu0teF1nC76MimnBi3lE9PiYZfcoiXn+/v37xnyavbxlz2unTp0yWuyF5k+xfIyPj+ddVrKXczFdcdvc42Z+3Nxzln1bvI/4DsRj5nVBIRVtwb/3Xub2m2/uPOfNNzP3vffezrL23nsF65UNW/D7sNu+u3wDYoaHh3Hnzh1MTk7i7t27uw5C6e7utmxpm7eqzcz7wcVYACEQCOy69R8MBo3Hz58/b3wW0XIwb1VfvnzZMm1RUzAYtLRoz5w5k1N79vdk3gd+/vz5nO9qcnISk5OTCAQCuHTpUs4+z2yTk5O4fv260RrJ16Mi3Lhxw1Jbwf15yB30J8YeXLp0yRhEaVsL/u/+znq7ubn87ymxfMtr9n51Md+I+VEMEA2FQnnnAwDGoNJAIGC0gM3L7MTEBDo6OhAMBi3LtnkA6cjIiLEsinEm2S3ejo4O3LhxA5FIJGdgoHk5F59jYWHBcnu3cT/Dw8PG4+Z1zN27dy2P9fT0GK34g8r3PWb/H8Syt6fPP8/8fuONnfveeCNzLol8z6sBDPh9MC94+YRCIUxOTloWuJGREUvXW3YAz83N4fLly5bQEQHa3d29ayBVijlwC63YpqenMT09bawE5+fnjQXV3E2Z3V0nNmJ6enqMgDV/f/m+n2zi+5qbmzNWPua/CxEr20IbRQsLCzh9+jQePnyIQCCAnp4e473yDZAqq3/6J+vt73yncu8toewjL8wDRLOJUJ+cnAQAy3yQ73ViozB7w29gYMBYlszvL9YPw8PDRdcv1iVTU1Po7u4ub7d3EXYbMJfv/uHhYZw/f95yVA2Q//vc62gbw/Hjmd+/+MXOfea///RPMwNVf/KTzHPffnvnsR/8QMpueh4Hv0+7HQs9NDRkBGChY6OnpqZ2PcY1FAoZ++/C4TAikYhlOubjZm/evJmzH+8genp6EIlEcqYt3Lp1C+FwGIFAADMzMwiHw5afmZkZo2VvXljHxsYQDoeNFSMA43lieoUMDg4anzsSiRjf6W7f3eXLl40Wz9jY2K7H6QPA/Py8cZhSPg8ePMCZM2cwMzOD06dPA7Aep5vvfAhl8dOfWlc+b77JffIONjIyknfjcmpqythQNh/r3dPTs6/D84CdfekDAwMYGxvDgwcPjMdmZ2eNZWdubg7T09PG/HsYp0+ftvTMiZ4MIHOoYfZ6Ybd1hviOivncRW9Ii8D+8MOdUzd/+GFmlP3bb2cOORUb8z/8ofUUz5JiC36fxJa32BI3bznna8FnGxgYQGdnJ0ZHR/MedtbT04PBwUGjK190ic3PzwPItA7EY/39/SXbap+cnMTQ0JDlfc0rDaHQVnq+rrqrV69aagUK9wCYiRWH6B4sphcje5fGrVu3MDExYTm2uaurC/fu3TNaG4FAALOzs3kHEwGZDYv5+XnMzs7i1q1bmJqaQmdnp9G6GBgYwOjoKKampsp3XPL4OPCjHwHr6zv35TvMhxxNtELNPUDBYPDA51K4dOmSZTky704LBoO4fPmyMV+PjY3l7ZnYr+xBxsFg8NBd9CWn69bAzj6E7vbtTLd99jJk7taXCAP+gMwhnj36fC89PT2WBUWEX75pZxOj1rPl6/7P3lVgJra4zTWZb09MTORtYecbFzA3N5d3P3SxJ7oRo+4DgQAePnxobPGbu/3M33H2CXB6e3vznuxGjCoWXfHm8Q/5ni9GJY+NjaGzsxPBYBCPHj3C8PAwQqEQHj16ZIwhEN+NOIKgZAH/3e/u/J297xAA3ntv5/h3OpBCG5j5jm0fHh42djeJ+SD76A7z67K7nOfn59Hd3Z1zxMq9e/eMM9yZlynx/GzmlrOY1m4neCq0QZxv3WGeTva6J3u9kr3+6e3tzekFM481CgQC5TvPx5kz+c8bsdepXd5+29o9LzO7R/lRccSI1XIxj2bNd4w5lUn2KPpCP83Nuv7++/mnwVH09KXx8fG8R7+Ugjh6xfxe5Vwn7Wl1defvR48Of1tCbMETgEx3enZPhBNPh1lTmpuBb34T+KM/Av78z3lqWrJVV1cXOjs7C+4aqKi1NaC/H5ieBp4+3elyP+jtH/8487dkeKpaIiKqPo8fHz7YzbdbWipbfwUw4ImIqDo9fgycPLkTzoe9LRkGPBERkYR4HDwREZGEGPBEREQSYsATERFJiAFPREQkof8PSmR5zkK6bccAAAAASUVORK5CYII="},63703:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-IOC\u4ecb\u7ecd-e04e26f613b86eea726c0bc090a9b03f.png"},46457:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-IOC\u5b9e\u73b0-53544eabe463f018e3e17c065398f718.png"},25771:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-RedisTemplate-a36e43021c85c413db40bf0619aee0d0.png"},68865:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-\u4f53\u7cfb\u7ed3\u6784-7c3c080fba1151f88878e584542eaeb1.png"},11534:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/Spring-\u6846\u67b6\u4ecb\u7ecd-b928155692b639742e1fd527a799d445.png"},82485:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringBoot-IDEA\u6784\u5efa\u5de5\u7a0b-401777636467b3536821a81c61f5b189.png"},39077:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringBoot-profile\u6fc0\u6d3b\u65b9\u5f0f\u865a\u62df\u673a\u53c2\u6570-6ac1136583aa96ddc38155cd33d68cb8.png"},82044:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringBoot-\u81ea\u52a8\u88c5\u914d\u914d\u7f6e\u6587\u4ef6-7d1e1f91617e7119ec0aa517bf40d886.png"},33331:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-HandlerMapping\u7684\u6620\u5c04\u89c4\u5219-a67332bbedf1d85d17571d890a73f290.png"},60907:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-MVC\u4e09\u5c42\u67b6\u6784-6c0fb3ea6d8048cc5b8ac4a25baa169e.png"},436:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-MVC\u529f\u80fd\u56fe\u793a-f2160de7a89850a3d4cfcf635c89b4e0.png"},77010:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-Model\u548cMap\u7684\u6570\u636e\u89e3\u6790-f72ece0e8fffa6c323ba746a467c4bcd.png"},58160:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-date\u6570\u636e\u7c7b\u578b\u8f6c\u6362-7e399a216b3a925f12c93650ad829b1a.png"},17063:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u4e09\u79cd\u5224\u5b9a\u7a7a\u68c0\u9a8c\u5668\u7684\u533a\u522b-2af880dc1befa5ecc05a787f7807f951.png"},86403:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u4e0a\u4f20\u6587\u4ef6\u8fc7\u7a0b\u5206\u6790-a667698ea008409ac0f261bff7648e0b.png"},10997:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u591a\u62e6\u622a\u5668\u914d\u7f6e-06d3023cb42196237f0deac3fffbb3f1.png"},85819:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u6280\u672f\u67b6\u6784-72500a7ef256fcd45ac8709f9756f106.png"},2023:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u62e6\u622a\u5668\u5de5\u4f5c\u6d41\u7a0b-e674b65e2847a00f8a451e01df59a993.png"},70794:(n,e,s)=>{s.d(e,{A:()=>r});const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABPkAAABrCAYAAAAFOFdaAAAfpElEQVR4nO3de5CU1Z3G8eOWSWCzVQkgGhhLM3KpCDoqiCB42yDEiEBAQCYkiorKyCWCMOOIKXfjIs5A0MBYGBFDTAwICAsjakB3vaIgg0AEU3KZaGUgCbf8EXf4I1Uuz4Hzevqdt3u6ey497/D9VHVNX06/73nfxlTlqd/5nTO2VO34wpzQp1eBAQAAAAAAABA//5LrCQAAAAAAAABoGEI+AAAAAAAAIOYI+QAAAAAAAICYI+QDAAAAAAAAYo6QDwAAAAAAAIg5Qj4AAAAAAAAg5gj5AAAAAAAAgJgj5AMAAAAAAABijpAPTeLYsWNmxMhRJv+Cbua++6ab2traXE8JAAAAAACg1WrWkG/FylU29Il6EARlp6x8rr1/V119ndm7d1/GnyP3SkpK7W9U35jRo8fa5wsXPmnHHz58uDmmBwAAAAAAYqDFVPKtXVdpfjjux7YCDDid3H77bfbvW2+9Hfm5wjwF5KPHjGrOaQEAAAAAgBjJWci3fNnzpnr/HrN7104zfNhQ+9727TvMxtdez9WUgJz4zne+Y//u2LEz8vP/+d837N/v/vt19u+UKZPsfztnnXVWc0wPAAAAAADEwJmZDF6zZo1555136h3XrVs3M3HixLSO2bZtW9N/QH9byQecrqZPu8/Mf/wJG+CFVW2tMmNGjyLUAwAAAAAASWVUyXfTTTeZdu3apRzzta99zRQWFjZoUj7XU8499Nrnb/DgHnqt99XjT73+3Hv79u1PGBvVBzDV8Xx+f8HNm7ckzDPc/y6dY0aN0XGbUrhHYvh+6Bp0LeH+ifpefcd67733k563vmsNb9qxdOlzCfNL9zeKk0GDBtq/4SW7bqnukCE3Bu+5ex0W/g3830l9/FxPP//YUb+n+v/pkUr438Qf//jHhM91HeEx4R6Cyc4Tft8dy81XD/8+6dypzhX+vL5rAwAAAAAgjjIK+b7yla+YcePGpRwzfPhw841vfCPtYypIWrCgwj6/9NJLzKDrT4YdLsh56qmnE8brtQt79N2hw0bYZb710ZjrB30vYayqB0tLZwXBloKmXr2vqHM8vdb7yUK3sYXjEuZZU1NjKiqeTHuOyc6r40YFalF0zkGDb6gTdoTvn7jwMxx2hPsiHjlyxB43TN/z56WAM3ysSZOnRl5zpteqOf3nzx4JXu/fX532bx4nWrJ7ee/edZbsuqW611xzdcrvK8TTb6BlvHp8sOW9hN9JIeLWqqqE8Gv37o/tX1UK+sKhos8FbWVlc4Jz/Xrps3Xmctv4O+wc3BiN73PFlUn7DqajqGhycEx3PzTX79841LzycmXCuRydL/y5/g0R9AEAAAAAWpuMe/Ll5+eb/v37R36mZbp9+/ZN6zgKdRQWKJhSkKSA79kli4NKwacXP2ODHL2/rWqL/T/nGze8avLy8mzws3PnH8y2Dz8MQijX40+PHwwfFnnOiRPvrtMH0B1LwdZjZeX2PZ1D59JYnVtzEH0eVS2mY+mY/titVdtOzO1AvXP0z+vm5wcVy5Ytb/QKtcqX1tvrjrpOvy9i375XBPMJ37dN724KQszKyvX2Pf+38oMWJ9trdYHSE0/MN7t2787oN48TbayhJbu+lStW2aW8qahSTd9TkOVoaa/umwuzXN8/FxrK+vUv22P74aqryOvR48LIc7mQ0PUHFAVu7vj+XPzlxVpurHMpAMyWljL7x9S5dH0KGd353bncOIWNug/+54888h/2msPVhwAAAAAAxFlWG29ELdtt6DLdB0qKg2Mq6Hn//c32uaui8wNB+fSzz8z5550XfF+hoavwu+22W+vMTwHU3XdNsM/VB7Cw8MulizrWJ5/sCarDpk6dbLp27WKf6zhurD7XuDB9rmP6YzVPVcLVN0f/vKq6Cy8pPHTo8InjHK33/vmBnf9QmObTuRXQuTm66j+/uq66ujrhO6q+05gePQuC3om6Z8ePH08IMf3fUBWZLvB0srlWv7pTMvnN46bg4ovsX1ftpkBN1XeXXFKQ8ns7//CRrQL0gyz/eC6YU/jlV+0p6CosvCXhnDpWqv5/7n1V1WUyF9F1hKsJMxEOHt25klU5uhDPDyTFze1vfzuU1TwAAAAAAGiJsgr5FOiFl+0OGzYso2W6qsLyK9/un1Gc0MeuPgqiVGnmh1gKoBRERfXay5WGztGFhc3p4IGDdm6ux5vCtOYQda0K9dq0aRO8jsNvni23ZFcVdpLuUt2//uWvNjwLL9XWMlVxoZqW4LqqPYV6LsxThZ1bJqzKwd6X9056Lo1XeOyfz6+I01ySOfvsjvXcgcykOpe4EE/LhMP3Rv7y19TfBwAAAAAgTrIK+UTLdvv162efa5mue54JVV6p+kv8PnY+txQ2XKFWUjzTfq6/4eWhCn60JDUVVaI5fnVYU0h3jn6fM/+hYKsp+Mtr/YeWxapKT8tnw+PClYHZasi1Zvubx4GW7LogLp2lunLOt86x4WDU/dTDVa65SjiFcgr1XJinCjuFfq5yMFz5FsUdW/NTmOgqATWXZJq7cs6Fin5vQP+hkBMAAAAAgNYi65BPVL139tlnN2iZrl+Z5YIahX/9+vVNeM9RCKjdVl2lmdsMQ/+H3fXsk/CSU7/XnJYDuwBL4zt06GC6d+8WVBX6veH8sfpc4zJR3xz982oDEr+aUc9ffvmVjM5XHy0r7j/gZE9F3RP1PvT9+tfP2WvWslktnxUtQdZv4i+jdvyAVPfJhbSup6KvMa41k988jlzApt51CtzcrrupfOucc9JaBqsqPN0zLXNV3zx3LoV/+r4qBxUWJluqG0V98vwNQ7REWMeK6nenMf5S4HPPPddughEW9V4Ut5lIst567jxugxEAAAAAAFqzBoV8WrY7bdq0jJbpRrl55MggqHHhj/+eera5ZXZamrl9+/bgu24Dj3DPvuuuvbbOedxx/P5zrv+eX1Xo9wH0x/o95zKRao7hPn7+Drl6/o/PP8/4fPXx++X5vfH0+O+16+z7HTq0Nx07ngxJou6bU1BwccImJvp9ku3q21jXmslvHjcuiFMIl6y3XZiW8+o7WpbqU/gV3uhC1XuqEPTDPHdO/c71LQ1WxZ6/Q264b6Dmq2Opus8PHRXO6ppuv/224D3Xo88/ngs305HqXHrtNh/R5hvhIHD06LHhwwEAAAAAEGsNCvnkq1/9aoMnoZBNYZu4Zbt5eZ3Nxg2vBAGSz210EcUtLQ0v+9T7T1YsSHhPAYC/ZE/f8fsE1nfMbIWPF65I88f5m040FoVta1avilx666r29JhbXpYwJ/VRDH9Hv4OW9/rv6zsaG76P0hTX2ti/T665ZbRaupsu92853JNPlXY+Ve8pRAsf252zvspBLYFVaObOoWBRu9v64aDmooffC08Bor90WPQdF8K5cQr+MllGG3UuhZguwNSx9LnuhX9vtMMuAAAAAACtyRlbqnZ8oSd9eqXewTOOtHS0tHSWrTBTEPTsksWx34EVAAAAAAAACGtwJR8AAAAAAACA3CLkAwAAAAAAAGKOkA8AAAAAAACIuVbdkw8AAAAAAAA4HVDJBwAAAAAAAMQcIR8AAAAAAAAQc4R8AAAAAAAAQMwR8gEAAAAAAAAxR8gHAAAAAAAAxBwhHwAAAAAAABBzhHwAAAAAAABAzBHyAQAAAAAAADFHyAcAAAAAAADEHCEfAAAAAAAAEHOEfAAAAAAAAEDMEfIBAAAAAAAAMUfIBwAAAAAAAMQcIR8AAAAAAAAQc4R8AAAAAAAAQMwR8gEAAAAAAAAxR8gHAAAAAAAAxNyZuZ4AsrPol8+YzR9UmW5du5jpP5ls2rZtk+spAQAAAAAAIEdiVclXW3vczH5snhk/oSjhcX/xLHPs2N9zPb1mo2vdu6/aPv9zzQFz4ODBHM8o2rFjx8yIkaPMipWrcj2VZrF58xaTf0G34FFWPjfleH2ucafL/QEAAAAAAE0nNpV8ayvXmzVrX8r1NJqdAr3/mjPXdO2Sb4rumWDfa9fum/b1kaNHzbl5nU3nTp1yPEtI375XmOr9e0xtba0pLZ2V6+kAAAAAAIDTSCxCPj/ga9u2rZkxbYrpckG+fa3qvqXP/TaX02sy+/ZXm3mPL7ShkUI9nwI/F/ohnkqKZ9oHAAAAAABAQ7X4kE9B16sbXrfPO7Rvbx4qnWkr2Rz1oiPsAgAAAAAAwOmsxYd8H+3abSvZ5Jqr+ycEfMn4FXBOeIMKtwxWS1712Q+GDTEVixYH3+nbp3cQHmYy1gkvL062QUbUMuTJRXebD7ZW2Y01HD3XQ+caf+uPzPxfVJg9e/fVCT79uTrhMap+9L8/qegu8+SJ63Hf8efqj426zkztPXGc8bffaWpqaszyZc/bJa6OetOVlJQGr8vK5pgxo0clfN8thV27rtK+zsvLM0t/tcR0PTFn/zib3t1kiotnmEmTp5rt23ckPV661G9vbOG44PWll15inl2y+MQ9bZfxsdSL76mnng5eh++DG/P++5vrnEN9Du+48y7Tr1/fhCrAdO4dAAAAAABovVr8xhsHDny5qURe5871jldo9sij5QkBnyikml78oA0Aw/TZ3PkLEr6jQG1r1YcZj3Wbg4SDO33voYcfCTYISTauITSHaTNLEwI+0Wu9H3U9+uxns8sSvqO5bnjtZPWkNvXQ5h6izT4assGJC/gu793L7N61MyHYUqi1bNlys61qi+1rt3HDq2bBgoqETSkUcP1w3I9Np86d7Bg9pk6dbI+pY/sUAg646lrzQEmxHacgTSGYwrps5r21qio4p+Z+/nnn2bBNc8qUwjl3jQopo1x37bU2nPzkkz0J7+v1oUOHzc0jRwbvpXPvAAAAAABA69aiQz4FYUdPhUrqxVdfFV94ae/jc+eYpc8sMj99sNh+X8Hc8hUv2uOGqXpOY0cMvyl4T9V0UVKNVTimkEzn03k1TvPQfBSkvfXOu3ac+gjuORVMqUJO476c68klyG7e/phklXQK35a9sCq4V+Fziz6PCul0HRqr63I+2vWxvU/a1EObe4j6AqZTSRk9v2NmZnGJDfjmzJkdXJcoRKusXG8DOVe1pso8BXgKr1yQtvFU8Hj3XV/eg6E3DbHHfHH16jrn9CvkCgouNsOHDTVvvPlmxnPXXCbdWxS81twLC8dGhnCNpXv3brZaMDxfvdb15p36TdK9dwAAAAAAoHVr8ct1M+Ev7S28ZVQQSGmTjoKLetiKO1WlqTqtvbcEUstTe/a40D6/5qoB5q23N9lATgFjOBBMNVYBmsIx0TxUURimykSNU1WcKIAbO+bLZZVuQ5FMKeB01Xg3DB4YHEf3QMucVTGozzXOzd+dX9chel/Xp/Dx6NFj5vjx4/b7sx6YkdWcnEOHDtmqN1W/hQM+2fbhh6Zjx7NssOXTeFWtHTly1LRp08YuwdUyVX/5qo6lyr6DJ+6r7rk7tgIy/3jJxmWrQ4cOSavwGoOuUUGiC+r0Wn+1hFfvu/mnc++yWVIMAAAAAADipUWHfKpoax/0kau1IV62IVhLoTBQ4ZnTvn07G2C1ZvPmzbd/FdBFhWvV1dW2Kq5X7yvqfOaCNN2zTz/7zC7D9fvZOarSy1S4v5+TrEde1HmbUq/LLrPLblUtqPm4qsFB1w8MxqRz7wAAAAAAQOvXokM+6XN572ADClXNqeos2yWjzSlqJ2CnIX3t4kibQKiyzG1c4W8YIfn5+fVuZKFATscIbzjREAocn3hivn2knH/5XLskVr3u3AYfrr9gU9KSXC3N1RJdhXz6G65kTOfeAQAAAACA1q9F9+QTt4RUtNxUO8f6IZmW0y765TP2vYt69ggqxX6/8fVgqa2WqO78aLd9rv5y6jPXFFSRd1HPC4O5Ll+RuPHBCytX23kq+FN/O9HSWPXnc7Q5RtQGGVFLh32qcHS99xSGunukv3ot+jzTSki3Qcj4CUX2PmdLIZXCPlXDhTeE8JeWJhNebpspt9S1/4D+GS3Vdd8bOnRIwg6+zcH1/tP59+3bb/9qQw5fOvcOAAAAAAC0fi2+kk9Ldu+9Z4IN9xScuZ1ifS7cUoClfnTqP6fwrGjKtNCx2pqxY262x/SXzDYmv0+fKhBdFaKb5+Drv2ufqw+f+vJFjXMbYKhv4L+e2jDEXY824Bh/64/qnFfBofoQVix6OvIeietTmCosDIvaXTfbSsoxo0fZ5aXa5VbhlL8phirWtDFHqoo07Sir6rkFCysyruZ7evHJgNJf6poOBbeaqwI21xtPO/S6qsSm5nrtrXrxRTsP3StfuvcOAAAAAAC0bi2+kk8UKv28fHbC7q8+f9fX4UOHJOxK66gacH75o03e08/NVWFcmDbAcPNMNs7fRVh/7504Ie3Ks8t7X5awm67jdhrW55lqrN11nalTJtv+eQrJXEWfWzarpajqLZd/QbfgoaWyjirpKtetsYGbP0YPBW8+16fOfa4KwN89/5uMQzDN7eGHf2qfu+NpM4x1a1fX6XmnuerzHj0Lgt6B4fkpKBwxcpR9b9DgG0xNTY29F3qt98O74Wq+ui86VlQVYrr3DgAAAAAAtG5nbKna8YWe9OlVkOu5AI1C4aGCOCrbAAAAAADA6SIWlXwAAAAAAAAAkiPkAwAAAAAAAGKOkA8AAAAAAACIOXryAQAAAAAAADFHJR8AAAAAAAAQc4R8AAAAAAAAQMwR8gEAAAAAAAAxR8gHAAAAAAAAxNyZjX3Af155ZWMfEgCQhTPfey/XUwAAAAAANBMq+QAAAAAAAICYI+QDAAAAAAAAYq7Rl+smHJylYgDQrGiZAAAAAACnJyr5AAAAAAAAgJgj5AMAAAAAAABijpAPAAAAAAAAiDlCPgAAAAAAACDmCPkAAAAAAACAmCPkAwAAAAAAAGKOkA8AAAAAAACIuTNzPYFM1NYeN/N/UWH27N2X8H6H9u3NQ6UzTbt238zRzHIr2X0Ja9u2rZkxbYrpckF+M80s3vaeuJ/jb7/T1NTU2NfDhw01c+bMtvcx1fiOHc8yzy5ZfOLfY7vmnG69ysrnmqeeetqUlc0xY0aPavbz19bWmtLSWaZT506mpHhm5JhczxEAAAAAgLiKTSXf2sr1pmjKtHqDrKa0b3/1iTlMt3NpDot++Yy5v3iWOXbs781yPiTq2rWLeeftN0z1/j1m4sS7cz2dSCtWrjIjRo468W/kWK6nUq+amgPmT59+am4eOTLXUwEAAAAAoNWJRSWfQrU1a1+yz8PVaKpiW/rcb5t8DlurPjQVi55u8vOIX5mnKsX6tG3bxsx6YEbw2p/riOE3meFDhzTZXPElFwq2VKqeS1ZB1xxeXL3afPv8801eXuekY3I9RwAAAAAA4qrFh3yqnnt1w+v2edSyXAVcRfdMyNX0AKRBlYbvv7/ZFBaOTbrcGQAAAAAAZK/Fh3wf7dpte3nJNVf3T6vvnoLBeY8vDL4n3bp2MdN/MtmGgqIlsP81Z645cvSo/ewHw4aYikWLg+/07dPbhodR/e5UVaiHXyXnVxtGnc//fHLR3eaDrVVm8wdV9rVfnRiuGNT8ps0sbZS+g/6x3fU5Whqs+WguU+69287VVRJOKrrLPHni3mguUdcWPobjn8O/j+Fzp8P1c1u7rjJ4L9y3TT3xZswsNvPmltuqMfV2k3AvvXTHpSvT3n1aYltSUpr0OmTz5i1mbOG44PWll14S9PlTYHbHnXeZ7dt3BJ/36n1F5Fh7/FN97pzly543fft+OT7V3LRM2a+sy/bebXztZFA/6PqBKc+Xao7h687LyzNLf7XEVlBmOk73RLR02P/tUt0bAAAAAABashbfk+/AgYPB87zOyZf5OQrTHnm0PCHgE4VL04sftAFgmD6bO39BwncUVikUq4/Cq9mPzUsI+NwxH3r4kch+egra/DBM512+4kV7rKakENEt/927rzqYm/7qtRRc1MPkf/vbwXcU7P1sdlkQ8ImuTYGdm6++r96B/jWJXuveaNyBgwfNn2sO1Dl3up791VIzefIk2x9PD4UxCocUEvkOHz5iBg2+wT7XuG1VW8ynn31mFiysyGpcOtLt3aff+b77ppsFCyrMxg2vBtfyb1//ug3PHD3fWlUVfL57105z/nnn2eBKAZbCuzWrV9nPFBAq1NP83Xh95m/6oZBO7+ucCrxSzW3ZsuXBsfRX1Xd63/9vw927/Pz8tO6dvrvp3U2mX7++dTYjUbjp5p1qji640zHc2Mp1a2zQmPDf7eYtNvBUxaAbN3XqZDtffeZTQDmzuMQex93L+2cUJ/wWAAAAAADERYsO+RQOHT0VBqlCqL4qtvDS3sfnzjFLn1lkfvpgsf1+qjBN1XUaq+o8R9V2rt+dPnc0RmNVxbfhtddt6KXj6zx6X+fV+RWMvfXOu3XOpUq4RQsfD8aJAjAFYZf3vsx+1u1U1ZG7jp+Xz27w7sH6vqohRXNzgaf+uhCvz+W963xPlXe6Ln9euuZduz+2z5evWGW/H3XP3bjOnTqZc0/1YuvaJT/ja5l0b1FCJVZBwcW2ekzhUTjQ9avPFCop8FFYFd6cIt1xjWXnzj+YrVXb6lSV3Xjj9xNe67mu19F91NxUmfbJJ3uadG5zy8uCIE5/HygpttWT+tyne+eqDzVO4dvBAwfr/BbSGBtuHDly1Bw6dNhcd+21wXs6r34/Vz2ocyuk9OcmQ28aYv+t6DN/fgoT/evtddllp851JOt5AgAAAACQKy1+uW4m/KW9hbeMCoIkVbCpQk2VZS5Ma+9VFCm46tnjQvv8mqsGmLfe3mRDKwWMCgTDy1IdffbRro9PPa+1FYRhfiWi871BA+0x9VDopipAfb++6raozT8yXfp6Uc8eNgjV+RRiKlTUX/Hvg6PgbuyYk4GJ5qu5u6XLNQcO2HvrqgDd0uIwjdN5/M1BGkrBTqfOnWywFOYHQaIqOAVECor8SrJ0xzWWN95888R96JVy44lkOnTokLQKrzFobh07nnXiPIkbvXTv3s1WCqpSz1/GGr53qaSz4UZ9NC/NT0uYky2pVZiooHLqgMkJ7+vfSv8B/W3Id/z48SAUzPa3AAAAAACgJWrRlXwKldqfCuoUSinEixsXFLYULvAUhXP7q/8UhHQX9bwwaaDZEFFBZ6a0hPKqq68z+Rd0Cx5+n7mWTv9+FUgqmEyn5596xvnXquWmrm9cU1HI2aZN9O9fXV13mXs6GmvDDYWuv3v+N7YiT0Gf7on+PUQtrdV1RHEBLgAAAAAArVGLr+TT8lHX600Vdqq0a+iy1abQGBtj1EfVcFoK21Dunv5fba3Zu2+//asARlV+9VFVnhPukZhsQ46GchtbDB06JGETCAVhUZV8LZFfeVh76n4no+uqrFxv+9O5ZbzuHuSK+u9lw224oYrAhtI9e+KJ+fbh7oceUZtvRImqVAQAAAAAoLVo0ZV8ouWjrg+cloNqR1x/Wauq5LSrq95TSOXCk99vfD2ooFPPuZ0fnawCVF849YdrCFeZpjBL1W9ubupN53th5eqMN5gIUwB3tJF7xLl7qrDpd8tX2r+q7lOVX5jfV1DXoqBVXI9EPdRjT7SMd8OpUEd0/10PRLdByfgJRfb3ysS2D09ugJJtT7d0l8k2ZDltOhSUaTlpTc2BpGNc5ZsCzXSCK3+JcUNo+W3U3NQDUMd3/eoykWrDjYbSvVG4J66Hnn43/X76HZtrHgAAAAAAtBQtvpJPQdq990yw4Z4Cp6i+b27zCoVUNwweaHvcKXAqmjItdKy2ZuyYm+0x1ZsrEwqz3OYdqoLTQxtw+D383Pv+vAZf/92srtlfpqxef41ZKejCyT3eUseoDTcc3c/w7sG6zy4UHDxooA1RNdfwWBfQRu2um+61KMjSUlWFfV1PhZOlpbPshhBavpmKdlTVsl71cUtVPZfuuIYYdP1A2xdOO7o+u2RxEDi9/PIrpnv37vbatFxW1+s2ANEYzU1LVKOoV5+o751f5ZgpbWSigKyi4kkzZ85sew90/sfKytMOHMOCjUYmL8l6Xo7ugfoC+htquPDX3QO3QYnulUJL17ev8qX1jTYPAAAAAABaqhZfyScKg7S7rL/Drc/frVU73rqdXX0Km+aXPxpZrZYOfe/O8T9OOjdtgBGmTTWyDeXG3/qjICBrCgonXTiqv8nuiz774djRCe8p3NR9dvRd3duo+bpNRhqyu67CmrKyOaakpNT2YuvRs8CGOdpFNYrr2abH/TOK7bLXqI0a6hu3YuWqhP5/ChV1br3WZ5mOc33lFOL16n1F8J1/fP55EKLp3+3DD//UPndjFAyuW7s6cuMNfe/n88rted3xRowcFewQrL967ff1c9ftj9N5Fe6Jm7vOr/ucbXjYmJWR7nfx+xTqvlSuW5MQQGqcglr/t40aBwAAAABAa3PGlqodX+hJn14FjXLAf155ZfD8zPfea5RjovFpCfO8xxfaqrhwaKeltfN/UWEr/Zqj12BjcX3aFHpFhXqZjkP2FB7ecedd5oGS4ozuMb9Nw/G/wQAAAABweopFJR8a3wbbszD9DTeATGS74UZ4CS4AAAAAAEhPi+/Jh8ajPniut6Hj99YDGot65/n986IoZH7hhZXmlltGBz0AtbQ22x6AAAAAAACczgj5TmPhZbpAc1Kwd9VVA8ygwd+3vQJFfRYbsoEIAAAAAACnK3ryAUArwv8GAwAAAMDpiZ58AAAAAAAAQMwR8gEAAAAAAAAx16Q9+fxlYwAAAAAAAACaBpV8AAAAAAAAQMwR8gEAAAAAAAAx1+jLddnNEQAAAAAAAGheVPIBAAAAAAAAMUfIBwAAAAAAAMQcIR8AAAAAAAAQc4R8AAAAAAAAQMz9P1yB1e6IVGdYAAAAAElFTkSuQmCC"},72520:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u6d4f\u89c8\u5668\u652f\u6301\u63a5\u6536\u7684\u6570\u636e\u7c7b\u578b-c4cca42169dd767d9f64b4e546f781b7.png"},60139:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u83b7\u53d6Controller\u5904\u7406\u5668-182c0ad0f1b3bdf2dcce280fe2b0dc1b.png"},2646:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u8bf7\u6c42\u76f8\u5e94\u7684\u539f\u7406-c6c20e4c1876c5f9e9316c2f11b1c7a5.png"},23127:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/SpringMVC-\u8fc7\u6ee4\u5668\u548c\u62e6\u622a\u5668\u7684\u8fd0\u884c\u673a\u5236-9f4eaed4c4839692755a94f1977eb90c.png"},26789:(n,e,s)=>{s.d(e,{A:()=>r});const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqgAAABmCAYAAAAHxWOxAAAO9ElEQVR4nO3dTWwbZ2LG8UfWF2WaMW1LRJWEtSTC2oJbwE5hFmkhwA5yK1DCi7Y6yIfdAIF93OVB8nHPkg9Cjg72kIt9YBfYwAUK9LCwAxhoALmw060FxC4jZZXYLv0hOjQtiaLFHoaUyNGQGuqL71D/H2DApIbiK5DvzPN+TluxWCwKAAAAMMShZhcAAAAAqERABQAAgFE6ml0AAAAA7J18YU0rq0XlC2uSpJXCmvKrtWd4dnW2SZICPismBnra976QNgRUAAAAD8sX1pRdeqvs0ls9z+aVLxT1IruqldLz5WC6U4Gedp0IdKq745CO+Nr17vFuBXwdexJg21gkBQAA4B35wpoev8zr8eKKHi+u7GoI3a6BkE8BX4cGQj69e6x7x7+PgAoAAGC4fGFN//39a80/WzYikG5lIOTTQF+Pfvbu4W29noAKAABgqHxhTXdTWX37+I3xodRJV8ch/f3PjjYcVAmoAAAABnqRXdV/fPNC2aW3zS7Kjr17rFv/eLbX9fFsMwUAAGCgWw8WWyKcStLjxRX96c+vXR9PQAUAADDQUt57Q/r1fP9s2fWxBFQAAAAD/fBipdlF2DVdHW16+ISACgAA4Gn35nP64UVeh7v3f6P83XT0cIe++78Vff3oJ9evIaACAAAY6tsnS/q3/3qptWKbjh721v2Vjh7uUEf7If3xT6/07ZOlhl7rrb8UAADgALr1ICNJeu94l/467Je/+5BevSk0uVTVujra1NPVrnyhqEdPlvTH/3m17d9FQAUAAPCIH1/m9ePL/PrjDwb8Cvo7dfRwuw61SUv5t8oX9n4H0XIYXStai7nm08t6mlnVq6XdCc0EVAAAAI+6N59zfP694136y16ffJ2H5O+2ZnR2dbRJktrapFq74LdZh6hYlNZKxyzl15QvFJXJrerNytquBtFaCKgAAAAtxt7T6jUskgIAAIBRCKgAAAAwCgEVAAAARtnWHNTR6dndLgc8LJmINrsIRqKeoIw64ow6gjLqCOzoQQUAAIBRCKgAAAAwCgEVAAAARiGgAgAAwCgEVAAAABiFgAoAAACjEFABAABgFAIqAAAAjEJABQAAgFEIqAAAADAKARUAAABGIaACAADAKARUAAAAGIWACqBKLD6s5MXQxhMjQ0peCivm5sUjQ0omhjUR2avSAU0SCetaYkhjNX48djGqa/GAq18Viw+7r1PAAdXR7ALsh7GLUZ3LLujyzaztJyFNJoJ6cfOhplK1Xl1xTP+QkjHpy+nvdKPW4SNDSkZXdfXzBc1IkgKauBTWWX9jZZ6bmdWVO429BmiukCZjPin9vE59chaLD2s80uDpKP1co9fTjb0GaLqAPvqLDs3Nlq8RLo0MKRnzNfZWuWzFtQjwlgMRUGtL68rMESXjUU3O1AiEI0c0qA4NxqNKlp66kIjqQun/czOzuiJ7KN1sMeUUkJ1YgfZEg38J0GxjF3s1KEmhXiUTvbUPrHXRbOBiGosPa9xdZxWwN5wCYyisZKL8oKC7Tp0fI31Wh0UsqqS9C3XLOrBcv4PEXr6omwPR0mo2bGp9l0KaTJTO5ZWa0Ng5eAG1xoc1WHWyKJ9YQpqMdejuzVnrJDNSowd1ZO+LDYPcvi0NDFj/PM9qEEWeum1ASeUTmGY2GnWx+LAulGcF1OrZLNW9xacZenRa3f370vy8dOHC1seaznbNsDoorIv7aEWnRu2RukoBTUQrrimVz18K62xuhbpxkHzxhfSrX+3LW9lHZWPxYY0norpQ63xd9bx1zh+/FN7XkNrCAdU2tB4KK5ko6G6qUL8lEAnrWrzH+v/IEQ2mM7rS4HClk2ORypb11uZ2/pbYK/fvSx99ZJ1YfvtbjwfVrKZml5WM9WlMWVc9M7F4UINa1pcV4XQ8otJF16p3ycSRiobcRou87tQVf0DjiQa6fBjdN1cmI/3iF9L589Kvf+3toHqnFEQjYV2Ld+ortz2YTkb6dFZLurrpmtKjE35pbnarL7WvagRvS7nVhouIfZLJSJ98In32mVVH9imols3cfKjR0rn5Wnxpi4ZVWr9PBTUe6dQpiYC6c1lNfT4rqXbLduxiVKe/ty6YG8cs6PK0JAU08bFP8vs2DVdWnyCW9aWLT4sh/hb0xRcbLWAvB9U7rzUX69XpEenGlvOerflzi6kn6+HznyOFijBq1bv11nn5ZW7mizLE33pu37b+tUJQrRQJ61o8oGP250P2jojKYf7yiNx3m77j9kZfbQzxt5z795sYVMvBs18TkWzdtQOnAh2SCvtWMqmlA2od5ZNL+rmuPglIyurG9QW9f6nUy3rzoaZSGwF3Xc0h/iH3LdotObyvwfxLWauCHSSvXlU/9nxQTeubdK8uRMOK3Vmof2gkqIi/oNSDcmMrrSvTFcGz5oW7V8lE0HlO3jZYrX8POWh1ZH6++nGrBdVUuSPDrYAmLvUqmFpwGJGzN/p2yZ3qKQjGO2h1JJOpftykoDrzYEmLkYBO9EuqdW6OhHUuJM3N7GD0YBsOTEAtD7HPpZc1GHKaA1QKhiNDSsaHNLaTYRwHmZfZ2hdvOw+tTu57+aP0wT81uxhmsAdVD7nxdVbn4j36KCLdqnPc2IcBHctldatcd+xzunNZXZ2erTN9ZmOx4abeoNyKZlzvetFAT5IJPvig2SUwgz2oarjZJWpQaYi9zjna6t3PVP88ElREWf3OYRQtFu/XWX9Bdx+4GGHLreqRrBG/C6GtDq6xSMtUn3xy8EKqE3tQ1d/u7fulVpRRQMHjVmfdOvti1/RzXd7nBk8LB9TqC93GEHvp+aoLZbXF1ML6hc9p+5vKIf7F1IIuv3RZpIZb3fCk+flS67ir2SVxL5VRKhdQ5OeBOgE1pNMhaW6mYhi+Ri+N40Xa1fffWyMI2IFgsNklcKeqEbbNhlFqQZedgmIkrE9L15ezH4aklLuOiRvXZ73TOMP2ZTLyL2WV62nCfKaqRpjT2oK918IB1TYH1eF5SQ77ljoof1BVQ/yl1c9blqNHJ/wFvXiygz/FYPPv/ZV0716zi7G/PvvM6im1O39emp6WzpyxHt/yUtDK6tbTgs4Geqoa0ZVOxYMazGV11R5Ia44M1NhuymGu6alAhxazS9suvfEOWh25fVtKOKwKPX/eGl04f956fM8DdcS2SEqSi9Gw8ne/XqANabI01Wz0625diwc1EUnX7PGMHe+Qcq9bd5X/H/6wedi7lWUy1mJbuzNnpF/+0hqJCwaVm97jOhLpVlClUd6aspr6/LkmE706Fw/ohusdX3amhQOqISLdCqqgb/qHlIw3ssmyh4Ywy4HsoDh9uvqxPZh6VHleZyzu3LP1qNa8z009o3VugDEypORJ+1Y6Ab3vlzLf92gyEd68/14dnrmhhce/Gw2zBw17MPW6OqMBjqMHm1hzUgdzWV0tHfdVOqoLH4cVSzl3lliNOGniUrShG7+4X6DbZJ6bu79D9jpiC6b7JfbzHh3Tsr5yeR49FuhRzV6MXUZA3Q31JqP3d+pYblWP7ixUHFPadqeiCz0WD+vUzQVvBFJYWiSY7i7ru+28GKTUC7RJeZQhramKBVfWPLuKhlokrIn+BU15IZDC0mrBtMrm/YAbed2gbSShvFD303hAM5sCZbkRl9bUzY06srHF28ZOARPxJU15IZDC0qRgKml9iomrBXqlntb9HOkioG7D+/FhJSPWlgtbTWwfO+nT4tNnGy3ikSElS5v/b1zAAzr1UjqdiOr0jEd6hA6yM2esIVuCaZXywo25mdkak+lLq5Wf2k5wI0c0mFvS79frw0bIHb2+Ub9i/SvSyaiSJ72ziPDAGhiQbt1q0WBaltaVaWkyEdW14y57KcvzWR0XWZWHUcNKXny+eZGVv7KXq7yx/3ONVu6iMSJJ/UpeCnKLUy+Ynm5OMNXG+hp3PewBTXwc0DEt68t9bPy0dEDdWOlY0N2v662i923aILz8oTltZ/PDzYeaqnzC9nsXU6VAGgnrXGhZX5UuspUrL2su0opxATZeC110nRYBWuzzRzfXEWsaymudrtiEf/R65c8dVuTnsrpadYILaCLq09xsaW/IygUpNW9u0bvvk/XRoJa501qF/k6Ha4dtm7WaNupC/Wkp5dBb/R0f+zAglRfvVl5v/LVuKxzQeGLYW6v4D5pgUPrNb/bt7Qbtt9bNZXV1uk4jxr6Kf6vj90BbsVgsNvqi0b2etNsiYvFhfaonDc//qbyBgBckG7n7zwFCPXEhEta1j6XfNdrbMzKk5MnXnmnIUUeceaKOVAbCLW7jW1YVQiv23W7k+2p1aBR092ZGJ+JH9E2jDbLt1q0moY4480QdaZDbz5qAih3jxOKMeoIy6ogz6gjKqCPOWrGOuP2sD+1xOQAAAICGEFABAABgFAIqAAAAjEJABQAAgFEIqAAAADAKARUAAABGIaACAADAKARUAAAAGIWACgAAAKMQUAEAAGAUAioAAACMQkAFAACAUQioAAAAMAoBFQAAAEZpKxaLxWYXAgAAANVGp2ebXYRdl0xEXR1HDyoAAACMQkAFAACAUQioAAAAMAoBFQAAAEYhoAIAAMAoBFQAAAADDfT5ml2EXdXI30NABQAAMNB4PKy+dzqbXYxdMdDn03g87Pp49kEFAAAw2L/fe6l//c9nyq28bXZRGubvbte//F2fzkWPyt/d7vp1BFQAAAAPmEllNfO/Wc2kskaHVX93u2KRgP7hb46r753OhoJpGQEVAADAY2Z/yGn+2Yrm08uaf2b9awZ/d7v63unUQJ9PAyGfou8f3pW5swRUAACAFvDsp9WqsPrs1aqe/ZRX+qdVvVlZa7jXtdzzafWCHtLhUhgNHe3SQF/3+uPt9JBuhYAKAABwgORW3urNylrNnx/uttbQ70XwdIuACgAAAKOwzRQAAACMQkAFAACAUQioAAAAMAoBFQAAAEYhoAIAAMAoBFQAAAAYhYAKAAAAoxBQAQAAYBQCKgAAAIxCQAUAAIBRCKgAAAAwCgEVAAAARiGgAgAAwCgEVAAAABiFgAoAAACjEFABAABgFAIqAAAAjEJABQAAgFEIqAAAADAKARUAAABGIaACAADAKARUAAAAGIWACgAAAKP8Pwe67CIJbi1oAAAAAElFTkSuQmCC"},56432:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/\u5206\u9875\u4ecb\u7ecd-5f38a66cae5739fbcfae0a56caebc144.png"},34051:(n,e,s)=>{s.d(e,{A:()=>r});const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA/QAAAF4CAYAAAD6yLLoAAAgAElEQVR4nO3dPY7USr8H4ObovDEx60BiGUMKAYu4K7hLuIsggJRZBhLrICZ+g74BajDGrg+7bNfffh7p6DA91eXyR/f45yqXX9zv9/sNAAAACOWfoxsAAAAA1BPoAQAAICCBHgAAAAIS6AEAACAggR4AAAACEugBAAAgIIEeAAAAAhLoAQAAICCBHgAAAAIS6AEAACAggR4AAAACEugBAAAgIIEeAAAAAhLoAQAAICCBHgAAAAIS6AEAACAggR4AAAACEugBAAAgIIEeAAAAAhLoAQAAIKB/j24AXNmXp6ejmwAA0LW3z89HNwG6pYceAAAAAhLoAQAAIKAX9/v9fnQj4MqGw+4NKQMA+Mk5EuTpoQcAAICABHoAAAAISKAHAACAgAR6AAAACEigBwAAgIAEegAAAAhIoAcAAICABHoAAAAISKAHAACAgAR6AAAACEigBwAAgID+PboBAAAAa3x5evr177fPzwe2BPYl0ANAwvcfR7cAgNR38dcPT3/87HubPbx6eXQLfhLoAQCA3QwD+JuP63rTx2EersY99AAAwCHWBPKp9669QADRCPQAAMBhloR6YR5+EugBAIDdTAXvmlAvzMNvAj0AALCrpaFemIc//TEpnhkh4Vg+gz/1MmsoALCdNx+f/wroXz88zQZ0YR7+9uJ+v98fPwgTbMUMpNe15A+tQE9P/G0E2NZcUM+dPwrzHKmX81VD7gEAgMMsGX4vzMNPAj0AAHComoAuzMNv/+aLQFu+hM/PLRYAQC3D7KGeHnoAAKALqcAuzMPf9NADm3r/7tuvf3/6/PrAlgAAEQjuUE6gBzYnyAMAQHtdBfpHT97cyf+ePX16Ffcx3M5DZ97mc+v8cOZ1B6Bf5j8BjmRkxjKbBvrSUJwLONSJcjFi6gLOXsfCkdvo0+fXl7yQAQAAtLXppHil4eTT59dFZR/l9gg9LZf1/t233YPqo91nuVjSehvucQztud8BAIDr6WrIPW1F7O2N2GYAOBtDX4E9uNVnvclAXzIceGrIcmoY89ohzuM21Qzhr11e7v2pXtfU8PG5OQKm6ivtYZ8rV7qskvkKattc6jH0/P27b8XtSI1AyB2HJb3lS/fFkv1eIrUfaj+nc2VSZWuPQwAAYD+TQ+7HJ+clgX3utVw9pUqHvw/D09Ll5ZY1tX3mttGw7FS94/aO65l6z9y2r13WuL2l5XJtrjF871ygTK1X6XE41+aSMnOBfM1+L5HbD0s+pyUXgNYch1OEfQAA2Eb2HvrHyfjae7Jb1ZMyFby2vuf+iAnVHv9f0iOe2/5HbcNo9/zvOY/D7VbeQ54q3/IzWHMcRtmnAAAQjXvoO3HE7O491XW7lQ3B30NPAXTvtvS07gAAQJpA34k9AmzrGfDXtnnNveVb6qU9RzyxoJd1BwAA8rJD7h8hoiR8pQJHTT1Lzd3v3VOvY0l79mhzbrK02m2496P5So61XB0tllVqbT0l23/4/9QcAaWfwd4+OwAAwJ9e3O/3++OH7z9+/6J0FvPczN8l9Ww9W3ftxYOasPt4vWZW+JL1z/XKLtmGa8rVtHnK8JEUj0fh1OzTcfnS9RqWXVqm9X6vmTG+9ljMtWGuTK5c7b4a7u//++//Vn8GX72sKg6bGv5thDMYXtgd/nvqbzXAllIZYfwd1Ztezlezgb7HjUc8ThK2UTNyZs/P8jjQP5S2oZcvSLjdBHrOJXWi7G81sLfx906UMH+79XO+mn0O/dETlAHTSj6nPXyWfX/AtN5PVKAXqRF6R+itPVdWO4LwDGpGep6Rv51/mwz0NhBbGl6JY7n/+c+fP3/9sKwMsD8nJBwhUs9XSwL4OU0dw0c8NeqIR1if9UJGyXdUL0/F6olZ7gFgR1cKUvRleMxFOv5K25oLAHu3h360/t5tfUxNueLfitLvKKH+TwI9cHpfnn6OCnn73Oae0KX1rWnH+L2t14l9XPEEjX2UTPwKZ+dYvw6h/jeBnl2YXIcjvX1+vn15erp9eXoqDsA9BeZHWx7/7qFN1Ct5rOSc1JDS2ifCrHlqzLBcq/s4a4LoknUvLVvzVJgtnryz9ukyrU9o17Sn5T2+JdtvXKbms1a7nZe8f2ldOVf+3niUzQW63LGRexpR7XD+peueWs6aC8ER9vv49tAaQv1P2efQA1zRuCd8rXEoH/83VX78u7fPz8J8ULkTsrlgNj4ZGtaTO/mcen9pmalljcsNX5uru8RUHVNtqln3mm1YsqzcepZuw6kyJeVK2ryFpe0p3Re1bSgtk3vPmu1cUnfq36Wf5RJX/t6YasdcoEwdG1PLToXVue+EVJnUrSAlx1jJZ2DKmfd7SZuuRA89l2Eyvv6tHclREr5TZbYKy6ne/rn2DMum2lzyfo7XqhehprfoUTa17JIytW1rtX6p3x1x4pa7GDO1DUvanAvBpVoPuV/bnl71si57Hs9X+d6I1FO7Rxuj7Pe1EzavGcFwFgI9cBqpwLxkqH2ul378ei6wj4fLb3EvfqsRBbTXKtTvHWZ76vVo2ZZcAJ7q8WsdtFvWdeWT2db2Oub3/Gxd4Xuj1XfsWmf9zux5eVf//rtsoNdbe27u2Wepqfvtx8G5JIiPh8o/XnvUm6tjbhh+Sk/3/TNt7Qln6v7PrfRyotR63UuGcY+XX7vf9m4zbeyxnff8LJ/1e6PXMNdLe8663x963f9HuGyg59oE/n6c9eJaSdhPlZnryU/Ndi/Ix7BXT/2j/tRJT0mZqWUefQLV+sR07sS3ZD1Lt+Fcm6eOh5Llb70vatuzdBkPW9W9tt49jvnc7Rgtlx/le+PIY6Pk+6X0O6iX4zDKfi/Vy9+iXry43+/3xw/ffxzZlH2dNUTw01RgH+5zgb4fU/vl1ct29ed6tZcE75aPnystP/cevfLb2+pv4/CEpPTkMFU21Qsz1ducK5Mrl2tHqalh7XND3XOhuMRc2ZL7TXNlSrfhVNnc8P7S5a0x/D7+v//+7+L2LLngsuRCSK78XHtqj7GaY2Orz3LNsbV2WXPL3PN7oyTQtzg2cnUNyy4ts+Q4TLU5t9/XHq977/fa8/OewnzL89U1BPqbcHcWuX1qn/dpr0C/dth8qZIh9DXhe+4+fZPh7Sfa38Yeenev4Izb0N/J6/K9cU097PfI3zu9BHpD7gEmlEw8VxKea+6Fn7voMH5tarlT9/5zPcNekLkh/SVlSLMNORPfG9dkv5+HQA8w0GLiudre89KRAFP3zZvVnqGSky0nZOvZhpyJ741rst/P45+jGwCc02OSp7mf97Dk/vLU5HKl9T3qWDNR3dK2D98LAMC5CfRAc1P3W+352JQtTAXsxxD3LcxdDDAJHgAAD10Mua95fMSWj2cZKpkcYsv25JZdOxvvGfU6OUtv7Wo14UmLx5S0elxXiZbBd66uI+5bLxkdALCWpwEBxLBJoC8NvD311NU8V/EoqTBfEvC3as94+XvZMxyW6Ol4LtXyWas9yc1s/1A7qV2qN74k1LfszTesHgCATQJ96fNglzxPsQct29Oi17P1skrVPPd3qVybh6H+f/6zaVOyjhhSXrNPpy58rH226pL2bH0hJtUzP5xErqanO/ee2kntlr5/XJfh9wAA19bFkHvSaoN4bxdAtrbHhYWorrhdthiSvrbOrX4vyAMtRXsGNACjQF9yL/bUMOvU0Ou1w7KX3tu+dHmt2pPbluPfz4X2mh7q0raM66zZp0uHaNf0BJe0eeq9Xz9kmzar9tif+v2aZeWe/ZlrS++3iwAAAO39Mct9yXDcuYmuUtYMRf70+XXxcOJx+S16J0vaM27L3DYbzwBeG+aH732UnwuLqWWV7tOS9ZorM7cuc/urZPu00mK91i4rFdBbbJ/oM8wDAAB/mx1y/wgAa+93bVVPSuoRWb1Yuu1Kt9k41Pe2/lN6buORbdvieI4S5M2qDHAcQ+4B4nEP/QaGQXz8+pq6St7fy8zvewfINZPi1eyvVuu1x/ZJ3VoBAADEJ9BvZGr4/JpRDnPv7/Xe6T3b0yKolu6vlk8I2NseF3tq5nTo7ZgFAIBoZgP944S85OQ7Fahq6llqKkS0Wt6SepYuO/W+1mEs18aWzyffcl8MX1s6Kd4W+2tNPUuP5zME5cdwz1cvl9cx9Qi4I2eDr3m0XKrs+HfDn5cso8RW222qvan1O9r3H0e3ALYxvM3JcHuAmF7c7/f744fvP5bPwD0uX1LP0pnFS9uUCjbjP2K5cJobtry0zePyNRPutV5WyQz0S8vM/W7qWEm1ay7M3275E5O535duw9wx3aqeuXI1+7R0O29xPA/fUzKiZGq/rAn0Q6ngODYOjsNya0Ll0mfMz9WzJtDPlds7PPcU1ksI9JyVQA+wXKvz1bVmA33kXr4S/oidz9JAzzbmLj6Nv1uOCvS5nuDaQD9XvlV4Hdefu1BQclGgdRtTllzYGDoy/Av0nJW/iwDL9RLoZ59Df/SkakBsW80/kDIXGlv1kufKp5ZT2obUhYWp10p76Mf1lNTbUulFjmi99wAAR/oj0AvwQGQlPc9re4qXatUrXnvP/NJ2beWo7Q8AcEZmuQdOaU1wHL93LjjXLKN09EBJSK8N8mtHDmw1XP7L09PsyIYtRwsAAJyFQA+c3iM4lhrfXz9X57Bsrvxc3allTU18VytXR0kPfatAPbeOW8w5AABwBQI9cDolwfEoJfeyP9TcEz9+7fHe0pnvj9DD/gAAiEygB9hB65nlW/Vq73UP/dxIgZa3IgAAXI1Af/vzsS1AbEuez76Hmhn492zvXj30c+t0xCP0AADOQqDnklzEOaeaMNg6yOaGwN9u873qPQ17Nws9AEAcAj1wGq0mvpu7z31Y/yOI19yvX7IsAAAoddlA/+aj4Zxzhr3XthNnMw7aU8G79MJAyaR1JUP/a0P92vvOa+5hN/QdAKBflw30XI+LE+ypdrRATYBeG7KFdACAc3hxv9/vjx++/ziyKfRCDz1He/Xy6BbAb/42clb+3gMs18v56j9HNwAAAACoJ9ADAABAQAI9AMBJeUwrwLkJ9AAAJ/QI80I9wHkJ9AAAJyfUA5yTQA8AcELjmeuFeoDzEegBAE6qRaj/+uHJxQCATgn0AAAntvQZ8+MgL9QD9EegBwA4uWGoTwXzR4gX3gFi+PfoBgAAnMH7d99ut9vt9unz6z/+3aNxYM8F+KW9/FuItJ0pY5+m2T6kCPQAACtFOOF+8/G5que9pxD/EGE7U8c+TbN9yBHoAeAktj7Zi3Yy+Wjv7RanzaWW7ouSUL8kyJe0p1WZs1qz7sNjfcoVt+dVXPkzw08CPQCcwJYndbmwcBZLLwDs2YO25b7Yqke+pM01Zc7WU9lyn463Te+f3d736dEXBUu2z+N3799962rbsZ8X9/v9/vjh+48jm0Ivhlfuexxux/m9enl0C+C3CH8b9zoR3vOE+6iT+x5DxZQ17Rz30Of+1tf0rKfK6aFPM8phvS3WPcrIpyvv96P0cr6qhx4AAnMSt61UD2fUbd76Yn3vvcAc44yfnZ7pqb8ugR4AgqrtOR0avmeqTKv7eKfqGZdLtWXpBYvUMlLlxrbo6Ust44z7oic1+7tkG6b26dSohbW3dYx/XlNHzZD8kmNnXG7Pz05u+9Tsi6W3iMy1ZapMSZuXEOqvyXPoASCg2qG3j/9Ky9T2upbWMy43LjNu51y7c0reV7J9WrnCvlja3j1NrcPSfZHbp1P1Lj3GWnwupsJ2rs7SY2fLfV/y2cltn9J90eJzOrUNt/yuG4vwOaQtPfQAENDSnpgje22mTnh770Xactjw2fZFxAAxFWxb1Ner8fdG6sLgcNss+a4562enxhHtPMNIGur8EeiPnskRACiXO9Ee/n78+lirMBYx1KW0DHpn3Bepoc1nkAulpfv0rPa4T77X7dzjsS7MX9MfgX74ZezeCwDoX0moH5ore5UeyiNdYV8s7c3tVW4dSvdpT8YBeU1b91rPHrdzb/tYmL8u99ADQHCp+1yX9CItfV+unrn7kHPLatWenC2XYV/EN173Jdui5bbbel886i4Nilu1Z6vPztLJ75Ysq9Sadb3dhPmrmnwOvYPi2jyHnqP18lxPuN1iPIf+oXT481RvV6pMq3rmys2db6y5FXBNm5cuc6v29Lovpt5b8trUskrXa62a5Wy5L4Zla9c99bmo3Z9L1ru23Fpbbp+p+paWqf1clLY5R247Ti/nqwI9fxHoOVovX5Bwu8UK9AAlSgK9HABpvZyvGnIPAAAXkLt3fnxLwdkMO63gLDy2DgAALqB2kr+zGAb5rx+ejEDlVCZ76M/66BEAAOA6pnrl9dRzJpOB3r0zAABAZKngLtRzFu6hBwAATmUqsBtqzxkJ9AAAwGmU9r7rpecMBHoAAOASxr30Qj3RCfQAAMAplAR0Q+85kz8Cfe7ZlAAAkQzPbYBzG4f5VHAf/k4vPZH98Rx6IR4AOIPIIb5l58pwOzjPm2YbnUNNmJ97v557IjLkHgA4nU+fX+8eznobDTC+MNBT29ZovZ33OE56OzbOZmmYdz89Z/BvvggAAFuaCnste471PHMVtb3sbz4+C/KEJtADAF2Z68kchtKpMktCa2k943KptiwZMj/Xi95inWp76ku3c009JXL7vWa9Uq+llpVrT8m6tz42SGsdxg29JxpD7gGAbgwDz9yw+bkytUOaS+sZlxuXGbfziOH+Q7n2TLVvyXYe1zn+d83+KNnvJes19Z4ly6pZ93Fbej42zmbtffNz79NjTyR66AGArh0ZgHLhtfVySpbf2qPu3oJmb+2ZE6WdZ9MqzA/fL8gTkUAPAHTj0+fXkxOIlQyDX6qHycqmhmlfKSjW7Pc99XBskGeIPFcm0AMAXRmHuEfQKxkm3mJ5HKN0v+/JsdGvLXrUXRggIvfQAwDdWPp4r1aPBRvXM3VfdMmy1rTnivdZb7Xfl05+t2RZpTzCrp03H5+FcC7vxf1+vz9++P7jyKbQi+HVTl+SHOHVy6NbAL/527ivkhnu58qVzGJeW89cubnA3fJRc0vVzhY//n2urtpJ70q2Q02bxuVL9um47NIyqacR5I6RHo6NK3Jey1Z6OV8V6PmLLz6O1ssXJNxu/jYCROa8lq30cr5qyD0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBA/w5/6GXqffrhmAAAAOiTHnoAuJD3777d3r/7dnQzAIAGBHoAOIlcWH/87tPn14e1YS+9tAMAtiTQA8AJ7BHWc8vvKUA/tkNPbQKA1gR6AAju6DD/WPbey89dRBDqATg7gR4AAisN8z2E/iMI9QCc2b/5IgBAj1qF9LmwO6x3qsyS5ZbWMy6XaktuO3z6/PpXb/7VLmgAcG566AEgoJownyo7/N3csPm5MrW93qX1jMuNy4zbWTLcX089AGck0ANAQFsG1CPuh3+YuvjQoj1XveUAgHMz5B4AgmoxlHxYx/j1sVYXD/buJRfmATgrgR4AAsuF+pIwO/7dXH2tAvGewVqYB+DMDLkHgODWDL9f+vz4Vs+dH9cztS4ly5oqI8wDcHYv7vf7/ehG0JcvT0+//v32+fnAlnAGj+Op1bFUU99c2SPb1Ho5ey37yr7/OLoF5cYBtiTQlsxwP1cuNwv+knrmys2tw9TFgOHrwjxc29cPv89r33z0t5J2Xr08ugU/GXIPbOrt8/Pty9PT7cvTU3Ho7CWk5toxvPj1+Hnu4kGpo9eZ2JaE19L3lM4iv9fycuUEeQCuQKAHurPkIsBYi4sC43ZMhfPS+nPlaoL/VNnxay4McLsJtQBwdgI90ERJIE2VaRlAh8tJBd2lIfiIsLzX7QMAAMQh0ANNTAXK2rA5LP94z9xFgJIwPhXeU/ehT9nqQsNWywAA4DoEeqAbU0Pte+yRXnsBIHexIre83JB7FwgAAK5BoAcuZ8n97MP3pEYj7GntBHwAAMQm0AObqxlqPu69bt3bPJzcbq7u3HD88fu3HDWQCukCPADAtQn0wObW9CSX3kNfs5y1s+gP3z+37BaGFwrWrC8AAOck0APdSfV41/SGl058t0RJT3+LZaQI8AAA1ybQA93IBdSWAXptHeNH49XU1yqI66EHALg2gR7YxJLwnZr9/ejZ7aeGvw/bWxLqW7ddgAcAuLZ/jm4AQM7cs+OPCLRTbal9DF0rb5+f//gPAIBr0UMPNNeyN32urpKJ7dYG7PH7U+vjfncAAPYm0ANNzQXwmnA89Z7c49tSj8Cben+uPXPD6kvk2jKltO6SbXL07QkAAOzjxf1+vx/dCPqy9aO4OK9ckFwSNLeos8V79xaprWfz/cfRLQBgqa8ffp/XvvnobyjtvHp5dAt+Euj5xZBgAADOTKinlV4CvUnx+MXEWgAAAHEI9AAAABCQSfFI0mMPXJ176AHicg89ZyfQ8xchHq4jNdlezUR8U2X3nshv6skEU8s3wSAAcBYCPUBASyaxvFqAffv8/Otxg1dbdwB+0ivP2Qn0AIHV9J6XWNt7PbWs8WtHhmu98wDAmQj0wOm1eFb9nKODYQ+Pm+x5aPt42UfvLwCAlgR64LRaht3H8O3xv4/WKqCOh6UP12/4794CccmIgJTe1gcAoMaL+/1+P7oRAFsq6SluVWYvtRcU5nrPU+Vrtsn4PaXtaKnVBH9jZrkHAMZevTy6BT/poQcIrNUw99IAv7ZdW+llxAQAwJ4EeqCJmp7ZqbKlAXDcCzx+RNlUXSnj5SwJtVOTvpUGzFRvcq7cXNm5Ni1pS0pqHUvWf20IT22TuX3Q8+0DAAC1BHqgiblgXRKYx48WSz3TfK7epfe1555ZXlrH+P1Tr02tw9y966ntU7MeqVC7Zi6AXB0lF2ha3v8/9Vpuu0bx/t232+12u336/PrglgAAvRHogU0Mg23L+no1DuipADkO/S2ekz534WSuraX1jF8r3a9HDoHv/VgZyoX1K4X5K60rALQi0AOHyAXOR9Adv34VS4fsr+2JbtWrvdc99HMjBVreirAVAfZPnz6/vr1/9+32/t032wQACgn0wCFyQWoqELboyd7S+ELEmraWvrc0uK5tT629eujn1qn1hY7WhPlpQj0A1Pnn6AYAjHvjp3rnS+rYqj2tPeouDZlT22fo7fPzr/+Grx1p2Kaj29Kb0jB/1dD/WN/H+gMA8/TQA02UzhZfM5w+VWaunsf7Sifkm6svNWS8ZKRA6T3ma7bPVNtSr3G8tSE9F3KH9Y7Lpn63tEyqbGkwn6pPTz0AlHlxv9/vRzcC4CxSFw1aDPueume89JF2uTatvW+/xha99ltt++8/1rXroSbMp8oOf1fy77n6hkF76j21ZUpfS9WVWlcA6Mmrl0e34Cc99AAN5J5vXtvDP6fmfSWhf2ndW7z/7PbsdS7paR+XTbWvpExt29xyAADrCfQADawdgr/FMkvKtGhXL0E+1Y5e2rhnqN/7HvSWyxPmAaCMQA8AO8qF+hZhdm7I/ZZahW9hHgDKmeUeAHa2Z9DOLePx+5L79mtm6F+ybsI8ANQxKR4AJLSaFG9KyeR1U+VzhpPOTf1urq7xckvK5MqVzpYvzAMQSS+T4gn0AJCwZaAf2zPUmmUeAJYT6AEggD0D/V5Sz6ivKQMAVyXQA0AAZwz0AMA6vQR6k+IBAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQC/u9/v96EYAAAAAdfTQAwAAQEACPQAAAAQk0AMAAFMVP5wAAACKSURBVEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQAI9AAAABCTQAwAAQEACPQAAAAQk0AMAAEBAAj0AAAAEJNADAABAQP8PJaxJAp33SWMAAAAASUVORK5CYII="},74685:(n,e,s)=>{s.d(e,{A:()=>r});const r=s.p+"assets/images/\u6ce8\u89e3\u9a71\u52a8\u793a\u4f8b-ad4e4aaa833710228da7fc473c3a9ac8.png"},28453:(n,e,s)=>{s.d(e,{R:()=>c,x:()=>a});var r=s(96540);const i={},l=r.createContext(i);function c(n){const e=r.useContext(l);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:c(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);